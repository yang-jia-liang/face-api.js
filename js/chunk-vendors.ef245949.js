(self["webpackChunkface_api"]=self["webpackChunkface_api"]||[]).push([[998],{9662:function(e,t,n){var r=n(614),o=n(6330),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not a function")}},9483:function(e,t,n){var r=n(4411),o=n(6330),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not a constructor")}},6077:function(e,t,n){var r=n(614),o=String,i=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw i("Can't set "+o(e)+" as a prototype")}},1223:function(e,t,n){var r=n(5112),o=n(30),i=n(3070).f,a=r("unscopables"),s=Array.prototype;void 0==s[a]&&i(s,a,{configurable:!0,value:o(null)}),e.exports=function(e){s[a][e]=!0}},1530:function(e,t,n){"use strict";var r=n(8710).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},5787:function(e,t,n){var r=n(7976),o=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw o("Incorrect invocation")}},9670:function(e,t,n){var r=n(111),o=String,i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not an object")}},4019:function(e){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(e,t,n){"use strict";var r,o,i,a=n(4019),s=n(9781),u=n(7854),c=n(614),l=n(111),f=n(2597),d=n(648),p=n(6330),h=n(8880),v=n(8052),m=n(3070).f,g=n(7976),y=n(9518),b=n(7674),x=n(5112),w=n(9711),C=n(9909),S=C.enforce,E=C.get,k=u.Int8Array,I=k&&k.prototype,_=u.Uint8ClampedArray,R=_&&_.prototype,T=k&&y(k),A=I&&y(I),D=Object.prototype,O=u.TypeError,F=x("toStringTag"),N=w("TYPED_ARRAY_TAG"),P="TypedArrayConstructor",M=a&&!!b&&"Opera"!==d(u.opera),B=!1,W={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L={BigInt64Array:8,BigUint64Array:8},V=function(e){if(!l(e))return!1;var t=d(e);return"DataView"===t||f(W,t)||f(L,t)},z=function(e){var t=y(e);if(l(t)){var n=E(t);return n&&f(n,P)?n[P]:z(t)}},U=function(e){if(!l(e))return!1;var t=d(e);return f(W,t)||f(L,t)},H=function(e){if(U(e))return e;throw O("Target is not a typed array")},j=function(e){if(c(e)&&(!b||g(T,e)))return e;throw O(p(e)+" is not a typed array constructor")},G=function(e,t,n,r){if(s){if(n)for(var o in W){var i=u[o];if(i&&f(i.prototype,e))try{delete i.prototype[e]}catch(a){try{i.prototype[e]=t}catch(c){}}}A[e]&&!n||v(A,e,n?t:M&&I[e]||t,r)}},q=function(e,t,n){var r,o;if(s){if(b){if(n)for(r in W)if(o=u[r],o&&f(o,e))try{delete o[e]}catch(i){}if(T[e]&&!n)return;try{return v(T,e,n?t:M&&T[e]||t)}catch(i){}}for(r in W)o=u[r],!o||o[e]&&!n||v(o,e,t)}};for(r in W)o=u[r],i=o&&o.prototype,i?S(i)[P]=o:M=!1;for(r in L)o=u[r],i=o&&o.prototype,i&&(S(i)[P]=o);if((!M||!c(T)||T===Function.prototype)&&(T=function(){throw O("Incorrect invocation")},M))for(r in W)u[r]&&b(u[r],T);if((!M||!A||A===D)&&(A=T.prototype,M))for(r in W)u[r]&&b(u[r].prototype,A);if(M&&y(R)!==A&&b(R,A),s&&!f(A,F))for(r in B=!0,m(A,F,{get:function(){return l(this)?this[N]:void 0}}),W)u[r]&&h(u[r],N,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:M,TYPED_ARRAY_TAG:B&&N,aTypedArray:H,aTypedArrayConstructor:j,exportTypedArrayMethod:G,exportTypedArrayStaticMethod:q,getTypedArrayConstructor:z,isView:V,isTypedArray:U,TypedArray:T,TypedArrayPrototype:A}},3331:function(e,t,n){"use strict";var r=n(7854),o=n(1702),i=n(9781),a=n(4019),s=n(6530),u=n(8880),c=n(9190),l=n(7293),f=n(5787),d=n(9303),p=n(7466),h=n(7067),v=n(1179),m=n(9518),g=n(7674),y=n(8006).f,b=n(3070).f,x=n(1285),w=n(1589),C=n(8003),S=n(9909),E=s.PROPER,k=s.CONFIGURABLE,I=S.get,_=S.set,R="ArrayBuffer",T="DataView",A="prototype",D="Wrong length",O="Wrong index",F=r[R],N=F,P=N&&N[A],M=r[T],B=M&&M[A],W=Object.prototype,L=r.Array,V=r.RangeError,z=o(x),U=o([].reverse),H=v.pack,j=v.unpack,G=function(e){return[255&e]},q=function(e){return[255&e,e>>8&255]},$=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},K=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},X=function(e){return H(e,23,4)},Y=function(e){return H(e,52,8)},J=function(e,t){b(e[A],t,{get:function(){return I(this)[t]}})},Z=function(e,t,n,r){var o=h(n),i=I(e);if(o+t>i.byteLength)throw V(O);var a=I(i.buffer).bytes,s=o+i.byteOffset,u=w(a,s,s+t);return r?u:U(u)},Q=function(e,t,n,r,o,i){var a=h(n),s=I(e);if(a+t>s.byteLength)throw V(O);for(var u=I(s.buffer).bytes,c=a+s.byteOffset,l=r(+o),f=0;f<t;f++)u[c+f]=l[i?f:t-f-1]};if(a){var ee=E&&F.name!==R;if(l((function(){F(1)}))&&l((function(){new F(-1)}))&&!l((function(){return new F,new F(1.5),new F(NaN),ee&&!k})))ee&&k&&u(F,"name",R);else{N=function(e){return f(this,P),new F(h(e))},N[A]=P;for(var te,ne=y(F),re=0;ne.length>re;)(te=ne[re++])in N||u(N,te,F[te]);P.constructor=N}g&&m(B)!==W&&g(B,W);var oe=new M(new N(2)),ie=o(B.setInt8);oe.setInt8(0,2147483648),oe.setInt8(1,2147483649),!oe.getInt8(0)&&oe.getInt8(1)||c(B,{setInt8:function(e,t){ie(this,e,t<<24>>24)},setUint8:function(e,t){ie(this,e,t<<24>>24)}},{unsafe:!0})}else N=function(e){f(this,P);var t=h(e);_(this,{bytes:z(L(t),0),byteLength:t}),i||(this.byteLength=t)},P=N[A],M=function(e,t,n){f(this,B),f(e,P);var r=I(e).byteLength,o=d(t);if(o<0||o>r)throw V("Wrong offset");if(n=void 0===n?r-o:p(n),o+n>r)throw V(D);_(this,{buffer:e,byteLength:n,byteOffset:o}),i||(this.buffer=e,this.byteLength=n,this.byteOffset=o)},B=M[A],i&&(J(N,"byteLength"),J(M,"buffer"),J(M,"byteLength"),J(M,"byteOffset")),c(B,{getInt8:function(e){return Z(this,1,e)[0]<<24>>24},getUint8:function(e){return Z(this,1,e)[0]},getInt16:function(e){var t=Z(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Z(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return K(Z(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return K(Z(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return j(Z(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return j(Z(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Q(this,1,e,G,t)},setUint8:function(e,t){Q(this,1,e,G,t)},setInt16:function(e,t){Q(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Q(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Q(this,4,e,$,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Q(this,4,e,$,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Q(this,4,e,X,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Q(this,8,e,Y,t,arguments.length>2?arguments[2]:void 0)}});C(N,R),C(M,T),e.exports={ArrayBuffer:N,DataView:M}},1285:function(e,t,n){"use strict";var r=n(7908),o=n(1400),i=n(6244);e.exports=function(e){var t=r(this),n=i(t),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:o(u,n);while(c>s)t[s++]=e;return t}},8457:function(e,t,n){"use strict";var r=n(9974),o=n(6916),i=n(7908),a=n(3411),s=n(7659),u=n(4411),c=n(6244),l=n(6135),f=n(8554),d=n(1246),p=Array;e.exports=function(e){var t=i(e),n=u(this),h=arguments.length,v=h>1?arguments[1]:void 0,m=void 0!==v;m&&(v=r(v,h>2?arguments[2]:void 0));var g,y,b,x,w,C,S=d(t),E=0;if(!S||this===p&&s(S))for(g=c(t),y=n?new this(g):p(g);g>E;E++)C=m?v(t[E],E):t[E],l(y,E,C);else for(x=f(t,S),w=x.next,y=n?new this:[];!(b=o(w,x)).done;E++)C=m?a(x,v,[b.value,E],!0):b.value,l(y,E,C);return y.length=E,y}},1318:function(e,t,n){var r=n(5656),o=n(1400),i=n(6244),a=function(e){return function(t,n,a){var s,u=r(t),c=i(u),l=o(a,c);if(e&&n!=n){while(c>l)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},9671:function(e,t,n){var r=n(9974),o=n(8361),i=n(7908),a=n(6244),s=function(e){var t=1==e;return function(n,s,u){var c,l,f=i(n),d=o(f),p=r(s,u),h=a(d);while(h-- >0)if(c=d[h],l=p(c,h,f),l)switch(e){case 0:return c;case 1:return h}return t?-1:void 0}};e.exports={findLast:s(0),findLastIndex:s(1)}},2092:function(e,t,n){var r=n(9974),o=n(1702),i=n(8361),a=n(7908),s=n(6244),u=n(5417),c=o([].push),l=function(e){var t=1==e,n=2==e,o=3==e,l=4==e,f=6==e,d=7==e,p=5==e||f;return function(h,v,m,g){for(var y,b,x=a(h),w=i(x),C=r(v,m),S=s(w),E=0,k=g||u,I=t?k(h,S):n||d?k(h,0):void 0;S>E;E++)if((p||E in w)&&(y=w[E],b=C(y,E,x),e))if(t)I[E]=b;else if(b)switch(e){case 3:return!0;case 5:return y;case 6:return E;case 2:c(I,y)}else switch(e){case 4:return!1;case 7:c(I,y)}return f?-1:o||l?l:I}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},9341:function(e,t,n){"use strict";var r=n(7293);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},3671:function(e,t,n){var r=n(9662),o=n(7908),i=n(8361),a=n(6244),s=TypeError,u=function(e){return function(t,n,u,c){r(n);var l=o(t),f=i(l),d=a(l),p=e?d-1:0,h=e?-1:1;if(u<2)while(1){if(p in f){c=f[p],p+=h;break}if(p+=h,e?p<0:d<=p)throw s("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=h)p in f&&(c=n(c,f[p],p,l));return c}};e.exports={left:u(!1),right:u(!0)}},1589:function(e,t,n){var r=n(1400),o=n(6244),i=n(6135),a=Array,s=Math.max;e.exports=function(e,t,n){for(var u=o(e),c=r(t,u),l=r(void 0===n?u:n,u),f=a(s(l-c,0)),d=0;c<l;c++,d++)i(f,d,e[c]);return f.length=d,f}},206:function(e,t,n){var r=n(1702);e.exports=r([].slice)},4362:function(e,t,n){var r=n(1589),o=Math.floor,i=function(e,t){var n=e.length,u=o(n/2);return n<8?a(e,t):s(e,i(r(e,0,u),t),i(r(e,u),t),t)},a=function(e,t){var n,r,o=e.length,i=1;while(i<o){r=i,n=e[i];while(r&&t(e[r-1],n)>0)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},s=function(e,t,n,r){var o=t.length,i=n.length,a=0,s=0;while(a<o||s<i)e[a+s]=a<o&&s<i?r(t[a],n[s])<=0?t[a++]:n[s++]:a<o?t[a++]:n[s++];return e};e.exports=i},7475:function(e,t,n){var r=n(3157),o=n(4411),i=n(111),a=n(5112),s=a("species"),u=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,o(t)&&(t===u||r(t.prototype))?t=void 0:i(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?u:t}},5417:function(e,t,n){var r=n(7475);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},3411:function(e,t,n){var r=n(9670),o=n(9212);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(a){o(e,"throw",a)}}},7072:function(e,t,n){var r=n(5112),o=r("iterator"),i=!1;try{var a=0,s={next:function(){return{done:!!a++}},return:function(){i=!0}};s[o]=function(){return this},Array.from(s,(function(){throw 2}))}catch(u){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var r={};r[o]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(u){}return n}},4326:function(e,t,n){var r=n(1702),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},648:function(e,t,n){var r=n(1694),o=n(614),i=n(4326),a=n(5112),s=a("toStringTag"),u=Object,c="Arguments"==i(function(){return arguments}()),l=function(e,t){try{return e[t]}catch(n){}};e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=l(t=u(e),s))?n:c?i(t):"Object"==(r=i(t))&&o(t.callee)?"Arguments":r}},7741:function(e,t,n){var r=n(1702),o=Error,i=r("".replace),a=function(e){return String(o(e).stack)}("zxcasd"),s=/\n\s*at [^:]*:[^\n]*/,u=s.test(a);e.exports=function(e,t){if(u&&"string"==typeof e&&!o.prepareStackTrace)while(t--)e=i(e,s,"");return e}},9920:function(e,t,n){var r=n(2597),o=n(3887),i=n(1236),a=n(3070);e.exports=function(e,t,n){for(var s=o(t),u=a.f,c=i.f,l=0;l<s.length;l++){var f=s[l];r(e,f)||n&&r(n,f)||u(e,f,c(t,f))}}},8544:function(e,t,n){var r=n(7293);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},4994:function(e,t,n){"use strict";var r=n(3383).IteratorPrototype,o=n(30),i=n(9114),a=n(8003),s=n(7497),u=function(){return this};e.exports=function(e,t,n,c){var l=t+" Iterator";return e.prototype=o(r,{next:i(+!c,n)}),a(e,l,!1,!0),s[l]=u,e}},8880:function(e,t,n){var r=n(9781),o=n(3070),i=n(9114);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6135:function(e,t,n){"use strict";var r=n(4948),o=n(3070),i=n(9114);e.exports=function(e,t,n){var a=r(t);a in e?o.f(e,a,i(0,n)):e[a]=n}},7045:function(e,t,n){var r=n(6339),o=n(3070);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),o.f(e,t,n)}},8052:function(e,t,n){var r=n(614),o=n(3070),i=n(6339),a=n(3072);e.exports=function(e,t,n,s){s||(s={});var u=s.enumerable,c=void 0!==s.name?s.name:t;if(r(n)&&i(n,c,s),s.global)u?e[t]=n:a(t,n);else{try{s.unsafe?e[t]&&(u=!0):delete e[t]}catch(l){}u?e[t]=n:o.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},9190:function(e,t,n){var r=n(8052);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},3072:function(e,t,n){var r=n(7854),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},654:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(1913),a=n(6530),s=n(614),u=n(4994),c=n(9518),l=n(7674),f=n(8003),d=n(8880),p=n(8052),h=n(5112),v=n(7497),m=n(3383),g=a.PROPER,y=a.CONFIGURABLE,b=m.IteratorPrototype,x=m.BUGGY_SAFARI_ITERATORS,w=h("iterator"),C="keys",S="values",E="entries",k=function(){return this};e.exports=function(e,t,n,a,h,m,I){u(n,t,a);var _,R,T,A=function(e){if(e===h&&P)return P;if(!x&&e in F)return F[e];switch(e){case C:return function(){return new n(this,e)};case S:return function(){return new n(this,e)};case E:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",O=!1,F=e.prototype,N=F[w]||F["@@iterator"]||h&&F[h],P=!x&&N||A(h),M="Array"==t&&F.entries||N;if(M&&(_=c(M.call(new e)),_!==Object.prototype&&_.next&&(i||c(_)===b||(l?l(_,b):s(_[w])||p(_,w,k)),f(_,D,!0,!0),i&&(v[D]=k))),g&&h==S&&N&&N.name!==S&&(!i&&y?d(F,"name",S):(O=!0,P=function(){return o(N,this)})),h)if(R={values:A(S),keys:m?P:A(C),entries:A(E)},I)for(T in R)(x||O||!(T in F))&&p(F,T,R[T]);else r({target:t,proto:!0,forced:x||O},R);return i&&!I||F[w]===P||p(F,w,P,{name:h}),v[t]=P,R}},7235:function(e,t,n){var r=n(857),o=n(2597),i=n(6061),a=n(3070).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||a(t,e,{value:i.f(e)})}},5117:function(e,t,n){"use strict";var r=n(6330),o=TypeError;e.exports=function(e,t){if(!delete e[t])throw o("Cannot delete property "+r(t)+" of "+r(e))}},9781:function(e,t,n){var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(e,t,n){var r=n(7854),o=n(111),i=r.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},3678:function(e){e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},8324:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:function(e,t,n){var r=n(317),o=r("span").classList,i=o&&o.constructor&&o.constructor.prototype;e.exports=i===Object.prototype?void 0:i},8886:function(e,t,n){var r=n(8113),o=r.match(/firefox\/(\d+)/i);e.exports=!!o&&+o[1]},7871:function(e){e.exports="object"==typeof window&&"object"!=typeof Deno},3823:function(e){e.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},256:function(e,t,n){var r=n(8113);e.exports=/MSIE|Trident/.test(r)},1528:function(e,t,n){var r=n(8113),o=n(7854);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==o.Pebble},6833:function(e,t,n){var r=n(8113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},5268:function(e,t,n){var r=n(4326),o=n(7854);e.exports="process"==r(o.process)},1036:function(e,t,n){var r=n(8113);e.exports=/web0s(?!.*chrome)/i.test(r)},8113:function(e,t,n){var r=n(5005);e.exports=r("navigator","userAgent")||""},7392:function(e,t,n){var r,o,i=n(7854),a=n(8113),s=i.process,u=i.Deno,c=s&&s.versions||u&&u.version,l=c&&c.v8;l&&(r=l.split("."),o=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(o=+r[1]))),e.exports=o},8008:function(e,t,n){var r=n(8113),o=r.match(/AppleWebKit\/(\d+)\./);e.exports=!!o&&+o[1]},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2914:function(e,t,n){var r=n(7293),o=n(9114);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",o(1,7)),7!==e.stack)}))},7762:function(e,t,n){"use strict";var r=n(9781),o=n(7293),i=n(9670),a=n(30),s=n(6277),u=Error.prototype.toString,c=o((function(){if(r){var e=a(Object.defineProperty({},"name",{get:function(){return this===e}}));if("true"!==u.call(e))return!0}return"2: 1"!==u.call({message:1,name:2})||"Error"!==u.call({})}));e.exports=c?function(){var e=i(this),t=s(e.name,"Error"),n=s(e.message);return t?n?t+": "+n:t:n}:u},2109:function(e,t,n){var r=n(7854),o=n(1236).f,i=n(8880),a=n(8052),s=n(3072),u=n(9920),c=n(4705);e.exports=function(e,t){var n,l,f,d,p,h,v=e.target,m=e.global,g=e.stat;if(l=m?r:g?r[v]||s(v,{}):(r[v]||{}).prototype,l)for(f in t){if(p=t[f],e.dontCallGetSet?(h=o(l,f),d=h&&h.value):d=l[f],n=c(m?f:v+(g?".":"#")+f,e.forced),!n&&void 0!==d){if(typeof p==typeof d)continue;u(p,d)}(e.sham||d&&d.sham)&&i(p,"sham",!0),a(l,f,p,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},7007:function(e,t,n){"use strict";n(4916);var r=n(1702),o=n(8052),i=n(2261),a=n(7293),s=n(5112),u=n(8880),c=s("species"),l=RegExp.prototype;e.exports=function(e,t,n,f){var d=s(e),p=!a((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),h=p&&!a((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return t=!0,null},n[d](""),!t}));if(!p||!h||n){var v=r(/./[d]),m=t(d,""[e],(function(e,t,n,o,a){var s=r(e),u=t.exec;return u===i||u===l.exec?p&&!a?{done:!0,value:v(t,n,o)}:{done:!0,value:s(n,t,o)}:{done:!1}}));o(String.prototype,e,m[0]),o(l,d,m[1])}f&&u(l[d],"sham",!0)}},2104:function(e,t,n){var r=n(4374),o=Function.prototype,i=o.apply,a=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(i):function(){return a.apply(i,arguments)})},9974:function(e,t,n){var r=n(1702),o=n(9662),i=n(4374),a=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?a(e,t):function(){return e.apply(t,arguments)}}},4374:function(e,t,n){var r=n(7293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:function(e,t,n){var r=n(4374),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},6530:function(e,t,n){var r=n(9781),o=n(2597),i=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=o(i,"name"),u=s&&"something"===function(){}.name,c=s&&(!r||r&&a(i,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:c}},1702:function(e,t,n){var r=n(4374),o=Function.prototype,i=o.bind,a=o.call,s=r&&i.bind(a,a);e.exports=r?function(e){return e&&s(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},5005:function(e,t,n){var r=n(7854),o=n(614),i=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},1246:function(e,t,n){var r=n(648),o=n(8173),i=n(7497),a=n(5112),s=a("iterator");e.exports=function(e){if(void 0!=e)return o(e,s)||o(e,"@@iterator")||i[r(e)]}},8554:function(e,t,n){var r=n(6916),o=n(9662),i=n(9670),a=n(6330),s=n(1246),u=TypeError;e.exports=function(e,t){var n=arguments.length<2?s(e):t;if(o(n))return i(r(n,e));throw u(a(e)+" is not iterable")}},8173:function(e,t,n){var r=n(9662);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},647:function(e,t,n){var r=n(1702),o=n(7908),i=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,f,d){var p=n+e.length,h=r.length,v=l;return void 0!==f&&(f=o(f),v=c),s(d,v,(function(o,s){var c;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,p);case"<":c=f[u(s,1,-1)];break;default:var l=+s;if(0===l)return o;if(l>h){var d=i(l/10);return 0===d?o:d<=h?void 0===r[d-1]?a(s,1):r[d-1]+a(s,1):o}c=r[l-1]}return void 0===c?"":c}))}},7854:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:function(e,t,n){var r=n(1702),o=n(7908),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},3501:function(e){e.exports={}},842:function(e,t,n){var r=n(7854);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},490:function(e,t,n){var r=n(5005);e.exports=r("document","documentElement")},4664:function(e,t,n){var r=n(9781),o=n(7293),i=n(317);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},1179:function(e){var t=Array,n=Math.abs,r=Math.pow,o=Math.floor,i=Math.log,a=Math.LN2,s=function(e,s,u){var c,l,f,d=t(u),p=8*u-s-1,h=(1<<p)-1,v=h>>1,m=23===s?r(2,-24)-r(2,-77):0,g=e<0||0===e&&1/e<0?1:0,y=0;e=n(e),e!=e||e===1/0?(l=e!=e?1:0,c=h):(c=o(i(e)/a),f=r(2,-c),e*f<1&&(c--,f*=2),e+=c+v>=1?m/f:m*r(2,1-v),e*f>=2&&(c++,f/=2),c+v>=h?(l=0,c=h):c+v>=1?(l=(e*f-1)*r(2,s),c+=v):(l=e*r(2,v-1)*r(2,s),c=0));while(s>=8)d[y++]=255&l,l/=256,s-=8;c=c<<s|l,p+=s;while(p>0)d[y++]=255&c,c/=256,p-=8;return d[--y]|=128*g,d},u=function(e,t){var n,o=e.length,i=8*o-t-1,a=(1<<i)-1,s=a>>1,u=i-7,c=o-1,l=e[c--],f=127&l;l>>=7;while(u>0)f=256*f+e[c--],u-=8;n=f&(1<<-u)-1,f>>=-u,u+=t;while(u>0)n=256*n+e[c--],u-=8;if(0===f)f=1-s;else{if(f===a)return n?NaN:l?-1/0:1/0;n+=r(2,t),f-=s}return(l?-1:1)*n*r(2,f-t)};e.exports={pack:s,unpack:u}},8361:function(e,t,n){var r=n(1702),o=n(7293),i=n(4326),a=Object,s=r("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?s(e,""):a(e)}:a},9587:function(e,t,n){var r=n(614),o=n(111),i=n(7674);e.exports=function(e,t,n){var a,s;return i&&r(a=t.constructor)&&a!==n&&o(s=a.prototype)&&s!==n.prototype&&i(e,s),e}},2788:function(e,t,n){var r=n(1702),o=n(614),i=n(5465),a=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return a(e)}),e.exports=i.inspectSource},8340:function(e,t,n){var r=n(111),o=n(8880);e.exports=function(e,t){r(t)&&"cause"in t&&o(e,"cause",t.cause)}},9909:function(e,t,n){var r,o,i,a=n(8536),s=n(7854),u=n(1702),c=n(111),l=n(8880),f=n(2597),d=n(5465),p=n(6200),h=n(3501),v="Object already initialized",m=s.TypeError,g=s.WeakMap,y=function(e){return i(e)?o(e):r(e,{})},b=function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}};if(a||d.state){var x=d.state||(d.state=new g),w=u(x.get),C=u(x.has),S=u(x.set);r=function(e,t){if(C(x,e))throw new m(v);return t.facade=e,S(x,e,t),t},o=function(e){return w(x,e)||{}},i=function(e){return C(x,e)}}else{var E=p("state");h[E]=!0,r=function(e,t){if(f(e,E))throw new m(v);return t.facade=e,l(e,E,t),t},o=function(e){return f(e,E)?e[E]:{}},i=function(e){return f(e,E)}}e.exports={set:r,get:o,has:i,enforce:y,getterFor:b}},7659:function(e,t,n){var r=n(5112),o=n(7497),i=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[i]===e)}},3157:function(e,t,n){var r=n(4326);e.exports=Array.isArray||function(e){return"Array"==r(e)}},614:function(e){e.exports=function(e){return"function"==typeof e}},4411:function(e,t,n){var r=n(1702),o=n(7293),i=n(614),a=n(648),s=n(5005),u=n(2788),c=function(){},l=[],f=s("Reflect","construct"),d=/^\s*(?:class|function)\b/,p=r(d.exec),h=!d.exec(c),v=function(e){if(!i(e))return!1;try{return f(c,l,e),!0}catch(t){return!1}},m=function(e){if(!i(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!p(d,u(e))}catch(t){return!0}};m.sham=!0,e.exports=!f||o((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?m:v},4705:function(e,t,n){var r=n(7293),o=n(614),i=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n==l||n!=c&&(o(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},5988:function(e,t,n){var r=n(111),o=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&o(e)===e}},111:function(e,t,n){var r=n(614);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},1913:function(e){e.exports=!1},7850:function(e,t,n){var r=n(111),o=n(4326),i=n(5112),a=i("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==o(e))}},2190:function(e,t,n){var r=n(5005),o=n(614),i=n(7976),a=n(3307),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&i(t.prototype,s(e))}},408:function(e,t,n){var r=n(9974),o=n(6916),i=n(9670),a=n(6330),s=n(7659),u=n(6244),c=n(7976),l=n(8554),f=n(1246),d=n(9212),p=TypeError,h=function(e,t){this.stopped=e,this.result=t},v=h.prototype;e.exports=function(e,t,n){var m,g,y,b,x,w,C,S=n&&n.that,E=!(!n||!n.AS_ENTRIES),k=!(!n||!n.IS_RECORD),I=!(!n||!n.IS_ITERATOR),_=!(!n||!n.INTERRUPTED),R=r(t,S),T=function(e){return m&&d(m,"normal",e),new h(!0,e)},A=function(e){return E?(i(e),_?R(e[0],e[1],T):R(e[0],e[1])):_?R(e,T):R(e)};if(k)m=e.iterator;else if(I)m=e;else{if(g=f(e),!g)throw p(a(e)+" is not iterable");if(s(g)){for(y=0,b=u(e);b>y;y++)if(x=A(e[y]),x&&c(v,x))return x;return new h(!1)}m=l(e,g)}w=k?e.next:m.next;while(!(C=o(w,m)).done){try{x=A(C.value)}catch(D){d(m,"throw",D)}if("object"==typeof x&&x&&c(v,x))return x}return new h(!1)}},9212:function(e,t,n){var r=n(6916),o=n(9670),i=n(8173);e.exports=function(e,t,n){var a,s;o(e);try{if(a=i(e,"return"),!a){if("throw"===t)throw n;return n}a=r(a,e)}catch(u){s=!0,a=u}if("throw"===t)throw n;if(s)throw a;return o(a),n}},3383:function(e,t,n){"use strict";var r,o,i,a=n(7293),s=n(614),u=n(30),c=n(9518),l=n(8052),f=n(5112),d=n(1913),p=f("iterator"),h=!1;[].keys&&(i=[].keys(),"next"in i?(o=c(c(i)),o!==Object.prototype&&(r=o)):h=!0);var v=void 0==r||a((function(){var e={};return r[p].call(e)!==e}));v?r={}:d&&(r=u(r)),s(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},7497:function(e){e.exports={}},6244:function(e,t,n){var r=n(7466);e.exports=function(e){return r(e.length)}},6339:function(e,t,n){var r=n(7293),o=n(614),i=n(2597),a=n(9781),s=n(6530).CONFIGURABLE,u=n(2788),c=n(9909),l=c.enforce,f=c.get,d=Object.defineProperty,p=a&&!r((function(){return 8!==d((function(){}),"length",{value:8}).length})),h=String(String).split("String"),v=e.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||s&&e.name!==t)&&(a?d(e,"name",{value:t,configurable:!0}):e.name=t),p&&n&&i(n,"arity")&&e.length!==n.arity&&d(e,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?a&&d(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(o){}var r=l(e);return i(r,"source")||(r.source=h.join("string"==typeof t?t:"")),e};Function.prototype.toString=v((function(){return o(this)&&f(this).source||u(this)}),"toString")},4758:function(e){var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},5948:function(e,t,n){var r,o,i,a,s,u,c,l,f=n(7854),d=n(9974),p=n(1236).f,h=n(261).set,v=n(6833),m=n(1528),g=n(1036),y=n(5268),b=f.MutationObserver||f.WebKitMutationObserver,x=f.document,w=f.process,C=f.Promise,S=p(f,"queueMicrotask"),E=S&&S.value;E||(r=function(){var e,t;y&&(e=w.domain)&&e.exit();while(o){t=o.fn,o=o.next;try{t()}catch(n){throw o?a():i=void 0,n}}i=void 0,e&&e.enter()},v||y||g||!b||!x?!m&&C&&C.resolve?(c=C.resolve(void 0),c.constructor=C,l=d(c.then,c),a=function(){l(r)}):y?a=function(){w.nextTick(r)}:(h=d(h,f),a=function(){h(r)}):(s=!0,u=x.createTextNode(""),new b(r).observe(u,{characterData:!0}),a=function(){u.data=s=!s})),e.exports=E||function(e){var t={fn:e,next:void 0};i&&(i.next=t),o||(o=t,a()),i=t}},133:function(e,t,n){var r=n(7392),o=n(7293);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},590:function(e,t,n){var r=n(7293),o=n(5112),i=n(1913),a=o("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t["delete"]("b"),n+=r+e})),i&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},8536:function(e,t,n){var r=n(7854),o=n(614),i=n(2788),a=r.WeakMap;e.exports=o(a)&&/native code/.test(i(a))},8523:function(e,t,n){"use strict";var r=n(9662),o=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new o(e)}},6277:function(e,t,n){var r=n(1340);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},1574:function(e,t,n){"use strict";var r=n(9781),o=n(1702),i=n(6916),a=n(7293),s=n(1956),u=n(5181),c=n(5296),l=n(7908),f=n(8361),d=Object.assign,p=Object.defineProperty,h=o([].concat);e.exports=!d||a((function(){if(r&&1!==d({b:1},d(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||s(d({},t)).join("")!=o}))?function(e,t){var n=l(e),o=arguments.length,a=1,d=u.f,p=c.f;while(o>a){var v,m=f(arguments[a++]),g=d?h(s(m),d(m)):s(m),y=g.length,b=0;while(y>b)v=g[b++],r&&!i(p,m,v)||(n[v]=m[v])}return n}:d},30:function(e,t,n){var r,o=n(9670),i=n(6048),a=n(748),s=n(3501),u=n(490),c=n(317),l=n(6200),f=">",d="<",p="prototype",h="script",v=l("IE_PROTO"),m=function(){},g=function(e){return d+h+f+e+d+"/"+h+f},y=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},b=function(){var e,t=c("iframe"),n="java"+h+":";return t.style.display="none",u.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(g("document.F=Object")),e.close(),e.F},x=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}x="undefined"!=typeof document?document.domain&&r?y(r):b():y(r);var e=a.length;while(e--)delete x[p][a[e]];return x()};s[v]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[p]=o(e),n=new m,m[p]=null,n[v]=e):n=x(),void 0===t?n:i.f(n,t)}},6048:function(e,t,n){var r=n(9781),o=n(3353),i=n(3070),a=n(9670),s=n(5656),u=n(1956);t.f=r&&!o?Object.defineProperties:function(e,t){a(e);var n,r=s(t),o=u(t),c=o.length,l=0;while(c>l)i.f(e,n=o[l++],r[n]);return e}},3070:function(e,t,n){var r=n(9781),o=n(4664),i=n(3353),a=n(9670),s=n(4948),u=TypeError,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,f="enumerable",d="configurable",p="writable";t.f=r?i?function(e,t,n){if(a(e),t=s(t),a(n),"function"===typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=l(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:f in n?n[f]:r[f],writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(a(e),t=s(t),a(n),o)try{return c(e,t,n)}catch(r){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:function(e,t,n){var r=n(9781),o=n(6916),i=n(5296),a=n(9114),s=n(5656),u=n(4948),c=n(2597),l=n(4664),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=s(e),t=u(t),l)try{return f(e,t)}catch(n){}if(c(e,t))return a(!o(i.f,e,t),e[t])}},8006:function(e,t,n){var r=n(6324),o=n(748),i=o.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},9518:function(e,t,n){var r=n(2597),o=n(614),i=n(7908),a=n(6200),s=n(8544),u=a("IE_PROTO"),c=Object,l=c.prototype;e.exports=s?c.getPrototypeOf:function(e){var t=i(e);if(r(t,u))return t[u];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof c?l:null}},7976:function(e,t,n){var r=n(1702);e.exports=r({}.isPrototypeOf)},6324:function(e,t,n){var r=n(1702),o=n(2597),i=n(5656),a=n(1318).indexOf,s=n(3501),u=r([].push);e.exports=function(e,t){var n,r=i(e),c=0,l=[];for(n in r)!o(s,n)&&o(r,n)&&u(l,n);while(t.length>c)o(r,n=t[c++])&&(~a(l,n)||u(l,n));return l}},1956:function(e,t,n){var r=n(6324),o=n(748);e.exports=Object.keys||function(e){return r(e,o)}},5296:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7674:function(e,t,n){var r=n(1702),o=n(9670),i=n(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(n,[]),t=n instanceof Array}catch(a){}return function(n,r){return o(n),i(r),t?e(n,r):n.__proto__=r,n}}():void 0)},2140:function(e,t,n){var r=n(6916),o=n(614),i=n(111),a=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&o(n=e.toString)&&!i(s=r(n,e)))return s;if(o(n=e.valueOf)&&!i(s=r(n,e)))return s;if("string"!==t&&o(n=e.toString)&&!i(s=r(n,e)))return s;throw a("Can't convert object to primitive value")}},3887:function(e,t,n){var r=n(5005),o=n(1702),i=n(8006),a=n(5181),s=n(9670),u=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(s(e)),n=a.f;return n?u(t,n(e)):t}},857:function(e,t,n){var r=n(7854);e.exports=r},2534:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},3702:function(e,t,n){var r=n(7854),o=n(2492),i=n(614),a=n(4705),s=n(2788),u=n(5112),c=n(7871),l=n(3823),f=n(1913),d=n(7392),p=o&&o.prototype,h=u("species"),v=!1,m=i(r.PromiseRejectionEvent),g=a("Promise",(function(){var e=s(o),t=e!==String(o);if(!t&&66===d)return!0;if(f&&(!p["catch"]||!p["finally"]))return!0;if(d<51||!/native code/.test(e)){var n=new o((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))},i=n.constructor={};if(i[h]=r,v=n.then((function(){}))instanceof r,!v)return!0}return!t&&(c||l)&&!m}));e.exports={CONSTRUCTOR:g,REJECTION_EVENT:m,SUBCLASSING:v}},2492:function(e,t,n){var r=n(7854);e.exports=r.Promise},9478:function(e,t,n){var r=n(9670),o=n(111),i=n(8523);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e),a=n.resolve;return a(t),n.promise}},612:function(e,t,n){var r=n(2492),o=n(7072),i=n(3702).CONSTRUCTOR;e.exports=i||!o((function(e){r.all(e).then(void 0,(function(){}))}))},2626:function(e,t,n){var r=n(3070).f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},8572:function(e){var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},7651:function(e,t,n){var r=n(6916),o=n(9670),i=n(614),a=n(4326),s=n(2261),u=TypeError;e.exports=function(e,t){var n=e.exec;if(i(n)){var c=r(n,e,t);return null!==c&&o(c),c}if("RegExp"===a(e))return r(s,e,t);throw u("RegExp#exec called on incompatible receiver")}},2261:function(e,t,n){"use strict";var r=n(6916),o=n(1702),i=n(1340),a=n(7066),s=n(2999),u=n(2309),c=n(30),l=n(9909).get,f=n(9441),d=n(7168),p=u("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,v=h,m=o("".charAt),g=o("".indexOf),y=o("".replace),b=o("".slice),x=function(){var e=/a/,t=/b*/g;return r(h,e,"a"),r(h,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),w=s.BROKEN_CARET,C=void 0!==/()??/.exec("")[1],S=x||C||w||f||d;S&&(v=function(e){var t,n,o,s,u,f,d,S=this,E=l(S),k=i(e),I=E.raw;if(I)return I.lastIndex=S.lastIndex,t=r(v,I,k),S.lastIndex=I.lastIndex,t;var _=E.groups,R=w&&S.sticky,T=r(a,S),A=S.source,D=0,O=k;if(R&&(T=y(T,"y",""),-1===g(T,"g")&&(T+="g"),O=b(k,S.lastIndex),S.lastIndex>0&&(!S.multiline||S.multiline&&"\n"!==m(k,S.lastIndex-1))&&(A="(?: "+A+")",O=" "+O,D++),n=new RegExp("^(?:"+A+")",T)),C&&(n=new RegExp("^"+A+"$(?!\\s)",T)),x&&(o=S.lastIndex),s=r(h,R?n:S,O),R?s?(s.input=b(s.input,D),s[0]=b(s[0],D),s.index=S.lastIndex,S.lastIndex+=s[0].length):S.lastIndex=0:x&&s&&(S.lastIndex=S.global?s.index+s[0].length:o),C&&s&&s.length>1&&r(p,s[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(s[u]=void 0)})),s&&_)for(s.groups=f=c(null),u=0;u<_.length;u++)d=_[u],f[d[0]]=s[d[1]];return s}),e.exports=v},7066:function(e,t,n){"use strict";var r=n(9670);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},4706:function(e,t,n){var r=n(6916),o=n(2597),i=n(7976),a=n(7066),s=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in s||o(e,"flags")||!i(s,e)?t:r(a,e)}},2999:function(e,t,n){var r=n(7293),o=n(7854),i=o.RegExp,a=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),s=a||r((function(){return!i("a","y").sticky})),u=a||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:u,MISSED_STICKY:s,UNSUPPORTED_Y:a}},9441:function(e,t,n){var r=n(7293),o=n(7854),i=o.RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},7168:function(e,t,n){var r=n(7293),o=n(7854),i=o.RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},4488:function(e){var t=TypeError;e.exports=function(e){if(void 0==e)throw t("Can't call method on "+e);return e}},6340:function(e,t,n){"use strict";var r=n(5005),o=n(3070),i=n(5112),a=n(9781),s=i("species");e.exports=function(e){var t=r(e),n=o.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},8003:function(e,t,n){var r=n(3070).f,o=n(2597),i=n(5112),a=i("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!o(e,a)&&r(e,a,{configurable:!0,value:t})}},6200:function(e,t,n){var r=n(2309),o=n(9711),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},5465:function(e,t,n){var r=n(7854),o=n(3072),i="__core-js_shared__",a=r[i]||o(i,{});e.exports=a},2309:function(e,t,n){var r=n(1913),o=n(5465);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.24.0",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6707:function(e,t,n){var r=n(9670),o=n(9483),i=n(5112),a=i("species");e.exports=function(e,t){var n,i=r(e).constructor;return void 0===i||void 0==(n=r(i)[a])?t:o(n)}},8710:function(e,t,n){var r=n(1702),o=n(9303),i=n(1340),a=n(4488),s=r("".charAt),u=r("".charCodeAt),c=r("".slice),l=function(e){return function(t,n){var r,l,f=i(a(t)),d=o(n),p=f.length;return d<0||d>=p?e?"":void 0:(r=u(f,d),r<55296||r>56319||d+1===p||(l=u(f,d+1))<56320||l>57343?e?s(f,d):r:e?c(f,d,d+2):l-56320+(r-55296<<10)+65536)}};e.exports={codeAt:l(!1),charAt:l(!0)}},3197:function(e,t,n){"use strict";var r=n(1702),o=2147483647,i=36,a=1,s=26,u=38,c=700,l=72,f=128,d="-",p=/[^\0-\u007E]/,h=/[.\u3002\uFF0E\uFF61]/g,v="Overflow: input needs wider integers to process",m=i-a,g=RangeError,y=r(h.exec),b=Math.floor,x=String.fromCharCode,w=r("".charCodeAt),C=r([].join),S=r([].push),E=r("".replace),k=r("".split),I=r("".toLowerCase),_=function(e){var t=[],n=0,r=e.length;while(n<r){var o=w(e,n++);if(o>=55296&&o<=56319&&n<r){var i=w(e,n++);56320==(64512&i)?S(t,((1023&o)<<10)+(1023&i)+65536):(S(t,o),n--)}else S(t,o)}return t},R=function(e){return e+22+75*(e<26)},T=function(e,t,n){var r=0;e=n?b(e/c):e>>1,e+=b(e/t);while(e>m*s>>1)e=b(e/m),r+=i;return b(r+(m+1)*e/(e+u))},A=function(e){var t=[];e=_(e);var n,r,u=e.length,c=f,p=0,h=l;for(n=0;n<e.length;n++)r=e[n],r<128&&S(t,x(r));var m=t.length,y=m;m&&S(t,d);while(y<u){var w=o;for(n=0;n<e.length;n++)r=e[n],r>=c&&r<w&&(w=r);var E=y+1;if(w-c>b((o-p)/E))throw g(v);for(p+=(w-c)*E,c=w,n=0;n<e.length;n++){if(r=e[n],r<c&&++p>o)throw g(v);if(r==c){var k=p,I=i;while(1){var A=I<=h?a:I>=h+s?s:I-h;if(k<A)break;var D=k-A,O=i-A;S(t,x(R(A+D%O))),k=b(D/O),I+=i}S(t,x(R(k))),h=T(p,E,y==m),p=0,y++}}p++,c++}return C(t,"")};e.exports=function(e){var t,n,r=[],o=k(E(I(e),h,"."),".");for(t=0;t<o.length;t++)n=o[t],S(r,y(p,n)?"xn--"+A(n):n);return C(r,".")}},6091:function(e,t,n){var r=n(6530).PROPER,o=n(7293),i=n(1361),a="​᠎";e.exports=function(e){return o((function(){return!!i[e]()||a[e]()!==a||r&&i[e].name!==e}))}},3111:function(e,t,n){var r=n(1702),o=n(4488),i=n(1340),a=n(1361),s=r("".replace),u="["+a+"]",c=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),f=function(e){return function(t){var n=i(o(t));return 1&e&&(n=s(n,c,"")),2&e&&(n=s(n,l,"")),n}};e.exports={start:f(1),end:f(2),trim:f(3)}},261:function(e,t,n){var r,o,i,a,s=n(7854),u=n(2104),c=n(9974),l=n(614),f=n(2597),d=n(7293),p=n(490),h=n(206),v=n(317),m=n(8053),g=n(6833),y=n(5268),b=s.setImmediate,x=s.clearImmediate,w=s.process,C=s.Dispatch,S=s.Function,E=s.MessageChannel,k=s.String,I=0,_={},R="onreadystatechange";try{r=s.location}catch(F){}var T=function(e){if(f(_,e)){var t=_[e];delete _[e],t()}},A=function(e){return function(){T(e)}},D=function(e){T(e.data)},O=function(e){s.postMessage(k(e),r.protocol+"//"+r.host)};b&&x||(b=function(e){m(arguments.length,1);var t=l(e)?e:S(e),n=h(arguments,1);return _[++I]=function(){u(t,void 0,n)},o(I),I},x=function(e){delete _[e]},y?o=function(e){w.nextTick(A(e))}:C&&C.now?o=function(e){C.now(A(e))}:E&&!g?(i=new E,a=i.port2,i.port1.onmessage=D,o=c(a.postMessage,a)):s.addEventListener&&l(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!d(O)?(o=O,s.addEventListener("message",D,!1)):o=R in v("script")?function(e){p.appendChild(v("script"))[R]=function(){p.removeChild(this),T(e)}}:function(e){setTimeout(A(e),0)}),e.exports={set:b,clear:x}},1400:function(e,t,n){var r=n(9303),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},4599:function(e,t,n){var r=n(7593),o=TypeError;e.exports=function(e){var t=r(e,"number");if("number"==typeof t)throw o("Can't convert number to bigint");return BigInt(t)}},7067:function(e,t,n){var r=n(9303),o=n(7466),i=RangeError;e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=o(t);if(t!==n)throw i("Wrong length or index");return n}},5656:function(e,t,n){var r=n(8361),o=n(4488);e.exports=function(e){return r(o(e))}},9303:function(e,t,n){var r=n(4758);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},7466:function(e,t,n){var r=n(9303),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},7908:function(e,t,n){var r=n(4488),o=Object;e.exports=function(e){return o(r(e))}},4590:function(e,t,n){var r=n(3002),o=RangeError;e.exports=function(e,t){var n=r(e);if(n%t)throw o("Wrong offset");return n}},3002:function(e,t,n){var r=n(9303),o=RangeError;e.exports=function(e){var t=r(e);if(t<0)throw o("The argument can't be less than 0");return t}},7593:function(e,t,n){var r=n(6916),o=n(111),i=n(2190),a=n(8173),s=n(2140),u=n(5112),c=TypeError,l=u("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var n,u=a(e,l);if(u){if(void 0===t&&(t="default"),n=r(u,e,t),!o(n)||i(n))return n;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},4948:function(e,t,n){var r=n(7593),o=n(2190);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},1694:function(e,t,n){var r=n(5112),o=r("toStringTag"),i={};i[o]="z",e.exports="[object z]"===String(i)},1340:function(e,t,n){var r=n(648),o=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},4038:function(e,t,n){var r=n(5268);e.exports=function(e){try{if(r)return Function('return require("'+e+'")')()}catch(t){}}},6330:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},9843:function(e,t,n){"use strict";var r=n(2109),o=n(7854),i=n(6916),a=n(9781),s=n(3832),u=n(260),c=n(3331),l=n(5787),f=n(9114),d=n(8880),p=n(5988),h=n(7466),v=n(7067),m=n(4590),g=n(4948),y=n(2597),b=n(648),x=n(111),w=n(2190),C=n(30),S=n(7976),E=n(7674),k=n(8006).f,I=n(7321),_=n(2092).forEach,R=n(6340),T=n(3070),A=n(1236),D=n(9909),O=n(9587),F=D.get,N=D.set,P=D.enforce,M=T.f,B=A.f,W=Math.round,L=o.RangeError,V=c.ArrayBuffer,z=V.prototype,U=c.DataView,H=u.NATIVE_ARRAY_BUFFER_VIEWS,j=u.TYPED_ARRAY_TAG,G=u.TypedArray,q=u.TypedArrayPrototype,$=u.aTypedArrayConstructor,K=u.isTypedArray,X="BYTES_PER_ELEMENT",Y="Wrong length",J=function(e,t){$(e);var n=0,r=t.length,o=new e(r);while(r>n)o[n]=t[n++];return o},Z=function(e,t){M(e,t,{get:function(){return F(this)[t]}})},Q=function(e){var t;return S(z,e)||"ArrayBuffer"==(t=b(e))||"SharedArrayBuffer"==t},ee=function(e,t){return K(e)&&!w(t)&&t in e&&p(+t)&&t>=0},te=function(e,t){return t=g(t),ee(e,t)?f(2,e[t]):B(e,t)},ne=function(e,t,n){return t=g(t),!(ee(e,t)&&x(n)&&y(n,"value"))||y(n,"get")||y(n,"set")||n.configurable||y(n,"writable")&&!n.writable||y(n,"enumerable")&&!n.enumerable?M(e,t,n):(e[t]=n.value,e)};a?(H||(A.f=te,T.f=ne,Z(q,"buffer"),Z(q,"byteOffset"),Z(q,"byteLength"),Z(q,"length")),r({target:"Object",stat:!0,forced:!H},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,n){var a=e.match(/\d+$/)[0]/8,u=e+(n?"Clamped":"")+"Array",c="get"+e,f="set"+e,p=o[u],g=p,y=g&&g.prototype,b={},w=function(e,t){var n=F(e);return n.view[c](t*a+n.byteOffset,!0)},S=function(e,t,r){var o=F(e);n&&(r=(r=W(r))<0?0:r>255?255:255&r),o.view[f](t*a+o.byteOffset,r,!0)},T=function(e,t){M(e,t,{get:function(){return w(this,t)},set:function(e){return S(this,t,e)},enumerable:!0})};H?s&&(g=t((function(e,t,n,r){return l(e,y),O(function(){return x(t)?Q(t)?void 0!==r?new p(t,m(n,a),r):void 0!==n?new p(t,m(n,a)):new p(t):K(t)?J(g,t):i(I,g,t):new p(v(t))}(),e,g)})),E&&E(g,G),_(k(p),(function(e){e in g||d(g,e,p[e])})),g.prototype=y):(g=t((function(e,t,n,r){l(e,y);var o,s,u,c=0,f=0;if(x(t)){if(!Q(t))return K(t)?J(g,t):i(I,g,t);o=t,f=m(n,a);var d=t.byteLength;if(void 0===r){if(d%a)throw L(Y);if(s=d-f,s<0)throw L(Y)}else if(s=h(r)*a,s+f>d)throw L(Y);u=s/a}else u=v(t),s=u*a,o=new V(s);N(e,{buffer:o,byteOffset:f,byteLength:s,length:u,view:new U(o)});while(c<u)T(e,c++)})),E&&E(g,G),y=g.prototype=C(q)),y.constructor!==g&&d(y,"constructor",g),P(y).TypedArrayConstructor=g,j&&d(y,j,u);var A=g!=p;b[u]=g,r({global:!0,constructor:!0,forced:A,sham:!H},b),X in g||d(g,X,a),X in y||d(y,X,a),R(u)}):e.exports=function(){}},3832:function(e,t,n){var r=n(7854),o=n(7293),i=n(7072),a=n(260).NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,u=r.Int8Array;e.exports=!a||!o((function(){u(1)}))||!o((function(){new u(-1)}))||!i((function(e){new u,new u(null),new u(1.5),new u(e)}),!0)||o((function(){return 1!==new u(new s(2),1,void 0).length}))},7321:function(e,t,n){var r=n(9974),o=n(6916),i=n(9483),a=n(7908),s=n(6244),u=n(8554),c=n(1246),l=n(7659),f=n(260).aTypedArrayConstructor;e.exports=function(e){var t,n,d,p,h,v,m=i(this),g=a(e),y=arguments.length,b=y>1?arguments[1]:void 0,x=void 0!==b,w=c(g);if(w&&!l(w)){h=u(g,w),v=h.next,g=[];while(!(p=o(v,h)).done)g.push(p.value)}for(x&&y>2&&(b=r(b,arguments[2])),n=s(g),d=new(f(m))(n),t=0;n>t;t++)d[t]=x?b(g[t],t):g[t];return d}},9711:function(e,t,n){var r=n(1702),o=0,i=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+i,36)}},3307:function(e,t,n){var r=n(133);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,n){var r=n(9781),o=n(7293);e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8053:function(e){var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},6061:function(e,t,n){var r=n(5112);t.f=r},5112:function(e,t,n){var r=n(7854),o=n(2309),i=n(2597),a=n(9711),s=n(133),u=n(3307),c=o("wks"),l=r.Symbol,f=l&&l["for"],d=u?l:l&&l.withoutSetter||a;e.exports=function(e){if(!i(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&i(l,e)?c[e]=l[e]:c[e]=u&&f?f(t):d(t)}return c[e]}},1361:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},9191:function(e,t,n){"use strict";var r=n(5005),o=n(2597),i=n(8880),a=n(7976),s=n(7674),u=n(9920),c=n(2626),l=n(9587),f=n(6277),d=n(8340),p=n(7741),h=n(2914),v=n(9781),m=n(1913);e.exports=function(e,t,n,g){var y="stackTraceLimit",b=g?2:1,x=e.split("."),w=x[x.length-1],C=r.apply(null,x);if(C){var S=C.prototype;if(!m&&o(S,"cause")&&delete S.cause,!n)return C;var E=r("Error"),k=t((function(e,t){var n=f(g?t:e,void 0),r=g?new C(e):new C;return void 0!==n&&i(r,"message",n),h&&i(r,"stack",p(r.stack,2)),this&&a(S,this)&&l(r,this,k),arguments.length>b&&d(r,arguments[b]),r}));if(k.prototype=S,"Error"!==w?s?s(k,E):u(k,E,{name:!0}):v&&y in C&&(c(k,C,y),c(k,C,"prepareStackTrace")),u(k,C),!m)try{S.name!==w&&i(S,"name",w),S.constructor=k}catch(I){}return k}}},8264:function(e,t,n){"use strict";var r=n(2109),o=n(7854),i=n(3331),a=n(6340),s="ArrayBuffer",u=i[s],c=o[s];r({global:!0,constructor:!0,forced:c!==u},{ArrayBuffer:u}),a(s)},9575:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(7293),a=n(3331),s=n(9670),u=n(1400),c=n(7466),l=n(6707),f=a.ArrayBuffer,d=a.DataView,p=d.prototype,h=o(f.prototype.slice),v=o(p.getUint8),m=o(p.setUint8),g=i((function(){return!new f(2).slice(1,void 0).byteLength}));r({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:g},{slice:function(e,t){if(h&&void 0===t)return h(s(this),e);var n=s(this).byteLength,r=u(e,n),o=u(void 0===t?n:t,n),i=new(l(this,f))(c(o-r)),a=new d(this),p=new d(i),g=0;while(r<o)m(p,g++,v(a,r++));return i}})},6699:function(e,t,n){"use strict";var r=n(2109),o=n(1318).includes,i=n(7293),a=n(1223),s=i((function(){return!Array(1).includes()}));r({target:"Array",proto:!0,forced:s},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},6992:function(e,t,n){"use strict";var r=n(5656),o=n(1223),i=n(7497),a=n(9909),s=n(3070).f,u=n(654),c=n(1913),l=n(9781),f="Array Iterator",d=a.set,p=a.getterFor(f);e.exports=u(Array,"Array",(function(e,t){d(this,{type:f,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var h=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!c&&l&&"values"!==h.name)try{s(h,"name",{value:"values"})}catch(v){}},5827:function(e,t,n){"use strict";var r=n(2109),o=n(3671).left,i=n(9341),a=n(7392),s=n(5268),u=i("reduce"),c=!s&&a>79&&a<83;r({target:"Array",proto:!0,forced:!u||c},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},5069:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(3157),a=o([].reverse),s=[1,2];r({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),a(this)}})},2707:function(e,t,n){"use strict";var r=n(2109),o=n(1702),i=n(9662),a=n(7908),s=n(6244),u=n(5117),c=n(1340),l=n(7293),f=n(4362),d=n(9341),p=n(8886),h=n(256),v=n(7392),m=n(8008),g=[],y=o(g.sort),b=o(g.push),x=l((function(){g.sort(void 0)})),w=l((function(){g.sort(null)})),C=d("sort"),S=!l((function(){if(v)return v<70;if(!(p&&p>3)){if(h)return!0;if(m)return m<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)g.push({k:t+r,v:n})}for(g.sort((function(e,t){return t.v-e.v})),r=0;r<g.length;r++)t=g[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}})),E=x||!w||!C||!S,k=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:c(t)>c(n)?1:-1}};r({target:"Array",proto:!0,forced:E},{sort:function(e){void 0!==e&&i(e);var t=a(this);if(S)return void 0===e?y(t):y(t,e);var n,r,o=[],c=s(t);for(r=0;r<c;r++)r in t&&b(o,t[r]);f(o,k(e)),n=o.length,r=0;while(r<n)t[r]=o[r++];while(r<c)u(t,r++);return t}})},1703:function(e,t,n){var r=n(2109),o=n(7854),i=n(2104),a=n(9191),s="WebAssembly",u=o[s],c=7!==Error("e",{cause:7}).cause,l=function(e,t){var n={};n[e]=a(e,t,c),r({global:!0,constructor:!0,arity:1,forced:c},n)},f=function(e,t){if(u&&u[e]){var n={};n[e]=a(s+"."+e,t,c),r({target:s,stat:!0,constructor:!0,arity:1,forced:c},n)}};l("Error",(function(e){return function(t){return i(e,this,arguments)}})),l("EvalError",(function(e){return function(t){return i(e,this,arguments)}})),l("RangeError",(function(e){return function(t){return i(e,this,arguments)}})),l("ReferenceError",(function(e){return function(t){return i(e,this,arguments)}})),l("SyntaxError",(function(e){return function(t){return i(e,this,arguments)}})),l("TypeError",(function(e){return function(t){return i(e,this,arguments)}})),l("URIError",(function(e){return function(t){return i(e,this,arguments)}})),f("CompileError",(function(e){return function(t){return i(e,this,arguments)}})),f("LinkError",(function(e){return function(t){return i(e,this,arguments)}})),f("RuntimeError",(function(e){return function(t){return i(e,this,arguments)}}))},5837:function(e,t,n){var r=n(2109),o=n(7854);r({global:!0},{globalThis:o})},8862:function(e,t,n){var r=n(2109),o=n(5005),i=n(2104),a=n(6916),s=n(1702),u=n(7293),c=n(3157),l=n(614),f=n(111),d=n(2190),p=n(206),h=n(133),v=o("JSON","stringify"),m=s(/./.exec),g=s("".charAt),y=s("".charCodeAt),b=s("".replace),x=s(1..toString),w=/[\uD800-\uDFFF]/g,C=/^[\uD800-\uDBFF]$/,S=/^[\uDC00-\uDFFF]$/,E=!h||u((function(){var e=o("Symbol")();return"[null]"!=v([e])||"{}"!=v({a:e})||"{}"!=v(Object(e))})),k=u((function(){return'"\\udf06\\ud834"'!==v("\udf06\ud834")||'"\\udead"'!==v("\udead")})),I=function(e,t){var n=p(arguments),r=t;if((f(t)||void 0!==e)&&!d(e))return c(t)||(t=function(e,t){if(l(r)&&(t=a(r,this,e,t)),!d(t))return t}),n[1]=t,i(v,null,n)},_=function(e,t,n){var r=g(n,t-1),o=g(n,t+1);return m(C,e)&&!m(S,o)||m(S,e)&&!m(C,r)?"\\u"+x(y(e,0),16):e};v&&r({target:"JSON",stat:!0,arity:3,forced:E||k},{stringify:function(e,t,n){var r=p(arguments),o=i(E?I:v,null,r);return k&&"string"==typeof o?b(o,w,_):o}})},5438:function(e,t,n){var r=n(2109),o=Math.hypot,i=Math.abs,a=Math.sqrt,s=!!o&&o(1/0,NaN)!==1/0;r({target:"Math",stat:!0,arity:2,forced:s},{hypot:function(e,t){var n,r,o=0,s=0,u=arguments.length,c=0;while(s<u)n=i(arguments[s++]),c<n?(r=c/n,o=o*r*r+1,c=n):n>0?(r=n/c,o+=r*r):o+=n;return c===1/0?1/0:c*a(o)}})},821:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(9662),a=n(8523),s=n(2534),u=n(408),c=n(612);r({target:"Promise",stat:!0,forced:c},{all:function(e){var t=this,n=a.f(t),r=n.resolve,c=n.reject,l=s((function(){var n=i(t.resolve),a=[],s=0,l=1;u(e,(function(e){var i=s++,u=!1;l++,o(n,t,e).then((function(e){u||(u=!0,a[i]=e,--l||r(a))}),c)})),--l||r(a)}));return l.error&&c(l.value),n.promise}})},4164:function(e,t,n){"use strict";var r=n(2109),o=n(1913),i=n(3702).CONSTRUCTOR,a=n(2492),s=n(5005),u=n(614),c=n(8052),l=a&&a.prototype;if(r({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(e){return this.then(void 0,e)}}),!o&&u(a)){var f=s("Promise").prototype["catch"];l["catch"]!==f&&c(l,"catch",f,{unsafe:!0})}},3401:function(e,t,n){"use strict";var r,o,i,a,s=n(2109),u=n(1913),c=n(5268),l=n(7854),f=n(6916),d=n(8052),p=n(7674),h=n(8003),v=n(6340),m=n(9662),g=n(614),y=n(111),b=n(5787),x=n(6707),w=n(261).set,C=n(5948),S=n(842),E=n(2534),k=n(8572),I=n(9909),_=n(2492),R=n(3702),T=n(8523),A="Promise",D=R.CONSTRUCTOR,O=R.REJECTION_EVENT,F=R.SUBCLASSING,N=I.getterFor(A),P=I.set,M=_&&_.prototype,B=_,W=M,L=l.TypeError,V=l.document,z=l.process,U=T.f,H=U,j=!!(V&&V.createEvent&&l.dispatchEvent),G="unhandledrejection",q="rejectionhandled",$=0,K=1,X=2,Y=1,J=2,Z=function(e){var t;return!(!y(e)||!g(t=e.then))&&t},Q=function(e,t){var n,r,o,i=t.value,a=t.state==K,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(t.rejection===J&&oe(t),t.rejection=Y),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),o=!0)),n===e.promise?c(L("Promise-chain cycle")):(r=Z(n))?f(r,n,u,c):u(n)):c(i)}catch(d){l&&!o&&l.exit(),c(d)}},ee=function(e,t){e.notified||(e.notified=!0,C((function(){var n,r=e.reactions;while(n=r.get())Q(n,e);e.notified=!1,t&&!e.rejection&&ne(e)})))},te=function(e,t,n){var r,o;j?(r=V.createEvent("Event"),r.promise=t,r.reason=n,r.initEvent(e,!1,!0),l.dispatchEvent(r)):r={promise:t,reason:n},!O&&(o=l["on"+e])?o(r):e===G&&S("Unhandled promise rejection",n)},ne=function(e){f(w,l,(function(){var t,n=e.facade,r=e.value,o=re(e);if(o&&(t=E((function(){c?z.emit("unhandledRejection",r,n):te(G,n,r)})),e.rejection=c||re(e)?J:Y,t.error))throw t.value}))},re=function(e){return e.rejection!==Y&&!e.parent},oe=function(e){f(w,l,(function(){var t=e.facade;c?z.emit("rejectionHandled",t):te(q,t,e.value)}))},ie=function(e,t,n){return function(r){e(t,r,n)}},ae=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=X,ee(e,!0))},se=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw L("Promise can't be resolved itself");var r=Z(t);r?C((function(){var n={done:!1};try{f(r,t,ie(se,n,e),ie(ae,n,e))}catch(o){ae(n,o,e)}})):(e.value=t,e.state=K,ee(e,!1))}catch(o){ae({done:!1},o,e)}}};if(D&&(B=function(e){b(this,W),m(e),f(r,this);var t=N(this);try{e(ie(se,t),ie(ae,t))}catch(n){ae(t,n)}},W=B.prototype,r=function(e){P(this,{type:A,done:!1,notified:!1,parent:!1,reactions:new k,rejection:!1,state:$,value:void 0})},r.prototype=d(W,"then",(function(e,t){var n=N(this),r=U(x(this,B));return n.parent=!0,r.ok=!g(e)||e,r.fail=g(t)&&t,r.domain=c?z.domain:void 0,n.state==$?n.reactions.add(r):C((function(){Q(r,n)})),r.promise})),o=function(){var e=new r,t=N(e);this.promise=e,this.resolve=ie(se,t),this.reject=ie(ae,t)},T.f=U=function(e){return e===B||e===i?new o(e):H(e)},!u&&g(_)&&M!==Object.prototype)){a=M.then,F||d(M,"then",(function(e,t){var n=this;return new B((function(e,t){f(a,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete M.constructor}catch(ue){}p&&p(M,W)}s({global:!0,constructor:!0,wrap:!0,forced:D},{Promise:B}),h(B,A,!1,!0),v(A)},7727:function(e,t,n){"use strict";var r=n(2109),o=n(1913),i=n(2492),a=n(7293),s=n(5005),u=n(614),c=n(6707),l=n(9478),f=n(8052),d=i&&i.prototype,p=!!i&&a((function(){d["finally"].call({then:function(){}},(function(){}))}));if(r({target:"Promise",proto:!0,real:!0,forced:p},{finally:function(e){var t=c(this,s("Promise")),n=u(e);return this.then(n?function(n){return l(t,e()).then((function(){return n}))}:e,n?function(n){return l(t,e()).then((function(){throw n}))}:e)}}),!o&&u(i)){var h=s("Promise").prototype["finally"];d["finally"]!==h&&f(d,"finally",h,{unsafe:!0})}},8674:function(e,t,n){n(3401),n(821),n(4164),n(6027),n(683),n(6294)},6027:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(9662),a=n(8523),s=n(2534),u=n(408),c=n(612);r({target:"Promise",stat:!0,forced:c},{race:function(e){var t=this,n=a.f(t),r=n.reject,c=s((function(){var a=i(t.resolve);u(e,(function(e){o(a,t,e).then(n.resolve,r)}))}));return c.error&&r(c.value),n.promise}})},683:function(e,t,n){"use strict";var r=n(2109),o=n(6916),i=n(8523),a=n(3702).CONSTRUCTOR;r({target:"Promise",stat:!0,forced:a},{reject:function(e){var t=i.f(this);return o(t.reject,void 0,e),t.promise}})},6294:function(e,t,n){"use strict";var r=n(2109),o=n(5005),i=n(1913),a=n(2492),s=n(3702).CONSTRUCTOR,u=n(9478),c=o("Promise"),l=i&&!s;r({target:"Promise",stat:!0,forced:i||s},{resolve:function(e){return u(l&&this===c?a:this,e)}})},1299:function(e,t,n){var r=n(2109),o=n(7854),i=n(8003);r({global:!0},{Reflect:{}}),i(o.Reflect,"Reflect",!0)},4603:function(e,t,n){var r=n(9781),o=n(7854),i=n(1702),a=n(4705),s=n(9587),u=n(8880),c=n(8006).f,l=n(7976),f=n(7850),d=n(1340),p=n(4706),h=n(2999),v=n(2626),m=n(8052),g=n(7293),y=n(2597),b=n(9909).enforce,x=n(6340),w=n(5112),C=n(9441),S=n(7168),E=w("match"),k=o.RegExp,I=k.prototype,_=o.SyntaxError,R=i(I.exec),T=i("".charAt),A=i("".replace),D=i("".indexOf),O=i("".slice),F=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,N=/a/g,P=/a/g,M=new k(N)!==N,B=h.MISSED_STICKY,W=h.UNSUPPORTED_Y,L=r&&(!M||B||C||S||g((function(){return P[E]=!1,k(N)!=N||k(P)==P||"/a/i"!=k(N,"i")}))),V=function(e){for(var t,n=e.length,r=0,o="",i=!1;r<=n;r++)t=T(e,r),"\\"!==t?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),o+=t):o+="[\\s\\S]":o+=t+T(e,++r);return o},z=function(e){for(var t,n=e.length,r=0,o="",i=[],a={},s=!1,u=!1,c=0,l="";r<=n;r++){if(t=T(e,r),"\\"===t)t+=T(e,++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:R(F,O(e,r+1))&&(r+=2,u=!0),o+=t,c++;continue;case">"===t&&u:if(""===l||y(a,l))throw new _("Invalid capture group name");a[l]=!0,i[i.length]=[l,c],u=!1,l="";continue}u?l+=t:o+=t}return[o,i]};if(a("RegExp",L)){for(var U=function(e,t){var n,r,o,i,a,c,h=l(I,this),v=f(e),m=void 0===t,g=[],y=e;if(!h&&v&&m&&e.constructor===U)return e;if((v||l(I,e))&&(e=e.source,m&&(t=p(y))),e=void 0===e?"":d(e),t=void 0===t?"":d(t),y=e,C&&"dotAll"in N&&(r=!!t&&D(t,"s")>-1,r&&(t=A(t,/s/g,""))),n=t,B&&"sticky"in N&&(o=!!t&&D(t,"y")>-1,o&&W&&(t=A(t,/y/g,""))),S&&(i=z(e),e=i[0],g=i[1]),a=s(k(e,t),h?this:I,U),(r||o||g.length)&&(c=b(a),r&&(c.dotAll=!0,c.raw=U(V(e),n)),o&&(c.sticky=!0),g.length&&(c.groups=g)),e!==y)try{u(a,"source",""===y?"(?:)":y)}catch(x){}return a},H=c(k),j=0;H.length>j;)v(U,k,H[j++]);I.constructor=U,U.prototype=I,m(o,"RegExp",U,{constructor:!0})}x("RegExp")},8450:function(e,t,n){var r=n(9781),o=n(9441),i=n(4326),a=n(7045),s=n(9909).get,u=RegExp.prototype,c=TypeError;r&&o&&a(u,"dotAll",{configurable:!0,get:function(){if(this!==u){if("RegExp"===i(this))return!!s(this).dotAll;throw c("Incompatible receiver, RegExp required")}}})},4916:function(e,t,n){"use strict";var r=n(2109),o=n(2261);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},2087:function(e,t,n){var r=n(7854),o=n(9781),i=n(7045),a=n(7066),s=n(7293),u=r.RegExp,c=u.prototype,l=o&&s((function(){var e=!0;try{u(".","d")}catch(l){e=!1}var t={},n="",r=e?"dgimsy":"gimsy",o=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(i.hasIndices="d"),i)o(a,i[a]);var s=Object.getOwnPropertyDescriptor(c,"flags").get.call(t);return s!==r||n!==r}));l&&i(c,"flags",{configurable:!0,get:a})},8783:function(e,t,n){"use strict";var r=n(8710).charAt,o=n(1340),i=n(9909),a=n(654),s="String Iterator",u=i.set,c=i.getterFor(s);a(String,"String",(function(e){u(this,{type:s,string:o(e),index:0})}),(function(){var e,t=c(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=r(n,o),t.index+=e.length,{value:e,done:!1})}))},5306:function(e,t,n){"use strict";var r=n(2104),o=n(6916),i=n(1702),a=n(7007),s=n(7293),u=n(9670),c=n(614),l=n(9303),f=n(7466),d=n(1340),p=n(4488),h=n(1530),v=n(8173),m=n(647),g=n(7651),y=n(5112),b=y("replace"),x=Math.max,w=Math.min,C=i([].concat),S=i([].push),E=i("".indexOf),k=i("".slice),I=function(e){return void 0===e?e:String(e)},_=function(){return"$0"==="a".replace(/./,"$0")}(),R=function(){return!!/./[b]&&""===/./[b]("a","$0")}(),T=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));a("replace",(function(e,t,n){var i=R?"$":"$0";return[function(e,n){var r=p(this),i=void 0==e?void 0:v(e,b);return i?o(i,e,r,n):o(t,d(r),e,n)},function(e,o){var a=u(this),s=d(e);if("string"==typeof o&&-1===E(o,i)&&-1===E(o,"$<")){var p=n(t,a,s,o);if(p.done)return p.value}var v=c(o);v||(o=d(o));var y=a.global;if(y){var b=a.unicode;a.lastIndex=0}var _=[];while(1){var R=g(a,s);if(null===R)break;if(S(_,R),!y)break;var T=d(R[0]);""===T&&(a.lastIndex=h(s,f(a.lastIndex),b))}for(var A="",D=0,O=0;O<_.length;O++){R=_[O];for(var F=d(R[0]),N=x(w(l(R.index),s.length),0),P=[],M=1;M<R.length;M++)S(P,I(R[M]));var B=R.groups;if(v){var W=C([F],P,N,s);void 0!==B&&S(W,B);var L=d(r(o,void 0,W))}else L=m(F,s,N,P,B,o);N>=D&&(A+=k(s,D,N)+L,D=N+F.length)}return A+k(s,D)}]}),!T||!_||R)},3210:function(e,t,n){"use strict";var r=n(2109),o=n(3111).trim,i=n(6091);r({target:"String",proto:!0,forced:i("trim")},{trim:function(){return o(this)}})},2443:function(e,t,n){var r=n(7235);r("asyncIterator")},1817:function(e,t,n){"use strict";var r=n(2109),o=n(9781),i=n(7854),a=n(1702),s=n(2597),u=n(614),c=n(7976),l=n(1340),f=n(3070).f,d=n(9920),p=i.Symbol,h=p&&p.prototype;if(o&&u(p)&&(!("description"in h)||void 0!==p().description)){var v={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=c(h,this)?new p(e):void 0===e?p():p(e);return""===e&&(v[t]=!0),t};d(m,p),m.prototype=h,h.constructor=m;var g="Symbol(test)"==String(p("test")),y=a(h.toString),b=a(h.valueOf),x=/^Symbol\((.*)\)[^)]+$/,w=a("".replace),C=a("".slice);f(h,"description",{configurable:!0,get:function(){var e=b(this),t=y(e);if(s(v,e))return"";var n=g?C(t,7,-1):w(t,x,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:m})}},8675:function(e,t,n){"use strict";var r=n(260),o=n(6244),i=n(9303),a=r.aTypedArray,s=r.exportTypedArrayMethod;s("at",(function(e){var t=a(this),n=o(t),r=i(e),s=r>=0?r:n+r;return s<0||s>=n?void 0:t[s]}))},3105:function(e,t,n){"use strict";var r=n(260),o=n(1285),i=n(4599),a=n(648),s=n(6916),u=n(1702),c=n(7293),l=r.aTypedArray,f=r.exportTypedArrayMethod,d=u("".slice),p=c((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e}));f("fill",(function(e){var t=arguments.length;l(this);var n="Big"===d(a(this),0,3)?i(e):+e;return s(o,this,n,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),p)},2958:function(e,t,n){"use strict";var r=n(260),o=n(9671).findLastIndex,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("findLastIndex",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},3408:function(e,t,n){"use strict";var r=n(260),o=n(9671).findLast,i=r.aTypedArray,a=r.exportTypedArrayMethod;a("findLast",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},4197:function(e,t,n){var r=n(9843);r("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},8145:function(e,t,n){"use strict";var r=n(3832),o=n(260).exportTypedArrayStaticMethod,i=n(7321);o("from",i,r)},5125:function(e,t,n){var r=n(9843);r("Int32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},3462:function(e,t,n){"use strict";var r=n(7854),o=n(6916),i=n(260),a=n(6244),s=n(4590),u=n(7908),c=n(7293),l=r.RangeError,f=r.Int8Array,d=f&&f.prototype,p=d&&d.set,h=i.aTypedArray,v=i.exportTypedArrayMethod,m=!c((function(){var e=new Uint8ClampedArray(2);return o(p,e,{length:1,0:3},1),3!==e[1]})),g=m&&i.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new f(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));v("set",(function(e){h(this);var t=s(arguments.length>1?arguments[1]:void 0,1),n=u(e);if(m)return o(p,this,n,t);var r=this.length,i=a(n),c=0;if(i+t>r)throw l("Wrong length");while(c<i)this[t+c]=n[c++]}),!m||g)},3824:function(e,t,n){"use strict";var r=n(7854),o=n(1702),i=n(7293),a=n(9662),s=n(4362),u=n(260),c=n(8886),l=n(256),f=n(7392),d=n(8008),p=u.aTypedArray,h=u.exportTypedArrayMethod,v=r.Uint16Array,m=v&&o(v.prototype.sort),g=!!m&&!(i((function(){m(new v(2),null)}))&&i((function(){m(new v(2),{})}))),y=!!m&&!i((function(){if(f)return f<74;if(c)return c<67;if(l)return!0;if(d)return d<602;var e,t,n=new v(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(m(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0})),b=function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!==n?-1:t!==t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}};h("sort",(function(e){return void 0!==e&&a(e),y?m(this,e):s(p(this),b(e))}),!y||g)},8255:function(e,t,n){var r=n(9843);r("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},9135:function(e,t,n){var r=n(9843);r("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},2472:function(e,t,n){var r=n(9843);r("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},9743:function(e,t,n){var r=n(9843);r("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},1118:function(e,t,n){n(2958)},7380:function(e,t,n){n(3408)},1091:function(e,t,n){var r=n(2109),o=n(7854),i=n(261).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==i},{clearImmediate:i})},3948:function(e,t,n){var r=n(7854),o=n(8324),i=n(8509),a=n(6992),s=n(8880),u=n(5112),c=u("iterator"),l=u("toStringTag"),f=a.values,d=function(e,t){if(e){if(e[c]!==f)try{s(e,c,f)}catch(r){e[c]=f}if(e[l]||s(e,l,t),o[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(r){e[n]=a[n]}}};for(var p in o)d(r[p]&&r[p].prototype,p);d(i,"DOMTokenList")},7714:function(e,t,n){"use strict";var r=n(2109),o=n(4038),i=n(5005),a=n(7293),s=n(30),u=n(9114),c=n(3070).f,l=n(8052),f=n(7045),d=n(2597),p=n(5787),h=n(9670),v=n(7762),m=n(6277),g=n(3678),y=n(7741),b=n(9909),x=n(9781),w=n(1913),C="DOMException",S="DATA_CLONE_ERR",E=i("Error"),k=i(C)||function(){try{var e=i("MessageChannel")||o("worker_threads").MessageChannel;(new e).port1.postMessage(new WeakMap)}catch(t){if(t.name==S&&25==t.code)return t.constructor}}(),I=k&&k.prototype,_=E.prototype,R=b.set,T=b.getterFor(C),A="stack"in E(C),D=function(e){return d(g,e)&&g[e].m?g[e].c:0},O=function(){p(this,F);var e=arguments.length,t=m(e<1?void 0:arguments[0]),n=m(e<2?void 0:arguments[1],"Error"),r=D(n);if(R(this,{type:C,name:n,message:t,code:r}),x||(this.name=n,this.message=t,this.code=r),A){var o=E(t);o.name=C,c(this,"stack",u(1,y(o.stack,1)))}},F=O.prototype=s(_),N=function(e){return{enumerable:!0,configurable:!0,get:e}},P=function(e){return N((function(){return T(this)[e]}))};x&&(f(F,"code",P("code")),f(F,"message",P("message")),f(F,"name",P("name"))),c(F,"constructor",u(1,O));var M=a((function(){return!(new k instanceof E)})),B=M||a((function(){return _.toString!==v||"2: 1"!==String(new k(1,2))})),W=M||a((function(){return 25!==new k(1,"DataCloneError").code})),L=M||25!==k[S]||25!==I[S],V=w?B||W||L:M;r({global:!0,constructor:!0,forced:V},{DOMException:V?O:k});var z=i(C),U=z.prototype;for(var H in B&&(w||k===z)&&l(U,"toString",v),W&&x&&k===z&&f(U,"code",N((function(){return D(h(this).name)}))),g)if(d(g,H)){var j=g[H],G=j.s,q=u(6,j.c);d(z,G)||c(z,G,q),d(U,G)||c(U,G,q)}},2801:function(e,t,n){"use strict";var r=n(2109),o=n(7854),i=n(5005),a=n(9114),s=n(3070).f,u=n(2597),c=n(5787),l=n(9587),f=n(6277),d=n(3678),p=n(7741),h=n(9781),v=n(1913),m="DOMException",g=i("Error"),y=i(m),b=function(){c(this,x);var e=arguments.length,t=f(e<1?void 0:arguments[0]),n=f(e<2?void 0:arguments[1],"Error"),r=new y(t,n),o=g(t);return o.name=m,s(r,"stack",a(1,p(o.stack,1))),l(r,this,b),r},x=b.prototype=y.prototype,w="stack"in g(m),C="stack"in new y(1,2),S=y&&h&&Object.getOwnPropertyDescriptor(o,m),E=!!S&&!(S.writable&&S.configurable),k=w&&!E&&!C;r({global:!0,constructor:!0,forced:v||k},{DOMException:k?b:y});var I=i(m),_=I.prototype;if(_.constructor!==I)for(var R in v||s(_,"constructor",a(1,I)),d)if(u(d,R)){var T=d[R],A=T.s;u(I,A)||s(I,A,a(6,T.c))}},1174:function(e,t,n){var r=n(5005),o=n(8003),i="DOMException";o(r(i),i)},4633:function(e,t,n){n(1091),n(2986)},2986:function(e,t,n){var r=n(2109),o=n(7854),i=n(261).set;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==i},{setImmediate:i})},5556:function(e,t,n){"use strict";n(6992);var r=n(2109),o=n(7854),i=n(6916),a=n(1702),s=n(9781),u=n(590),c=n(8052),l=n(9190),f=n(8003),d=n(4994),p=n(9909),h=n(5787),v=n(614),m=n(2597),g=n(9974),y=n(648),b=n(9670),x=n(111),w=n(1340),C=n(30),S=n(9114),E=n(8554),k=n(1246),I=n(8053),_=n(5112),R=n(4362),T=_("iterator"),A="URLSearchParams",D=A+"Iterator",O=p.set,F=p.getterFor(A),N=p.getterFor(D),P=Object.getOwnPropertyDescriptor,M=function(e){if(!s)return o[e];var t=P(o,e);return t&&t.value},B=M("fetch"),W=M("Request"),L=M("Headers"),V=W&&W.prototype,z=L&&L.prototype,U=o.RegExp,H=o.TypeError,j=o.decodeURIComponent,G=o.encodeURIComponent,q=a("".charAt),$=a([].join),K=a([].push),X=a("".replace),Y=a([].shift),J=a([].splice),Z=a("".split),Q=a("".slice),ee=/\+/g,te=Array(4),ne=function(e){return te[e-1]||(te[e-1]=U("((?:%[\\da-f]{2}){"+e+"})","gi"))},re=function(e){try{return j(e)}catch(t){return e}},oe=function(e){var t=X(e,ee," "),n=4;try{return j(t)}catch(r){while(n)t=X(t,ne(n--),re);return t}},ie=/[!'()~]|%20/g,ae={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},se=function(e){return ae[e]},ue=function(e){return X(G(e),ie,se)},ce=d((function(e,t){O(this,{type:D,iterator:E(F(e).entries),kind:t})}),"Iterator",(function(){var e=N(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(x(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===q(e,0)?Q(e,1):e:w(e)))};le.prototype={type:A,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,a,s,u,c=k(e);if(c){t=E(e,c),n=t.next;while(!(r=i(n,t)).done){if(o=E(b(r.value)),a=o.next,(s=i(a,o)).done||(u=i(a,o)).done||!i(a,o).done)throw H("Expected sequence with length 2");K(this.entries,{key:w(s.value),value:w(u.value)})}}else for(var l in e)m(e,l)&&K(this.entries,{key:l,value:w(e[l])})},parseQuery:function(e){if(e){var t,n,r=Z(e,"&"),o=0;while(o<r.length)t=r[o++],t.length&&(n=Z(t,"="),K(this.entries,{key:oe(Y(n)),value:oe($(n,"="))}))}},serialize:function(){var e,t=this.entries,n=[],r=0;while(r<t.length)e=t[r++],K(n,ue(e.key)+"="+ue(e.value));return $(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var fe=function(){h(this,de);var e=arguments.length>0?arguments[0]:void 0;O(this,new le(e))},de=fe.prototype;if(l(de,{append:function(e,t){I(arguments.length,2);var n=F(this);K(n.entries,{key:w(e),value:w(t)}),n.updateURL()},delete:function(e){I(arguments.length,1);var t=F(this),n=t.entries,r=w(e),o=0;while(o<n.length)n[o].key===r?J(n,o,1):o++;t.updateURL()},get:function(e){I(arguments.length,1);for(var t=F(this).entries,n=w(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){I(arguments.length,1);for(var t=F(this).entries,n=w(e),r=[],o=0;o<t.length;o++)t[o].key===n&&K(r,t[o].value);return r},has:function(e){I(arguments.length,1);var t=F(this).entries,n=w(e),r=0;while(r<t.length)if(t[r++].key===n)return!0;return!1},set:function(e,t){I(arguments.length,1);for(var n,r=F(this),o=r.entries,i=!1,a=w(e),s=w(t),u=0;u<o.length;u++)n=o[u],n.key===a&&(i?J(o,u--,1):(i=!0,n.value=s));i||K(o,{key:a,value:s}),r.updateURL()},sort:function(){var e=F(this);R(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){var t,n=F(this).entries,r=g(e,arguments.length>1?arguments[1]:void 0),o=0;while(o<n.length)t=n[o++],r(t.value,t.key,this)},keys:function(){return new ce(this,"keys")},values:function(){return new ce(this,"values")},entries:function(){return new ce(this,"entries")}},{enumerable:!0}),c(de,T,de.entries,{name:"entries"}),c(de,"toString",(function(){return F(this).serialize()}),{enumerable:!0}),f(fe,A),r({global:!0,constructor:!0,forced:!u},{URLSearchParams:fe}),!u&&v(L)){var pe=a(z.has),he=a(z.set),ve=function(e){if(x(e)){var t,n=e.body;if(y(n)===A)return t=e.headers?new L(e.headers):new L,pe(t,"content-type")||he(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),C(e,{body:S(0,w(n)),headers:S(0,t)})}return e};if(v(B)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return B(e,arguments.length>1?ve(arguments[1]):{})}}),v(W)){var me=function(e){return h(this,V),new W(e,arguments.length>1?ve(arguments[1]):{})};V.constructor=me,me.prototype=V,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:me})}}e.exports={URLSearchParams:fe,getState:F}},1637:function(e,t,n){n(5556)},8789:function(e,t,n){"use strict";n(8783);var r,o=n(2109),i=n(9781),a=n(590),s=n(7854),u=n(9974),c=n(1702),l=n(8052),f=n(7045),d=n(5787),p=n(2597),h=n(1574),v=n(8457),m=n(1589),g=n(8710).codeAt,y=n(3197),b=n(1340),x=n(8003),w=n(8053),C=n(5556),S=n(9909),E=S.set,k=S.getterFor("URL"),I=C.URLSearchParams,_=C.getState,R=s.URL,T=s.TypeError,A=s.parseInt,D=Math.floor,O=Math.pow,F=c("".charAt),N=c(/./.exec),P=c([].join),M=c(1..toString),B=c([].pop),W=c([].push),L=c("".replace),V=c([].shift),z=c("".split),U=c("".slice),H=c("".toLowerCase),j=c([].unshift),G="Invalid authority",q="Invalid scheme",$="Invalid host",K="Invalid port",X=/[a-z]/i,Y=/[\d+-.a-z]/i,J=/\d/,Z=/^0x/i,Q=/^[0-7]+$/,ee=/^\d+$/,te=/^[\da-f]+$/i,ne=/[\0\t\n\r #%/:<>?@[\\\]^|]/,re=/[\0\t\n\r #/:<>?@[\\\]^|]/,oe=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,ie=/[\t\n\r]/g,ae=function(e){var t,n,r,o,i,a,s,u=z(e,".");if(u.length&&""==u[u.length-1]&&u.length--,t=u.length,t>4)return e;for(n=[],r=0;r<t;r++){if(o=u[r],""==o)return e;if(i=10,o.length>1&&"0"==F(o,0)&&(i=N(Z,o)?16:8,o=U(o,8==i?1:2)),""===o)a=0;else{if(!N(10==i?ee:8==i?Q:te,o))return e;a=A(o,i)}W(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=O(256,5-t))return null}else if(a>255)return null;for(s=B(n),r=0;r<n.length;r++)s+=n[r]*O(256,3-r);return s},se=function(e){var t,n,r,o,i,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,f=0,d=function(){return F(e,f)};if(":"==d()){if(":"!=F(e,1))return;f+=2,c++,l=c}while(d()){if(8==c)return;if(":"!=d()){t=n=0;while(n<4&&N(te,d()))t=16*t+A(d(),16),f++,n++;if("."==d()){if(0==n)return;if(f-=n,c>6)return;r=0;while(d()){if(o=null,r>0){if(!("."==d()&&r<4))return;f++}if(!N(J,d()))return;while(N(J,d())){if(i=A(d(),10),null===o)o=i;else{if(0==o)return;o=10*o+i}if(o>255)return;f++}u[c]=256*u[c]+o,r++,2!=r&&4!=r||c++}if(4!=r)return;break}if(":"==d()){if(f++,!d())return}else if(d())return;u[c++]=t}else{if(null!==l)return;f++,c++,l=c}}if(null!==l){a=c-l,c=7;while(0!=c&&a>0)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s}else if(8!=c)return;return u},ue=function(e){for(var t=null,n=1,r=null,o=0,i=0;i<8;i++)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);return o>n&&(t=r,n=o),t},ce=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)j(t,e%256),e=D(e/256);return P(t,".")}if("object"==typeof e){for(t="",r=ue(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=M(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},le={},fe=h({},le,{" ":1,'"':1,"<":1,">":1,"`":1}),de=h({},fe,{"#":1,"?":1,"{":1,"}":1}),pe=h({},de,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),he=function(e,t){var n=g(e,0);return n>32&&n<127&&!p(t,e)?e:encodeURIComponent(e)},ve={ftp:21,file:null,http:80,https:443,ws:80,wss:443},me=function(e,t){var n;return 2==e.length&&N(X,F(e,0))&&(":"==(n=F(e,1))||!t&&"|"==n)},ge=function(e){var t;return e.length>1&&me(U(e,0,2))&&(2==e.length||"/"===(t=F(e,2))||"\\"===t||"?"===t||"#"===t)},ye=function(e){return"."===e||"%2e"===H(e)},be=function(e){return e=H(e),".."===e||"%2e."===e||".%2e"===e||"%2e%2e"===e},xe={},we={},Ce={},Se={},Ee={},ke={},Ie={},_e={},Re={},Te={},Ae={},De={},Oe={},Fe={},Ne={},Pe={},Me={},Be={},We={},Le={},Ve={},ze=function(e,t,n){var r,o,i,a=b(e);if(t){if(o=this.parse(a),o)throw T(o);this.searchParams=null}else{if(void 0!==n&&(r=new ze(n,!0)),o=this.parse(a,null,r),o)throw T(o);i=_(new I),i.bindURL(this),this.searchParams=i}};ze.prototype={type:"URL",parse:function(e,t,n){var o,i,a,s,u=this,c=t||xe,l=0,f="",d=!1,h=!1,g=!1;e=b(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=L(e,oe,"")),e=L(e,ie,""),o=v(e);while(l<=o.length){switch(i=o[l],c){case xe:if(!i||!N(X,i)){if(t)return q;c=Ce;continue}f+=H(i),c=we;break;case we:if(i&&(N(Y,i)||"+"==i||"-"==i||"."==i))f+=H(i);else{if(":"!=i){if(t)return q;f="",c=Ce,l=0;continue}if(t&&(u.isSpecial()!=p(ve,f)||"file"==f&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=f,t)return void(u.isSpecial()&&ve[u.scheme]==u.port&&(u.port=null));f="","file"==u.scheme?c=Fe:u.isSpecial()&&n&&n.scheme==u.scheme?c=Se:u.isSpecial()?c=_e:"/"==o[l+1]?(c=Ee,l++):(u.cannotBeABaseURL=!0,W(u.path,""),c=We)}break;case Ce:if(!n||n.cannotBeABaseURL&&"#"!=i)return q;if(n.cannotBeABaseURL&&"#"==i){u.scheme=n.scheme,u.path=m(n.path),u.query=n.query,u.fragment="",u.cannotBeABaseURL=!0,c=Ve;break}c="file"==n.scheme?Fe:ke;continue;case Se:if("/"!=i||"/"!=o[l+1]){c=ke;continue}c=Re,l++;break;case Ee:if("/"==i){c=Te;break}c=Be;continue;case ke:if(u.scheme=n.scheme,i==r)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.query=n.query;else if("/"==i||"\\"==i&&u.isSpecial())c=Ie;else if("?"==i)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.query="",c=Le;else{if("#"!=i){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.path.length--,c=Be;continue}u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.query=n.query,u.fragment="",c=Ve}break;case Ie:if(!u.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,c=Be;continue}c=Te}else c=Re;break;case _e:if(c=Re,"/"!=i||"/"!=F(f,l+1))continue;l++;break;case Re:if("/"!=i&&"\\"!=i){c=Te;continue}break;case Te:if("@"==i){d&&(f="%40"+f),d=!0,a=v(f);for(var y=0;y<a.length;y++){var x=a[y];if(":"!=x||g){var w=he(x,pe);g?u.password+=w:u.username+=w}else g=!0}f=""}else if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(d&&""==f)return G;l-=v(f).length+1,f="",c=Ae}else f+=i;break;case Ae:case De:if(t&&"file"==u.scheme){c=Pe;continue}if(":"!=i||h){if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(u.isSpecial()&&""==f)return $;if(t&&""==f&&(u.includesCredentials()||null!==u.port))return;if(s=u.parseHost(f),s)return s;if(f="",c=Me,t)return;continue}"["==i?h=!0:"]"==i&&(h=!1),f+=i}else{if(""==f)return $;if(s=u.parseHost(f),s)return s;if(f="",c=Oe,t==De)return}break;case Oe:if(!N(J,i)){if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()||t){if(""!=f){var C=A(f,10);if(C>65535)return K;u.port=u.isSpecial()&&C===ve[u.scheme]?null:C,f=""}if(t)return;c=Me;continue}return K}f+=i;break;case Fe:if(u.scheme="file","/"==i||"\\"==i)c=Ne;else{if(!n||"file"!=n.scheme){c=Be;continue}if(i==r)u.host=n.host,u.path=m(n.path),u.query=n.query;else if("?"==i)u.host=n.host,u.path=m(n.path),u.query="",c=Le;else{if("#"!=i){ge(P(m(o,l),""))||(u.host=n.host,u.path=m(n.path),u.shortenPath()),c=Be;continue}u.host=n.host,u.path=m(n.path),u.query=n.query,u.fragment="",c=Ve}}break;case Ne:if("/"==i||"\\"==i){c=Pe;break}n&&"file"==n.scheme&&!ge(P(m(o,l),""))&&(me(n.path[0],!0)?W(u.path,n.path[0]):u.host=n.host),c=Be;continue;case Pe:if(i==r||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&me(f))c=Be;else if(""==f){if(u.host="",t)return;c=Me}else{if(s=u.parseHost(f),s)return s;if("localhost"==u.host&&(u.host=""),t)return;f="",c=Me}continue}f+=i;break;case Me:if(u.isSpecial()){if(c=Be,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=r&&(c=Be,"/"!=i))continue}else u.fragment="",c=Ve;else u.query="",c=Le;break;case Be:if(i==r||"/"==i||"\\"==i&&u.isSpecial()||!t&&("?"==i||"#"==i)){if(be(f)?(u.shortenPath(),"/"==i||"\\"==i&&u.isSpecial()||W(u.path,"")):ye(f)?"/"==i||"\\"==i&&u.isSpecial()||W(u.path,""):("file"==u.scheme&&!u.path.length&&me(f)&&(u.host&&(u.host=""),f=F(f,0)+":"),W(u.path,f)),f="","file"==u.scheme&&(i==r||"?"==i||"#"==i))while(u.path.length>1&&""===u.path[0])V(u.path);"?"==i?(u.query="",c=Le):"#"==i&&(u.fragment="",c=Ve)}else f+=he(i,de);break;case We:"?"==i?(u.query="",c=Le):"#"==i?(u.fragment="",c=Ve):i!=r&&(u.path[0]+=he(i,le));break;case Le:t||"#"!=i?i!=r&&("'"==i&&u.isSpecial()?u.query+="%27":u.query+="#"==i?"%23":he(i,le)):(u.fragment="",c=Ve);break;case Ve:i!=r&&(u.fragment+=he(i,fe));break}l++}},parseHost:function(e){var t,n,r;if("["==F(e,0)){if("]"!=F(e,e.length-1))return $;if(t=se(U(e,1,-1)),!t)return $;this.host=t}else if(this.isSpecial()){if(e=y(e),N(ne,e))return $;if(t=ae(e),null===t)return $;this.host=t}else{if(N(re,e))return $;for(t="",n=v(e),r=0;r<n.length;r++)t+=he(n[r],le);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return p(ve,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&me(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,i=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==o?(c+="//",e.includesCredentials()&&(c+=n+(r?":"+r:"")+"@"),c+=ce(o),null!==i&&(c+=":"+i)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+P(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw T(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Ue(e.path[0]).origin}catch(n){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ce(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",xe)},getUsername:function(){return this.username},setUsername:function(e){var t=v(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=he(t[n],pe)}},getPassword:function(){return this.password},setPassword:function(e){var t=v(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=he(t[n],pe)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ce(e):ce(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Ae)},getHostname:function(){var e=this.host;return null===e?"":ce(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,De)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=b(e),""==e?this.port=null:this.parse(e,Oe))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+P(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Me))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=b(e),""==e?this.query=null:("?"==F(e,0)&&(e=U(e,1)),this.query="",this.parse(e,Le)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){e=b(e),""!=e?("#"==F(e,0)&&(e=U(e,1)),this.fragment="",this.parse(e,Ve)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Ue=function(e){var t=d(this,He),n=w(arguments.length,1)>1?arguments[1]:void 0,r=E(t,new ze(e,!1,n));i||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},He=Ue.prototype,je=function(e,t){return{get:function(){return k(this)[e]()},set:t&&function(e){return k(this)[t](e)},configurable:!0,enumerable:!0}};if(i&&(f(He,"href",je("serialize","setHref")),f(He,"origin",je("getOrigin")),f(He,"protocol",je("getProtocol","setProtocol")),f(He,"username",je("getUsername","setUsername")),f(He,"password",je("getPassword","setPassword")),f(He,"host",je("getHost","setHost")),f(He,"hostname",je("getHostname","setHostname")),f(He,"port",je("getPort","setPort")),f(He,"pathname",je("getPathname","setPathname")),f(He,"search",je("getSearch","setSearch")),f(He,"searchParams",je("getSearchParams")),f(He,"hash",je("getHash","setHash"))),l(He,"toJSON",(function(){return k(this).serialize()}),{enumerable:!0}),l(He,"toString",(function(){return k(this).serialize()}),{enumerable:!0}),R){var Ge=R.createObjectURL,qe=R.revokeObjectURL;Ge&&l(Ue,"createObjectURL",u(Ge,R)),qe&&l(Ue,"revokeObjectURL",u(qe,R))}x(Ue,"URL"),o({global:!0,constructor:!0,forced:!a,sham:!i},{URL:Ue})},285:function(e,t,n){n(8789)},3753:function(e,t,n){"use strict";var r=n(2109),o=n(6916);r({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return o(URL.prototype.toString,this)}})},5110:function(){},4870:function(e,t,n){"use strict";n.d(t,{BK:function(){return ze},Bj:function(){return i},Fl:function(){return Ge},IU:function(){return Re},Jd:function(){return S},PG:function(){return Ee},SU:function(){return We},Um:function(){return we},WL:function(){return Ve},X$:function(){return _},X3:function(){return _e},Xl:function(){return Te},dq:function(){return Ne},iH:function(){return Pe},j:function(){return k},lk:function(){return E},qj:function(){return xe},qq:function(){return b},yT:function(){return Ie}});n(3948),n(1817),n(1299);var r=n(7139);let o;class i{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&o&&(this.parent=o,this.index=(o.scopes||(o.scopes=[])).push(this)-1)}run(e){if(this.active){const t=o;try{return o=this,e()}finally{o=t}}else 0}on(){o=this}off(){o=this.parent}stop(e){if(this.active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}function a(e,t=o){t&&t.active&&t.effects.push(e)}const s=e=>{const t=new Set(e);return t.w=0,t.n=0,t},u=e=>(e.w&h)>0,c=e=>(e.n&h)>0,l=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=h},f=e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const o=t[r];u(o)&&!c(o)?o.delete(e):t[n++]=o,o.w&=~h,o.n&=~h}t.length=n}},d=new WeakMap;let p=0,h=1;const v=30;let m;const g=Symbol(""),y=Symbol("");class b{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,a(this,n)}run(){if(!this.active)return this.fn();let e=m,t=w;while(e){if(e===this)return;e=e.parent}try{return this.parent=m,m=this,w=!0,h=1<<++p,p<=v?l(this):x(this),this.fn()}finally{p<=v&&f(this),h=1<<--p,m=this.parent,w=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){m===this?this.deferStop=!0:this.active&&(x(this),this.onStop&&this.onStop(),this.active=!1)}}function x(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let w=!0;const C=[];function S(){C.push(w),w=!1}function E(){const e=C.pop();w=void 0===e||e}function k(e,t,n){if(w&&m){let t=d.get(e);t||d.set(e,t=new Map);let r=t.get(n);r||t.set(n,r=s());const o=void 0;I(r,o)}}function I(e,t){let n=!1;p<=v?c(e)||(e.n|=h,n=!u(e)):n=!e.has(m),n&&(e.add(m),m.deps.push(e))}function _(e,t,n,o,i,a){const u=d.get(e);if(!u)return;let c=[];if("clear"===t)c=[...u.values()];else if("length"===n&&(0,r.kJ)(e))u.forEach(((e,t)=>{("length"===t||t>=o)&&c.push(e)}));else switch(void 0!==n&&c.push(u.get(n)),t){case"add":(0,r.kJ)(e)?(0,r.S0)(n)&&c.push(u.get("length")):(c.push(u.get(g)),(0,r._N)(e)&&c.push(u.get(y)));break;case"delete":(0,r.kJ)(e)||(c.push(u.get(g)),(0,r._N)(e)&&c.push(u.get(y)));break;case"set":(0,r._N)(e)&&c.push(u.get(g));break}if(1===c.length)c[0]&&R(c[0]);else{const e=[];for(const t of c)t&&e.push(...t);R(s(e))}}function R(e,t){const n=(0,r.kJ)(e)?e:[...e];for(const r of n)r.computed&&T(r,t);for(const r of n)r.computed||T(r,t)}function T(e,t){(e!==m||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const A=(0,r.fY)("__proto__,__v_isRef,__isVue"),D=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(r.yk)),O=B(),F=B(!1,!0),N=B(!0),P=M();function M(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=Re(this);for(let t=0,o=this.length;t<o;t++)k(n,"get",t+"");const r=n[t](...e);return-1===r||!1===r?n[t](...e.map(Re)):r}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){S();const n=Re(this)[t].apply(this,e);return E(),n}})),e}function B(e=!1,t=!1){return function(n,o,i){if("__v_isReactive"===o)return!e;if("__v_isReadonly"===o)return e;if("__v_isShallow"===o)return t;if("__v_raw"===o&&i===(e?t?ge:me:t?ve:he).get(n))return n;const a=(0,r.kJ)(n);if(!e&&a&&(0,r.RI)(P,o))return Reflect.get(P,o,i);const s=Reflect.get(n,o,i);return((0,r.yk)(o)?D.has(o):A(o))?s:(e||k(n,"get",o),t?s:Ne(s)?a&&(0,r.S0)(o)?s:s.value:(0,r.Kn)(s)?e?Ce(s):xe(s):s)}}const W=V(),L=V(!0);function V(e=!1){return function(t,n,o,i){let a=t[n];if(ke(a)&&Ne(a)&&!Ne(o))return!1;if(!e&&!ke(o)&&(Ie(o)||(o=Re(o),a=Re(a)),!(0,r.kJ)(t)&&Ne(a)&&!Ne(o)))return a.value=o,!0;const s=(0,r.kJ)(t)&&(0,r.S0)(n)?Number(n)<t.length:(0,r.RI)(t,n),u=Reflect.set(t,n,o,i);return t===Re(i)&&(s?(0,r.aU)(o,a)&&_(t,"set",n,o,a):_(t,"add",n,o)),u}}function z(e,t){const n=(0,r.RI)(e,t),o=e[t],i=Reflect.deleteProperty(e,t);return i&&n&&_(e,"delete",t,void 0,o),i}function U(e,t){const n=Reflect.has(e,t);return(0,r.yk)(t)&&D.has(t)||k(e,"has",t),n}function H(e){return k(e,"iterate",(0,r.kJ)(e)?"length":g),Reflect.ownKeys(e)}const j={get:O,set:W,deleteProperty:z,has:U,ownKeys:H},G={get:N,set(e,t){return!0},deleteProperty(e,t){return!0}},q=(0,r.l7)({},j,{get:F,set:L}),$=e=>e,K=e=>Reflect.getPrototypeOf(e);function X(e,t,n=!1,r=!1){e=e["__v_raw"];const o=Re(e),i=Re(t);n||(t!==i&&k(o,"get",t),k(o,"get",i));const{has:a}=K(o),s=r?$:n?De:Ae;return a.call(o,t)?s(e.get(t)):a.call(o,i)?s(e.get(i)):void(e!==o&&e.get(t))}function Y(e,t=!1){const n=this["__v_raw"],r=Re(n),o=Re(e);return t||(e!==o&&k(r,"has",e),k(r,"has",o)),e===o?n.has(e):n.has(e)||n.has(o)}function J(e,t=!1){return e=e["__v_raw"],!t&&k(Re(e),"iterate",g),Reflect.get(e,"size",e)}function Z(e){e=Re(e);const t=Re(this),n=K(t),r=n.has.call(t,e);return r||(t.add(e),_(t,"add",e,e)),this}function Q(e,t){t=Re(t);const n=Re(this),{has:o,get:i}=K(n);let a=o.call(n,e);a||(e=Re(e),a=o.call(n,e));const s=i.call(n,e);return n.set(e,t),a?(0,r.aU)(t,s)&&_(n,"set",e,t,s):_(n,"add",e,t),this}function ee(e){const t=Re(this),{has:n,get:r}=K(t);let o=n.call(t,e);o||(e=Re(e),o=n.call(t,e));const i=r?r.call(t,e):void 0,a=t.delete(e);return o&&_(t,"delete",e,void 0,i),a}function te(){const e=Re(this),t=0!==e.size,n=void 0,r=e.clear();return t&&_(e,"clear",void 0,void 0,n),r}function ne(e,t){return function(n,r){const o=this,i=o["__v_raw"],a=Re(i),s=t?$:e?De:Ae;return!e&&k(a,"iterate",g),i.forEach(((e,t)=>n.call(r,s(e),s(t),o)))}}function re(e,t,n){return function(...o){const i=this["__v_raw"],a=Re(i),s=(0,r._N)(a),u="entries"===e||e===Symbol.iterator&&s,c="keys"===e&&s,l=i[e](...o),f=n?$:t?De:Ae;return!t&&k(a,"iterate",c?y:g),{next(){const{value:e,done:t}=l.next();return t?{value:e,done:t}:{value:u?[f(e[0]),f(e[1])]:f(e),done:t}},[Symbol.iterator](){return this}}}}function oe(e){return function(...t){return"delete"!==e&&this}}function ie(){const e={get(e){return X(this,e)},get size(){return J(this)},has:Y,add:Z,set:Q,delete:ee,clear:te,forEach:ne(!1,!1)},t={get(e){return X(this,e,!1,!0)},get size(){return J(this)},has:Y,add:Z,set:Q,delete:ee,clear:te,forEach:ne(!1,!0)},n={get(e){return X(this,e,!0)},get size(){return J(this,!0)},has(e){return Y.call(this,e,!0)},add:oe("add"),set:oe("set"),delete:oe("delete"),clear:oe("clear"),forEach:ne(!0,!1)},r={get(e){return X(this,e,!0,!0)},get size(){return J(this,!0)},has(e){return Y.call(this,e,!0)},add:oe("add"),set:oe("set"),delete:oe("delete"),clear:oe("clear"),forEach:ne(!0,!0)},o=["keys","values","entries",Symbol.iterator];return o.forEach((o=>{e[o]=re(o,!1,!1),n[o]=re(o,!0,!1),t[o]=re(o,!1,!0),r[o]=re(o,!0,!0)})),[e,n,t,r]}const[ae,se,ue,ce]=ie();function le(e,t){const n=t?e?ce:ue:e?se:ae;return(t,o,i)=>"__v_isReactive"===o?!e:"__v_isReadonly"===o?e:"__v_raw"===o?t:Reflect.get((0,r.RI)(n,o)&&o in t?n:t,o,i)}const fe={get:le(!1,!1)},de={get:le(!1,!0)},pe={get:le(!0,!1)};const he=new WeakMap,ve=new WeakMap,me=new WeakMap,ge=new WeakMap;function ye(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function be(e){return e["__v_skip"]||!Object.isExtensible(e)?0:ye((0,r.W7)(e))}function xe(e){return ke(e)?e:Se(e,!1,j,fe,he)}function we(e){return Se(e,!1,q,de,ve)}function Ce(e){return Se(e,!0,G,pe,me)}function Se(e,t,n,o,i){if(!(0,r.Kn)(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const a=i.get(e);if(a)return a;const s=be(e);if(0===s)return e;const u=new Proxy(e,2===s?o:n);return i.set(e,u),u}function Ee(e){return ke(e)?Ee(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function ke(e){return!(!e||!e["__v_isReadonly"])}function Ie(e){return!(!e||!e["__v_isShallow"])}function _e(e){return Ee(e)||ke(e)}function Re(e){const t=e&&e["__v_raw"];return t?Re(t):e}function Te(e){return(0,r.Nj)(e,"__v_skip",!0),e}const Ae=e=>(0,r.Kn)(e)?xe(e):e,De=e=>(0,r.Kn)(e)?Ce(e):e;function Oe(e){w&&m&&(e=Re(e),I(e.dep||(e.dep=s())))}function Fe(e,t){e=Re(e),e.dep&&R(e.dep)}function Ne(e){return!(!e||!0!==e.__v_isRef)}function Pe(e){return Me(e,!1)}function Me(e,t){return Ne(e)?e:new Be(e,t)}class Be{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Re(e),this._value=t?e:Ae(e)}get value(){return Oe(this),this._value}set value(e){e=this.__v_isShallow?e:Re(e),(0,r.aU)(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:Ae(e),Fe(this,e))}}function We(e){return Ne(e)?e.value:e}const Le={get:(e,t,n)=>We(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const o=e[t];return Ne(o)&&!Ne(n)?(o.value=n,!0):Reflect.set(e,t,n,r)}};function Ve(e){return Ee(e)?e:new Proxy(e,Le)}function ze(e){const t=(0,r.kJ)(e)?new Array(e.length):{};for(const n in e)t[n]=He(e,n);return t}class Ue{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return void 0===e?this._defaultValue:e}set value(e){this._object[this._key]=e}}function He(e,t,n){const r=e[t];return Ne(r)?r:new Ue(e,t,n)}class je{constructor(e,t,n,r){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new b(e,(()=>{this._dirty||(this._dirty=!0,Fe(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this["__v_isReadonly"]=n}get value(){const e=Re(this);return Oe(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Ge(e,t,n=!1){let o,i;const a=(0,r.mf)(e);a?(o=e,i=r.dG):(o=e.get,i=e.set);const s=new je(o,i,a||!i,n);return s}},3396:function(e,t,n){"use strict";n.d(t,{$d:function(){return a},Ah:function(){return Fe},Cn:function(){return z},FN:function(){return In},Fl:function(){return Un},HY:function(){return Gt},JJ:function(){return J},Jd:function(){return Oe},P$:function(){return ce},Q2:function(){return je},Q6:function(){return ve},U2:function(){return fe},Uk:function(){return vn},Us:function(){return Ot},Wm:function(){return fn},Xn:function(){return Ae},Y3:function(){return C},Y8:function(){return ae},YP:function(){return te},_:function(){return ln},aZ:function(){return me},bv:function(){return Te},dD:function(){return V},dG:function(){return xn},dl:function(){return xe},f3:function(){return Z},h:function(){return Hn},iD:function(){return nn},ic:function(){return De},kq:function(){return mn},lA:function(){return on},lR:function(){return jt},m0:function(){return Q},nK:function(){return he},se:function(){return we},up:function(){return Ue},w5:function(){return U},wg:function(){return Jt},wy:function(){return We}});n(3948),n(8862),n(6699),n(2707),n(3210),n(4916),n(5306),n(1703),n(1817),n(4603),n(8450),n(1299),n(5827);var r=n(4870),o=n(7139);function i(e,t,n,r){let o;try{o=r?e(...r):e()}catch(i){s(i,t,n)}return o}function a(e,t,n,r){if((0,o.mf)(e)){const a=i(e,t,n,r);return a&&(0,o.tI)(a)&&a.catch((e=>{s(e,t,n)})),a}const u=[];for(let o=0;o<e.length;o++)u.push(a(e[o],t,n,r));return u}function s(e,t,n,r=!0){const o=t?t.vnode:null;if(t){let r=t.parent;const o=t.proxy,a=n;while(r){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,o,a))return;r=r.parent}const s=t.appContext.config.errorHandler;if(s)return void i(s,null,10,[e,o,a])}u(e,n,o,r)}function u(e,t,n,r=!0){console.error(e)}let c=!1,l=!1;const f=[];let d=0;const p=[];let h=null,v=0;const m=[];let g=null,y=0;const b=Promise.resolve();let x=null,w=null;function C(e){const t=x||b;return e?t.then(this?e.bind(this):e):t}function S(e){let t=d+1,n=f.length;while(t<n){const r=t+n>>>1,o=O(f[r]);o<e?t=r+1:n=r}return t}function E(e){f.length&&f.includes(e,c&&e.allowRecurse?d+1:d)||e===w||(null==e.id?f.push(e):f.splice(S(e.id),0,e),k())}function k(){c||l||(l=!0,x=b.then(F))}function I(e){const t=f.indexOf(e);t>d&&f.splice(t,1)}function _(e,t,n,r){(0,o.kJ)(e)?n.push(...e):t&&t.includes(e,e.allowRecurse?r+1:r)||n.push(e),k()}function R(e){_(e,h,p,v)}function T(e){_(e,g,m,y)}function A(e,t=null){if(p.length){for(w=t,h=[...new Set(p)],p.length=0,v=0;v<h.length;v++)h[v]();h=null,v=0,w=null,A(e,t)}}function D(e){if(A(),m.length){const e=[...new Set(m)];if(m.length=0,g)return void g.push(...e);for(g=e,g.sort(((e,t)=>O(e)-O(t))),y=0;y<g.length;y++)g[y]();g=null,y=0}}const O=e=>null==e.id?1/0:e.id;function F(e){l=!1,c=!0,A(e),f.sort(((e,t)=>O(e)-O(t)));o.dG;try{for(d=0;d<f.length;d++){const e=f[d];e&&!1!==e.active&&i(e,null,14)}}finally{d=0,f.length=0,D(e),c=!1,x=null,(f.length||p.length||m.length)&&F(e)}}new Set;new Map;function N(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||o.kT;let i=n;const s=t.startsWith("update:"),u=s&&t.slice(7);if(u&&u in r){const e=`${"modelValue"===u?"model":u}Modifiers`,{number:t,trim:a}=r[e]||o.kT;a&&(i=n.map((e=>e.trim()))),t&&(i=n.map(o.He))}let c;let l=r[c=(0,o.hR)(t)]||r[c=(0,o.hR)((0,o._A)(t))];!l&&s&&(l=r[c=(0,o.hR)((0,o.rs)(t))]),l&&a(l,e,6,i);const f=r[c+"Once"];if(f){if(e.emitted){if(e.emitted[c])return}else e.emitted={};e.emitted[c]=!0,a(f,e,6,i)}}function P(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(void 0!==i)return i;const a=e.emits;let s={},u=!1;if(!(0,o.mf)(e)){const r=e=>{const n=P(e,t,!0);n&&(u=!0,(0,o.l7)(s,n))};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}return a||u?((0,o.kJ)(a)?a.forEach((e=>s[e]=null)):(0,o.l7)(s,a),r.set(e,s),s):(r.set(e,null),null)}function M(e,t){return!(!e||!(0,o.F7)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,o.RI)(e,t[0].toLowerCase()+t.slice(1))||(0,o.RI)(e,(0,o.rs)(t))||(0,o.RI)(e,t))}let B=null,W=null;function L(e){const t=B;return B=e,W=e&&e.type.__scopeId||null,t}function V(e){W=e}function z(){W=null}function U(e,t=B,n){if(!t)return e;if(e._n)return e;const r=(...n)=>{r._d&&en(-1);const o=L(t),i=e(...n);return L(o),r._d&&en(1),i};return r._n=!0,r._c=!0,r._d=!0,r}function H(e){const{type:t,vnode:n,proxy:r,withProxy:i,props:a,propsOptions:[u],slots:c,attrs:l,emit:f,render:d,renderCache:p,data:h,setupState:v,ctx:m,inheritAttrs:g}=e;let y,b;const x=L(e);try{if(4&n.shapeFlag){const e=i||r;y=gn(d.call(e,e,p,a,v,h,m)),b=l}else{const e=t;0,y=gn(e.length>1?e(a,{attrs:l,slots:c,emit:f}):e(a,null)),b=t.props?l:j(l)}}catch(C){Xt.length=0,s(C,e,1),y=fn($t)}let w=y;if(b&&!1!==g){const e=Object.keys(b),{shapeFlag:t}=w;e.length&&7&t&&(u&&e.some(o.tR)&&(b=G(b,u)),w=hn(w,b))}return n.dirs&&(w=hn(w),w.dirs=w.dirs?w.dirs.concat(n.dirs):n.dirs),n.transition&&(w.transition=n.transition),y=w,L(x),y}const j=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,o.F7)(n))&&((t||(t={}))[n]=e[n]);return t},G=(e,t)=>{const n={};for(const r in e)(0,o.tR)(r)&&r.slice(9)in t||(n[r]=e[r]);return n};function q(e,t,n){const{props:r,children:o,component:i}=e,{props:a,children:s,patchFlag:u}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&u>=0))return!(!o&&!s||s&&s.$stable)||r!==a&&(r?!a||$(r,a,c):!!a);if(1024&u)return!0;if(16&u)return r?$(r,a,c):!!a;if(8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(a[n]!==r[n]&&!M(c,n))return!0}}return!1}function $(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let o=0;o<r.length;o++){const i=r[o];if(t[i]!==e[i]&&!M(n,i))return!0}return!1}function K({vnode:e,parent:t},n){while(t&&t.subTree===e)(e=t.vnode).el=n,t=t.parent}const X=e=>e.__isSuspense;function Y(e,t){t&&t.pendingBranch?(0,o.kJ)(e)?t.effects.push(...e):t.effects.push(e):T(e)}function J(e,t){if(kn){let n=kn.provides;const r=kn.parent&&kn.parent.provides;r===n&&(n=kn.provides=Object.create(r)),n[e]=t}else 0}function Z(e,t,n=!1){const r=kn||B;if(r){const i=null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return n&&(0,o.mf)(t)?t.call(r.proxy):t}else 0}function Q(e,t){return ne(e,null,t)}const ee={};function te(e,t,n){return ne(e,t,n)}function ne(e,t,{immediate:n,deep:s,flush:u,onTrack:c,onTrigger:l}=o.kT){const f=kn;let d,p,h=!1,v=!1;if((0,r.dq)(e)?(d=()=>e.value,h=(0,r.yT)(e)):(0,r.PG)(e)?(d=()=>e,s=!0):(0,o.kJ)(e)?(v=!0,h=e.some((e=>(0,r.PG)(e)||(0,r.yT)(e))),d=()=>e.map((e=>(0,r.dq)(e)?e.value:(0,r.PG)(e)?ie(e):(0,o.mf)(e)?i(e,f,2):void 0))):d=(0,o.mf)(e)?t?()=>i(e,f,2):()=>{if(!f||!f.isUnmounted)return p&&p(),a(e,f,3,[m])}:o.dG,t&&s){const e=d;d=()=>ie(e())}let m=e=>{p=x.onStop=()=>{i(e,f,4)}};if(On)return m=o.dG,t?n&&a(t,f,3,[d(),v?[]:void 0,m]):d(),o.dG;let g=v?[]:ee;const y=()=>{if(x.active)if(t){const e=x.run();(s||h||(v?e.some(((e,t)=>(0,o.aU)(e,g[t]))):(0,o.aU)(e,g)))&&(p&&p(),a(t,f,3,[e,g===ee?void 0:g,m]),g=e)}else x.run()};let b;y.allowRecurse=!!t,b="sync"===u?y:"post"===u?()=>Dt(y,f&&f.suspense):()=>R(y);const x=new r.qq(d,b);return t?n?y():g=x.run():"post"===u?Dt(x.run.bind(x),f&&f.suspense):x.run(),()=>{x.stop(),f&&f.scope&&(0,o.Od)(f.scope.effects,x)}}function re(e,t,n){const r=this.proxy,i=(0,o.HD)(e)?e.includes(".")?oe(r,e):()=>r[e]:e.bind(r,r);let a;(0,o.mf)(t)?a=t:(a=t.handler,n=t);const s=kn;_n(this);const u=ne(i,a.bind(r),n);return s?_n(s):Rn(),u}function oe(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function ie(e,t){if(!(0,o.Kn)(e)||e["__v_skip"])return e;if(t=t||new Set,t.has(e))return e;if(t.add(e),(0,r.dq)(e))ie(e.value,t);else if((0,o.kJ)(e))for(let n=0;n<e.length;n++)ie(e[n],t);else if((0,o.DM)(e)||(0,o._N)(e))e.forEach((e=>{ie(e,t)}));else if((0,o.PO)(e))for(const n in e)ie(e[n],t);return e}function ae(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Te((()=>{e.isMounted=!0})),Oe((()=>{e.isUnmounting=!0})),e}const se=[Function,Array],ue={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:se,onEnter:se,onAfterEnter:se,onEnterCancelled:se,onBeforeLeave:se,onLeave:se,onAfterLeave:se,onLeaveCancelled:se,onBeforeAppear:se,onAppear:se,onAfterAppear:se,onAppearCancelled:se},setup(e,{slots:t}){const n=In(),o=ae();let i;return()=>{const a=t.default&&ve(t.default(),!0);if(!a||!a.length)return;let s=a[0];if(a.length>1){let e=!1;for(const t of a)if(t.type!==$t){0,s=t,e=!0;break}}const u=(0,r.IU)(e),{mode:c}=u;if(o.isLeaving)return de(s);const l=pe(s);if(!l)return de(s);const f=fe(l,u,o,n);he(l,f);const d=n.subTree,p=d&&pe(d);let h=!1;const{getTransitionKey:v}=l.type;if(v){const e=v();void 0===i?i=e:e!==i&&(i=e,h=!0)}if(p&&p.type!==$t&&(!an(l,p)||h)){const e=fe(p,u,o,n);if(he(p,e),"out-in"===c)return o.isLeaving=!0,e.afterLeave=()=>{o.isLeaving=!1,n.update()},de(s);"in-out"===c&&l.type!==$t&&(e.delayLeave=(e,t,n)=>{const r=le(o,p);r[String(p.key)]=p,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete f.delayedLeave},f.delayedLeave=n})}return s}}},ce=ue;function le(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function fe(e,t,n,r){const{appear:i,mode:s,persisted:u=!1,onBeforeEnter:c,onEnter:l,onAfterEnter:f,onEnterCancelled:d,onBeforeLeave:p,onLeave:h,onAfterLeave:v,onLeaveCancelled:m,onBeforeAppear:g,onAppear:y,onAfterAppear:b,onAppearCancelled:x}=t,w=String(e.key),C=le(n,e),S=(e,t)=>{e&&a(e,r,9,t)},E=(e,t)=>{const n=t[1];S(e,t),(0,o.kJ)(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},k={mode:s,persisted:u,beforeEnter(t){let r=c;if(!n.isMounted){if(!i)return;r=g||c}t._leaveCb&&t._leaveCb(!0);const o=C[w];o&&an(e,o)&&o.el._leaveCb&&o.el._leaveCb(),S(r,[t])},enter(e){let t=l,r=f,o=d;if(!n.isMounted){if(!i)return;t=y||l,r=b||f,o=x||d}let a=!1;const s=e._enterCb=t=>{a||(a=!0,S(t?o:r,[e]),k.delayedLeave&&k.delayedLeave(),e._enterCb=void 0)};t?E(t,[e,s]):s()},leave(t,r){const o=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return r();S(p,[t]);let i=!1;const a=t._leaveCb=n=>{i||(i=!0,r(),S(n?m:v,[t]),t._leaveCb=void 0,C[o]===e&&delete C[o])};C[o]=e,h?E(h,[t,a]):a()},clone(e){return fe(e,t,n,r)}};return k}function de(e){if(ye(e))return e=hn(e),e.children=null,e}function pe(e){return ye(e)?e.children?e.children[0]:void 0:e}function he(e,t){6&e.shapeFlag&&e.component?he(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ve(e,t=!1,n){let r=[],o=0;for(let i=0;i<e.length;i++){let a=e[i];const s=null==n?a.key:String(n)+String(null!=a.key?a.key:i);a.type===Gt?(128&a.patchFlag&&o++,r=r.concat(ve(a.children,t,s))):(t||a.type!==$t)&&r.push(null!=s?hn(a,{key:s}):a)}if(o>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function me(e){return(0,o.mf)(e)?{setup:e,name:e.name}:e}const ge=e=>!!e.type.__asyncLoader;const ye=e=>e.type.__isKeepAlive;RegExp,RegExp;function be(e,t){return(0,o.kJ)(e)?e.some((e=>be(e,t))):(0,o.HD)(e)?e.split(",").includes(t):!!e.test&&e.test(t)}function xe(e,t){Ce(e,"a",t)}function we(e,t){Ce(e,"da",t)}function Ce(e,t,n=kn){const r=e.__wdc||(e.__wdc=()=>{let t=n;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(Ie(t,r,n),n){let e=n.parent;while(e&&e.parent)ye(e.parent.vnode)&&Se(r,t,n,e),e=e.parent}}function Se(e,t,n,r){const i=Ie(t,e,r,!0);Fe((()=>{(0,o.Od)(r[t],i)}),n)}function Ee(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}function ke(e){return 128&e.shapeFlag?e.ssContent:e}function Ie(e,t,n=kn,o=!1){if(n){const i=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;(0,r.Jd)(),_n(n);const i=a(t,n,e,o);return Rn(),(0,r.lk)(),i});return o?i.unshift(s):i.push(s),s}}const _e=e=>(t,n=kn)=>(!On||"sp"===e)&&Ie(e,t,n),Re=_e("bm"),Te=_e("m"),Ae=_e("bu"),De=_e("u"),Oe=_e("bum"),Fe=_e("um"),Ne=_e("sp"),Pe=_e("rtg"),Me=_e("rtc");function Be(e,t=kn){Ie("ec",e,t)}function We(e,t){const n=B;if(null===n)return e;const r=Ln(n)||n.proxy,i=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[e,n,s,u=o.kT]=t[a];(0,o.mf)(e)&&(e={mounted:e,updated:e}),e.deep&&ie(n),i.push({dir:e,instance:r,value:n,oldValue:void 0,arg:s,modifiers:u})}return e}function Le(e,t,n,o){const i=e.dirs,s=t&&t.dirs;for(let u=0;u<i.length;u++){const c=i[u];s&&(c.oldValue=s[u].value);let l=c.dir[o];l&&((0,r.Jd)(),a(l,n,8,[e.el,c,e,t]),(0,r.lk)())}}const Ve="components",ze="directives";function Ue(e,t){return Ge(Ve,e,!0,t)||e}const He=Symbol();function je(e){return Ge(ze,e)}function Ge(e,t,n=!0,r=!1){const i=B||kn;if(i){const n=i.type;if(e===Ve){const e=Vn(n,!1);if(e&&(e===t||e===(0,o._A)(t)||e===(0,o.kC)((0,o._A)(t))))return n}const a=qe(i[e]||n[e],t)||qe(i.appContext[e],t);return!a&&r?n:a}}function qe(e,t){return e&&(e[t]||e[(0,o._A)(t)]||e[(0,o.kC)((0,o._A)(t))])}const $e=e=>e?Tn(e)?Ln(e)||e.proxy:$e(e.parent):null,Ke=(0,o.l7)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>$e(e.parent),$root:e=>$e(e.root),$emit:e=>e.emit,$options:e=>tt(e),$forceUpdate:e=>e.f||(e.f=()=>E(e.update)),$nextTick:e=>e.n||(e.n=C.bind(e.proxy)),$watch:e=>re.bind(e)}),Xe={get({_:e},t){const{ctx:n,setupState:i,data:a,props:s,accessCache:u,type:c,appContext:l}=e;let f;if("$"!==t[0]){const r=u[t];if(void 0!==r)switch(r){case 1:return i[t];case 2:return a[t];case 4:return n[t];case 3:return s[t]}else{if(i!==o.kT&&(0,o.RI)(i,t))return u[t]=1,i[t];if(a!==o.kT&&(0,o.RI)(a,t))return u[t]=2,a[t];if((f=e.propsOptions[0])&&(0,o.RI)(f,t))return u[t]=3,s[t];if(n!==o.kT&&(0,o.RI)(n,t))return u[t]=4,n[t];Ye&&(u[t]=0)}}const d=Ke[t];let p,h;return d?("$attrs"===t&&(0,r.j)(e,"get",t),d(e)):(p=c.__cssModules)&&(p=p[t])?p:n!==o.kT&&(0,o.RI)(n,t)?(u[t]=4,n[t]):(h=l.config.globalProperties,(0,o.RI)(h,t)?h[t]:void 0)},set({_:e},t,n){const{data:r,setupState:i,ctx:a}=e;return i!==o.kT&&(0,o.RI)(i,t)?(i[t]=n,!0):r!==o.kT&&(0,o.RI)(r,t)?(r[t]=n,!0):!(0,o.RI)(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(a[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:i,propsOptions:a}},s){let u;return!!n[s]||e!==o.kT&&(0,o.RI)(e,s)||t!==o.kT&&(0,o.RI)(t,s)||(u=a[0])&&(0,o.RI)(u,s)||(0,o.RI)(r,s)||(0,o.RI)(Ke,s)||(0,o.RI)(i.config.globalProperties,s)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,o.RI)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let Ye=!0;function Je(e){const t=tt(e),n=e.proxy,i=e.ctx;Ye=!1,t.beforeCreate&&Qe(t.beforeCreate,e,"bc");const{data:a,computed:s,methods:u,watch:c,provide:l,inject:f,created:d,beforeMount:p,mounted:h,beforeUpdate:v,updated:m,activated:g,deactivated:y,beforeDestroy:b,beforeUnmount:x,destroyed:w,unmounted:C,render:S,renderTracked:E,renderTriggered:k,errorCaptured:I,serverPrefetch:_,expose:R,inheritAttrs:T,components:A,directives:D,filters:O}=t,F=null;if(f&&Ze(f,i,F,e.appContext.config.unwrapInjectedRef),u)for(const r in u){const e=u[r];(0,o.mf)(e)&&(i[r]=e.bind(n))}if(a){0;const t=a.call(n,n);0,(0,o.Kn)(t)&&(e.data=(0,r.qj)(t))}if(Ye=!0,s)for(const r in s){const e=s[r],t=(0,o.mf)(e)?e.bind(n,n):(0,o.mf)(e.get)?e.get.bind(n,n):o.dG;0;const a=!(0,o.mf)(e)&&(0,o.mf)(e.set)?e.set.bind(n):o.dG,u=Un({get:t,set:a});Object.defineProperty(i,r,{enumerable:!0,configurable:!0,get:()=>u.value,set:e=>u.value=e})}if(c)for(const r in c)et(c[r],i,n,r);if(l){const e=(0,o.mf)(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{J(t,e[t])}))}function N(e,t){(0,o.kJ)(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(d&&Qe(d,e,"c"),N(Re,p),N(Te,h),N(Ae,v),N(De,m),N(xe,g),N(we,y),N(Be,I),N(Me,E),N(Pe,k),N(Oe,x),N(Fe,C),N(Ne,_),(0,o.kJ)(R))if(R.length){const t=e.exposed||(e.exposed={});R.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});S&&e.render===o.dG&&(e.render=S),null!=T&&(e.inheritAttrs=T),A&&(e.components=A),D&&(e.directives=D)}function Ze(e,t,n=o.dG,i=!1){(0,o.kJ)(e)&&(e=at(e));for(const a in e){const n=e[a];let s;s=(0,o.Kn)(n)?"default"in n?Z(n.from||a,n.default,!0):Z(n.from||a):Z(n),(0,r.dq)(s)&&i?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:e=>s.value=e}):t[a]=s}}function Qe(e,t,n){a((0,o.kJ)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function et(e,t,n,r){const i=r.includes(".")?oe(n,r):()=>n[r];if((0,o.HD)(e)){const n=t[e];(0,o.mf)(n)&&te(i,n)}else if((0,o.mf)(e))te(i,e.bind(n));else if((0,o.Kn)(e))if((0,o.kJ)(e))e.forEach((e=>et(e,t,n,r)));else{const r=(0,o.mf)(e.handler)?e.handler.bind(n):t[e.handler];(0,o.mf)(r)&&te(i,r,e)}else 0}function tt(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:o,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,s=i.get(t);let u;return s?u=s:o.length||n||r?(u={},o.length&&o.forEach((e=>nt(u,e,a,!0))),nt(u,t,a)):u=t,i.set(t,u),u}function nt(e,t,n,r=!1){const{mixins:o,extends:i}=t;i&&nt(e,i,n,!0),o&&o.forEach((t=>nt(e,t,n,!0)));for(const a in t)if(r&&"expose"===a);else{const r=rt[a]||n&&n[a];e[a]=r?r(e[a],t[a]):t[a]}return e}const rt={data:ot,props:ut,emits:ut,methods:ut,computed:ut,beforeCreate:st,created:st,beforeMount:st,mounted:st,beforeUpdate:st,updated:st,beforeDestroy:st,beforeUnmount:st,destroyed:st,unmounted:st,activated:st,deactivated:st,errorCaptured:st,serverPrefetch:st,components:ut,directives:ut,watch:ct,provide:ot,inject:it};function ot(e,t){return t?e?function(){return(0,o.l7)((0,o.mf)(e)?e.call(this,this):e,(0,o.mf)(t)?t.call(this,this):t)}:t:e}function it(e,t){return ut(at(e),at(t))}function at(e){if((0,o.kJ)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function st(e,t){return e?[...new Set([].concat(e,t))]:t}function ut(e,t){return e?(0,o.l7)((0,o.l7)(Object.create(null),e),t):t}function ct(e,t){if(!e)return t;if(!t)return e;const n=(0,o.l7)(Object.create(null),e);for(const r in t)n[r]=st(e[r],t[r]);return n}function lt(e,t,n,i=!1){const a={},s={};(0,o.Nj)(s,sn,1),e.propsDefaults=Object.create(null),dt(e,t,a,s);for(const r in e.propsOptions[0])r in a||(a[r]=void 0);n?e.props=i?a:(0,r.Um)(a):e.type.props?e.props=a:e.props=s,e.attrs=s}function ft(e,t,n,i){const{props:a,attrs:s,vnode:{patchFlag:u}}=e,c=(0,r.IU)(a),[l]=e.propsOptions;let f=!1;if(!(i||u>0)||16&u){let r;dt(e,t,a,s)&&(f=!0);for(const i in c)t&&((0,o.RI)(t,i)||(r=(0,o.rs)(i))!==i&&(0,o.RI)(t,r))||(l?!n||void 0===n[i]&&void 0===n[r]||(a[i]=pt(l,c,i,void 0,e,!0)):delete a[i]);if(s!==c)for(const e in s)t&&(0,o.RI)(t,e)||(delete s[e],f=!0)}else if(8&u){const n=e.vnode.dynamicProps;for(let r=0;r<n.length;r++){let i=n[r];if(M(e.emitsOptions,i))continue;const u=t[i];if(l)if((0,o.RI)(s,i))u!==s[i]&&(s[i]=u,f=!0);else{const t=(0,o._A)(i);a[t]=pt(l,c,t,u,e,!1)}else u!==s[i]&&(s[i]=u,f=!0)}}f&&(0,r.X$)(e,"set","$attrs")}function dt(e,t,n,i){const[a,s]=e.propsOptions;let u,c=!1;if(t)for(let r in t){if((0,o.Gg)(r))continue;const l=t[r];let f;a&&(0,o.RI)(a,f=(0,o._A)(r))?s&&s.includes(f)?(u||(u={}))[f]=l:n[f]=l:M(e.emitsOptions,r)||r in i&&l===i[r]||(i[r]=l,c=!0)}if(s){const t=(0,r.IU)(n),i=u||o.kT;for(let r=0;r<s.length;r++){const u=s[r];n[u]=pt(a,t,u,i[u],e,!(0,o.RI)(i,u))}}return c}function pt(e,t,n,r,i,a){const s=e[n];if(null!=s){const e=(0,o.RI)(s,"default");if(e&&void 0===r){const e=s.default;if(s.type!==Function&&(0,o.mf)(e)){const{propsDefaults:o}=i;n in o?r=o[n]:(_n(i),r=o[n]=e.call(null,t),Rn())}else r=e}s[0]&&(a&&!e?r=!1:!s[1]||""!==r&&r!==(0,o.rs)(n)||(r=!0))}return r}function ht(e,t,n=!1){const r=t.propsCache,i=r.get(e);if(i)return i;const a=e.props,s={},u=[];let c=!1;if(!(0,o.mf)(e)){const r=e=>{c=!0;const[n,r]=ht(e,t,!0);(0,o.l7)(s,n),r&&u.push(...r)};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}if(!a&&!c)return r.set(e,o.Z6),o.Z6;if((0,o.kJ)(a))for(let f=0;f<a.length;f++){0;const e=(0,o._A)(a[f]);vt(e)&&(s[e]=o.kT)}else if(a){0;for(const e in a){const t=(0,o._A)(e);if(vt(t)){const n=a[e],r=s[t]=(0,o.kJ)(n)||(0,o.mf)(n)?{type:n}:n;if(r){const e=yt(Boolean,r.type),n=yt(String,r.type);r[0]=e>-1,r[1]=n<0||e<n,(e>-1||(0,o.RI)(r,"default"))&&u.push(t)}}}}const l=[s,u];return r.set(e,l),l}function vt(e){return"$"!==e[0]}function mt(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function gt(e,t){return mt(e)===mt(t)}function yt(e,t){return(0,o.kJ)(t)?t.findIndex((t=>gt(t,e))):(0,o.mf)(t)&&gt(t,e)?0:-1}const bt=e=>"_"===e[0]||"$stable"===e,xt=e=>(0,o.kJ)(e)?e.map(gn):[gn(e)],wt=(e,t,n)=>{if(t._n)return t;const r=U(((...e)=>xt(t(...e))),n);return r._c=!1,r},Ct=(e,t,n)=>{const r=e._ctx;for(const i in e){if(bt(i))continue;const n=e[i];if((0,o.mf)(n))t[i]=wt(i,n,r);else if(null!=n){0;const e=xt(n);t[i]=()=>e}}},St=(e,t)=>{const n=xt(t);e.slots.default=()=>n},Et=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=(0,r.IU)(t),(0,o.Nj)(t,"_",n)):Ct(t,e.slots={})}else e.slots={},t&&St(e,t);(0,o.Nj)(e.slots,sn,1)},kt=(e,t,n)=>{const{vnode:r,slots:i}=e;let a=!0,s=o.kT;if(32&r.shapeFlag){const e=t._;e?n&&1===e?a=!1:((0,o.l7)(i,t),n||1!==e||delete i._):(a=!t.$stable,Ct(t,i)),s=t}else t&&(St(e,t),s={default:1});if(a)for(const o in i)bt(o)||o in s||delete i[o]};function It(){return{app:null,config:{isNativeTag:o.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let _t=0;function Rt(e,t){return function(n,r=null){(0,o.mf)(n)||(n=Object.assign({},n)),null==r||(0,o.Kn)(r)||(r=null);const i=It(),a=new Set;let s=!1;const u=i.app={_uid:_t++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:jn,get config(){return i.config},set config(e){0},use(e,...t){return a.has(e)||(e&&(0,o.mf)(e.install)?(a.add(e),e.install(u,...t)):(0,o.mf)(e)&&(a.add(e),e(u,...t))),u},mixin(e){return i.mixins.includes(e)||i.mixins.push(e),u},component(e,t){return t?(i.components[e]=t,u):i.components[e]},directive(e,t){return t?(i.directives[e]=t,u):i.directives[e]},mount(o,a,c){if(!s){0;const l=fn(n,r);return l.appContext=i,a&&t?t(l,o):e(l,o,c),s=!0,u._container=o,o.__vue_app__=u,Ln(l.component)||l.component.proxy}},unmount(){s&&(e(null,u._container),delete u._container.__vue_app__)},provide(e,t){return i.provides[e]=t,u}};return u}}function Tt(e,t,n,a,s=!1){if((0,o.kJ)(e))return void e.forEach(((e,r)=>Tt(e,t&&((0,o.kJ)(t)?t[r]:t),n,a,s)));if(ge(a)&&!s)return;const u=4&a.shapeFlag?Ln(a.component)||a.component.proxy:a.el,c=s?null:u,{i:l,r:f}=e;const d=t&&t.r,p=l.refs===o.kT?l.refs={}:l.refs,h=l.setupState;if(null!=d&&d!==f&&((0,o.HD)(d)?(p[d]=null,(0,o.RI)(h,d)&&(h[d]=null)):(0,r.dq)(d)&&(d.value=null)),(0,o.mf)(f))i(f,l,12,[c,p]);else{const t=(0,o.HD)(f),i=(0,r.dq)(f);if(t||i){const r=()=>{if(e.f){const n=t?p[f]:f.value;s?(0,o.kJ)(n)&&(0,o.Od)(n,u):(0,o.kJ)(n)?n.includes(u)||n.push(u):t?(p[f]=[u],(0,o.RI)(h,f)&&(h[f]=p[f])):(f.value=[u],e.k&&(p[e.k]=f.value))}else t?(p[f]=c,(0,o.RI)(h,f)&&(h[f]=c)):i&&(f.value=c,e.k&&(p[e.k]=c))};c?(r.id=-1,Dt(r,n)):r()}else 0}}function At(){}const Dt=Y;function Ot(e){return Ft(e)}function Ft(e,t){At();const n=(0,o.E9)();n.__VUE__=!0;const{insert:i,remove:a,patchProp:s,createElement:u,createText:c,createComment:l,setText:f,setElementText:d,parentNode:p,nextSibling:h,setScopeId:v=o.dG,cloneNode:m,insertStaticContent:g}=e,y=(e,t,n,r=null,o=null,i=null,a=!1,s=null,u=!!t.dynamicChildren)=>{if(e===t)return;e&&!an(e,t)&&(r=Q(e),$(e,o,i,!0),e=null),-2===t.patchFlag&&(u=!1,t.dynamicChildren=null);const{type:c,ref:l,shapeFlag:f}=t;switch(c){case qt:b(e,t,n,r);break;case $t:x(e,t,n,r);break;case Kt:null==e&&w(t,n,r,a);break;case Gt:P(e,t,n,r,o,i,a,s,u);break;default:1&f?k(e,t,n,r,o,i,a,s,u):6&f?M(e,t,n,r,o,i,a,s,u):(64&f||128&f)&&c.process(e,t,n,r,o,i,a,s,u,te)}null!=l&&o&&Tt(l,e&&e.ref,i,t||e,!t)},b=(e,t,n,r)=>{if(null==e)i(t.el=c(t.children),n,r);else{const n=t.el=e.el;t.children!==e.children&&f(n,t.children)}},x=(e,t,n,r)=>{null==e?i(t.el=l(t.children||""),n,r):t.el=e.el},w=(e,t,n,r)=>{[e.el,e.anchor]=g(e.children,t,n,r,e.el,e.anchor)},C=({el:e,anchor:t},n,r)=>{let o;while(e&&e!==t)o=h(e),i(e,n,r),e=o;i(t,n,r)},S=({el:e,anchor:t})=>{let n;while(e&&e!==t)n=h(e),a(e),e=n;a(t)},k=(e,t,n,r,o,i,a,s,u)=>{a=a||"svg"===t.type,null==e?_(t,n,r,o,i,a,s,u):O(e,t,o,i,a,s,u)},_=(e,t,n,r,a,c,l,f)=>{let p,h;const{type:v,props:g,shapeFlag:y,transition:b,patchFlag:x,dirs:w}=e;if(e.el&&void 0!==m&&-1===x)p=e.el=m(e.el);else{if(p=e.el=u(e.type,c,g&&g.is,g),8&y?d(p,e.children):16&y&&T(e.children,p,null,r,a,c&&"foreignObject"!==v,l,f),w&&Le(e,null,r,"created"),g){for(const t in g)"value"===t||(0,o.Gg)(t)||s(p,t,null,g[t],c,e.children,r,a,Z);"value"in g&&s(p,"value",null,g.value),(h=g.onVnodeBeforeMount)&&wn(h,r,e)}R(p,e,e.scopeId,l,r)}w&&Le(e,null,r,"beforeMount");const C=(!a||a&&!a.pendingBranch)&&b&&!b.persisted;C&&b.beforeEnter(p),i(p,t,n),((h=g&&g.onVnodeMounted)||C||w)&&Dt((()=>{h&&wn(h,r,e),C&&b.enter(p),w&&Le(e,null,r,"mounted")}),a)},R=(e,t,n,r,o)=>{if(n&&v(e,n),r)for(let i=0;i<r.length;i++)v(e,r[i]);if(o){let n=o.subTree;if(t===n){const t=o.vnode;R(e,t,t.scopeId,t.slotScopeIds,o.parent)}}},T=(e,t,n,r,o,i,a,s,u=0)=>{for(let c=u;c<e.length;c++){const u=e[c]=s?yn(e[c]):gn(e[c]);y(null,u,t,n,r,o,i,a,s)}},O=(e,t,n,r,i,a,u)=>{const c=t.el=e.el;let{patchFlag:l,dynamicChildren:f,dirs:p}=t;l|=16&e.patchFlag;const h=e.props||o.kT,v=t.props||o.kT;let m;n&&Nt(n,!1),(m=v.onVnodeBeforeUpdate)&&wn(m,n,t,e),p&&Le(t,e,n,"beforeUpdate"),n&&Nt(n,!0);const g=i&&"foreignObject"!==t.type;if(f?F(e.dynamicChildren,f,c,n,r,g,a):u||z(e,t,c,null,n,r,g,a,!1),l>0){if(16&l)N(c,t,h,v,n,r,i);else if(2&l&&h.class!==v.class&&s(c,"class",null,v.class,i),4&l&&s(c,"style",h.style,v.style,i),8&l){const o=t.dynamicProps;for(let t=0;t<o.length;t++){const a=o[t],u=h[a],l=v[a];l===u&&"value"!==a||s(c,a,u,l,i,e.children,n,r,Z)}}1&l&&e.children!==t.children&&d(c,t.children)}else u||null!=f||N(c,t,h,v,n,r,i);((m=v.onVnodeUpdated)||p)&&Dt((()=>{m&&wn(m,n,t,e),p&&Le(t,e,n,"updated")}),r)},F=(e,t,n,r,o,i,a)=>{for(let s=0;s<t.length;s++){const u=e[s],c=t[s],l=u.el&&(u.type===Gt||!an(u,c)||70&u.shapeFlag)?p(u.el):n;y(u,c,l,null,r,o,i,a,!0)}},N=(e,t,n,r,i,a,u)=>{if(n!==r){for(const c in r){if((0,o.Gg)(c))continue;const l=r[c],f=n[c];l!==f&&"value"!==c&&s(e,c,f,l,u,t.children,i,a,Z)}if(n!==o.kT)for(const c in n)(0,o.Gg)(c)||c in r||s(e,c,n[c],null,u,t.children,i,a,Z);"value"in r&&s(e,"value",n.value,r.value)}},P=(e,t,n,r,o,a,s,u,l)=>{const f=t.el=e?e.el:c(""),d=t.anchor=e?e.anchor:c("");let{patchFlag:p,dynamicChildren:h,slotScopeIds:v}=t;v&&(u=u?u.concat(v):v),null==e?(i(f,n,r),i(d,n,r),T(t.children,n,d,o,a,s,u,l)):p>0&&64&p&&h&&e.dynamicChildren?(F(e.dynamicChildren,h,n,o,a,s,u),(null!=t.key||o&&t===o.subTree)&&Pt(e,t,!0)):z(e,t,n,d,o,a,s,u,l)},M=(e,t,n,r,o,i,a,s,u)=>{t.slotScopeIds=s,null==e?512&t.shapeFlag?o.ctx.activate(t,n,r,a,u):B(t,n,r,o,i,a,u):W(e,t,u)},B=(e,t,n,r,o,i,a)=>{const s=e.component=En(e,r,o);if(ye(e)&&(s.ctx.renderer=te),Fn(s),s.asyncDep){if(o&&o.registerDep(s,L),!e.el){const e=s.subTree=fn($t);x(null,e,t,n)}}else L(s,e,t,n,o,i,a)},W=(e,t,n)=>{const r=t.component=e.component;if(q(e,t,n)){if(r.asyncDep&&!r.asyncResolved)return void V(r,t,n);r.next=t,I(r.update),r.update()}else t.el=e.el,r.vnode=t},L=(e,t,n,i,a,s,u)=>{const c=()=>{if(e.isMounted){let t,{next:n,bu:r,u:i,parent:c,vnode:l}=e,f=n;0,Nt(e,!1),n?(n.el=l.el,V(e,n,u)):n=l,r&&(0,o.ir)(r),(t=n.props&&n.props.onVnodeBeforeUpdate)&&wn(t,c,n,l),Nt(e,!0);const d=H(e);0;const h=e.subTree;e.subTree=d,y(h,d,p(h.el),Q(h),e,a,s),n.el=d.el,null===f&&K(e,d.el),i&&Dt(i,a),(t=n.props&&n.props.onVnodeUpdated)&&Dt((()=>wn(t,c,n,l)),a)}else{let r;const{el:u,props:c}=t,{bm:l,m:f,parent:d}=e,p=ge(t);if(Nt(e,!1),l&&(0,o.ir)(l),!p&&(r=c&&c.onVnodeBeforeMount)&&wn(r,d,t),Nt(e,!0),u&&re){const n=()=>{e.subTree=H(e),re(u,e.subTree,e,a,null)};p?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{0;const r=e.subTree=H(e);0,y(null,r,n,i,e,a,s),t.el=r.el}if(f&&Dt(f,a),!p&&(r=c&&c.onVnodeMounted)){const e=t;Dt((()=>wn(r,d,e)),a)}(256&t.shapeFlag||d&&ge(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&Dt(e.a,a),e.isMounted=!0,t=n=i=null}},l=e.effect=new r.qq(c,(()=>E(f)),e.scope),f=e.update=()=>l.run();f.id=e.uid,Nt(e,!0),f()},V=(e,t,n)=>{t.component=e;const o=e.vnode.props;e.vnode=t,e.next=null,ft(e,t.props,o,n),kt(e,t.children,n),(0,r.Jd)(),A(void 0,e.update),(0,r.lk)()},z=(e,t,n,r,o,i,a,s,u=!1)=>{const c=e&&e.children,l=e?e.shapeFlag:0,f=t.children,{patchFlag:p,shapeFlag:h}=t;if(p>0){if(128&p)return void j(c,f,n,r,o,i,a,s,u);if(256&p)return void U(c,f,n,r,o,i,a,s,u)}8&h?(16&l&&Z(c,o,i),f!==c&&d(n,f)):16&l?16&h?j(c,f,n,r,o,i,a,s,u):Z(c,o,i,!0):(8&l&&d(n,""),16&h&&T(f,n,r,o,i,a,s,u))},U=(e,t,n,r,i,a,s,u,c)=>{e=e||o.Z6,t=t||o.Z6;const l=e.length,f=t.length,d=Math.min(l,f);let p;for(p=0;p<d;p++){const r=t[p]=c?yn(t[p]):gn(t[p]);y(e[p],r,n,null,i,a,s,u,c)}l>f?Z(e,i,a,!0,!1,d):T(t,n,r,i,a,s,u,c,d)},j=(e,t,n,r,i,a,s,u,c)=>{let l=0;const f=t.length;let d=e.length-1,p=f-1;while(l<=d&&l<=p){const r=e[l],o=t[l]=c?yn(t[l]):gn(t[l]);if(!an(r,o))break;y(r,o,n,null,i,a,s,u,c),l++}while(l<=d&&l<=p){const r=e[d],o=t[p]=c?yn(t[p]):gn(t[p]);if(!an(r,o))break;y(r,o,n,null,i,a,s,u,c),d--,p--}if(l>d){if(l<=p){const e=p+1,o=e<f?t[e].el:r;while(l<=p)y(null,t[l]=c?yn(t[l]):gn(t[l]),n,o,i,a,s,u,c),l++}}else if(l>p)while(l<=d)$(e[l],i,a,!0),l++;else{const h=l,v=l,m=new Map;for(l=v;l<=p;l++){const e=t[l]=c?yn(t[l]):gn(t[l]);null!=e.key&&m.set(e.key,l)}let g,b=0;const x=p-v+1;let w=!1,C=0;const S=new Array(x);for(l=0;l<x;l++)S[l]=0;for(l=h;l<=d;l++){const r=e[l];if(b>=x){$(r,i,a,!0);continue}let o;if(null!=r.key)o=m.get(r.key);else for(g=v;g<=p;g++)if(0===S[g-v]&&an(r,t[g])){o=g;break}void 0===o?$(r,i,a,!0):(S[o-v]=l+1,o>=C?C=o:w=!0,y(r,t[o],n,null,i,a,s,u,c),b++)}const E=w?Mt(S):o.Z6;for(g=E.length-1,l=x-1;l>=0;l--){const e=v+l,o=t[e],d=e+1<f?t[e+1].el:r;0===S[l]?y(null,o,n,d,i,a,s,u,c):w&&(g<0||l!==E[g]?G(o,n,d,2):g--)}}},G=(e,t,n,r,o=null)=>{const{el:a,type:s,transition:u,children:c,shapeFlag:l}=e;if(6&l)return void G(e.component.subTree,t,n,r);if(128&l)return void e.suspense.move(t,n,r);if(64&l)return void s.move(e,t,n,te);if(s===Gt){i(a,t,n);for(let e=0;e<c.length;e++)G(c[e],t,n,r);return void i(e.anchor,t,n)}if(s===Kt)return void C(e,t,n);const f=2!==r&&1&l&&u;if(f)if(0===r)u.beforeEnter(a),i(a,t,n),Dt((()=>u.enter(a)),o);else{const{leave:e,delayLeave:r,afterLeave:o}=u,s=()=>i(a,t,n),c=()=>{e(a,(()=>{s(),o&&o()}))};r?r(a,s,c):c()}else i(a,t,n)},$=(e,t,n,r=!1,o=!1)=>{const{type:i,props:a,ref:s,children:u,dynamicChildren:c,shapeFlag:l,patchFlag:f,dirs:d}=e;if(null!=s&&Tt(s,null,n,e,!0),256&l)return void t.ctx.deactivate(e);const p=1&l&&d,h=!ge(e);let v;if(h&&(v=a&&a.onVnodeBeforeUnmount)&&wn(v,t,e),6&l)J(e.component,n,r);else{if(128&l)return void e.suspense.unmount(n,r);p&&Le(e,null,t,"beforeUnmount"),64&l?e.type.remove(e,t,n,o,te,r):c&&(i!==Gt||f>0&&64&f)?Z(c,t,n,!1,!0):(i===Gt&&384&f||!o&&16&l)&&Z(u,t,n),r&&X(e)}(h&&(v=a&&a.onVnodeUnmounted)||p)&&Dt((()=>{v&&wn(v,t,e),p&&Le(e,null,t,"unmounted")}),n)},X=e=>{const{type:t,el:n,anchor:r,transition:o}=e;if(t===Gt)return void Y(n,r);if(t===Kt)return void S(e);const i=()=>{a(n),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&e.shapeFlag&&o&&!o.persisted){const{leave:t,delayLeave:r}=o,a=()=>t(n,i);r?r(e.el,i,a):a()}else i()},Y=(e,t)=>{let n;while(e!==t)n=h(e),a(e),e=n;a(t)},J=(e,t,n)=>{const{bum:r,scope:i,update:a,subTree:s,um:u}=e;r&&(0,o.ir)(r),i.stop(),a&&(a.active=!1,$(s,e,t,n)),u&&Dt(u,t),Dt((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},Z=(e,t,n,r=!1,o=!1,i=0)=>{for(let a=i;a<e.length;a++)$(e[a],t,n,r,o)},Q=e=>6&e.shapeFlag?Q(e.component.subTree):128&e.shapeFlag?e.suspense.next():h(e.anchor||e.el),ee=(e,t,n)=>{null==e?t._vnode&&$(t._vnode,null,null,!0):y(t._vnode||null,e,t,null,null,null,n),D(),t._vnode=e},te={p:y,um:$,m:G,r:X,mt:B,mc:T,pc:z,pbc:F,n:Q,o:e};let ne,re;return t&&([ne,re]=t(te)),{render:ee,hydrate:ne,createApp:Rt(ee,ne)}}function Nt({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function Pt(e,t,n=!1){const r=e.children,i=t.children;if((0,o.kJ)(r)&&(0,o.kJ)(i))for(let o=0;o<r.length;o++){const e=r[o];let t=i[o];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=i[o]=yn(i[o]),t.el=e.el),n||Pt(e,t))}}function Mt(e){const t=e.slice(),n=[0];let r,o,i,a,s;const u=e.length;for(r=0;r<u;r++){const u=e[r];if(0!==u){if(o=n[n.length-1],e[o]<u){t[r]=o,n.push(r);continue}i=0,a=n.length-1;while(i<a)s=i+a>>1,e[n[s]]<u?i=s+1:a=s;u<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}i=n.length,a=n[i-1];while(i-- >0)n[i]=a,a=t[a];return n}const Bt=e=>e.__isTeleport,Wt=e=>e&&(e.disabled||""===e.disabled),Lt=e=>"undefined"!==typeof SVGElement&&e instanceof SVGElement,Vt=(e,t)=>{const n=e&&e.to;if((0,o.HD)(n)){if(t){const e=t(n);return e}return null}return n},zt={__isTeleport:!0,process(e,t,n,r,o,i,a,s,u,c){const{mc:l,pc:f,pbc:d,o:{insert:p,querySelector:h,createText:v,createComment:m}}=c,g=Wt(t.props);let{shapeFlag:y,children:b,dynamicChildren:x}=t;if(null==e){const e=t.el=v(""),c=t.anchor=v("");p(e,n,r),p(c,n,r);const f=t.target=Vt(t.props,h),d=t.targetAnchor=v("");f&&(p(d,f),a=a||Lt(f));const m=(e,t)=>{16&y&&l(b,e,t,o,i,a,s,u)};g?m(n,c):f&&m(f,d)}else{t.el=e.el;const r=t.anchor=e.anchor,l=t.target=e.target,p=t.targetAnchor=e.targetAnchor,v=Wt(e.props),m=v?n:l,y=v?r:p;if(a=a||Lt(l),x?(d(e.dynamicChildren,x,m,o,i,a,s),Pt(e,t,!0)):u||f(e,t,m,y,o,i,a,s,!1),g)v||Ut(t,n,r,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const e=t.target=Vt(t.props,h);e&&Ut(t,e,null,c,0)}else v&&Ut(t,l,p,c,1)}},remove(e,t,n,r,{um:o,o:{remove:i}},a){const{shapeFlag:s,children:u,anchor:c,targetAnchor:l,target:f,props:d}=e;if(f&&i(l),(a||!Wt(d))&&(i(c),16&s))for(let p=0;p<u.length;p++){const e=u[p];o(e,t,n,!0,!!e.dynamicChildren)}},move:Ut,hydrate:Ht};function Ut(e,t,n,{o:{insert:r},m:o},i=2){0===i&&r(e.targetAnchor,t,n);const{el:a,anchor:s,shapeFlag:u,children:c,props:l}=e,f=2===i;if(f&&r(a,t,n),(!f||Wt(l))&&16&u)for(let d=0;d<c.length;d++)o(c[d],t,n,2);f&&r(s,t,n)}function Ht(e,t,n,r,o,i,{o:{nextSibling:a,parentNode:s,querySelector:u}},c){const l=t.target=Vt(t.props,u);if(l){const u=l._lpa||l.firstChild;if(16&t.shapeFlag)if(Wt(t.props))t.anchor=c(a(e),t,s(e),n,r,o,i),t.targetAnchor=u;else{t.anchor=a(e);let s=u;while(s)if(s=a(s),s&&8===s.nodeType&&"teleport anchor"===s.data){t.targetAnchor=s,l._lpa=t.targetAnchor&&a(t.targetAnchor);break}c(u,t,l,n,r,o,i)}}return t.anchor&&a(t.anchor)}const jt=zt,Gt=Symbol(void 0),qt=Symbol(void 0),$t=Symbol(void 0),Kt=Symbol(void 0),Xt=[];let Yt=null;function Jt(e=!1){Xt.push(Yt=e?null:[])}function Zt(){Xt.pop(),Yt=Xt[Xt.length-1]||null}let Qt=1;function en(e){Qt+=e}function tn(e){return e.dynamicChildren=Qt>0?Yt||o.Z6:null,Zt(),Qt>0&&Yt&&Yt.push(e),e}function nn(e,t,n,r,o,i){return tn(ln(e,t,n,r,o,i,!0))}function rn(e,t,n,r,o){return tn(fn(e,t,n,r,o,!0))}function on(e){return!!e&&!0===e.__v_isVNode}function an(e,t){return e.type===t.type&&e.key===t.key}const sn="__vInternal",un=({key:e})=>null!=e?e:null,cn=({ref:e,ref_key:t,ref_for:n})=>null!=e?(0,o.HD)(e)||(0,r.dq)(e)||(0,o.mf)(e)?{i:B,r:e,k:t,f:!!n}:e:null;function ln(e,t=null,n=null,r=0,i=null,a=(e===Gt?0:1),s=!1,u=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&un(t),ref:t&&cn(t),scopeId:W,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null};return u?(bn(c,n),128&a&&e.normalize(c)):n&&(c.shapeFlag|=(0,o.HD)(n)?8:16),Qt>0&&!s&&Yt&&(c.patchFlag>0||6&a)&&32!==c.patchFlag&&Yt.push(c),c}const fn=dn;function dn(e,t=null,n=null,i=0,a=null,s=!1){if(e&&e!==He||(e=$t),on(e)){const r=hn(e,t,!0);return n&&bn(r,n),Qt>0&&!s&&Yt&&(6&r.shapeFlag?Yt[Yt.indexOf(e)]=r:Yt.push(r)),r.patchFlag|=-2,r}if(zn(e)&&(e=e.__vccOpts),t){t=pn(t);let{class:e,style:n}=t;e&&!(0,o.HD)(e)&&(t.class=(0,o.C_)(e)),(0,o.Kn)(n)&&((0,r.X3)(n)&&!(0,o.kJ)(n)&&(n=(0,o.l7)({},n)),t.style=(0,o.j5)(n))}const u=(0,o.HD)(e)?1:X(e)?128:Bt(e)?64:(0,o.Kn)(e)?4:(0,o.mf)(e)?2:0;return ln(e,t,n,i,a,u,s,!0)}function pn(e){return e?(0,r.X3)(e)||sn in e?(0,o.l7)({},e):e:null}function hn(e,t,n=!1){const{props:r,ref:i,patchFlag:a,children:s}=e,u=t?xn(r||{},t):r,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&un(u),ref:t&&t.ref?n&&i?(0,o.kJ)(i)?i.concat(cn(t)):[i,cn(t)]:cn(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Gt?-1===a?16:16|a:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&hn(e.ssContent),ssFallback:e.ssFallback&&hn(e.ssFallback),el:e.el,anchor:e.anchor};return c}function vn(e=" ",t=0){return fn(qt,null,e,t)}function mn(e="",t=!1){return t?(Jt(),rn($t,null,e)):fn($t,null,e)}function gn(e){return null==e||"boolean"===typeof e?fn($t):(0,o.kJ)(e)?fn(Gt,null,e.slice()):"object"===typeof e?yn(e):fn(qt,null,String(e))}function yn(e){return null===e.el||e.memo?e:hn(e)}function bn(e,t){let n=0;const{shapeFlag:r}=e;if(null==t)t=null;else if((0,o.kJ)(t))n=16;else if("object"===typeof t){if(65&r){const n=t.default;return void(n&&(n._c&&(n._d=!1),bn(e,n()),n._c&&(n._d=!0)))}{n=32;const r=t._;r||sn in t?3===r&&B&&(1===B.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=B}}else(0,o.mf)(t)?(t={default:t,_ctx:B},n=32):(t=String(t),64&r?(n=16,t=[vn(t)]):n=8);e.children=t,e.shapeFlag|=n}function xn(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const e in r)if("class"===e)t.class!==r.class&&(t.class=(0,o.C_)([t.class,r.class]));else if("style"===e)t.style=(0,o.j5)([t.style,r.style]);else if((0,o.F7)(e)){const n=t[e],i=r[e];!i||n===i||(0,o.kJ)(n)&&n.includes(i)||(t[e]=n?[].concat(n,i):i)}else""!==e&&(t[e]=r[e])}return t}function wn(e,t,n,r=null){a(e,t,7,[n,r])}const Cn=It();let Sn=0;function En(e,t,n){const i=e.type,a=(t?t.appContext:e.appContext)||Cn,s={uid:Sn++,vnode:e,type:i,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new r.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ht(i,a),emitsOptions:P(i,a),emit:null,emitted:null,propsDefaults:o.kT,inheritAttrs:i.inheritAttrs,ctx:o.kT,data:o.kT,props:o.kT,attrs:o.kT,slots:o.kT,refs:o.kT,setupState:o.kT,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=N.bind(null,s),e.ce&&e.ce(s),s}let kn=null;const In=()=>kn||B,_n=e=>{kn=e,e.scope.on()},Rn=()=>{kn&&kn.scope.off(),kn=null};function Tn(e){return 4&e.vnode.shapeFlag}let An,Dn,On=!1;function Fn(e,t=!1){On=t;const{props:n,children:r}=e.vnode,o=Tn(e);lt(e,n,o,t),Et(e,r);const i=o?Nn(e,t):void 0;return On=!1,i}function Nn(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=(0,r.Xl)(new Proxy(e.ctx,Xe));const{setup:a}=n;if(a){const n=e.setupContext=a.length>1?Wn(e):null;_n(e),(0,r.Jd)();const u=i(a,e,0,[e.props,n]);if((0,r.lk)(),Rn(),(0,o.tI)(u)){if(u.then(Rn,Rn),t)return u.then((n=>{Pn(e,n,t)})).catch((t=>{s(t,e,0)}));e.asyncDep=u}else Pn(e,u,t)}else Mn(e,t)}function Pn(e,t,n){(0,o.mf)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,o.Kn)(t)&&(e.setupState=(0,r.WL)(t)),Mn(e,n)}function Mn(e,t,n){const i=e.type;if(!e.render){if(!t&&An&&!i.render){const t=i.template;if(t){0;const{isCustomElement:n,compilerOptions:r}=e.appContext.config,{delimiters:a,compilerOptions:s}=i,u=(0,o.l7)((0,o.l7)({isCustomElement:n,delimiters:a},r),s);i.render=An(t,u)}}e.render=i.render||o.dG,Dn&&Dn(e)}_n(e),(0,r.Jd)(),Je(e),(0,r.lk)(),Rn()}function Bn(e){return new Proxy(e.attrs,{get(t,n){return(0,r.j)(e,"get","$attrs"),t[n]}})}function Wn(e){const t=t=>{e.exposed=t||{}};let n;return{get attrs(){return n||(n=Bn(e))},slots:e.slots,emit:e.emit,expose:t}}function Ln(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy((0,r.WL)((0,r.Xl)(e.exposed)),{get(t,n){return n in t?t[n]:n in Ke?Ke[n](e):void 0}}))}function Vn(e,t=!0){return(0,o.mf)(e)?e.displayName||e.name:e.name||t&&e.__name}function zn(e){return(0,o.mf)(e)&&"__vccOpts"in e}const Un=(e,t)=>(0,r.Fl)(e,t,On);function Hn(e,t,n){const r=arguments.length;return 2===r?(0,o.Kn)(t)&&!(0,o.kJ)(t)?on(t)?fn(e,null,[t]):fn(e,t):fn(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):3===r&&on(n)&&(n=[n]),fn(e,t,n))}Symbol("");const jn="3.2.37"},9242:function(e,t,n){"use strict";n.d(t,{D2:function(){return ee},F8:function(){return te},ri:function(){return ae},uT:function(){return B}});n(3948),n(4916),n(5306),n(6699),n(8862),n(3210);var r=n(7139),o=n(3396);n(4870);const i="http://www.w3.org/2000/svg",a="undefined"!==typeof document?document:null,s=a&&a.createElement("template"),u={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const o=t?a.createElementNS(i,e):a.createElement(e,n?{is:n}:void 0);return"select"===e&&r&&null!=r.multiple&&o.setAttribute("multiple",r.multiple),o},createText:e=>a.createTextNode(e),createComment:e=>a.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>a.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,r,o,i){const a=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling)){while(1)if(t.insertBefore(o.cloneNode(!0),n),o===i||!(o=o.nextSibling))break}else{s.innerHTML=r?`<svg>${e}</svg>`:e;const o=s.content;if(r){const e=o.firstChild;while(e.firstChild)o.appendChild(e.firstChild);o.removeChild(e)}t.insertBefore(o,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function c(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function l(e,t,n){const o=e.style,i=(0,r.HD)(n);if(n&&!i){for(const e in n)d(o,e,n[e]);if(t&&!(0,r.HD)(t))for(const e in t)null==n[e]&&d(o,e,"")}else{const r=o.display;i?t!==n&&(o.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(o.display=r)}}const f=/\s*!important$/;function d(e,t,n){if((0,r.kJ)(n))n.forEach((n=>d(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=v(e,t);f.test(n)?e.setProperty((0,r.rs)(o),n.replace(f,""),"important"):e[o]=n}}const p=["Webkit","Moz","ms"],h={};function v(e,t){const n=h[t];if(n)return n;let o=(0,r._A)(t);if("filter"!==o&&o in e)return h[t]=o;o=(0,r.kC)(o);for(let r=0;r<p.length;r++){const n=p[r]+o;if(n in e)return h[t]=n}return t}const m="http://www.w3.org/1999/xlink";function g(e,t,n,o,i){if(o&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(m,t.slice(6,t.length)):e.setAttributeNS(m,t,n);else{const o=(0,r.Pq)(t);null==n||o&&!(0,r.yA)(n)?e.removeAttribute(t):e.setAttribute(t,o?"":n)}}function y(e,t,n,o,i,a,s){if("innerHTML"===t||"textContent"===t)return o&&s(o,i,a),void(e[t]=null==n?"":n);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=n;const r=null==n?"":n;return e.value===r&&"OPTION"!==e.tagName||(e.value=r),void(null==n&&e.removeAttribute(t))}let u=!1;if(""===n||null==n){const o=typeof e[t];"boolean"===o?n=(0,r.yA)(n):null==n&&"string"===o?(n="",u=!0):"number"===o&&(n=0,u=!0)}try{e[t]=n}catch(c){0}u&&e.removeAttribute(t)}const[b,x]=(()=>{let e=Date.now,t=!1;if("undefined"!==typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let w=0;const C=Promise.resolve(),S=()=>{w=0},E=()=>w||(C.then(S),w=b());function k(e,t,n,r){e.addEventListener(t,n,r)}function I(e,t,n,r){e.removeEventListener(t,n,r)}function _(e,t,n,r,o=null){const i=e._vei||(e._vei={}),a=i[t];if(r&&a)a.value=r;else{const[n,s]=T(t);if(r){const a=i[t]=A(r,o);k(e,n,a,s)}else a&&(I(e,n,a,s),i[t]=void 0)}}const R=/(?:Once|Passive|Capture)$/;function T(e){let t;if(R.test(e)){let n;t={};while(n=e.match(R))e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[(0,r.rs)(e.slice(2)),t]}function A(e,t){const n=e=>{const r=e.timeStamp||b();(x||r>=n.attached-1)&&(0,o.$d)(D(e,n.value),t,5,[e])};return n.value=e,n.attached=E(),n}function D(e,t){if((0,r.kJ)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}const O=/^on[a-z]/,F=(e,t,n,o,i=!1,a,s,u,f)=>{"class"===t?c(e,o,i):"style"===t?l(e,n,o):(0,r.F7)(t)?(0,r.tR)(t)||_(e,t,n,o,s):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):N(e,t,o,i))?y(e,t,o,a,s,u,f):("true-value"===t?e._trueValue=o:"false-value"===t&&(e._falseValue=o),g(e,t,o,i))};function N(e,t,n,o){return o?"innerHTML"===t||"textContent"===t||!!(t in e&&O.test(t)&&(0,r.mf)(n)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!O.test(t)||!(0,r.HD)(n))&&t in e))))}"undefined"!==typeof HTMLElement&&HTMLElement;const P="transition",M="animation",B=(e,{slots:t})=>(0,o.h)(o.P$,z(e),t);B.displayName="Transition";const W={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},L=(B.props=(0,r.l7)({},o.P$.props,W),(e,t=[])=>{(0,r.kJ)(e)?e.forEach((e=>e(...t))):e&&e(...t)}),V=e=>!!e&&((0,r.kJ)(e)?e.some((e=>e.length>1)):e.length>1);function z(e){const t={};for(const r in e)r in W||(t[r]=e[r]);if(!1===e.css)return t;const{name:n="v",type:o,duration:i,enterFromClass:a=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:u=`${n}-enter-to`,appearFromClass:c=a,appearActiveClass:l=s,appearToClass:f=u,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:h=`${n}-leave-to`}=e,v=U(i),m=v&&v[0],g=v&&v[1],{onBeforeEnter:y,onEnter:b,onEnterCancelled:x,onLeave:w,onLeaveCancelled:C,onBeforeAppear:S=y,onAppear:E=b,onAppearCancelled:k=x}=t,I=(e,t,n)=>{G(e,t?f:u),G(e,t?l:s),n&&n()},_=(e,t)=>{e._isLeaving=!1,G(e,d),G(e,h),G(e,p),t&&t()},R=e=>(t,n)=>{const r=e?E:b,i=()=>I(t,e,n);L(r,[t,i]),q((()=>{G(t,e?c:a),j(t,e?f:u),V(r)||K(t,o,m,i)}))};return(0,r.l7)(t,{onBeforeEnter(e){L(y,[e]),j(e,a),j(e,s)},onBeforeAppear(e){L(S,[e]),j(e,c),j(e,l)},onEnter:R(!1),onAppear:R(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>_(e,t);j(e,d),Z(),j(e,p),q((()=>{e._isLeaving&&(G(e,d),j(e,h),V(w)||K(e,o,g,n))})),L(w,[e,n])},onEnterCancelled(e){I(e,!1),L(x,[e])},onAppearCancelled(e){I(e,!0),L(k,[e])},onLeaveCancelled(e){_(e),L(C,[e])}})}function U(e){if(null==e)return null;if((0,r.Kn)(e))return[H(e.enter),H(e.leave)];{const t=H(e);return[t,t]}}function H(e){const t=(0,r.He)(e);return t}function j(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function G(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function q(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let $=0;function K(e,t,n,r){const o=e._endId=++$,i=()=>{o===e._endId&&r()};if(n)return setTimeout(i,n);const{type:a,timeout:s,propCount:u}=X(e,t);if(!a)return r();const c=a+"end";let l=0;const f=()=>{e.removeEventListener(c,d),i()},d=t=>{t.target===e&&++l>=u&&f()};setTimeout((()=>{l<u&&f()}),s+1),e.addEventListener(c,d)}function X(e,t){const n=window.getComputedStyle(e),r=e=>(n[e]||"").split(", "),o=r(P+"Delay"),i=r(P+"Duration"),a=Y(o,i),s=r(M+"Delay"),u=r(M+"Duration"),c=Y(s,u);let l=null,f=0,d=0;t===P?a>0&&(l=P,f=a,d=i.length):t===M?c>0&&(l=M,f=c,d=u.length):(f=Math.max(a,c),l=f>0?a>c?P:M:null,d=l?l===P?i.length:u.length:0);const p=l===P&&/\b(transform|all)(,|$)/.test(n[P+"Property"]);return{type:l,timeout:f,propCount:d,hasTransform:p}}function Y(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map(((t,n)=>J(t)+J(e[n]))))}function J(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Z(){return document.body.offsetHeight}new WeakMap,new WeakMap;const Q={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ee=(e,t)=>n=>{if(!("key"in n))return;const o=(0,r.rs)(n.key);return t.some((e=>e===o||Q[e]===o))?e(n):void 0},te={beforeMount(e,{value:t},{transition:n}){e._vod="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):ne(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!==!n&&(r?t?(r.beforeEnter(e),ne(e,!0),r.enter(e)):r.leave(e,(()=>{ne(e,!1)})):ne(e,t))},beforeUnmount(e,{value:t}){ne(e,t)}};function ne(e,t){e.style.display=t?e._vod:"none"}const re=(0,r.l7)({patchProp:F},u);let oe;function ie(){return oe||(oe=(0,o.Us)(re))}const ae=(...e)=>{const t=ie().createApp(...e);const{mount:n}=t;return t.mount=e=>{const o=se(e);if(!o)return;const i=t._component;(0,r.mf)(i)||i.render||i.template||(i.template=o.innerHTML),o.innerHTML="";const a=n(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),a},t};function se(e){if((0,r.HD)(e)){const t=document.querySelector(e);return t}return e}},7139:function(e,t,n){"use strict";n.d(t,{C_:function(){return p},DM:function(){return O},E9:function(){return re},F7:function(){return E},Gg:function(){return j},HD:function(){return P},He:function(){return te},Kn:function(){return B},NO:function(){return C},Nj:function(){return ee},Od:function(){return _},PO:function(){return U},Pq:function(){return s},RI:function(){return T},S0:function(){return H},W7:function(){return z},WV:function(){return v},Z6:function(){return x},_A:function(){return $},_N:function(){return D},aU:function(){return Z},dG:function(){return w},e1:function(){return i},fY:function(){return r},hR:function(){return J},hq:function(){return m},ir:function(){return Q},j5:function(){return c},kC:function(){return Y},kJ:function(){return A},kT:function(){return b},l7:function(){return I},mf:function(){return N},rs:function(){return X},tI:function(){return W},tR:function(){return k},yA:function(){return u},yk:function(){return M},zw:function(){return g}});n(4916),n(3210),n(5306),n(8862),n(5827),n(3948),n(5837);function r(e,t){const n=Object.create(null),r=e.split(",");for(let o=0;o<r.length;o++)n[r[o]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}const o="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",i=r(o);const a="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",s=r(a);function u(e){return!!e||""===e}function c(e){if(A(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],o=P(r)?d(r):c(r);if(o)for(const e in o)t[e]=o[e]}return t}return P(e)||B(e)?e:void 0}const l=/;(?![^(]*\))/g,f=/:(.+)/;function d(e){const t={};return e.split(l).forEach((e=>{if(e){const n=e.split(f);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function p(e){let t="";if(P(e))t=e;else if(A(e))for(let n=0;n<e.length;n++){const r=p(e[n]);r&&(t+=r+" ")}else if(B(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function h(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=v(e[r],t[r]);return n}function v(e,t){if(e===t)return!0;let n=F(e),r=F(t);if(n||r)return!(!n||!r)&&e.getTime()===t.getTime();if(n=M(e),r=M(t),n||r)return e===t;if(n=A(e),r=A(t),n||r)return!(!n||!r)&&h(e,t);if(n=B(e),r=B(t),n||r){if(!n||!r)return!1;const o=Object.keys(e).length,i=Object.keys(t).length;if(o!==i)return!1;for(const n in e){const r=e.hasOwnProperty(n),o=t.hasOwnProperty(n);if(r&&!o||!r&&o||!v(e[n],t[n]))return!1}}return String(e)===String(t)}function m(e,t){return e.findIndex((e=>v(e,t)))}const g=e=>P(e)?e:null==e?"":A(e)||B(e)&&(e.toString===L||!N(e.toString))?JSON.stringify(e,y,2):String(e),y=(e,t)=>t&&t.__v_isRef?y(e,t.value):D(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n])=>(e[`${t} =>`]=n,e)),{})}:O(t)?{[`Set(${t.size})`]:[...t.values()]}:!B(t)||A(t)||U(t)?t:String(t),b={},x=[],w=()=>{},C=()=>!1,S=/^on[^a-z]/,E=e=>S.test(e),k=e=>e.startsWith("onUpdate:"),I=Object.assign,_=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},R=Object.prototype.hasOwnProperty,T=(e,t)=>R.call(e,t),A=Array.isArray,D=e=>"[object Map]"===V(e),O=e=>"[object Set]"===V(e),F=e=>"[object Date]"===V(e),N=e=>"function"===typeof e,P=e=>"string"===typeof e,M=e=>"symbol"===typeof e,B=e=>null!==e&&"object"===typeof e,W=e=>B(e)&&N(e.then)&&N(e.catch),L=Object.prototype.toString,V=e=>L.call(e),z=e=>V(e).slice(8,-1),U=e=>"[object Object]"===V(e),H=e=>P(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,j=r(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),G=e=>{const t=Object.create(null);return n=>{const r=t[n];return r||(t[n]=e(n))}},q=/-(\w)/g,$=G((e=>e.replace(q,((e,t)=>t?t.toUpperCase():"")))),K=/\B([A-Z])/g,X=G((e=>e.replace(K,"-$1").toLowerCase())),Y=G((e=>e.charAt(0).toUpperCase()+e.slice(1))),J=G((e=>e?`on${Y(e)}`:"")),Z=(e,t)=>!Object.is(e,t),Q=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},ee=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},te=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let ne;const re=()=>ne||(ne="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{})},166:function(e,t,n){"use strict";n.d(t,{zi:function(){return Eg},oE:function(){return zp},d7:function(){return tm},aK:function(){return Cm},dV:function(){return lh},Qr:function(){return Cg},bd:function(){return wg},ii:function(){return o},WI:function(){return Sg},JF:function(){return kh},qB:function(){return eg},_C:function(){return kg},P6:function(){return r}});var r={};n.r(r),n.d(r,{computeReshapedDimensions:function(){return vp},getCenterPoint:function(){return mp},isDimensions:function(){return hp},isEven:function(){return dp},isFloat:function(){return fp},isTensor:function(){return ap},isTensor1D:function(){return sp},isTensor2D:function(){return up},isTensor3D:function(){return cp},isTensor4D:function(){return lp},isValidNumber:function(){return yp},isValidProbablitiy:function(){return bp},range:function(){return gp},round:function(){return pp}});var o={};n.r(o),n.d(o,{AnchorPosition:function(){return Qp},DrawBox:function(){return ah},DrawBoxOptions:function(){return ih},DrawFaceLandmarks:function(){return iv},DrawFaceLandmarksOptions:function(){return ov},DrawTextField:function(){return oh},DrawTextFieldOptions:function(){return rh},drawContour:function(){return Zd},drawDetections:function(){return sh},drawFaceExpressions:function(){return tv},drawFaceLandmarks:function(){return av}});n(1817),n(3948),n(1703),n(2087),n(4916),n(5306),n(2707),n(9575),n(4197),n(8675),n(3105),n(3462),n(3824),n(7380),n(1118),n(5125),n(2472),n(5827),n(9135),n(5069),n(5837),n(8862),n(8255),n(5438),n(8145),n(7714),n(2801),n(1174),n(3210),n(8264),n(285),n(1637),n(9743),n(4633);var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var c=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l(n,t[0],t[1]),t.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),r=n[0],o=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,o)}))}},e}();function l(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function f(){return d}var d=null,p=new Map,h=new Map;function v(e,t){var n=x(e,t);return p.get(n)}function m(e){return h.get(e)}function g(e){for(var t=p.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function y(e){var t=e.kernelName,n=e.backendName,r=x(t,n);if(p.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");p.set(r,e)}function b(e){var t=e.kernelName;h.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),h.set(t,e)}function x(e,t){return t+"_"+e}function w(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function C(e,t,n){return Math.max(e,Math.min(t,n))}function S(e){return e%2==0?e:e+1}function E(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function k(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function I(e,t,n){void 0===n&&(n=""),k(A(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))}function _(e){k(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function R(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||j(e)&&!n)for(var r=0;r<e.length;++r)R(e[r],t,n);else t.push(e);return t}function T(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function A(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function D(e){return e%1==0}function O(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function F(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function N(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function P(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?o():setTimeout(a,s)}};a()}))}function M(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function B(e,t){var n=t.length;return k((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e})),k(e.every((function(e){return D(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function W(e,t){for(var n=[],r=[],o=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||o?null:B(t,e).sort(),a=0,s=0;s<e.length;++s){if(null!=i){if(i[a]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[a]||i[a]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function L(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function V(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function z(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function U(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function H(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function j(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function G(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function q(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function $(e){return"string"==typeof e||e instanceof String}function K(e){return"boolean"==typeof e}function X(e){return"number"==typeof e}function Y(e){return Array.isArray(e)?Y(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":X(e)?"float32":$(e)?"string":K(e)?"bool":"float32"}function J(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Z(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Q(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function ee(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=R(e)),n&&z(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)0!==Math.round(e[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function te(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var o=new Array;if(1===n.length)for(var i=n[0],a=0;a<i;a++)o[a]=r[t+a];else{i=n[0];var s=n.slice(1),u=s.reduce((function(e,t){return e*t}));for(a=0;a<i;a++)o[a]=e(t+a*u,s,r)}return o}(0,e,t)}function ne(e,t){for(var n=re(e,t),r=0;r<n.length;r++)n[r]=1;return n}function re(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function oe(){return f().platform.now()}function ie(e){e.forEach((function(t){k(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."}))}))}function ae(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",f().platform.encode(e,t)}function se(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",f().platform.decode(e,t)}function ue(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function ce(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}Object.freeze({shuffle:w,clamp:C,nearestLargerEven:S,sum:E,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(t[r]);n+=o*o}return n},assert:k,assertShapesMatch:I,assertNonNull:_,flatten:R,sizeFromShape:T,isScalarShape:function(e){return 0===e.length},arraysEqual:A,isInt:D,tanh:O,sizeToSquarishShape:F,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return w(t),t},rightPad:N,repeatedTry:P,inferFromImplicitShape:M,parseAxisParam:B,squeezeShape:W,getTypedArrayFromDType:L,getArrayFromDType:V,checkConversionForErrors:z,isValidDtype:U,hasEncodingLoss:H,isTypedArray:j,bytesPerElement:G,bytesFromStringArray:q,isString:$,isBoolean:K,isNumber:X,inferDtype:Y,isFunction:J,nearestDivisor:Z,computeStrides:Q,toTypedArray:ee,toNestedArray:te,makeOnesTypedArray:ne,makeZerosTypedArray:re,now:oe,assertNonNegativeIntegerDimensions:ie,fetch:function(e,t){return f().platform.fetch(e,t)},encodeString:ae,decodeString:se,locToIndex:ue,indexToLoc:ce});var le=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new fe)}return e.prototype.profileKernel=function(e,t,n){var r,o=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var o=e[r];if(isNaN(o)||!isFinite(o))return console.warn("Found "+o+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then((function(i){var a="";null!=i.getExtraProfileInfo&&(a=i.getExtraProfileInfo()),o.logger.logKernelProfile(e,n,r,i.kernelMs,t,a)}))}))})),r},e}(),fe=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,o,i){var a="number"==typeof r?N(r+"ms",9):r.error,s=N(e,25),u=t.rank,c=t.size,l=N(t.shape.toString(),14),f="";for(var d in o){var p=o[d].shape||t.shape,h=p.length;f+=d+": "+h+"D "+(h>0?p:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+f+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),de=20,pe=3,he=7;function ve(e,t,n,r){var o=Q(t),i=function(e,t,n,r){var o=T(t),i=r[r.length-1],a=new Array(i).fill(0),s=t.length,u="complex64"===n?ye(e):e;if(s>1)for(var c=0;c<o/i;c++)for(var l=c*i,f=0;f<i;f++)a[f]=Math.max(a[f],me(u[l+f],0,n).length);return a}(e,t,n,o),a=t.length,s=function e(t,n,r,o,i,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[me(ye(t)[0],0,r)]:"bool"===r?[ge(t[0])]:[t[0].toString()];if(1===c){if(u>de){var l=pe*s,f=Array.from(t.slice(0,l)),d=Array.from(t.slice((u-pe)*s,u*s));return"complex64"===r&&(f=ye(f),d=ye(d)),["["+f.map((function(e,t){return me(e,i[t],r)})).join(", ")+", ..., "+d.map((function(e,t){return me(e,i[u-pe+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?ye(t):Array.from(t)).map((function(e,t){return me(e,i[t],r)})).join(", ")+"]"]}var p=n.slice(1),h=o.slice(1),v=o[0]*s,m=[];if(u>de){for(var g=0;g<pe;g++){var y=(b=g*v)+v;m.push.apply(m,e(t.slice(b,y),p,r,h,i,!1))}for(m.push("..."),g=u-pe;g<u;g++)y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),p,r,h,i,g===u-1))}else for(g=0;g<u;g++){var b;y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),p,r,h,i,g===u-1))}var x=2===c?",":"";for(m[0]="["+m[0]+x,g=1;g<m.length-1;g++)m[g]=" "+m[g]+x;var w=",\n";for(g=2;g<c;g++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":w),m}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function me(e,t,n){return N(Array.isArray(e)?parseFloat(e[0].toFixed(he))+" + "+parseFloat(e[1].toFixed(he))+"j":$(e)?"'"+e+"'":"bool"===n?ge(e):parseFloat(e.toFixed(he)).toString(),t)}function ge(e){return 0===e?"false":"true"}function ye(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var be=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=T(e),null!=n){var o=n.length;k(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||V(t,this.size),this.strides=Q(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),k(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"}));var o=this.locToIndex(n);this.values[o]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,o=e;r<o.length;r++){var i=o[r];if(i<0||i>=this.shape[n]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return xe().makeTensor(this.values,this.shape,this.dtype)},e}(),xe=null,we=null,Ce=null,Se=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=T(e),this.strides=Q(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),k(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,o){return this.throwIfDisposed(),this.reshape([e,t,n,r,o])},e.prototype.asType=function(e){return this.throwIfDisposed(),we.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,we.buffer(this.shape,this.dtype,e)]}}))}))},e.prototype.bufferSync=function(){return we.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,te(this.shape,e)]}}))}))},e.prototype.arraySync=function(){return te(this.shape,this.dataSync())},e.prototype.data=function(){return s(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=xe().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map((function(e){return se(e)}))]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},e.prototype.dataSync=function(){this.throwIfDisposed();var e=xe().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return se(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,xe().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},e.prototype.dispose=function(){this.isDisposed||(xe().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),we.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),we.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),we.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),we.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),we.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),we.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),we.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),ve(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),we.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),we.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),we.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),we.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),we.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),we.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),we.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),we.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),we.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),we.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),we.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),we.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),Ce("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,r,n)},e.prototype.batchNorm=function(e,t,n,r,o){return void 0===o&&(o=.001),this.throwIfDisposed(),we.batchNorm(this,e,t,n,r,o)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),we.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),we.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),we.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),we.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),we.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),we.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),we.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),we.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),we.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),we.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),we.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),we.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),we.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),we.div(this,e)},e.prototype.divNoNan=function(e){return this.throwIfDisposed(),we.divNoNan(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),we.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),we.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),we.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),we.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),we.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),we.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),we.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),we.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),we.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),we.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),we.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),we.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),we.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),we.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),we.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),we.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),we.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),we.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),we.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),we.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),we.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),we.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),we.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),we.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),we.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),we.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),we.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),we.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),we.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),we.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),we.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),we.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),we.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),we.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),we.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),we.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),we.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),we.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),we.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),we.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),we.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),we.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),we.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),we.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),we.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),we.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),we.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),we.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),we.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),we.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),we.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),we.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),we.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),we.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),we.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),we.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),we.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),we.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),we.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),we.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),we.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),we.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),we.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),we.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),we.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),we.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),we.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),we.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),we.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),we.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),we.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),we.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),we.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),we.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,o,i){return void 0===r&&(r="NWC"),void 0===o&&(o=1),this.throwIfDisposed(),we.conv1d(this,e,t,n,r,o,i)},e.prototype.conv2d=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),we.conv2d(this,e,t,n,r,o,i)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),we.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),we.depthwiseConv2d(this,e,t,n,r,o,i)},e.prototype.separableConv2d=function(e,t,n,r,o,i){return void 0===o&&(o=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),we.separableConv2d(this,e,t,n,r,o,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),we.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),we.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),we.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,o){return this.throwIfDisposed(),we.pool(this,e,t,n,r,o)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),xe().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),we.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),we.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),we.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),we.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,o,i,a,s){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),we.stridedSlice(this,e,t,n,r,o,i,a,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),we.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),we.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),we.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),we.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),we.spectral.irfft(this)},e}();Object.defineProperty(Se,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var Ee,ke,Ie,_e,Re,Te=function(e){function t(t,n,r,o){var i=e.call(this,t.shape,t.dtype,t.dataId,o)||this;return i.trainable=n,i.name=r,i}return a(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!A(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");xe().disposeTensor(this),this.dataId=e.dataId,xe().incRef(this,null)},t.prototype.dispose=function(){xe().disposeVariable(this),this.isDisposedInternal=!0},t}(Se);Object.defineProperty(Te,Symbol.hasInstance,{value:function(e){return e instanceof Se&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Ee||(Ee={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ke||(ke={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Ie||(Ie={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(_e||(_e={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Re||(Re={}));var Ae={float32:_e,int32:ke,bool:Ie,complex64:Re};function De(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return Ae[e][t]}function Oe(e){return De(e,"int32")}function Fe(e,t){if(e.dtype===t.dtype)return[e,t];var n=De(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Ne(e,t){k(e.dtype===t.dtype,(function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"}))}function Pe(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof Se)n.push(t);else if(o=t,Array.isArray(o)||"object"==typeof o){var o,i=t;for(var a in i){var s=i[a];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:Fe,assertTypesMatch:Ne,isTensorInList:function(e,t){return t.some((function(t){return t.id===e.id}))},getTensorsInContainer:Pe});var Me,Be=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),We=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Be}return e.prototype.ready=function(){return s(this,void 0,void 0,(function(){var e,t,n;return u(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(o){switch(o.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=o.sent(),[3,3];case 2:r=n,o.label=3;case 3:if(!r)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new le(this.backendInstance),[2,!0]}}))}))},e.prototype.setupRegisteredKernels=function(){var e=this;g(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))},e.prototype.disposeRegisteredKernels=function(e){var t=this;g(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var o=++this.pendingBackendInitId,i=r.then((function(n){return!(o<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),o=r.success,i=r.asyncInit;if(i||o)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,o=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,o,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,o=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun((function(){return r.startScope(o)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){return e.toFloat()}}}),[]),t},e.prototype.runKernel=function(e,t,n,r,o){return this.runKernelFunc(null,t,null,e,n,r,o)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),o=0;n.forEach((function(e){o+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-o-i;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,o,i,a){var s,u=this;void 0===i&&(i=[]),void 0===a&&(a=[]);var c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,d=function(e){l&&(c=e.map((function(e){return u.keep(u.clone(e))})))},p=this.state.numBytes,h=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var m,g=v(r,this.backendName);return f=null!=g?function(){var e=u.backend.numDataIds();m=g.kernelFunc({inputs:t,attrs:o,backend:u.backend});var n=Array.isArray(m)?m:[m];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)})),c=s.filter((function(e,t){return a[t]}));return d((i||[]).slice().concat(c)),s}:function(){var t=u.backend.numDataIds();m=u.tidy((function(){return e(u.backend,d)}));var n=Array.isArray(m)?m:[m];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n},this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,(function(){return f()})):f()})),l&&this.addTapeNode(r,t,s,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-h,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShapes:s.map((function(e){return e.shape}))}),Array.isArray(m)?s:s[0]},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var o=e;"string"===n&&$(e[0])&&(o=e.map((function(e){return ae(e)})));var i=r.write(o,t,n),a=new Se(t,n,i,this.nextTensorId());if(this.incRef(a,r),"string"===n){var s=this.state.tensorInfo.get(i),u=q(o);this.state.numBytes+=u-s.bytes,s.bytes=u}return a},e.prototype.makeTensorFromDataId=function(e,t,n,r){var o=new Se(t,n=n||"float32",e,this.nextTensorId());return this.incRef(o,r),o},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var o=new Te(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*G(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Te||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,o){var i=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},s=m(e);null!=s&&(r=s.gradFunc),null!=r&&(a.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],o=re(r.size,r.dtype);return i.makeTensor(o,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],o)}),this.state.activeTape.push(a)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=Pe(e),r=new Set(n.map((function(e){return e.id}))),o=0;o<this.state.activeScope.track.length;o++){var i=this.state.activeScope.track[o];i.kept||r.has(i.id)||i.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==a.id||t.track(e)}))},e.prototype.gradients=function(e,t,n,r){var o=this;if(void 0===r&&(r=!1),k(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",e)}));k(i instanceof Se,(function(){return"The result y returned by f() must be a tensor."}));var a=function(e,t,n){for(var r={},o={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var a=(h=e[i]).inputs;for(var s in a){for(var u=a[s],c=!1,l=0;l<t.length;l++)if(r[u.id]){h.outputs.forEach((function(e){return r[e.id]=!0})),c=!0,o[h.id]=!0;break}if(c)break}}var f={};f[n.id]=!0;var d={};for(i=e.length-1;i>=0;i--)for(a=(h=e[i]).inputs,l=0;l<h.outputs.length;l++)if(f[h.outputs[l].id]){for(var s in a)f[a[s].id]=!0,d[h.id]=!0;break}var p=[];for(i=0;i<e.length;i++){var h;if(o[(h=e[i]).id]&&d[h.id]){var v={};for(var s in h.inputs){var m=h.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},h);g.inputs=v,g.outputs=h.outputs,p.push(g)}}return p}(this.state.activeTape,t,i);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,r,s={};s[i.id]=null==n?(e=i.shape,r=ne(T(e),"float32"),Le.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var o=t[r],i=[];if(o.outputs.forEach((function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)})),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+o.kernelName+".");var a=o.gradient(i),s=function(t){if(!(t in a))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[t]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=o.inputs[t];if(!A(r.shape,i.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var u in o.inputs)s(u)},o=t.length-1;o>=0;o--)r(o)}(s,a,(function(e){return o.tidy(e)}));var u=t.map((function(e){return s[e.id]}));return 0===o.state.gradientDepth&&(o.state.activeTape.forEach((function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()})),o.state.activeTape=null),{value:i,grads:u}}))},e.prototype.customGrad=function(e){var t=this;return k(J(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];k(r.every((function(e){return e instanceof Se})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(e,t){i[t]=e})),t.runKernelFunc((function(t,o){return k((n=e.apply(void 0,r.concat([o]))).value instanceof Se,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),k(J(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(e,t){var o=n.gradFunc(e,t),i=Array.isArray(o)?o:[o];k(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),k(i.every((function(e){return e instanceof Se})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return i.forEach((function(e,t){a[t]=function(){return e}})),a}))}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return t=oe(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=oe()-t,[2,n]}}))}))},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Be,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),Le=function(){var e=function(){if(null==Me){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Me=e}return Me}();if(null==e._tfengine){var t=new c(e);e._tfengine=new We(t)}return function(e){d=e}(e._tfengine.ENV),xe=function(){return e._tfengine},e._tfengine}();function Ve(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var ze=f();ze.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),ze.registerFlag("IS_BROWSER",(function(){return Ve()})),ze.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),ze.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),ze.registerFlag("PROD",(function(){return!1})),ze.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return ze.getBool("DEBUG")})),ze.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),ze.registerFlag("IS_TEST",(function(){return!1}));var Ue,He,je,Ge={},qe={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $e(e,t){Ge[e]=t}function Ke(e){e in Ge||(Ge[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete Ge[e]}),!1),1===e?t.getContext("webgl",qe)||t.getContext("experimental-webgl",qe):t.getContext("webgl2",qe)}(e));var t=Ge[e];return t.isContextLost()?(delete Ge[e],Ke(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ge[e])}function Xe(e,t){return[t,e]}function Ye(e){var t=T(e);return F(Math.ceil(t/4))}function Je(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Ze(e,t){var n,r,o,i,a,s,u,c,l,d=e;return 2===f().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,c=d.HALF_FLOAT,l=d.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=d.RGBA,a=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function Qe(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+rt(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Ue||(Ue={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(He||(He={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(je||(je={}));var et=5.96e-8,tt=65504;function nt(e){return!!(f().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||et<Math.abs(e)&&Math.abs(e)<tt)}function rt(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function ot(e,t,n){return _t(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function it(e,t,n){var r=_t(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Qe(e,t,(function(){return e.shaderSource(r,n)})),Qe(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function at(e,t,n){var r=_t(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Qe(e,t,(function(){return e.shaderSource(r,n)})),Qe(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=ct.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],o=e.split("\n"),i=o.length.toString().length+2,a=o.map((function(e,t){return N((t+1).toString(),i)+e})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var c=a.slice(0,r-1),l=a.slice(r-1,r),f=a.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+N(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var st,ut,ct=/ERROR: [0-9]+:([0-9]+):/g;function lt(e,t){return _t(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function ft(e,t,n){if(Qe(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function dt(e,t,n){if(Qe(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function pt(e,t,n){var r=_t(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Qe(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),Qe(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function ht(e,t,n){var r=_t(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Qe(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),Qe(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function vt(e,t){return _t(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function mt(e,t){var n=f().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function gt(e,t){return _t(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function yt(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return-1!==u&&(Qe(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,o)})),Qe(e,t,(function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)})),Qe(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function bt(e,t,n,r){Rt(e,r),Qe(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}function xt(e,t,n,r){return _t(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function wt(e,t,n){return e.getUniformLocation(t,n)}function Ct(e,t,n,r,o,i){Qe(e,t,(function(){return bt(e,t,r,i)})),Qe(e,t,(function(){return e.uniform1i(o,i)}))}function St(e,t,n,r){Qe(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),Qe(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function Et(e,t,n){Qe(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),Qe(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function kt(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+It(e,t))}function It(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function _t(e,t,n,r){var o=Qe(e,t,(function(){return n()}));if(null==o)throw new Error(r);return o}function Rt(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Tt(e,t){return void 0===t&&(t=2),T(e.slice(0,e.length-t))}function At(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Dt(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Tt(e)].concat(At(e))),t}function Ot(e,t){var n;void 0===t&&(t=!1);var r=f().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?S(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var o=W(e);e=o.newShape}var i=T(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=Tt(e),s=2,u=2;return e.length&&(s=(n=At(e))[0],u=n[1]),F(i=a*(s/2)*(u/2)).map((function(e){return 2*e}))}return F(i)}function Ft(e){return e%2==0}function Nt(e,t){if(A(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(Ft(n)&&Ft(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Ft(e[0])&&Ft(t[0])}function Pt(e){if(null==st){var t=Ke(e);st=t.getParameter(t.MAX_TEXTURE_SIZE)}return st}function Mt(e){if(null==ut){var t=Ke(e);ut=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ut)}function Bt(e){if(0===e)return 0;var t=Ke(e);return Wt(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Wt(t,"EXT_disjoint_timer_query")?1:0}function Wt(e,t){return null!=e.getExtension(t)}function Lt(e){try{if(null!=Ke(e))return!0}catch(e){return!1}return!1}function Vt(e){if(0===e)return!1;var t=Ke(e);if(1===e){if(!Wt(t,"OES_texture_float"))return!1}else if(!Wt(t,"EXT_color_buffer_float"))return!1;return Ut(t)}function zt(e){if(0===e)return!1;var t=Ke(e);if(1!==e){if(Wt(t,"EXT_color_buffer_float"))return Ut(t);if(Wt(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=Ze(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),i}(t,n)}return!1}return!!Wt(t,"OES_texture_float")&&!!Wt(t,"WEBGL_color_buffer_float")&&Ut(t)}function Ut(e){var t=Ze(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function Ht(e){return 2===e&&null!=Ke(e).fenceSync}var jt=Object.freeze({callAndCheck:Qe,canBeRepresented:nt,getWebGLErrorMessage:rt,getExtensionOrThrow:ot,createVertexShader:it,createFragmentShader:at,createProgram:lt,linkProgram:ft,validateProgram:dt,createStaticVertexBuffer:pt,createStaticIndexBuffer:ht,getNumChannels:function(){return 2===f().getNumber("WEBGL_VERSION")?1:4},createTexture:vt,validateTextureSize:mt,createFramebuffer:gt,bindVertexBufferToProgramAttribute:yt,bindTextureUnit:bt,unbindTextureUnit:function(e,t,n){Rt(e,n),Qe(e,t,(function(){return e.activeTexture(e.TEXTURE0+n)})),Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:xt,getProgramUniformLocation:wt,bindTextureToProgramUniformSampler:Ct,bindCanvasToFramebuffer:function(e,t){Qe(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Qe(e,t,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),Qe(e,t,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:St,unbindColorTextureFromFramebuffer:Et,validateFramebuffer:kt,getFramebufferErrorMessage:It,getBatchDim:Tt,getRowsCols:At,getShapeAs3D:Dt,getTextureShapeFromLogicalShape:Ot,isReshapeFree:Nt,getWebGLMaxTextureSize:Pt,resetMaxTextureSize:function(){st=null},resetMaxTexturesInShader:function(){ut=null},getMaxTexturesInShader:Mt,getWebGLDisjointQueryTimerVersion:Bt,hasExtension:Wt,isWebGLVersionEnabled:Lt,isCapableOfRenderingToFloatTexture:Vt,isDownloadFloatTextureEnabled:zt,isWebGLFenceEnabled:Ht}),Gt=f();function qt(e){f().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function $t(e,t){return Le.tidy(e,t)}function Kt(e){Pe(e).forEach((function(e){return e.dispose()}))}function Xt(e){return Le.keep(e)}function Yt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];f().getBool("IS_TEST")||console.warn.apply(console,e)}function Jt(e,t){var n=e;if(j(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||j(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&f().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||j(t)){k(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),k(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var o=n.slice(1),i=0;i<t.length;++i)e(t[i],o,r.concat(i))}else k(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(e,r,[]),r}function Zt(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function Qt(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof Se)return Zt(r,e.dtype,t,n),e;var o=Y(e);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),Zt(r,o,t,n),null==e||!j(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Jt(e,o);j(e)||Array.isArray(e)||(e=[e]);var s="string"!==o?ee(e,o,f().getBool("DEBUG")):R(e,[],!0);return Le.makeTensor(s,a,o)}function en(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return Qt(e,t+"["+r+"]",n)}),r)}function tn(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function nn(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?o.push(e[i++]):o.push(t[a++]);return o}function rn(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((function(t){return e[t]}))]}function on(e,t){return nn(e,t.map((function(e){return 1})),t)}function an(e,t,n){k(tn(t,n),(function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."}))}function sn(e,t){if(tn(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function un(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function cn(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function ln(e,t){var n=e[0].length;e.forEach((function(e,t){k(e.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"}))})),k(t>=0&&t<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=e[0];e.forEach((function(e,o){for(var i=0;i<n;i++)k(i===t||e[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+o+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."}))}))}function fn(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function dn(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Le.startScope(n);try{var o=r.apply(void 0,e);return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Le.endScope(o),o}catch(e){throw Le.endScope(null),e}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}Gt.registerFlag("HAS_WEBGL",(function(){return Gt.getNumber("WEBGL_VERSION")>0})),Gt.registerFlag("WEBGL_VERSION",(function(){return Lt(2)?2:Lt(1)?1:0})),Gt.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Gt.get("WEBGL_VERSION")})),Gt.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Gt.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Gt.registerFlag("WEBGL_PACK",(function(){return Gt.getBool("HAS_WEBGL")})),Gt.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_PACK_CLIP",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Gt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_PACK_REDUCE",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_CONV_IM2COL",(function(){return Gt.getBool("WEBGL_PACK")})),Gt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Pt(Gt.getNumber("WEBGL_VERSION"))})),Gt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Mt(Gt.getNumber("WEBGL_VERSION"))})),Gt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Gt.getNumber("WEBGL_VERSION");return 0===e?0:Bt(e)})),Gt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Gt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e})),Gt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return Vt(Gt.getNumber("WEBGL_VERSION"))})),Gt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Gt.getBool("WEBGL_FORCE_F16_TEXTURES")&&Gt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Gt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return zt(Gt.getNumber("WEBGL_VERSION"))})),Gt.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Ht(Gt.getNumber("WEBGL_VERSION"))})),Gt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Gt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Ce=qt;var pn=dn({complex_:function(e,t){var n=Qt(e,"real","complex"),r=Qt(t,"imag","complex");return I(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Le.runKernelFunc((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),hn=dn({real_:function(e){var t=Qt(e,"input","real");return Le.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),vn=dn({imag_:function(e){var t=Qt(e,"input","imag");return Le.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function mn(e,t,n){return gn(e,t,Jt(e,n),n)}function gn(e,t,n,r){if(null==r&&(r=Y(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!j(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){ie(t);var o=T(t),i=T(n);k(o===i,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i}));for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==T(t.slice(a));k(n[a]===t[a]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "}))}}return j(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?ee(e,r,f().getBool("DEBUG")):R(e,[],!0),Le.makeTensor(e,t,r)}function yn(e,t){if((j(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&j(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return gn(e,[],[],t)}function bn(e,t){_(e);var n=Jt(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return gn(e,null,n,t)}function xn(e,t,n){if(_(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Jt(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return gn(e,t,r,n)}function wn(e,t,n){if(_(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Jt(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return gn(e,t,r,n)}function Cn(e,t,n){if(_(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Jt(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return gn(e,t,r,n)}function Sn(e,t,n){if(_(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Jt(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return gn(e,t,r,n)}function En(e,t,n){if(_(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Jt(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return gn(e,t=t||r,r,n)}function kn(e,t,n,r){return void 0===t&&(t=!0),Le.makeVariable(e,t,n,r)}function In(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=In(e,"float32"),r=_n(e,"float32");return pn(n,r)}var o=ne(T(e),t);return Le.makeTensor(o,e,t)}function _n(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=_n(e,"float32"),r=_n(e,"float32");return pn(n,r)}var o=re(T(e),t);return Le.makeTensor(o,e,t)}function Rn(e,t,n){return Le.runKernelFunc((function(r){return r.fill(e,t,n)}),{})}function Tn(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return Le.runKernelFunc((function(r){return r.linspace(e,t,n)}),{})}function An(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return _n([0],r);var o=re(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return bn(o,r)}var Dn=dn({onesLike_:function(e){var t=Qt(e,"x","onesLike");if("complex64"===t.dtype){var n=Dn(hn(t)),r=On(vn(t));return pn(n,r)}return Le.runKernelFunc((function(e){return e.onesLike(t)}),{$x:t},(function(e,t){return{$x:function(){return On(e)}}}))}}),On=dn({zerosLike_:function(e){var t=Qt(e,"x","zerosLike");return Le.runKernelFunc((function(e){return e.zerosLike(t)}),{$x:t},(function(e,t){return{$x:function(){return On(e)}}}))}}),Fn=dn({concat_:function(e,t){void 0===t&&(t=0),k(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=en(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")})),t=B(t,n[0].shape)[0];var r=fn(n.map((function(e){return e.shape})),t);if(0===T(r))return mn([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var o=n.map((function(e){return e.shape}));ln(o,t);var i=n,a={axis:t};return Le.runKernelFunc((function(e){return e.concat(n,t)}),i,(function(e){var n=o.map((function(e){return e[t]}));return Wn(e,n,t).map((function(e){return function(){return e}}))}),"Concat",a)}}),Nn=dn({concat1d_:function(e){return Fn(e,0)}}),Pn=dn({concat2d_:function(e,t){return Fn(e,t)}}),Mn=dn({concat3d_:function(e,t){return Fn(e,t)}}),Bn=dn({concat4d_:function(e,t){return Fn(e,t)}}),Wn=dn({split_:function(e,t,n){void 0===n&&(n=0);var r,o=Qt(e,"x","split");return n=B(n,o.shape)[0],"number"==typeof t?(k(o.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(o.shape[n]/t)):(k(o.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t),Le.runKernelFunc((function(e){return e.split(o,r,n)}),{$x:o},(function(e){return{$x:function(){return Fn(e,n)}}}))}});function Ln(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var Vn=Ln((function(e){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.alea=i}(0,e,!1)})),zn=Ln((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xor128=i}(0,e,!1)})),Un=Ln((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xorwow=i}(0,e,!1)})),Hn=Ln((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&(i.x&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xorshift7=i}(0,e,!1)})),jn=Ln((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),o=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=a+1640531527|0,o=0==(n=s[127&i]^=r+a)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=a,e.X=s,e.i=o}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&(i.X&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xor4096=i}(0,e,!1)})),Gn=Ln((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.tychei=i}(0,e,!1)})),qn=Ln((function(e){!function(t,r){var o,i=this,a=256,s=6,u="random",c=r.pow(a,s),l=r.pow(2,52),f=2*l,d=a-1;function p(e,n,d){var p=[],y=m(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,g(t)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(a):(e=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(e)),g(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,g(t)]}}():e,3),p),b=new h(p),x=function(){for(var e=b.g(s),t=c,n=0;e<l;)e=(e+n)*a,t*=a,n=b.g(1);for(;e>=f;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,m(g(b.S),t),(n.pass||d||function(e,t,n,o){return o&&(o.S&&v(o,b),e.state=function(){return v(b,{})}),n?(r[u]=e,t):e})(x,y,"global"in n?n.global:this==r,n.state)}function h(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);o<a;)s[o]=o++;for(o=0;o<a;o++)s[o]=s[i=d&i+e[o%n]+(t=s[o])],s[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,s=r.S;e--;)t=s[o=d&o+1],n=n*a+s[d&(s[o]=s[i=d&i+t])+(s[i]=t)];return r.i=o,r.j=i,n})(a)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",o=0;o<r.length;)t[d&o]=d&(n^=19*t[d&o])+r.charCodeAt(o++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(r["seed"+u]=p,m(r.random(),t),e.exports){e.exports=p;try{o=n(4902)}catch(e){}}}([],Math)}));qn.alea=Vn,qn.xor128=zn,qn.xorwow=Un,qn.xorshift7=Hn,qn.xor4096=jn,qn.tychei=Gn;var $n=qn.alea,Kn=function(){function e(e,t,n,r,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=o||Math.random();this.random=$n(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var o=void 0,i=void 0,a=void 0;do{a=(o=2*this.random()-1)*o+(i=2*this.random()-1)*i}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),Xn=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var o=r||Math.random();this.randu=$n(o.toString()),this.randn=new Kn(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,o,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(o=this.randu())<t||Math.log(o)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),Yn=function(){function e(e,t,n,r){var o=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==o.dtype||"float32"===o.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=$n(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Jn(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",ie(e),new be(e,t,n)}function Zn(e,t){void 0===t&&(t=!1),console.log(e.toString(t))}var Qn=dn({batchToSpaceND_:function(e,t,n){var r=Qt(e,"x","batchToSpaceND"),o=t.reduce((function(e,t){return e*t}));return k(r.rank>=1+t.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length})),k(n.length===t.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length})),k(r.shape[0]%o==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o})),Le.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),er=dn({broadcastTo_:function(e,t){var n=Qt(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(1!==n.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));return 0===s.length?n.clone():Le.runKernelFunc((function(e){return e.tile(n,i)}),{input:n},(function(e){return{input:function(){return e.sum(s,!0)}}}))}}),tr=dn({cast_:function(e,t){var n=Qt(e,"x","cast");if(!U(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return Le.runKernelFunc((function(e){return e.cast(n,t)}),{x:n},(function(e){return{x:function(){return e.clone()}}}),"Cast",r)}}),nr=dn({clone_:function(e){var t=Qt(e,"x","clone",null);return Le.runKernelFunc((function(){return Le.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),rr=dn({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=Qt(e,"x","cumsum"),i=sn([t|=0],o.rank),a=o;null!=i&&(a=o.transpose(i));var s=cn(1,o.rank)[0],u=Le.runKernelFunc((function(e){return e.cumsum(a,s,n,r)}),{permutedX:a},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),or=dn({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=Qt(e,"x","depthToSpace"),o="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return k(o*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+t+"  for depthToSpace with input shape\n      "+r.shape})),k(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape})),k(a%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape})),Le.runKernelFunc((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),ir=dn({expandDims_:function(e,t){void 0===t&&(t=0);var n=Qt(e,"x","expandDims",null);k(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(k(-(n.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),t=n.rank+t+1),r.splice(t,0,1),yr(n,r)}}),ar=dn({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var o=Jn([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return Cr(ir(s,0),[n[0],1,1]);if(2===n.length)return Cr(ir(ir(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Cr(ir(ir(ir(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),sr=dn({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var o=Qt(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?o.as2D(1,-1):o,u=Le.runKernelFunc((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===a?u.as1D():u}}),ur=dn({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=Qt(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),Le.runKernelFunc((function(e){return e.oneHot(o,t,n,r)}),{$indices:o},(function(e){return{$indices:function(){return _n(o.shape,"float32")}}})).reshape(i)}}),cr=dn({pad_:function(e,t,n){void 0===n&&(n=0);var r=Qt(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return Le.runKernelFunc((function(e){return e.pad(r,t,n)}),{x:r},(function(e){var n=t.map((function(e){return e[0]}));return{x:function(){return e.slice(n,r.shape)}}}),"PadV2",o)}}),lr=dn({pad1d_:function(e,t,n){return void 0===n&&(n=0),k(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),cr(e,[t],n)}}),fr=dn({pad2d_:function(e,t,n){return void 0===n&&(n=0),k(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),cr(e,t,n)}}),dr=dn({pad3d_:function(e,t,n){return void 0===n&&(n=0),k(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),cr(e,t,n)}}),pr=dn({pad4d_:function(e,t,n){return void 0===n&&(n=0),k(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),cr(e,t,n)}}),hr=dn({rand_:function(e,t,n){var r=T(e),o=null;if(null==n||"float32"===n)o=new Float32Array(r);else if("int32"===n)o=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return Le.makeTensor(o,e,n)}}),vr=dn({randomNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Kn(t,n,r,!1,o),a=Jn(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),mr=dn({randomGamma_:function(e,t,n,r,o){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new Xn(t,n,r,o),a=Jn(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),gr=dn({randomUniform_:function(e,t,n,r,o){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=Jn(e,r),a=new Yn(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),yr=dn({reshape_:function(e,t){var n=Qt(e,"x","reshape",null);t=M(t,n.size),k(n.size===T(t),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:t};return Le.runKernelFunc((function(e){return e.reshape(n,t)}),{x:n},(function(e){return{x:function(){return e.reshape(n.shape)}}}),"Reshape",r)}}),br=dn({spaceToBatchND_:function(e,t,n){var r=Qt(e,"x","spaceToBatchND");return k(r.rank>=1+t.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length})),k(n.length===t.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length})),k(r.shape.reduce((function(e,r,o){return o>0&&o<=t.length?e&&(r+n[o-1][0]+n[o-1][1])%t[o-1]==0:e}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()})),Le.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),xr=dn({squeeze_:function(e,t){var n=Qt(e,"x","squeeze");return yr(n,W(n.shape,t).newShape)}}),wr=dn({stack_:function(e,t){void 0===t&&(t=0);var n=en(e,"tensors","stack");if(k(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;k(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){I(o,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){k(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var a=n.map((function(e){return e.expandDims(t)}));return Fn(a,t)}}),Cr=dn({tile_:function(e,t){var n=Qt(e,"x","tile",null);k(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."}));var r=[n],o={reps:t};return Le.runKernelFunc((function(e,r){var o=e.tile(n,t);return r([n]),o}),{x:n},(function(e,n){var r=n[0];return{x:function(){var n=On(r);if(1===r.rank)for(var o=0;o<t[0];++o)n=n.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(o=0;o<t[0];++o)for(var i=0;i<t[1];++i)n=n.add(e.slice([o*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(var a=0;a<t[2];++a)n=n.add(e.slice([o*r.shape[0],i*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(a=0;a<t[2];++a)for(var s=0;s<t[3];++s)n=n.add(e.slice([o*r.shape[0],i*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}),"Tile",o,r)}}),Sr=dn({truncatedNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Kn(t,n,r,!0,o),a=Jn(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Er=dn({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=Qt(e,"x","unstack");k(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),t<0&&(t+=n.shape.length);var r={axis:t};return Le.runKernelFunc((function(e){return e.unstack(n,t)}),{x:n},(function(e){return{x:function(){return wr(e,t)}}}),"Unpack",r)}}),kr=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,a,s,c,l,f,d;return u(this,(function(u){switch(u.label){case 0:return n=Qt(e,"x","setdiff1d"),r=Qt(t,"y","setdiff1d"),k(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),k(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),k(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return o=u.sent(),[4,r.data()];case 2:for(i=u.sent(),a=new Set(i),s=0,f=0;f<o.length;f++)a.has(o[f])||s++;for(c=new be([s],n.dtype),l=new be([s],"int32"),f=0,d=0;f<o.length;f++)a.has(o[f])||(c.values[d]=o[f],l.values[d]=f,d++);return[2,[c.toTensor(),l.toTensor()]]}}))}))};function Ir(e,t,n,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function _r(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Rr(e,t,n,r){void 0===r&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function Tr(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Ar(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function Dr(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var c=Q(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,o,u,c]}Object.freeze({prepareAndValidate:Dr});var Or=30;function Fr(e){return e<=Or?e:Z(e,Math.floor(Math.sqrt(e)))}function Nr(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function Pr(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}Nr(n,t,e)}function Mr(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:T(t.shape)/u,sliceSize:a,strides:Q(n.slice(0,o)).concat([1]),outputSize:T(n)}}Object.freeze({validateUpdateShape:Nr,validateInput:Pr,calculateShapes:Mr});function Br(e,t,n){k(e.rank===t.length,(function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."})),k(e.rank===n.length,(function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."}));for(var r=function(r){k(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"}))},o=0;o<e.rank;++o)r(o)}function Wr(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Lr(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function Vr(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),C(0,i,s-1)}function zr(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),a>0?C(0,i,s):C(-1,i,s-1)}function Ur(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function Hr(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:Br,maskToAxes:Wr,computeOutShape:Lr,startForAxis:Vr,stopForAxis:zr,isSliceContinous:Ur,computeFlatOffset:Hr});function jr(e,t){k(J(e),(function(){return"The f passed in variableGrads(f) must be a function"})),k(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof Te})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],Le.registeredVariables)t.push(Le.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,i=t.length;k((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var a=Le.gradients(e,t,null,!0),s=a.value,u=a.grads;k(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),k(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=o&&o.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}function Gr(e){return Le.customGrad(e)}var qr=dn({softmax_:function(e,t){void 0===t&&(t=-1);var n=Qt(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return Le.runKernelFunc((function(e,r){var o=e.softmax(n,t);return r([o]),o}),{logits:n},(function(e,n){var r=n[0],o=e.mul(r);return{logits:function(){return o.sub(o.sum([t],!0).mul(r))}}}),"Softmax",{dim:t},[],[!0])}}),$r=dn({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=Qt(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Gr((function(e,n){var r=e.max(t,!0),o=e.sub(r),i=o.toFloat().sub(o.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),Kr=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),Xr=function(){function e(){}return e.prototype.time=function(e){return Yr("time")},e.prototype.read=function(e){return Yr("read")},e.prototype.readSync=function(e){return Yr("readSync")},e.prototype.numDataIds=function(){return Yr("numDataIds")},e.prototype.disposeData=function(e){return Yr("disposeData")},e.prototype.write=function(e,t,n){return Yr("write")},e.prototype.move=function(e,t,n,r){return Yr("move")},e.prototype.memory=function(){return Yr("memory")},e.prototype.floatPrecision=function(){return Yr("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return Yr("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Yr("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return Yr("slice")},e.prototype.stridedSlice=function(e,t,n,r){return Yr("stridedSlice")},e.prototype.unstack=function(e,t){return Yr("unstack")},e.prototype.reverse=function(e,t){return Yr("reverse")},e.prototype.concat=function(e,t){return Yr("concat")},e.prototype.neg=function(e){return Yr("neg")},e.prototype.add=function(e,t){return Yr("add")},e.prototype.addN=function(e){return Yr("addN")},e.prototype.subtract=function(e,t){return Yr("subtract")},e.prototype.multiply=function(e,t){return Yr("multiply")},e.prototype.realDivide=function(e,t){return Yr("realDivide")},e.prototype.floorDiv=function(e,t){return Yr("floorDiv")},e.prototype.sum=function(e,t){return Yr("sum")},e.prototype.prod=function(e,t){return Yr("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return Yr("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return Yr("argMin")},e.prototype.argMax=function(e,t){return Yr("argMax")},e.prototype.equal=function(e,t){return Yr("equal")},e.prototype.notEqual=function(e,t){return Yr("notEqual")},e.prototype.less=function(e,t){return Yr("less")},e.prototype.lessEqual=function(e,t){return Yr("lessEqual")},e.prototype.greater=function(e,t){return Yr("greater")},e.prototype.greaterEqual=function(e,t){return Yr("greaterEqual")},e.prototype.logicalNot=function(e){return Yr("logicalNot")},e.prototype.logicalAnd=function(e,t){return Yr("logicalAnd")},e.prototype.logicalOr=function(e,t){return Yr("logicalOr")},e.prototype.where=function(e){return Yr("where")},e.prototype.select=function(e,t,n){return Yr("select")},e.prototype.topk=function(e,t,n){return Yr("topk")},e.prototype.min=function(e,t){return Yr("min")},e.prototype.minimum=function(e,t){return Yr("minimum")},e.prototype.mod=function(e,t){return Yr("mod")},e.prototype.max=function(e,t){return Yr("max")},e.prototype.maximum=function(e,t){return Yr("maximum")},e.prototype.all=function(e,t){return Yr("all")},e.prototype.any=function(e,t){return Yr("any")},e.prototype.squaredDifference=function(e,t){return Yr("squaredDifference")},e.prototype.ceil=function(e){return Yr("ceil")},e.prototype.floor=function(e){return Yr("floor")},e.prototype.round=function(e){return Yr("round")},e.prototype.sign=function(e){return Yr("sign")},e.prototype.isNaN=function(e){return Yr("isNaN")},e.prototype.isInf=function(e){return Yr("isInf")},e.prototype.isFinite=function(e){return Yr("isFinite")},e.prototype.pow=function(e,t){return Yr("pow")},e.prototype.exp=function(e){return Yr("exp")},e.prototype.expm1=function(e){return Yr("expm1")},e.prototype.softmax=function(e,t){return Yr("softmax")},e.prototype.log=function(e){return Yr("log")},e.prototype.log1p=function(e){return Yr("log1p")},e.prototype.sqrt=function(e){return Yr("sqrt")},e.prototype.rsqrt=function(e){return Yr("rsqrt")},e.prototype.square=function(e){return Yr("square")},e.prototype.reciprocal=function(e){return Yr("reciprocal")},e.prototype.relu=function(e){return Yr("relu")},e.prototype.relu6=function(e){return Yr("relu6")},e.prototype.prelu=function(e,t){return Yr("prelu")},e.prototype.elu=function(e){return Yr("elu")},e.prototype.eluDer=function(e,t){return Yr("eluDer")},e.prototype.selu=function(e){return Yr("selu")},e.prototype.int=function(e){return Yr("int")},e.prototype.clip=function(e,t,n){return Yr("clip")},e.prototype.abs=function(e){return Yr("abs")},e.prototype.complexAbs=function(e){return Yr("complexAbs")},e.prototype.sigmoid=function(e){return Yr("sigmoid")},e.prototype.softplus=function(e){return Yr("softplus")},e.prototype.sin=function(e){return Yr("sin")},e.prototype.cos=function(e){return Yr("cos")},e.prototype.tan=function(e){return Yr("tan")},e.prototype.asin=function(e){return Yr("asin")},e.prototype.acos=function(e){return Yr("acos")},e.prototype.atan=function(e){return Yr("atan")},e.prototype.atan2=function(e,t){return Yr("atan2")},e.prototype.sinh=function(e){return Yr("sinh")},e.prototype.cosh=function(e){return Yr("cosh")},e.prototype.tanh=function(e){return Yr("tanh")},e.prototype.asinh=function(e){return Yr("asinh")},e.prototype.acosh=function(e){return Yr("acosh")},e.prototype.atanh=function(e){return Yr("atanh")},e.prototype.erf=function(e){return Yr("erf")},e.prototype.step=function(e,t){return Yr("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Yr("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return Yr("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return Yr("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return Yr("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Yr("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return Yr("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return Yr("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return Yr("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return Yr("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return Yr("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return Yr("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return Yr("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return Yr("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return Yr("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return Yr("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return Yr("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return Yr("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return Yr("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return Yr("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return Yr("reshape")},e.prototype.cast=function(e,t){return Yr("cast")},e.prototype.tile=function(e,t){return Yr("tile")},e.prototype.pad=function(e,t,n){return Yr("pad")},e.prototype.transpose=function(e,t){return Yr("transpose")},e.prototype.gather=function(e,t,n){return Yr("gather")},e.prototype.gatherND=function(e,t){return Yr("gatherND")},e.prototype.scatterND=function(e,t,n){return Yr("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return Yr("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return Yr("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return Yr("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return Yr("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return Yr("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return Yr("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,o,i){return Yr("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){return Yr("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,o,i,a){return Yr("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return Yr("multinomial")},e.prototype.oneHot=function(e,t,n,r){return Yr("oneHot")},e.prototype.cumsum=function(e,t,n,r){return Yr("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,o){return Yr("nonMaxSuppression")},e.prototype.fft=function(e){return Yr("fft")},e.prototype.ifft=function(e){return Yr("ifft")},e.prototype.complex=function(e,t){return Yr("complex")},e.prototype.real=function(e){return Yr("real")},e.prototype.imag=function(e){return Yr("imag")},e.prototype.cropAndResize=function(e,t,n,r,o,i){return Yr("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return Yr("depthToSpace")},e.prototype.split=function(e,t,n){return Yr("split")},e.prototype.sparseToDense=function(e,t,n,r){return Yr("sparseToDense")},e.prototype.diag=function(e){return Yr("diag")},e.prototype.fill=function(e,t,n){return Yr("fill")},e.prototype.onesLike=function(e){return Yr("onesLike")},e.prototype.zerosLike=function(e){return Yr("zerosLike")},e.prototype.linspace=function(e,t,n){return Yr("linspace")},e.prototype.dispose=function(){return Yr("dispose")},e}();function Yr(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Jr(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&1===a&&r.unshift(i)}return r}function Zr(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(null==o||1===o&&a>1)&&n.unshift(i)}return n}function Qr(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];null==i&&(i=1);var a=t[t.length-o-1];if(null==a&&(a=1),1===i)n.unshift(a);else if(1===a)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function eo(e,t,n,r,o,i,a){void 0===a&&(a="channelsLast");var s,u=io(t),c=u[0],l=u[1];if("channelsLast"===a)s=[c,l,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,l,e[1],e[1]]}return no(e,s,n,r,o,i,!1,a)}function to(e,t,n,r,o,i,a){void 0===a&&(a="NDHWC");var s,u,c=ao(t),l=c[0],f=c[1],d=c[2];if("NDHWC"===a)u="channelsLast",s=[l,f,d,e[4],e[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,f,d,e[1],e[1]]}return ro(e,s,n,r,o,!1,u,i)}function no(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],d=u[3];if("channelsLast"===s)c=e[0],l=e[1],f=e[2],d=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],d=e[1],l=e[2],f=e[3]}var p,h=t[0],v=t[1],m=t[3],g=io(n),y=g[0],b=g[1],x=io(r),w=x[0],C=x[1],S=so(h,w),E=so(v,C),I=function(e,t,n,r,o,i,a,s){var u,c,l;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,o){null==r&&(r=oo(e,t,n));var i=e[0],a=e[1],s=uo((i-t+2*r)/n+1,o);k(D(s),(function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"}));var u=uo((a-t+2*r)/n+1,o);return k(D(u),(function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"})),[s,u]}([t,n],i,r,e,s);c=f[0],l=f[1]}else if("same"===e){c=Math.ceil(t/r),l=Math.ceil(n/o);var d=Math.max(0,(c-1)*r+i-t),p=Math.max(0,(l-1)*o+a-n),h=Math.floor(d/2),v=d-h,m=Math.floor(p/2);u={top:h,bottom:v,left:m,right:p-m,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),l=Math.ceil((n-a+1)/o)}return{padInfo:u,outHeight:c,outWidth:l}}(o,l,f,y,b,S,E,i),_=I.padInfo,R=I.outHeight,T=I.outWidth,A=a?m*d:m;return"channelsFirst"===s?p=[c,A,R,T]:"channelsLast"===s&&(p=[c,R,T,A]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:f,inChannels:d,outHeight:R,outWidth:T,outChannels:A,padInfo:_,strideHeight:y,strideWidth:b,filterHeight:h,filterWidth:v,effectiveFilterHeight:S,effectiveFilterWidth:E,dilationHeight:w,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function ro(e,t,n,r,o,i,a,s){void 0===i&&(i=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],d=u[3],p=u[4];if("channelsLast"===a)c=e[0],l=e[1],f=e[2],d=e[3],p=e[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=e[0],p=e[1],l=e[2],f=e[3],d=e[4]}var h,v=t[0],m=t[1],g=t[2],y=t[4],b=ao(n),x=b[0],w=b[1],C=b[2],S=ao(r),E=S[0],I=S[1],_=S[2],R=so(v,E),T=so(m,I),A=so(g,_),O=function(e,t,n,r,o,i,a,s,u,c,l){var f,d,p,h;if("number"==typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,o,i){null==o&&(o=oo(e,t,r));var a=e[0],s=e[1],u=e[2],c=uo((a-t+2*o)/r+1,i);k(D(c),(function(){return"The output # of depths ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=uo((s-t+2*o)/r+1,i);k(D(l),(function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var f=uo((u-t+2*o)/r+1,i);return k(D(f),(function(){return"The output # of columns ("+f+") must be an integer. Change the stride and/or zero pad parameters"})),[c,l,f,n]}([t,n,r,1],s,1,o,e,l);d=v[0],p=v[1],h=v[2]}else if("same"===e){d=Math.ceil(t/o),p=Math.ceil(n/i),h=Math.ceil(r/a);var m=(d-1)*o+s-t,g=(p-1)*i+u-n,y=(h-1)*a+c-r,b=Math.floor(m/2),x=m-b,w=Math.floor(g/2),C=g-w,S=Math.floor(y/2);f={top:w,bottom:C,left:S,right:y-S,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((t-s+1)/o),p=Math.ceil((n-u+1)/i),h=Math.ceil((r-c+1)/a)}return{padInfo:f,outDepth:d,outHeight:p,outWidth:h}}(o,l,f,d,x,w,C,R,T,A,s),F=O.padInfo,N=O.outDepth,P=O.outHeight,M=O.outWidth,B=i?y*p:y;return"channelsFirst"===a?h=[c,B,N,P,M]:"channelsLast"===a&&(h=[c,N,P,M,B]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:f,inWidth:d,inChannels:p,outDepth:N,outHeight:P,outWidth:M,outChannels:B,padInfo:F,strideDepth:x,strideHeight:w,strideWidth:C,filterDepth:v,filterHeight:m,filterWidth:g,effectiveFilterDepth:R,effectiveFilterHeight:T,effectiveFilterWidth:A,dilationDepth:E,dilationHeight:I,dilationWidth:_,inShape:e,outShape:h,filterShape:t}}function oo(e,t,n,r){void 0===r&&(r=1);var o=so(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function io(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function ao(e){return"number"==typeof e?[e,e,e]:e}function so(e,t){return t<=1?e:e+(e-1)*(t-1)}function uo(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function co(e){var t=io(e),n=t[0],r=t[1],o=t[2];return 1===n&&1===r&&1===o}function lo(e,t){return co(e)||co(t)}function fo(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function po(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=_n(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!H(e.dtype,t))return Le.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=yn(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function ho(e,t){return Le.makeTensorFromDataId(e.dataId,t,e.dtype)}function vo(e,t,n){var r=(t-e)/(n-1),o=re(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return bn(o,"float32")}Object.freeze({castTensor:po,reshapeTensor:ho,linspaceImpl:vo,upcastType:De,axesAreInnerMostDims:tn,combineLocations:nn,computeOutAndReduceShapes:rn,expandShapeToKeepDim:on,assertAxesAreInnerMostDims:an,getAxesPermutation:sn,getUndoAxesPermutation:un,getInnerMostAxes:cn,getBroadcastDims:Jr,getReductionAxes:Zr,assertAndGetBroadcastShape:Qr,assertParamsConsistent:ln,computeOutShape:fn,computePool2DInfo:eo,computePool3DInfo:to,computeConv2DInfo:no,computeConv3DInfo:ro,computeDefaultPad:oo,tupleValuesAreOne:co,eitherStridesOrDilationsAreOne:lo,convertConv2DDataFormat:fo,PARALLELIZE_THRESHOLD:Or,computeOptimalWindowSize:Fr});function mo(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function go(e,t){return{real:e[2*t],imag:e[2*t+1]}}function yo(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function bo(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function xo(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,o=e.length,i=0,a=!1;r<o;){var s=n(t,e[i=r+(o-r>>>1)]);s>0?r=i+1:(o=i,a=!s)}return a?r:-r-1}(e,t,n||wo)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function wo(e,t){return e>t?1:e<t?-1:0}function Co(e,t,n,r,o){return Eo(e,t,n,r,o,0).selectedIndices}function So(e,t,n,r,o,i){var a=Eo(e,t,n,r,o,i,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function Eo(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(t).map((function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}})).filter((function(e){return e.score>o})).sort(_o),c=i>0?-.5/i:0,l=[],f=[];l.length<n&&u.length>0;){var d=u.pop(),p=d.score,h=d.boxIndex,v=d.suppressBeginIndex;if(p<o)break;for(var m=!1,g=l.length-1;g>=v;--g){var y=ko(e,h,l[g]);if(y>=r){m=!0;break}if(d.score=d.score*Io(r,c,y),d.score<=o)break}d.suppressBeginIndex=l.length,m||(d.score===p?(l.push(h),f.push(d.score)):d.score>o&&xo(u,d,_o))}var b=l.length;return s&&(l.fill(0,b),f.fill(0,b)),{selectedIndices:bn(l,"int32"),selectedScores:bn(f,"float32"),numValidOutputs:yn(b,"int32")}}function ko(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),p=(s-i)*(u-a),h=(f-c)*(d-l);if(p<=0||h<=0)return 0;var v=Math.max(i,c),m=Math.max(a,l),g=Math.min(s,f),y=Math.min(u,d),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(p+h-b)}function Io(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function _o(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Ro(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map((function(t){o[n]=t;var i=e.slice(r,o);return r[n]+=t,i}))}function To(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=Jn(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function Ao(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],c=L(n,s*r),l=L("int32",s*r),f=0;f<s;f++){for(var d=f*u,p=e.subarray(d,d+u),h=[],v=0;v<p.length;v++)h.push({value:p[v],index:v});h.sort((function(e,t){return t.value-e.value}));var m=f*r,g=c.subarray(m,m+r),y=l.subarray(m,m+r);for(v=0;v<r;v++)g[v]=h[v].value,y[v]=h[v].index}var b=t.slice();return b[b.length-1]=r,[mn(c,b,n),mn(l,b,"int32")]}function Do(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=Jn(e,"int32"),i=Jn([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var Oo=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Fo=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},No=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Po(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}function Mo(e,t){return 1===t?[e]:Po(e,t)}function Bo(){var e,t,n,r,o,i,a,s,u,c;return 2===f().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Wo(e,t,n){void 0===n&&(n="index");var r=Q(t);return r.map((function(t,o){return"int "+e[o]+" = "+n+" / "+t+"; "+(o===r.length-1?"int "+e[o+1]+" = "+n+" - "+e[o]+" * "+t:"index -= "+e[o]+" * "+t)+";"})).join("")}function Lo(e){var t=Q(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var Vo="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function zo(e,t,n,r){var o=[];e.forEach((function(e){var t=T(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?o.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(o.push("uniform sampler2D "+e.name+";"),o.push("uniform int offset"+e.name+";"))}));var i,a,s=o.join("\n"),u=e.map((function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?Ho(e):Uo(e);var o=e.shapeInfo.logicalShape,i=t.logicalShape;return o.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,o=r.charAt(0).toUpperCase()+r.slice(1),i="get"+o+"AtOutCoords",a=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=Jr(e.shapeInfo.logicalShape,t.logicalShape),c=Yo(s),l=s-a,f=["x","y","z","w","u","v"];n=0===a?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords."+f[e+l]+" = 0;"})).join("\n");var d="";d=s<2&&a>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+f[t+l]})).join(", ");var p="return outputValue;",h=1===T(e.shapeInfo.logicalShape),v=1===T(t.logicalShape);if(1!==a||h||v){if(h&&!v)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=a-2,g=a-1;u.indexOf(m)>-1&&u.indexOf(g)>-1?p="return vec4(outputValue.x);":u.indexOf(m)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+d+");\n      "+p+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",i=t.texShape,a=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&A(a,i))return"\n      float "+o+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=Yo(u),f=Jr(e.shapeInfo.logicalShape,t.logicalShape),d=u-s,p=["x","y","z","w","u","v"];c=0===s?"":u<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords."+p[e+d]+" = 0;"})).join("\n");var h="";return h=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+p[t+d]})).join(", "),"\n    float "+o+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+h+");\n    }\n  "}(e,t)),r}(e,t,r)})).join("\n"),c=t.texShape,l=Bo(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),d=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+jo+"\n    "+Go+"\n    "+qo+"\n  "}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(A(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Math.ceil(n[2]/2),a=i*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+o[0]+", "+o[1]+"));\n      int index = resTexRC.x * "+o[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),o=r*Math.ceil(e[e.length-2]/2),i=o,a="",s="b, r, c",u=2;u<e.length-1;u++)i*=e[e.length-u-1],a="\n      int b"+u+" = index / "+i+";\n      index -= b"+u+" * "+i+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,o,i,a}(t.logicalShape,c),a=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return A(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=Wo(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=Wo(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=Wo(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=Wo(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),a=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(d+=$o),[d,f,a,s,i,u,n].join("\n")}function Uo(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,o=r[0],i=r[1];if(1===o&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=e.shapeInfo.texShape,s=a[0],u=a[1],c=Ko(t);return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+s+", "+u+", "+c+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Xo(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,o=r[0],i=r[1];if(1===i&&1===o)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=Ko(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+o+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+o+", "+i+", index + "+a+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape;if(null!=o&&A(t,o)){var i=o[0],a=o[1];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var s=W(t),u=s.newShape,c=s.keptDims,l=u;if(l.length<t.length){var f=Jo(e,l);return"\n      "+Uo(f)+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+Zo(["row","col"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+Xo(e)+"\n      }\n    ";var d=o[0],p=o[1],h=Ko(n);return 1===p?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+d+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===d?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+p+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+h+";\n    vec2 uv = uvFromFlat("+d+", "+p+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[1]*t[2],i=t[2],a=W(t),s=a.newShape,u=a.keptDims,c=s;if(c.length<t.length){var l=Jo(e,c);return"\n        "+Uo(l)+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+Zo(["row","col","depth"],u)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+i+", 1)));\n        "+Xo(e)+"\n      }\n    ";var f=e.shapeInfo.texShape,d=f[0],p=f[1],h=e.shapeInfo.flatOffset;if(p===o&&null==h)return"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+p+".0, "+d+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ";if(p===i&&null==h)return"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+p+".0, "+d+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ";var v=Ko(n);return"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+i+" + depth + "+v+";\n        vec2 uv = uvFromFlat("+d+", "+p+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[3],i=t[2]*o,a=t[1]*i,s=W(t),u=s.newShape,c=s.keptDims;if(u.length<t.length){var l=Jo(e,u);return"\n      "+Uo(l)+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+Zo(["row","col","depth","depth2"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+i+", "+o+", 1)));\n        "+Xo(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1];if(h===a&&null==f)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+h+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(h===o&&null==f)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+h+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var v=Ko(n);return"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+i+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+h+", index + "+v+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[4],i=t[3]*o,a=t[2]*i,s=t[1]*a,u=W(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var f=Jo(e,c);return"\n      "+Uo(f)+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+Zo(["row","col","depth","depth2","depth3"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+a+", "+i+", "+o+")) +\n          depth3;\n        "+Xo(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],v=p[1];if(v===s&&null==d)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+i+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(v===o&&null==d)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var m=Ko(n);return"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" + depth * "+i+" +\n          depth2 * "+o+" + depth3 + "+m+";\n      vec2 uv = uvFromFlat("+h+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=W(t),i=o.newShape,a=o.keptDims;if(i.length<t.length){var s=Jo(e,i);return"\n      "+Uo(s)+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+Zo(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    "}var u=t[5],c=t[4]*u,l=t[3]*c,f=t[2]*l,d=t[1]*f;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+d+", "+f+", "+l+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+u+", 1)));\n        "+Xo(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,v=h[0],m=h[1];if(m===d&&null==p)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+f+", "+l+", "+c+", "+u+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+v+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(m===u&&null==p)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+v+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var g=Ko(n);return"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+d+" + col * "+f+" + depth * "+l+" +\n          depth2 * "+c+" + depth3 * "+u+" + depth4 + "+g+";\n      vec2 uv = uvFromFlat("+v+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Ho(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Bo(),"\n    vec4 "+n+"() {\n      return "+r.texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Bo();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+o[0]+", "+o[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=o[0],a=o[1],s=Bo();if(null!=o&&A(t,o))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(t[1]/2);return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+c+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===t[0]){var a=t.slice(1),s=Jo(e,a);return"\n        "+Ho(s)+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+Zo(["b","row","col"],[1,2])+");\n        }\n      "}var u=i[0],c=i[1],l=Math.ceil(t[2]/2),f=l*Math.ceil(t[1]/2),d=Bo();return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+f+", "+l+", b, row, col);\n      return "+d.texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=a[0],u=a[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),f="int b, int row, int col",d="b * "+l+" + (row / 2) * "+c+" + (col / 2)",p=2;p<n-1;p++)f="int b"+p+", "+f,l*=t[n-p-1],d="b"+p+" * "+l+" + "+d;var h=Bo();return"\n    vec4 "+o+"("+f+") {\n      int index = "+d+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+h.texture2D+"("+r+", uv);\n    }\n  "}(e)}}var jo="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Go="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",qo="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",$o="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Ko(e){return"offset"+e}function Xo(e){var t=e.name,n=T(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function Yo(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Jo(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Zo(e,t){return t.map((function(t){return e[t]})).join(", ")}var Qo=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,k(e.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=Yo(c),f=Mo("coords",c);if(1===i){var d=Yo(s=c+1);a="\n        "+d+" sourceLocR = "+d+"("+f.join()+", 0);\n        ++"+f[c-1]+";\n        "+d+" sourceLocG = "+d+"("+f.join()+", 0);\n        ++"+f[c-2]+";\n        "+d+" sourceLocA = "+d+"("+f.join()+", 0);\n        --"+f[c-1]+";\n        "+d+" sourceLocB = "+d+"("+f.join()+", 0);\n        --"+f[c-2]+";"}else s=c,a="\n        "+l+" sourceLocR = coords;\n        ++"+f[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+f[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+f[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+f[c-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),h="."+p[s-1],v=p.map((function(e){return"int "+e})),m=Mo("sourceLocR",s-1).concat("inIdx.r"),g=Mo("sourceLocG",s-1).concat("inIdx.g"),y=Mo("sourceLocB",s-1).concat("inIdx.b"),b=Mo("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",C="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",S=r?"":"\n      float getBestIndicesAChannel("+v.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+v.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+S+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+f[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+f[c-2]+" < "+(u[c-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+h+", sourceLocG"+h+",\n          sourceLocB"+h+", sourceLocA"+h+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+C+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+C+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},ei=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,f=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+a+") {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ti=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=l-1-e.padInfo.front,h=f-1-e.padInfo.top,v=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+p+", "+h+", "+v+");\n      const float avgMultiplier = float("+m+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+o+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+f+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+d+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ni=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Qr(e,t),Qr(e,n);var a="0.0";null!=r&&(Qr(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=o&&(Qr(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},ri=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Qr(e,t),Qr(e,n);var a="vec4(0.0)";null!=r&&(Qr(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(Qr(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},oi="return areal * breal - aimag * bimag;",ii="return areal * bimag + aimag * breal;",ai=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qr(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},si="return a + b;",ui="return a - b;",ci="return a * b;",li="return (a < 0.) ? b * a : a;",fi=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Qr(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},di="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",pi=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Qr(t,n);var o=this.outputShape.length,i="";if(r)if(0===o||1===T(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Yo(o)+" coords = getOutputCoords();\n        ",1===o)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Mo("coords",o);i+="\n            bool nextRowOutOfBounds =\n              ("+a[o-2]+" + 1) >= "+this.outputShape[o-2]+";\n            bool nextColOutOfBounds =\n              ("+a[o-1]+" + 1) >= "+this.outputShape[o-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},hi=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),vi=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),mi=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},gi=function(e){this.outputShape=[],this.outputShape=fn(e,1),this.variableNames=e.map((function(e,t){return"T"+t}));var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},yi=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=fn(e,t);var n=this.outputShape,r=n.length,o=Yo(r),i=Mo("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((function(e,t){return"T"+t}));var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var c=a[t],l=a.slice(-2),f=a.join(),d="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+f+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var p=s[u-1];d+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+bi(a,c,p)+"),\n            vec2("+bi(l,c,p)+"));\n        }"}var h=s.length,v=s[s.length-1];d+="\n        return getChannel(\n          getT"+h+"("+bi(a,c,v)+"),\n          vec2("+bi(l,c,v)+"));",this.userCode="\n      float getValue("+a.map((function(e){return"int "+e}))+") {\n        "+d+"\n      }\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function bi(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?e+" - "+n:e})).join()}var xi=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},wi=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i="channelsLast"===e.dataFormat,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ci=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+o+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+a+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Si=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+o+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ei=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ki=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ii=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),p=e.inChannels%4,h="channelsLast"===e.dataFormat,v=h?1:2,m=h?2:3,g=h?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+v+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+h+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===p)+") {\n\n              if ("+h+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+d+") *\n                    getW(wR, wC, "+d+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+d+", xR, xC) *\n                    getW(wR, wC, "+d+", d2);\n              }\n\n            } else if ("+(2===p)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n\n              if ("+h+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===p)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n\n              if ("+h+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1),\n                  getX(batch, xR, xC, "+d+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC),\n                  getX(batch, "+d+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},_i=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,f=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),h=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===h)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+p+") *\n                  getW(wF, wR, wC, "+p+", d2);\n              } else if ("+(2===h)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===h)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1),\n                  getX(batch, xF, xR, xC, "+p+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2),\n                  getW(wF, wR, wC, "+p+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ri=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=e.outChannels/e.inChannels,v="",m="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",m="result = activation(result);");var g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+h+";\n        int q = d2 - d1 * "+h+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+d+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+o+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+p+"; wC++) {\n            int xC = xCCorner + wC * "+f+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+m+"\n        setOutput(result);\n      }\n    "},Ti=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=p,v="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var g=0;g<p;g++)v+="\n          vec4 xTexelR"+m+"C"+2*g+" = vec4(0.);\n          vec4 wR"+m+"C"+g+" = vec4(0.);\n          vec4 xR"+m+"C"+g+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<h;y++){if(v+="\n          xR = xRCorner + "+m*l+";\n          xC = xCCorner + "+(g=2*y)*f+";\n        ",1===c){if(g<p&&(v+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+m+"C"+g+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+m+"C"+g+" = vec4(previous.zw, xTexelR"+m+"C"+g+".xy);\n                } else {\n                  xR"+m+"C"+g+" = vec4(0, 0, xTexelR"+m+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+o+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = xTexelR"+m+"C"+g+";\n              ",g+1<p)){var b=s%2==0?S(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(v+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",f>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+o+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+m+"C"+g+" = vec4(0.);\n                    }\n                  "),v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".xy);\n                "):v+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+m+"C"+(g+1)+" = xTexelR"+m+"C"+(g+2)+";\n                "}}else g<p&&(v+="\n              if(xR >= 0 && xR < "+o+") {\n            ",s%2==1?(v+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n              ",g+1<p&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+m+"C"+(g+1)+" = vec4(xTexelR"+m+"C"+(g+2)+".xy, final.xy);\n                ")):(v+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".xy, xTexelR"+m+"C"+(g+2)+".xy);\n              ",g+1<p&&(v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n                ")),v+="}");g<p&&(v+="\n            vec4 wTexelR"+m+"C"+g+" = getW("+m+", "+g+", d1, q);\n            wR"+m+"C"+g+" = vec4(wTexelR"+m+"C"+g+".xz, wTexelR"+m+"C"+g+".xz);\n          ",g+1<p&&(v+="\n              vec4 wTexelR"+m+"C"+(g+1)+" = getW("+m+", "+(g+1)+", d1, q);\n              wR"+m+"C"+(g+1)+" =\n                vec4(wTexelR"+m+"C"+(g+1)+".xz, wTexelR"+m+"C"+(g+1)+".xz);"))}for(m=0;m<d;m++)for(g=0;g<p;g++)v+="dotProd += xR"+m+"C"+g+" * wR"+m+"C"+g+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+v+"\n\n        vec4 result = dotProd;\n        "+C+"\n        "+w+"\n        setOutput(result);\n      }\n    "},Ai=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],c=t[0],l=n[0],f=n[1];this.outputShape=[c,l,f,u];var d="bilinear"===r?1:0,p=[a-1+".0",s-1+".0"],h=p[0],v=p[1],m=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],g=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],w=x[0],C=x[1],S=x[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+C+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+S+";\n        if( in_x < 0.0 || in_x > "+v+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+d+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Di=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Yo(r)+" coords = getOutputCoords();\n        int end = "+Oi(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+Oi(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Oi(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var Fi=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ue.DENSE;var t=Ye(e),n=Bo();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Wo(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},Ni=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ue.DENSE;var t=Ye(e),n=Bo();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Wo(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},Pi=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),Mi=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Bi=function(e){this.variableNames=["A"],this.outTexUsage=He.DOWNLOAD;var t=Bo();this.outputShape=e,this.userCode="\n      "+Vo+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},Wi=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=He.DOWNLOAD;var t=Bo();this.outputShape=e,this.userCode="\n      "+Vo+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},Li=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Bo(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+Lo(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},Vi=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Bo(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Lo(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},zi="return real * expR - imag * expI;",Ui="return real * expI + imag * expR;",Hi=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},ji=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),Gi=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Yo(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=0;i<e.length;i++)i===t?o.push("int(getIndices("+r[i]+"))"):o.push(""+r[i]);return o.join()}(e,n);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},qi=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Yo(t.length),o=Yo(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function $i(e,t){var n=Bo();return it(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Ki(e,t){return pt(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Xi(e,t){return ht(e,t,new Uint16Array([0,1,2,2,1,3]))}function Yi(e,t,n,r,o,i,a){mt(n,r);var s=vt(e,t),u=e.TEXTURE_2D;return Qe(e,t,(function(){return e.bindTexture(u,s)})),Qe(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),Qe(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),Qe(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),Qe(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),Qe(e,t,(function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)})),Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function Ji(e,t,n,r,o){var i=Xe(n,r);return Yi(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function Zi(e,t,n,r,o){var i=Xe(n,r);return Yi(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function Qi(e,t,n,r,o){var i=Xe(n,r);return Yi(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function ea(e,t,n,r,o){var i=Je(n,r);return Yi(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function ta(e,t,n,r,o){var i=Je(n,r);return Yi(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function na(e,t,n,r){return Qe(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),yt(e,t,n,"clipSpacePos",r,3,20,0)&&yt(e,t,n,"uv",r,2,20,12)}function ra(e,t,n,r,o,i,a){var s,u,c;Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,c=a.internalFormatPackedFloat),s.set(i),Qe(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,o,0,e.RGBA,u,s)})),Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function oa(e,t,n,r){Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Qe(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):Qe(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),Qe(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function ia(e,t,n,r,o){var i=e.createBuffer();Qe(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)}));var a=16*n*r;return Qe(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)})),Qe(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),Qe(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),i}function aa(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function sa(e,t,n,r,o){var i=Xe(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return Qe(e,t,(function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function ua(e,t,n,r,o,i,a,s){var u=e,c=new Float32Array(function(e,t){var n=Je(e,t);return n[0]*n[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function ca(e,t,n,r){var o=new Float32Array(n*r*4);return Qe(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)})),o}var la=Object.freeze({createVertexShader:$i,createVertexBuffer:Ki,createIndexBuffer:Xi,createFloat32MatrixTexture:Ji,createFloat16MatrixTexture:Zi,createUnsignedBytesMatrixTexture:Qi,createPackedMatrixTexture:ea,createFloat16PackedMatrixTexture:ta,bindVertexProgramAttributeStreams:na,uploadDenseMatrixToTexture:ra,uploadPixelDataToTexture:oa,createBufferFromOutputTexture:ia,downloadFloat32MatrixFromBuffer:aa,downloadByteEncodedFloatMatrixFromOutputTexture:sa,downloadPackedMatrixFromBuffer:ua,downloadMatrixFromPackedOutputTexture:ca}),fa=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=f().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,$e(t,e)):this.gl=Ke(t);var n="WEBGL_color_buffer_float";if(1===f().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=ot(this.gl,this.debug,"OES_texture_float"),Wt(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ot(this.gl,this.debug,"OES_texture_half_float");else if(f().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Wt(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ot(this.gl,this.debug,"EXT_color_buffer_half_float");else if(f().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Wt(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Wt(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Ki(this.gl,this.debug),this.indexBuffer=Xi(this.gl,this.debug),this.framebuffer=gt(this.gl,this.debug),this.textureConfig=Ze(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return f().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Qe(t,this.debug,(function(){return t.finish()})),Qe(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Qe(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),Qe(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Qe(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Qe(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Ji(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),Zi(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),Qi(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),oa(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),ra(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),ta(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),ea(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Et(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Qe(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return sa(r.gl,r.debug,t,n,r.textureConfig)}))},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,o,i){return ua(this.gl,e,0,0,0,o,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return aa(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=ia(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(f().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,i=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=o.clientWaitSync(i,0,0);return e===o.ALREADY_SIGNALED||e===o.CONDITION_SATISFIED},t=i}else f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return ca(r.gl,r.debug,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=at(t,this.debug,e),r=$i(t,this.debug),o=lt(t,this.debug);return Qe(t,this.debug,(function(){return t.attachShader(o,r)})),Qe(t,this.debug,(function(){return t.attachShader(o,n)})),ft(t,this.debug,o),this.debug&&dt(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=na(t,this.debug,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&Qe(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&dt(this.gl,this.debug,this.program),Qe(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?xt(this.gl,this.debug,e,t):wt(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),Qe(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Ct(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=Je(t,n),o=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,o,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&dt(this.gl,this.debug,this.program),kt(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Qe(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Qe(this.gl,this.debug,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=ot(this.gl,this.debug,2===f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(2!==f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(n){switch(n.label){case 0:return[4,P((function(){return t.disposed||t.isQueryAvailable(e,f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length;++t)if(!e[t]())break;return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||P((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),St(this.gl,this.debug,e,this.framebuffer),this.debug&&kt(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(St(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&kt(this.gl)):Et(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;St(r,this.debug,e,this.framebuffer),this.debug&&kt(r),this.outputTexture=e,Qe(r,this.debug,(function(){return r.viewport(0,0,t,n)})),Qe(r,this.debug,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var o=this;this.throwIfDisposed(),Qe(this.gl,this.debug,(function(){return o.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function da(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,o=t[n],i=o.shape;if(!A(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!o.isUniform){var a=e.texShape,s=o.isUniform?null:o.texData.texShape;if(!A(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var pa=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,f=n.dataFormat,d=s.left,p=s.top,h=o*r,v=Bo(),m="channelsLast"===f,g=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+p+";\n            d0 = offsetY + "+l+" * (pos / "+h+");\n\n            if(d0 < "+t[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+d+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+h+".) / "+o+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+o+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+v.output+" = result;\n      }\n    "},ha=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},va=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},ma=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},ga=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ya=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=c-1-e.padInfo.left,p=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+f+", "+d+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+o+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+a+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+p+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ba=function(e,t,n,r,o,i,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",h="";i&&(p=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",h="result = activation(result);");var v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+p+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+f[0]+" * "+d[0]+");\n          result += ("+f[1]+" * "+d[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+v+"\n\n        "+h+"\n\n        setOutput(result);\n      }\n    "},xa=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),wa=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Ca=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Mo("rc",t),r=Yo(t),o=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",o=e-2;o<e;o++)r+=n[o]+" >= "+t[o],o<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var o=r.slice(-2);return"\n    int r = "+o[0]+";\n    int c = "+o[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),a=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var o=0;o<=1;o++){for(var i=(0===r?"r":"rp1")+", "+(0===o?"c":"cp1"),a=2;a<e;a++)i=t[t.length-1-a]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+o+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},Sa=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,o=Yo(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Ea=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));for(var r=e.length,o=Yo(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=Mo("rc",r),u=Mo("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",f=[o+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",h=0,v=1===r?2:4;h<v;h++)p+="\n        "+f[h]+"\n        if ("+d+") {\n          result["+h+"] = float("+n+");\n        } else {\n          "+o+" source = rc - start;\n          result["+h+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";p+=1===r?"} ":"}}",this.userCode="\n      const "+o+" start = "+o+"("+i+");\n      const "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+p+"\n        setOutput(result);\n      }\n    "},ka=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,p="0.0";if(d||(p="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+l+", "+f+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var h=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(h="avgValue / count");var v=4*Math.floor(r/4),m=r%4,g="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+l+", "+f+");\n      const float initializationValue = "+p+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+p+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+h+");\n      }\n    "}},Ia=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,h=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var m="avg"===t,g="0.0";if(m||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+i+", "+a+");\n        const ivec3 pads = ivec3("+p+", "+h+", "+v+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+f+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+f+" * "+d+" +\n                      wR * "+d+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,w="\n      if ("+m+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+p+", "+h+", "+v+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},_a=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 1e-20",s="min"):"max"===t&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,f="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===t?(a="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(a="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var p="";o%n>0&&(p="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+p+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+f+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(2===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(3===l)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+f+"\n        }\n        setOutput("+u+");\n      }\n    "},Ra=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Wo(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Lo(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Ta=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],d=c[1]/l[1],p=1/f,h=1/d,v=2*Math.ceil(p)+2,m=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+h+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Aa=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Da=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Oa=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],d=c[1]/l[1],p=1/f,h=1/d,v=2*Math.ceil(p)+2,m=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+h+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Fa=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Na=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),o=Yo(n);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},Pa=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=Mo("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Yo(n);function s(n){var r=e.map((function(r,o){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(o,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+o+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+o+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+o+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},Ma=function(e,t,n,r,o,i,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Yo(o.length),u=Yo(i.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",f="";1===r?f="i":2===r&&(f="i, coords[1]");var d="getUpdates("+f+")",p=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+p+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+d+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Ba=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";o%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var f="";o%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+f+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},Wa=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var c=Yo(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},La=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=Yo(this.rank),r="uniform int start["+this.rank+"];",o=function(e){if(1===e)return"sourceLoc";if(e<=6)return Va.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map((function(e,t){return"sourceLoc."+Va[t]+" = start["+t+"] + coords."+Va[t]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+o+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Va=["x","y","z","w","u","v"],za=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Yo(this.rank),n=Mo("coords",this.rank),r=Mo("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+o+")",a="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map((function(e,t){return"start["+t+"]"})).join()+");":e.map((function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Ua=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Yo(n.length),i=Yo(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map((function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"})).join(",")}this.userCode="\n      "+o+" begin = "+o+"("+e+");\n      "+o+" strides = "+o+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},Ha=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,o=ja(t,n),i=Ga(e,o,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[i].shift();return this.usedTextures[i].push(a),a}return this.numUsedTextures++,this.log(),o===je.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===je.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===je.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===je.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===je.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var o=Ga(t,ja(n,r),r);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[o],a=i.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(a,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function ja(e,t){if(e===He.UPLOAD)return je.PACKED_2X2_FLOAT32;if(e===He.RENDER||null==e)return function(e){return f().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?je.PACKED_2X2_FLOAT32:je.UNPACKED_FLOAT32:e?je.PACKED_2X2_FLOAT16:je.UNPACKED_FLOAT16}(t);if(e===He.DOWNLOAD||e===He.PIXELS)return je.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function Ga(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var qa=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Yo(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],o=0;o<e.length;o++)r.push("imod("+n[o]+", "+e[o]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},$a=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Yo(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),o=0;o<e.length;o++)r[e[o]]=n[o];return r.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},Ka=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Yo(this.rank),i=Po("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+o+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},Xa=1.7580993408473768,Ya=1.0507009873554805,Ja=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Za="if (isnan(x)) return x;",Qa="return x;",es="return abs(x);",ts=Za+"\n  return (x < 0.0) ? 0.0 : x;\n",ns=Za+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",rs="return (x >= 0.0) ? x : (exp(x) - 1.0);",os="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+Xa+";\n  float scale = "+Ya+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",is="return -x;",as="return ceil(x);",ss="return floor(x);",us="return exp(x);",cs="return exp(x) - 1.0;",ls=Za+"\n  return sin(x);\n",fs=Za+"\n  return cos(x);\n",ds=Za+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",ps=Za+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",hs=Za+"\n  return atan(x);\n",vs=Za+"return log(x + sqrt(x * x + 1.0));",ms=Za+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",gs=Za+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",ys="return x;",bs="return x;",xs="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ws="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Cs="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Ss=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Es=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=Mo("rc",t),r=Yo(t),o=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},ks={};function Is(e,t){if(void 0===t&&(t=!1),"linear"===e)return t?bs:Qa;if("relu"===e)return t?xs:ts;if("elu"===e)return t?Cs:rs;if("relu6"===e)return t?ws:ns;if("prelu"===e)return t?di:li;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var _s=600,Rs=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!f().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var o=Ke(f().getNumber("WEBGL_VERSION"));r.binaryCache=((n=f().getNumber("WEBGL_VERSION"))in ks||(ks[n]={}),ks[n]),r.gpgpu=new fa(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new Ha(r.gpgpu),r.numMBBeforeWarning=null==f().global.screen?1024:f().global.screen.height*f().global.screen.width*window.devicePixelRatio*_s/1024/1024,r.texData=new Kr(r,Le),r}return a(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(f().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:He.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(f().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:He.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,o=t.complexTensors,i=t.slice,a=t.shape,s=t.isPacked;if(null!=i){var u=void 0;u=s?new Ss(a,ys):new Ja(a,ys);var c=this.runWebGLProgram(u,[{dataId:e,shape:a,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,d,p=null!=this.activeTimers;return p&&(f=oe()),d="complex64"===r?mo(o.real.dataSync(),o.imag.dataSync()):this.getValuesFromTexture(e),p&&(this.downloadWaitMs+=oe()-f),this.convertAndCacheOnCPU(e,d)},t.prototype.read=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,l,d,p,h,v,m,g,y,b,x,w,C,S,E;return u(this,(function(u){switch(u.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.values,o=n.shape,i=n.slice,a=n.dtype,s=n.complexTensors,c=n.isPacked,null!=i)return l=void 0,l=c?new Ss(o,ys):new Ja(o,ys),d=this.runWebGLProgram(l,[{dataId:e,shape:o,dtype:a}],a),p=this.read(d.dataId),this.disposeData(d.dataId),[2,p];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!f().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===f().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==a&&f().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(e),m=this.texData.get(v.dataId),h=(E=this.gpgpu).createBufferFromTexture.apply(E,[m.texture].concat(Ye(o)))),this.pendingRead.set(e,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:u.sent(),u.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return y=u.sent(),b=y[0],x=y[1],g=mo(b,x),[3,5];case 4:null==h?g=this.getValuesFromTexture(e):(w=T(o),g=this.gpgpu.downloadFloat32MatrixFromBuffer(h,w)),u.label=5;case 5:return null!=v&&this.disposeData(v.dataId),C=this.convertAndCacheOnCPU(e,g),S=this.pendingRead.get(e),this.pendingRead.delete(e),S.forEach((function(e){return e(C)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,C]}}))}))},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!nt(n)){if(f().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.dtype,i=n.isPacked,a=T(r);if(f().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),u=this.texData.get(s.dataId),c=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[u.texture].concat(Ye(r))).subarray(0,a);return this.disposeData(s.dataId),c}var l=f().getBool("WEBGL_PACK")&&!0===i,d=l?Dt(r):r,p=l?new Wi(d):new Bi(d),h=this.runWebGLProgram(p,[{shape:d,dtype:o,dataId:e}],"float32"),v=this.texData.get(h.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,a);return this.disposeData(h.dataId),m},t.prototype.time=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return u(this,(function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),o=R(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=R(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return s=u.sent(),a.kernelMs=E(s),a.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},[3,3];case 2:a.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:oe(),endMs:null}},t.prototype.endTimer=function(e){return f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=oe(),e)},t.prototype.getQueryTime=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return f().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,o=t.texShape,i=t.usage,a=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(n,o,i,a)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return f().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Le.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&e.size<t}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Le.keep(e.clone()),imag:Le.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===T(n))return mn([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,o=Ur(e.shape,t,n);if(r||!o){var i=f().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new za(n):new La(n),a=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,a)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),o=this.makeOutput(n,e.dtype),i=this.texData.get(o.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var a=Hr(t,e.strides);r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),o},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var o=Lr(t,n,r);if(o.some((function(e){return 0===e})))return mn([],o);var i=new Ua(t,r,o);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=f().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Pa(e.shape,t):new Na(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return hn(e)})),r=e.map((function(e){return vn(e)}));return pn(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>f().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(e.length/2),i=this.concat(e.slice(0,o),t),a=this.concat(e.slice(o),t);return this.concat([i,a],t)}if(f().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new yi(e.map((function(e){return e.shape})),t);return this.compileAndRun(s,e)}var u=fn(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,T(e.shape.slice(t)))})),l=new gi(c.map((function(e){return e.shape})));return this.compileAndRun(l,c).reshape(u)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,is,e.dtype);var t=new Ja(e.shape,is);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var o=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],a=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===o||1===i)&&a>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var u=1===i?e:e.as3D(s,a,1),c=1===i?2:1,l=1===i?t.as3D(s,1,a):t;return this.multiply(u,l).sum(c,!0)}var f=De(e.dtype,t.dtype),d=new ba(e.shape,[s,o,i],n,r);return this.compileAndRun(d,[e,t],f)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,o=e.transposeB,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],c=o?n.shape[1]:n.shape[2],l=t.shape[0],f=De(t.dtype,n.dtype),d=null!=i,p=null!=s,h=a?Is(a,!0):null,v=new ba(t.shape,[l,u,c],r,o,d,h,p),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(v,m,f)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),o=new ai(oi,e.shape,t.shape),i=new ai(ii,e.shape,t.shape),a=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(o,a),u=this.compileAndRun(i,a),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,ci,e.dtype);var l=new fi(ci,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,o,i){var a=[e,t,n],s=null;null!=i&&(s=i.shape,a.push(i));var u=null;if(null!=o&&(u=o.shape,a.push(o)),f().getBool("WEBGL_PACK_NORMALIZATION")){var c=new ri(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,a)}var l=new ni(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,a)},t.prototype.localResponseNormalization4D=function(e,t,n,r,o){var i=f().getBool("WEBGL_PACK_NORMALIZATION")?new ma(e.shape,t,n,r,o):new ha(e.shape,t,n,r,o);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,o,i,a){var s=new va(t.shape,r,o,i,a);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return se(e)}));return To(Jn(e.shape,e.dtype,n),t)}var r=new qa(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=f().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ea(e.shape,t,n):new Sa(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=f().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ka(e.shape,t):new $a(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new Gi(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){k(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),o=Ir(e.shape,t,r),i=_r(o.length,t.length),a=Rr(e.shape,t,r),s=Tr(n,t.length),u=Ar(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){k(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=Ir(a.shape,t,r,!1),u=_r(s.length,t.length,!1),c=Rr(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],o=e.shape[1],i=Fr(o),a=new _a({windowSize:i,inSize:o,batchSize:r},t),s=this.compileAndRun(a,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],o=e.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var i=Fr(o),a=new No({windowSize:i,inSize:o,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(a,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,o=Fr(r[r.length-1]),i=new Qo(r,o,t,null==n),a=null==n?[e]:[e,n],s=this.compileAndRun(i,a,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){an("sum",t,e.rank);var n=rn(e.shape,t),r=n[0],o=T(n[1]),i=e.as2D(-1,o),a=Oe(e.dtype);return this.reduce(i,"sum",a).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=rn(e.shape,t),r=n[0],o=T(n[1]),i=e.as2D(-1,o),a=Oe(e.dtype);return this.reduce(i,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,o=sn([r],e.rank),i=e;null!=o&&(i=e.transpose(o),r=cn(1,e.rank)[0]);var a=function(e,t,n){for(var r=[],o=e.length,i=0;i<o;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=T([i.shape[r]]),u=i.as2D(-1,s),c=Oe(e.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",t,c,n).reshape(a);return null!=o&&(l=l.transpose(un(o))),l},t.prototype.segOpCompute=function(e,t,n,r,o){var i=e.shape[0],a=e.shape[1],s=function(e,t){var n,r=!1;for(e<=Or?(n=e,r=!0):n=Z(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Z(e,n+1);return n}(a,o),u=new Ba({windowSize:s,inSize:a,batchSize:i,numSegments:o},t),c=this.compileAndRun(u,[e,n],r);return c.shape[1]===o?c:(n=An(0,o).tile([a/s]),this.segOpCompute(c,t,n,r,o))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(an("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!f().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var o=rn(e.shape,r),i=o[0],a=T(o[1]),s=e.as2D(-1,a);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var o=new Di(e.shape,n,r);return this.compileAndRun(o,[e])},t.prototype.equal=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new fi("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new fi("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new fi("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new fi("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new fi("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new fi("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new Ja(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new fi("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new fi("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new Wa(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],De(t.dtype,n.dtype))},t.prototype.where=function(e){Yt("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Do(e.shape,t)},t.prototype.topk=function(e,t,n){return Ao(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){an("min",t,e.rank);var n=rn(e.shape,t),r=n[0],o=T(n[1]),i=e.as2D(-1,o);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fi("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fi("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);an("max",t,e.rank);var n=rn(e.shape,t),r=n[0],o=T(n[1]),i=e.as2D(-1,o);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fi("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){an("all",t,e.rank);var n=rn(e.shape,t),r=n[0],o=T(n[1]),i=e.as2D(-1,o);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){an("any",t,e.rank);var n=rn(e.shape,t),r=n[0],o=T(n[1]),i=e.as2D(-1,o);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.realDivide=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new fi("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},t.prototype.floorDiv=function(e,t){if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new fi("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,si);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=De(e.dtype,t.dtype);if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,si,n);var r=new fi(si,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new Ss(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,o){void 0===o&&(o=!1);var i=new pi(n,e.shape,t.shape,o);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,o=this.texData.get(e.dataId),i=this.texData.get(t.dataId),a=[[o.complexTensors.real,i.complexTensors.real],[o.complexTensors.imag,i.complexTensors.imag]].map((function(o){var i=o[0],a=o[1],s=r.makeComplexComponentTensorInfo(e,i),u=r.makeComplexComponentTensorInfo(t,a),c=new fi(n,e.shape,t.shape);return r.compileAndRun(c,[s,u],De(i.dtype,a.dtype))})),s=a[0],u=a[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>f().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var o=e.map((function(e){return e.dtype})).reduce((function(e,t){return De(e,t)})),i=e.map((function(e){return e.shape})),a=f().getBool("WEBGL_PACK")?new Fo(e[0].shape,i):new Oo(e[0].shape,i);return this.compileAndRun(a,e,o)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,ui);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=De(e.dtype,t.dtype);if(f().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,ui,e.dtype);var r=new fi(ui,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fi("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=De(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,as,e.dtype);var t=new Ja(e.shape,as);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ss,e.dtype);var t=new Ja(e.shape,ss);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new Ja(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new Ja(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new Ja(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new Ja(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new Ja(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,us,e.dtype);var t=new Ja(e.shape,us);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cs,e.dtype);var t=new Ja(e.shape,cs);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=B([t],e.shape),r=this.max(e,n),o=on(r.shape,n),i=this.subtract(e,r.reshape(o)),a=this.exp(i),s=this.sum(a,n).reshape(o);return this.realDivide(a,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new Ja(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new Ja(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new Ja(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new Ja(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new Ja(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=f().getBool("WEBGL_PACK")?new Ss(e.shape,xs):new Ja(e.shape,ts),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=f().getBool("WEBGL_PACK")?new Ss(e.shape,ws):new Ja(e.shape,ns),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi(di,e.shape,t.shape):new fi(li,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Cs,e.dtype);var t=new Ja(e.shape,rs);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new fi("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new Ja(e.shape,os);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new Ja(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,o=(r=f().getBool("WEBGL_PACK_CLIP")?new vi(e.shape):new hi(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,o)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(f().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,es,e.dtype);var t=new Ja(e.shape,es);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new mi(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new Ja(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new Ja(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new Ja(e.shape,ls);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new Ja(e.shape,fs);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new Ja(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new Ja(e.shape,ds);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new Ja(e.shape,ps);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new Ja(e.shape,hs);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fi("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new Ja(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new Ja(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new Ja(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new Ja(e.shape,vs);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new Ja(e.shape,ms);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new Ja(e.shape,gs);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new Ja(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new Ja(e.shape,function(e){return void 0===e&&(e=0),Za+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,o,i){var a=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,c=a[0]*a[1]*a[2],l=n.outChannels,d="channelsLast"===n.dataFormat,p=(1===c||1===l)&&u>1e3,h=a[2]%2!=0&&!!s.isPacked;if(p||!f().getBool("WEBGL_LAZILY_UNPACK")||!f().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!h){var v=d?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],m=this.reshape(e,[1,v,n.inChannels]),g=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:g,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:i}),n.outShape)}var y=d?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),b={dataId:e.dataId,shape:[1,y,n.inChannels],dtype:e.dtype},x=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,k(Nt(s.shape,b.shape),(function(){return"packed reshape "+s.shape+" to "+b.shape+" isn't free"}));var w=this.reshape(t,[1,n.inChannels,n.outChannels]),C=this.fusedBatchMatMul({a:b,b:w,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:i}),S=this.texData.get(C.dataId);return k(S.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=x,S.shape=n.outShape,Le.makeTensorFromDataId(C.dataId,n.outShape,C.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,o,i){var a=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,f="channelsLast"===n.dataFormat,d=a*s*u,p=l*c,h=[d,p],v=e.squeeze([0]),m=t.reshape([1,d,-1]),g=new pa(h,v.shape,n),y=this.compileAndRun(g,[v]).reshape([1,h[0],h[1]]),b=null!=r,x=null!=i,w=o?Is(o,!0):null,C=new ba(y.shape,[1,p,n.outChannels],!0,!1,b,w,x),S=[y,m];r&&S.push(r),x&&S.push(i);var E=this.compileAndRun(C,S);return f?E.reshape([1,l,c,n.outChannels]):E.reshape([1,n.outChannels,l,c])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,o,i,a);if(f().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,o,i,a);var s=null!=o,u=null!=a,c=i?Is(i,!1):null,l=new Ii(r,s,c,u),d=[t,n];return o&&d.push(o),a&&d.push(a),this.compileAndRun(l,d)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(f().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new Ii(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new wi(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new xi(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,o=e.convInfo,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=f().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,c=a?Is(a,u):null,l=[n,r],d=null!=i,p=null!=s;return d&&l.push(i),p&&l.push(s),u?(t=new Ti(o,d,c,p),this.compileAndRun(t,l)):(t=new Ri(o,d,c,p),this.compileAndRun(t,l))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return f().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Ti(n),this.compileAndRun(r,[e,t])):(r=new Ri(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new ki(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new Ei(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new _i(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new Si(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new Ci(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new ka(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new ka(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var o=new ka(r,"max",!0),i=this.compileAndRun(o,[t]),a=new ga(r),s=this.compileAndRun(a,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new ei(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return po(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),o=0,i=0;i<e.rank;i++)i!==t&&(r[o++]=e.shape[i]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)a[t]=i,u[i]=this.slice(e,a,s).reshape(r);return u},t.prototype.avgPool3d=function(e,t){var n=new Ia(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new ti(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new Ia(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var o=new Ia(r,"max",!0),i=this.compileAndRun(o,[t]),a=new ya(r),s=this.compileAndRun(a,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!Nt(e.shape,t)&&(null===n.texture||!Nt(n.shape,t))){var r=this.packedReshape(e,t);return Le.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return ho(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var o=f().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Da(e.shape,t,n,r):new Aa(e.shape,t,n,r);return this.compileAndRun(o,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new Ta(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var o=new Fa(e.shape,t,n,r);return this.compileAndRun(o,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new Oa(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var o=t?e:qr(e),i=o.shape[0],a=o.shape[1],s=new xa(i,a,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[o],"int32",u)},t.prototype.oneHot=function(e,t,n,r){var o=new wa(e.size,t,n,r);return this.compileAndRun(o,[e])},t.prototype.diag=function(e){var t=new Mi(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,o){return Yt("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Co(e.dataSync(),t.dataSync(),n,r,o)},t.prototype.cropAndResize=function(e,t,n,r,o,i){var a=new Ai(e.shape,t.shape,r,o,i);return this.compileAndRun(a,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){k(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));var r=e.shape[0],o="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],a="NHWC"===n?e.shape[3]:e.shape[1],s=o*t,u=i*t,c=a/(t*t),l=new Pi("NHWC"===n?[r,s,u,c]:[r,c,s,u],t,n);return this.compileAndRun(l,[e])},t.prototype.split=function(e,t,n){return Ro(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=Mr(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/a,a],l=e.reshape([i,o]),f=t.reshape([i,a]);if(0===u)return ho(mn([]),n);var d=yn(0),p=new Ma(i,o,l.rank,f.rank,s,c);return this.compileAndRun(p,[f,l,d]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var o=Mr(0,e,n),i=o.sliceRank,a=o.numUpdates,s=o.strides,u=o.outputSize,c=new Ma(a,i,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new Hi(zi,e.shape,t),o=new Hi(Ui,e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],a=this.compileAndRun(r,i),s=this.compileAndRun(o,i),u=this.complex(a,s).as2D(e.shape[0],e.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=Dr(e,t),i=o[0],a=o[1],s=o[2],u=o[3],c=t.reshape([a,r]),l=e.reshape([e.size/s,s]),f=new qi(r,u,[a,s]);return this.compileAndRun(f,[l,c]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||Y(t))){var r=V(n,T(e));return r.fill(t),Le.makeTensor(r,e,n,this)}var o=new ji(e,t),i=o.getCustomSetupFunc(t);return this.compileAndRun(o,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return vo(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return Le.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new Es(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new Ca(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[Tt(e.shape)].concat(At(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},o=[Tt(t)].concat(At(t)),i=new Ra(o,n),a=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:a.dataId,shape:t,dtype:a.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,o=n.shape,i=n.dtype,a=Dt(o);return t=r?new Ni(a):new Fi(a),{dtype:i,shape:o,dataId:this.runWebGLProgram(t,[{shape:a,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var a=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(a.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===Ue.DENSE){var u=Ye(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===T(a.shape))return s.values=L(a.dtype,0),a;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&T(t.shape)<=f().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),c.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!Nt(n.shape,t.shape)){var r=t,o=t.shape;t.shape=n.shape,t=i.packedReshape(t,o),c.push(t),n=i.texData.get(t.dataId),r.shape=o}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(a.dataId);var d,p={shape:a.shape,texData:s,isUniform:!1},h=function(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t}));var o=e.userCode,i=e.constructor.name;return i+"_"+r+"_"+o}(e,l,p),v=this.getAndSaveBinary(h,(function(){return function(e,t,n,r){var o=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),a=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=zo(i,s,o,t.packedInputs),c=e.createProgram(u),l=null,d=e.getUniformLocation(c,"NAN",!1);1===f().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var p={},h=0;h<t.variableNames.length;h++){var v=t.variableNames[h];p[v]=e.getUniformLocation(c,v,!1),p["offset"+v]=e.getUniformLocation(c,"offset"+v,!1)}return{program:t,source:u,webGLProgram:c,uniformLocations:p,inShapeInfos:a,outShapeInfo:s,infLoc:l,nanLoc:d}}(i.gpgpu,e,l,p)})),m=null!=this.activeTimers;if(m&&(d=this.startTimer()),function(e,t,n,r,o){da(t.inShapeInfos,n),da([t.outShapeInfo],[r]);var i=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,a[0],a[1]):e.setOutputMatrixTexture(i,a[0],a[1]),e.setProgram(t.webGLProgram),1===f().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var o=t.program.variableNames[r],i=t.uniformLocations[o],a=t.uniformLocations["offset"+o];if(null!=i)if(n.isUniform)if(T(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=a&&e.gl.uniform1i(a,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=o&&o(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,v,l,p,r),c.forEach((function(e){return i.disposeData(e.dataId)})),m&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)})),!f().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===o){var g=this.unpackTensor(a);return this.disposeData(a.dataId),g}return a},t.prototype.compileAndRun=function(e,t,n,r,o){void 0===o&&(o=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,o);return Le.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(f().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=$t((function(){if(!f().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=f().getBool("DEBUG");f().set("DEBUG",!1);var n=e.abs(yn(1e-8)).dataSync()[0];if(f().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.dtype,i=n.values,a=n.texture,s=n.usage,u=n.isPacked;if(null==a){var c,l=null!=this.activeTimers;l&&(c=oe());var f=n.texShape;if(null==f&&(f=Ot(r,u),n.texShape=f),null!=i){var d=Dt(r),p=void 0,h=f[1],v=f[0],m=i instanceof Uint8Array;u?(h=(t=Je(f[0],f[1]))[0],v=t[1],p=new Vi(d,[v,h],m)):p=new Li(d,[v,h],m);var g=this.makeTensorInfo([v,h],o);this.texData.get(g.dataId).usage=m?He.PIXELS:He.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),h,v,i);var y=this.runWebGLProgram(p,[g],o,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=oe()-c)}else{var x=this.acquireTexture(f,s,o,u);n.texture=x}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*G(t)},t}(Xr);Ve()&&Le.registerBackend("webgl",(function(){return new Rs}),2);var Ts=dn({square_:function(e){var t=Qt(e,"x","square"),n=[t];return Le.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}}),As="SquaredDifference",Ds=dn({squaredDifference_:function(e,t){var n,r=Qt(e,"a","squaredDifference"),o=Qt(t,"b","squaredDifference");n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return Le.runKernelFunc((function(e,t){var n=e.squaredDifference(r,o);return t([r,o]),n}),i,(function(e,t){var n=t[0],r=t[1],o=yn(2);return{a:function(){return e.mul(n.sub(r).mul(o))},b:function(){return e.mul(r.sub(n).mul(o))}}}),As,{},a,[])}}),Os=dn({abs_:function(e){var t=Qt(e,"x","abs");return"complex64"===t.dtype?Le.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):Le.runKernelFunc((function(e,n){var r=e.abs(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}}),"Abs")}}),Fs=dn({acos_:function(e){var t=Qt(e,"x","acos");return Le.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(yn(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),Ns=dn({acosh_:function(e){var t=Qt(e,"x","acosh");return Le.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Ps=dn({asin_:function(e){var t=Qt(e,"x","asin");return Le.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(yn(1).sub(n.toFloat().square()).sqrt())}}}))}}),Ms=dn({asinh_:function(e){var t=Qt(e,"x","asinh");return Le.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(yn(1).add(n.toFloat().square()).sqrt())}}}))}}),Bs=dn({atan_:function(e){var t=Qt(e,"x","atan");return Le.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),Ws=dn({atanh_:function(e){var t=Qt(e,"x","atanh");return Le.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(yn(1).sub(n.toFloat().square()))}}}))}}),Ls=dn({ceil_:function(e){var t=Qt(e,"x","ceil");return Le.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),Vs=dn({clipByValue_:function(e,t,n){var r=Qt(e,"x","clipByValue");k(t<=n,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."}));var o=[r],i={min:t,max:n};return Le.runKernelFunc((function(e,o){var i=e.clip(r,t,n);return o([r]),i}),{x:r},(function(e,r){var o=r[0];return{x:function(){return e.where(o.greaterEqual(t).logicalAnd(o.lessEqual(n)),On(e))}}}),"ClipByValue",i,o)}}),zs=dn({cos_:function(e){var t=Qt(e,"x","cos"),n=[t];return Le.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}}),"Cos",{},n)}}),Us=dn({cosh_:function(e){var t=Qt(e,"x","cosh");return Le.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}}))}}),Hs=dn({erf_:function(e){var t=Qt(e,"x","erf");return k("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),Le.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),js=dn({exp_:function(e){var t=Qt(e,"x","exp");return Le.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),{x:t},(function(e,t){return{x:function(){return e.mulStrict(t[0])}}}),"Exp",{},[],[!0])}}),Gs=dn({expm1_:function(e){var t=Qt(e,"x","expm1");return Le.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}}))}}),qs=dn({floor_:function(e){var t=Qt(e,"x","floor");return Le.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),$s=dn({log_:function(e){var t=Qt(e,"x","log"),n=[t];return Le.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}}),"Log",{},n)}}),Ks=dn({log1p_:function(e){var t=Qt(e,"x","log1p");return Le.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}}))}}),Xs=dn({logSigmoid_:function(e){var t=Qt(e,"x","logSigmoid");return Le.runKernelFunc((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),Ys=dn({neg_:function(e){var t=Qt(e,"x","neg"),n=[t];return Le.runKernelFunc((function(e){return e.neg(t)}),{x:t},(function(e){return{x:function(){return e.neg()}}}),"Neg",{},n)}}),Js=dn({reciprocal_:function(e){var t=Qt(e,"x","reciprocal");return Le.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),Zs=dn({round_:function(e){var t=Qt(e,"x","round");return Le.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),Qs=dn({rsqrt_:function(e){var t=Qt(e,"x","rsqrt"),n=[t];return Le.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),eu=dn({sigmoid_:function(e){var t=Qt(e,"x","sigmoid");return Le.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(yn(1).sub(n)))}}}),"Sigmoid")}}),tu=dn({sign_:function(e){var t=Qt(e,"x","sign");return Le.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),nu=dn({isNaN_:function(e){var t=Qt(e,"x","isNaN");return Le.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),ru=dn({isInf_:function(e){var t=Qt(e,"x","isInf");return Le.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),ou=dn({isFinite_:function(e){var t=Qt(e,"x","isFinite");return Le.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return On(e)}}}))}}),iu=dn({sin_:function(e){var t=Qt(e,"x","sin"),n=[t];return Le.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}}),"Sin",{},n)}}),au=dn({sinh_:function(e){var t=Qt(e,"x","sinh");return Le.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}}))}}),su=dn({softplus_:function(e){var t=Qt(e,"x","softplus");return Le.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),uu=dn({sqrt_:function(e){var t=Qt(e,"x","sqrt");return Le.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}))}}),cu=dn({step_:function(e,t){void 0===t&&(t=0);var n=Qt(e,"x","step");return Le.runKernelFunc((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return On(e)}}}))}}),lu=dn({tan_:function(e){var t=Qt(e,"x","tan");return Le.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),fu=dn({tanh_:function(e){var t=Qt(e,"x","tanh");return Le.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return yn(1).sub(n.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}});function du(e,t,n,r,o,i){var a,s,u=Qt(e,"x","batchNorm"),c=Qt(t,"mean","batchNorm"),l=Qt(n,"variance","batchNorm");return null!=o&&(a=Qt(o,"scale","batchNorm")),null!=r&&(s=Qt(r,"offset","batchNorm")),k(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),k(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),k(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=a&&k(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&k(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),vu(u,c,l,s,a,i)}function pu(e,t,n,r,o,i){var a,s,u=Qt(e,"x","batchNorm"),c=Qt(t,"mean","batchNorm"),l=Qt(n,"variance","batchNorm");return null!=o&&(a=Qt(o,"scale","batchNorm")),null!=r&&(s=Qt(r,"offset","batchNorm")),k(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),k(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),k(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=a&&k(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&k(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),vu(u,c,l,s,a,i)}function hu(e,t,n,r,o,i){var a,s,u=Qt(e,"x","batchNorm"),c=Qt(t,"mean","batchNorm"),l=Qt(n,"variance","batchNorm");return null!=o&&(a=Qt(o,"scale","batchNorm")),null!=r&&(s=Qt(r,"offset","batchNorm")),k(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),k(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),k(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=a&&k(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&k(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),vu(u,c,l,s,a,i)}function vu(e,t,n,r,o,i){null==i&&(i=.001);var a,s,u,c=Qt(e,"x","batchNorm"),l=Qt(t,"mean","batchNorm"),f=Qt(n,"variance","batchNorm");null!=o&&(a=Qt(o,"scale","batchNorm")),null!=r&&(s=Qt(r,"offset","batchNorm")),k(l.rank===f.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),k(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),k(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var d=[c,l,f,a];return Le.runKernelFunc((function(e,t){var n=e.batchNormalization(u,mu(l),mu(f),i,mu(a),mu(s));return t([c,l,f,a]),n}),{x:c,mean:l,variance:f,scale:a,offset:s},(function(e,t){var n=t,r=n[0],o=n[1],a=n[2],s=n[3],c=null==s?yn(1):s,l=Zr(o.shape,u.shape),f=[];if(1===o.rank){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var p=r.sub(o),h=e.mul(c),v=Qs(a.add(yn(i))),m=v.mul(v).mul(v).mul(yn(-.5));return{x:function(){return 1===o.rank?e.mul(Cr(v.as4D(1,1,1,o.shape[0]),f)).mul(c).reshape(r.shape):e.mul(v).mul(c).reshape(r.shape)},mean:function(){var e=v.mul(yn(-1)).mul(h);return 1===o.rank&&(e=e.sum(l)),e.reshape(o.shape)},variance:function(){var e=m.mul(p).mul(h);return 1===o.rank&&(e=e.sum(l)),e.reshape(o.shape)},scale:function(){var t=p.mul(v),n=e.mul(t);return 1===o.rank&&(n=n.sum(l)),n.reshape(o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=t.sum(l)),t.reshape(o.shape)}}}),"BatchNormalization",{varianceEpsilon:i},d).reshape(c.shape)}function mu(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function gu(){qt("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var yu=dn({batchNormalization2d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),gu(),du(e,t,n,i,o,r)}}),bu=dn({batchNormalization3d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),gu(),pu(e,t,n,i,o,r)}}),xu=dn({batchNormalization4d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),gu(),hu(e,t,n,i,o,r)}}),wu=dn({batchNormalization_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),gu(),vu(e,t,n,i,o,r)}}),Cu=dn({batchNorm_:vu}),Su=dn({batchNorm2d_:du}),Eu=dn({batchNorm3d_:pu}),ku=dn({batchNorm4d_:hu}),Iu=dn({logicalAnd_:function(e,t){var n=Qt(e,"a","logicalAnd","bool"),r=Qt(t,"b","logicalAnd","bool");return Qr(n.shape,r.shape),Le.runKernelFunc((function(e){return e.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),_u=dn({logicalNot_:function(e){var t=Qt(e,"x","logicalNot","bool");return Le.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),Ru=dn({logicalOr_:function(e,t){var n=Qt(e,"a","logicalOr","bool"),r=Qt(t,"b","logicalOr","bool");return Qr(n.shape,r.shape),Le.runKernelFunc((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),Tu=dn({logicalXor_:function(e,t){var n=Qt(e,"a","logicalXor","bool"),r=Qt(t,"b","logicalXor","bool");return Qr(n.shape,r.shape),Ru(e,t).logicalAnd(Iu(e,t).logicalNot())}}),Au=dn({where_:function(e,t,n){var r=Qt(t,"a","where"),o=Qt(n,"b","where"),i=Qt(e,"condition","where","bool");return I(r.shape,o.shape,"Error in where: "),1===i.rank?k(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):I(i.shape,o.shape,"Error in where: "),Le.runKernelFunc((function(e,t){var n=e.select(i,r,o);return t([i]),n}),{$condition:i,$a:r,$b:o},(function(e,t){var n=t[0];return{$condition:function(){return On(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}))}}),Du=function(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(o){switch(o.label){case 0:return[4,(t=Qt(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Do(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},Ou=dn({add_:function(e,t){var n,r=Qt(e,"a","add"),o=Qt(t,"b","add");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e){return e.add(r,o)}),{a:r,b:o},(function(e){return{a:function(){var t=e,n=Zr(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=Zr(o.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(o.shape)}}}),"Add")}}),Fu=dn({addN_:function(e){k(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),k(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return Qt(e,"tensors"+t,"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!A(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return Le.runKernelFunc((function(e){return e.addN(t)}),r,(function(e){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}),"AddN")}}),Nu=dn({addStrict_:function(e,t){var n=Qt(e,"a","addStrict"),r=Qt(t,"b","addStrict");return I(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Pu=dn({atan2_:function(e,t){var n,r=Qt(e,"a","atan2"),o=Qt(t,"b","atan2");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e,t){var n=e.atan2(r,o);return t([r,o]),n}),{$a:r,$b:o},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=Ou(n.square(),r.square()),o=e.mul(r.div(t)),a=Zr(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},$b:function(){var t=Ou(n.square(),r.square()),o=Ys(e.mul(n.div(t))),a=Zr(r.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(r.shape)}}}))}}),Mu=dn({div_:function(e,t){var n,r=Qt(e,"a","div"),o=Qt(t,"b","div");if(n=Fe(r,o),r=n[0],o=n[1],"int32"===r.dtype&&"int32"===o.dtype)return Lu(r,o);var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e,t){var n=e.realDivide(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),o=Zr(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=Zr(r.shape,i);o.length>0&&(t=t.sum(o).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}),"Div")}}),Bu=dn({divNoNan_:function(e,t){var n,r=Qt(e,"a","div"),o=Qt(t,"b","div");r=(n=Fe(r,o))[0],o=n[1];var i=Mu(r,o),a=On(i),s=o.equal(a);return Au(s,a,i)}}),Wu=dn({divStrict_:function(e,t){var n=Qt(e,"a","div"),r=Qt(t,"b","div");return I(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Lu=dn({floorDiv_:function(e,t){var n,r=Qt(e,"a","floorDiv"),o=Qt(t,"b","floorDiv");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e,t){var n=e.floorDiv(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),o=Zr(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=Zr(r.shape,i);o.length>0&&(t=t.sum(o).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}),"FloorDiv")}}),Vu=dn({maximum_:function(e,t){var n,r=Qt(e,"a","maximum"),o=Qt(t,"b","maximum");return n=Fe(r,o),r=n[0],o=n[1],"bool"===r.dtype&&(r=r.toInt(),o=o.toInt()),Qr(r.shape,o.shape),Le.runKernelFunc((function(e,t){var n=e.maximum(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}}),"Maximum")}}),zu=dn({maximumStrict_:function(e,t){var n=Qt(e,"a","maximumStrict"),r=Qt(t,"b","maximumStrict");return I(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Uu=dn({minimum_:function(e,t){var n,r=Qt(e,"a","minimum"),o=Qt(t,"b","minimum");return n=Fe(r,o),r=n[0],o=n[1],"bool"===r.dtype&&(r=r.toInt(),o=o.toInt()),Qr(r.shape,o.shape),Le.runKernelFunc((function(e,t){var n=e.minimum(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}}),"Minimum")}}),Hu=dn({minimumStrict_:function(e,t){var n=Qt(e,"a","minimumStrict"),r=Qt(t,"b","minimumStrict");return I(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),ju=dn({mod_:function(e,t){var n,r=Qt(e,"a","mod"),o=Qt(t,"b","mod");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e,t){var n=e.mod(r,o);return t([r,o]),n}),{$a:r,$b:o},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=Zr(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),o=Zr(r.shape,i);return o.length>0?t.sum(o).reshape(r.shape):t}}}))}}),Gu=dn({modStrict_:function(e,t){var n=Qt(e,"a","modStrict"),r=Qt(t,"b","modStrict");return I(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),qu=dn({mul_:function(e,t){var n,r=Qt(e,"a","mul"),o=Qt(t,"b","mul");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e,t){var n=e.multiply(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),o=Zr(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=Zr(r.shape,i);return o.length>0?t.sum(o).reshape(r.shape):t}}}),"Mul")}}),$u=dn({mulStrict_:function(e,t){var n=Qt(e,"a","mul"),r=Qt(t,"b","mul");return I(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Ku=dn({pow_:function(e,t){var n,r=Qt(e,"base","pow"),o=Qt(t,"exp","pow");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape),a=[r,o];return Le.runKernelFunc((function(e,t){var n=e.pow(r,o);return t([r,o,n]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1],o=t[2];return{a:function(){var t=r.toFloat(),o=e.mul(t.mul(n.pow(t.sub(yn(1))))),a=Zr(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},b:function(){var t=n.greater(0),a=n.log().where(t,On(n)),s=e.mul(o.mul(a)),u=Zr(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},a,[!0])}}),Xu=dn({powStrict_:function(e,t){return I(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),Yu=dn({squaredDifferenceStrict_:function(e,t){var n=Qt(e,"a","squaredDifferenceStrict"),r=Qt(t,"b","squaredDifferenceStrict");return I(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ju=dn({sub_:function(e,t){var n,r=Qt(e,"a","sub"),o=Qt(t,"b","sub");n=Fe(r,o),r=n[0],o=n[1];var i=Qr(r.shape,o.shape);return Le.runKernelFunc((function(e){return e.subtract(r,o)}),{a:r,b:o},(function(e){return{a:function(){var t=e,n=Zr(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=Zr(o.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(o.shape)}}}),"Sub")}}),Zu=dn({subStrict_:function(e,t){var n=Qt(e,"a","subStrict"),r=Qt(t,"b","subStrict");return I(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Qu=dn({equal_:function(e,t){var n,r=Qt(e,"a","equal"),o=Qt(t,"b","equal");return n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape),Le.runKernelFunc((function(e){return e.equal(r,o)}),{$a:r,$b:o})}}),ec=dn({equalStrict_:function(e,t){var n=Qt(e,"a","equalStrict"),r=Qt(t,"b","equalStrict");return I(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),tc=dn({greater_:function(e,t){var n,r=Qt(e,"a","greater"),o=Qt(t,"b","greater");return n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape),Le.runKernelFunc((function(e){return e.greater(r,o)}),{a:r,b:o},null,"Greater")}}),nc=dn({greaterEqual_:function(e,t){var n,r=Qt(e,"a","greaterEqual"),o=Qt(t,"b","greaterEqual");return n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape),Le.runKernelFunc((function(e,t){var n=e.greaterEqual(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return On(n)},b:function(){return On(r)}}}),"GreaterEqual")}}),rc=dn({greaterEqualStrict_:function(e,t){var n=Qt(e,"a","greaterEqualStrict"),r=Qt(t,"b","greaterEqualStrict");return I(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),oc=dn({greaterStrict_:function(e,t){var n=Qt(e,"a","greaterStrict"),r=Qt(t,"b","greaterStrict");return I(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),ic=dn({less_:function(e,t){var n,r=Qt(e,"a","less"),o=Qt(t,"b","less");return n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape),Le.runKernelFunc((function(e){return e.less(r,o)}),{a:r,b:o},null,"Less")}}),ac=dn({lessEqual_:function(e,t){var n,r=Qt(e,"a","lessEqual"),o=Qt(t,"b","lessEqual");return n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape),Le.runKernelFunc((function(e,t){var n=e.lessEqual(r,o);return t([r,o]),n}),{a:r,b:o},null,"LessEqual")}}),sc=dn({lessEqualStrict_:function(e,t){var n=Qt(e,"a","lessEqualStrict"),r=Qt(t,"b","lessEqualStrict");return I(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),uc=dn({lessStrict_:function(e,t){var n=Qt(e,"a","lessStrict"),r=Qt(t,"b","lessStrict");return I(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),cc=dn({notEqual_:function(e,t){var n,r=Qt(e,"a","notEqual"),o=Qt(t,"b","notEqual");return n=Fe(r,o),r=n[0],o=n[1],Qr(r.shape,o.shape),Le.runKernelFunc((function(e){return e.notEqual(r,o)}),{a:r,b:o},null,"NotEqual")}}),lc=dn({notEqualStrict_:function(e,t){var n=Qt(e,"a","notEqualStrict"),r=Qt(t,"b","notEqualStrict");return I(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function fc(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function dc(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var pc=dn({gather_:function(e,t,n){void 0===n&&(n=0);var r=Qt(e,"x","gather"),o=Qt(t,"indices","gather","int32");n=B(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],o=[],i=1,a=1,s=0;s<n;s++)o.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)o.push(t.shape[s]);for(s=n+1;s<e.rank;s++)o.push(e.shape[s]),a*=e.shape[s];return{batchSize:i,sliceSize:a,dimSize:r,outputShape:o}}(r,o,n);return Le.runKernelFunc((function(e,t){var i=e.gather(r,o.flatten(),n);return t([o]),i}),{x:r,indices:o},(function(e,t){var o=t[0];return{x:function(){var t=r.shape,i=o.size,a=t.slice(0,n),s=a.length,u=t.slice(n,t.length).slice(1),c=u.length,l=fc(0,s),f=fc(s+1,s+1+c),d=dc([a,[i],u]),p=e.reshape(d),h=o.reshape([i]),v=dc([[s],l,f]),m=p.transpose(v),g=hc(m,h,r.shape[n]),y=un(v);return g.transpose(y)},indices:function(){return o}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),hc=dn({unsortedSegmentSum_:function(e,t,n){var r=Qt(e,"x","unsortedSegmentSum"),o=Qt(t,"segmentIds","unsortedSegmentSum","int32");return k(D(n),(function(){return"numSegments must be of dtype int"})),Le.runKernelFunc((function(e,t){var i=e.unsortedSegmentSum(r,o,n);return t([o]),i}),{$x:r},(function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=Vu(t,On(t)),r=pc(e,n),o=nc(t,yn(0,"int32")),i=r.rank-o.rank,a=0;a<i;++a)o=ir(o,a+1);o=Iu(o,In(r.shape,"bool"));var s=On(r);return Au(o,r,s)}(e,n)}}}))}}),vc=function(e,t,n){return s(this,void 0,void 0,(function(){var r,o,i,a,s,c,l,f,d,p,h,v,m;return u(this,(function(u){switch(u.label){case 0:for(r=Qt(e,"tensor","boolMask"),o=Qt(t,"mask","boolMask","bool"),i=null==n?0:n,a=o.rank,s=r.shape,k(a>0,(function(){return"mask cannot be scalar"})),I(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=i;l<i+a;l++)c*=s[l];return f=s.slice(0,i).concat([c],s.slice(i+a)),d=r.reshape(f),p=o.reshape([-1]),[4,Du(p)];case 1:return h=u.sent(),v=h.squeeze([1]),m=pc(d,v,i),e!==r&&r.dispose(),t!==o&&o.dispose(),v.dispose(),d.dispose(),p.dispose(),h.dispose(),[2,m]}}))}))};function mc(e,t,n,r,o,i,a){void 0===i&&(i="NHWC"),k(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),k(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),k(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),k(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===i?s[3]:s[1],f="NHWC"===i?u.shape[3]:u.shape[1];k(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),k(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."})),null!=a&&k(D(o),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var d=fo(i),p=no(s,n.shape,r,1,o,a,!1,d),h=Le.runKernelFunc((function(e,t){var r=e.conv2dDerInput(u,n,p);return t([n,u]),r}),{dy4D:u,filter:n},(function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return xc(e,n,r,o,i,1,a)},filter:function(){return Cc(e,s,n.shape,r,o,i,a)}}}));return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function gc(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],o=t[2];return 1===n&&1===r&&1===o}function yc(e,t,n,r,o){k(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var i=e,a=t,s=!1;4===t.rank&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=a.shape[4];k(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),k(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),k(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),k(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),k(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=ro(i,n.shape,r,1,o),f=Le.runKernelFunc((function(e){return e.conv3dDerInput(a,n,l)}),{dy5D:a});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var bc=dn({conv1d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NWC"),void 0===i&&(i=1);var s=Qt(e,"x","conv1d"),u=Qt(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),k(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),k(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&k(D(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),k(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),k(lo(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),k("NWC"===o,(function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."}));var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),p=xc(d,f,[1,n],r,"NHWC",[1,i],a);return l?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),xc=dn({conv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=Qt(e,"x","conv2d"),u=Qt(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),k(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),k(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&k(D(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var f="NHWC"===o?c.shape[3]:c.shape[1];k(f===u.shape[2],(function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."})),k(lo(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var d=fo(o),p=no(c.shape,u.shape,n,i,r,a,!1,d),h=[u,c],v=Le.runKernelFunc((function(e,t){var n=e.conv2d(c,u,p);return t([u,c]),n}),{x:c,filter:u},(function(e,t){var a=t,s=a[0],u=a[1];return k(co(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return Sc(u.shape,e,s,n,r,o)},filter:function(){return Cc(u,e,s.shape,n,r,o)}}}),"Conv2D",p,h);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),wc=dn({conv3d_:function(e,t,n,r,o,i){void 0===o&&(o="NDHWC"),void 0===i&&(i=[1,1,1]);var a=Qt(e,"x","conv3d"),s=Qt(t,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),k(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),k(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),k(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),k(function(e,t){return gc(e)||gc(t)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),k("NDHWC"===o,(function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."}));var l=ro(u.shape,s.shape,n,i,r),f=Le.runKernelFunc((function(e,t){var n=e.conv3d(u,s,l);return t([u,s]),n}),{x:u,$filter:s},(function(e,t){k(gc(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var o=t[0],a=t[1];return{x:function(){return yc(o.shape,e,a,n,r)},$filter:function(){return function(e,t,n,r,o){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var a=t;4===a.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),k(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),k(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),k(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),k(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),k(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=ro(i.shape,n,r,1,o);return Le.runKernelFunc((function(e){return e.conv3dDerFilter(i,a,s)}),{x5D:i,dy5D:a})}(o,e,a.shape,n,r)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Cc=dn({conv2dDerFilter_:function(e,t,n,r,o,i,a){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),k(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),k(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),k(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];k(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),k(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=a&&k(D(o),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var f=fo(i),d=no(s.shape,n,r,1,o,a,!1,f);return Le.runKernelFunc((function(e){return e.conv2dDerFilter(s,u,d)}),{x4D:s,dy4D:u})}}),Sc=dn({conv2dDerInput_:mc}),Ec=dn({depthwiseConv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=Qt(e,"x","depthwiseConv2d"),u=Qt(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),k(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),k(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),k(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),k(lo(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=a&&k(D(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var f=no(c.shape,u.shape,n,i,r,a,!0),d=[c,u],p=Le.runKernelFunc((function(e,t){var n=e.depthwiseConv2D(c,u,f);return t([c,u]),n}),{x:c,filter:u},(function(e,t){k(co(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=t[0],r=t[1];return{x:function(){return kc(n.shape,e,r,f)},filter:function(){return Ic(n,e,r.shape,f)}}}),"DepthwiseConv2dNative",f,d);return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),kc=dn({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;3===t.rank&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=Le.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(o,n,r)}),{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),Ic=dn({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;3===e.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Le.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(o,i,r)}),{x4D:o,dy4D:i})}}),_c=dn({separableConv2d_:function(e,t,n,r,o,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var s=Qt(e,"x","separableConv2d"),u=Qt(t,"depthwiseFilter","separableConv2d"),c=Qt(n,"pointwiseFilter","separableConv2d"),l=s,f=!1;if(3===s.rank&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");k(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),k(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),k(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),k(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),k(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var d=u.shape[2],p=u.shape[3];k(c.shape[2]===d*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*p+", but got "+c.shape[2]+"."}));var h=Ec(l,u,r,o,a,i),v=xc(h,c,1,"valid",a);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Rc=dn({conv2dTranspose_:function(e,t,n,r,o,i){return mc(n,Qt(e,"x","conv2dTranspose"),Qt(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),Tc=dn({conv3dTranspose_:function(e,t,n,r,o){return yc(n,Qt(e,"x","conv3dTranspose"),Qt(t,"filter","conv3dTranspose"),r,o)}}),Ac=dn({matMul_:function(e,t,n,r){var o;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Qt(e,"a","matMul"),a=Qt(t,"b","matMul");o=Fe(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],f=i.shape.slice(0,-2),d=a.shape.slice(0,-2),p=T(f),h=T(d);k(i.rank>=2&&a.rank>=2&&i.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."})),k(A(f,d),(function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."})),k(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=i.shape.slice(0,-2).concat([c,l]),m=n?i.as3D(p,s,c):i.as3D(p,c,s),g=r?a.as3D(h,l,u):a.as3D(h,u,l),y={transposeA:n,transposeB:r};return Le.runKernelFunc((function(e,t){var o=e.batchMatMul(m,g,n,r);return t([m,g]),o}),{a:m,b:g},(function(e,t){var o=t,i=o[0],a=o[1];return n||r?!n&&r?{a:function(){return e.matMul(a,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return a.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return a.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(a,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}}),"BatchMatMul",y).reshape(v)}}),Dc=dn({dot_:function(e,t){var n=Qt(e,"t1","dot"),r=Qt(t,"t2","dot");k(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var o=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return k(o===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),Oc=dn({outerProduct_:function(e,t){var n=Qt(e,"v1","outerProduct"),r=Qt(t,"v2","outerProduct");return k(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Fc=dn({reverse_:function(e,t){var n=Qt(e,"x","reverse");if(0===n.rank)return n.clone();var r=B(t,n.shape);return Le.runKernelFunc((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),Nc=dn({reverse1d_:function(e){var t=Qt(e,"x","reverse");return k(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),Fc(t,0)}}),Pc=dn({reverse2d_:function(e,t){var n=Qt(e,"x","reverse");return k(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),Fc(n,t)}}),Mc=dn({reverse3d_:function(e,t){var n=Qt(e,"x","reverse");return k(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),Fc(n,t)}}),Bc=dn({reverse4d_:function(e,t){var n=Qt(e,"x","reverse");return k(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),Fc(n,t)}});function Wc(e,t,n,r,o,i){var a=Qt(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),k(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),k(lo(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&k(D(o),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."}));var c=eo(s.shape,t,n,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&A(c.inShape,c.outShape))return a.clone();var l=[s],f=Le.runKernelFunc((function(e,t){var n=e.maxPool(s,c);return t([s,n]),n}),{x:s},(function(e,i){var a=i[0],s=i[1];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=Qt(e,"dy","maxPoolBackprop"),c=Qt(t,"input","maxPoolBackprop"),l=Qt(n,"output","maxPoolBackprop");k(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),k(lo(o,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"})),k(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),k(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."})),null!=s&&k(D(a),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var f=eo(c.shape,r,o,i,a,s);return Le.runKernelFunc((function(e){return e.maxPoolBackprop(u,c,l,f)}),{$dy:u,$input:c})}(e,a,s,t,n,r,o)}}}),"MaxPool",c,l);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function Lc(e,t,n,r,o,i){var a=Qt(e,"x","avgPool","float32");null==r&&(r=[1,1]),k(lo(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),k(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&k(D(o),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."}));var c=eo(s.shape,t,n,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&A(c.inShape,c.outShape))return a.clone();var l=Le.runKernelFunc((function(e){return e.avgPool(s,c)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,o,i){var a=Qt(e,"dy","avgPoolBackprop"),s=Qt(t,"input","avgPoolBackprop");k(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==o&&(o=[1,1]),k(lo(r,o),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"}));var u=s,c=a,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),k(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),k(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var f=eo(u.shape,n,r,o,i),d=Le.runKernelFunc((function(e){return e.avgPoolBackprop(c,u,f)}),{dy4D:c,input4D:u});return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(e,s,t,n,r,o)}}}),"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Vc=dn({maxPool_:function(e,t,n,r,o){return Wc(e,t,n,1,r,o)}}),zc=dn({avgPool_:function(e,t,n,r,o){return Lc(e,t,n,1,r,o)}}),Uc=dn({pool_:function(e,t,n,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var a=Qt(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),k(lo(i,o),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"}));var c,l=eo(s.shape,t,i,o,r),f=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),o=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],o[t]]}))}([l.filterHeight,l.filterWidth],f):[[0,0],[0,0]];var d=1===f[0]&&1===f[1],p=function(e,t,n){var r=n.map((function(e){return e[0]})),o=n.map((function(e){return e[1]})),i=e.concat(r,o),a=t.map((function(e,t){return(e-i[t]%e)%e})),s=o.map((function(e,t){return e+a[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,a[t]]}));return[u,c]}([l.inHeight,l.inWidth],f,c),h=p[0],v=p[1],m=d?r:"valid",g=d?s:br(s,f,h),y=("avg"===n?function(){return Lc(g,t,i,1,m)}:function(){return Wc(g,t,i,1,m)})(),b=d?y:Qn(y,f,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Hc=dn({maxPool3d_:function(e,t,n,r,o,i,a){void 0===i&&(i="NDHWC");var s=Qt(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),k(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),k("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),k(lo(n,a),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&k(D(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var l=to(u.shape,t,n,a,r,o,i),f=Le.runKernelFunc((function(e,t){var n=e.maxPool3d(u,l);return t([u,n]),n}),{x:u},(function(e,i){var s=i[0],u=i[1];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=Qt(e,"dy","maxPool3dBackprop"),c=Qt(t,"input","maxPool3dBackprop"),l=Qt(n,"output","maxPool3dBackprop"),f=u,d=c,p=l,h=!1;4===c.rank&&(h=!0,f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),d=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),p=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),k(5===f.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+f.rank+"."})),k(5===d.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."})),k(5===p.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+p.rank+"."})),null==i&&(i=[1,1,1]),k(lo(o,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"})),null!=s&&k(D(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var v=to(d.shape,r,o,i,a,s),m=Le.runKernelFunc((function(e){return e.maxPool3dBackprop(f,d,p,v)}),{dy5D:f,input5D:d});return h?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(e,s,u,t,n,a,r,o)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),jc=dn({avgPool3d_:function(e,t,n,r,o,i,a){void 0===i&&(i="NDHWC");var s=Qt(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),k(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),k("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),k(lo(n,a),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&k(D(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var l=to(u.shape,t,n,a,r,o,i),f=Le.runKernelFunc((function(e){return e.avgPool3d(u,l)}),{x:u},(function(e){return{x:function(){return function(e,t,n,r,o,i,a){var s=Qt(e,"dy","avgPool3dBackprop"),u=Qt(t,"input","avgPool3dBackprop"),c=s,l=u,f=!1;4===u.rank&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),k(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),k(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==o&&(o=[1,1,1]),k(lo(r,o),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"})),null!=a&&k(D(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var d=to(l.shape,n,r,o,i,a),p=Le.runKernelFunc((function(e){return e.avgPool3dBackprop(c,l,d)}),{dy5D:c,input5D:l});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}(e,u,t,n,a,r,o)}}}));return f=f.cast(u.dtype),c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Gc=dn({slice_:function(e,t,n){var r,o,i=Qt(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(e){k(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(k(-1===e,(function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."})),i.shape[t]-r[t])})),Br(i,r,o);var a=i.shape,s={begin:r,size:o};return Le.runKernelFunc((function(e){return e.slice(i,r,o)}),{x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],a[n]-r[n]-o[n]]);return{x:function(){return e.pad(t)}}}),"Slice",s)}}),qc=dn({slice1d_:function(e,t,n){var r=Qt(e,"x","slice1d");return k(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Gc(r,[t],[n])}}),$c=dn({slice2d_:function(e,t,n){var r=Qt(e,"x","slice2d");return k(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Gc(r,t,n)}}),Kc=dn({slice3d_:function(e,t,n){var r=Qt(e,"x","slice3d");return k(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Gc(r,t,n)}}),Xc=dn({slice4d_:function(e,t,n){var r=Qt(e,"x","slice4d");return k(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Gc(r,t,n)}});function Yc(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(on(t.shape,r))),e.rank<n.rank&&(e=e.reshape(on(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==o?r:r.transpose(o)}}}var Jc=dn({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","all","bool"),o=B(t,r.shape),i=o,a=sn(i,r.rank);null!=a&&(r=r.transpose(a),i=cn(i.length,r.rank));var s=Le.runKernelFunc((function(e){return e.all(r,i)}),{$x:r});if(n){var u=on(s.shape,o);return s.reshape(u)}return s}}),Zc=dn({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","any","bool"),o=B(t,r.shape),i=o,a=sn(i,r.rank);null!=a&&(r=r.transpose(a),i=cn(i.length,r.rank));var s=Le.runKernelFunc((function(e){return e.any(r,i)}),{$x:r});if(n){var u=on(s.shape,o);return s.reshape(u)}return s}}),Qc=dn({argMax_:function(e,t){void 0===t&&(t=0);var n=Qt(e,"x","argMax");null==t&&(t=0);var r=B(t,n.shape),o=sn(r,n.rank);null!=o&&(n=n.transpose(o),r=cn(r.length,n.rank));var i={axis:r[0]},a=[n];return Le.runKernelFunc((function(e,t){var o=e.argMax(n,r[0]);return t([n]),o}),{x:n},(function(e,t){var n=t[0];return{x:function(){return On(n)}}}),"ArgMax",i,a)}}),el=dn({argMin_:function(e,t){void 0===t&&(t=0);var n=Qt(e,"x","argMin");null==t&&(t=0);var r=B(t,n.shape),o=sn(r,n.rank);return null!=o&&(n=n.transpose(o),r=cn(r.length,n.rank)),Le.runKernelFunc((function(e,t){var o=e.argMin(n,r[0]);return t([n]),o}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return On(n)}}}))}}),tl=dn({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","logSumExp"),o=B(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=on(s.shape,o);return s.reshape(u)}return s}}),nl=dn({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","max"),o=r,i=B(t,r.shape),a=i,s=sn(a,r.rank);null!=s&&(r=r.transpose(s),a=cn(a.length,r.rank));var u=[r],c=Le.runKernelFunc((function(e,t){var n=e.max(r,a);return t([o,n]),n}),{x:r},(function(e,t){return Yc(e,t[1],t[0],i,s)}),"Max",{axes:a},u,[!0]);if(n){var l=on(c.shape,i);c=c.reshape(l)}return c}}),rl=dn({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","mean"),o=B(t,r.shape),i=T(rn(r.shape,o)[1]);return Gr((function(e){var r=yn(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(In(e.shape,"float32")).div(i)}}}))(r)}}),ol=dn({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","min"),o=r,i=B(t,r.shape),a=i,s=sn(a,r.rank);null!=s&&(r=r.transpose(s),a=cn(a.length,r.rank));var u=[r],c=Le.runKernelFunc((function(e,t){var n=e.min(r,a);return t([o,n]),n}),{x:r},(function(e,t){return Yc(e,t[1],t[0],i,s)}),"Min",{axes:a},u,[!0]);if(n){var l=on(c.shape,i);c=c.reshape(l)}return c}}),il=dn({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=B(t,(e=Qt(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=on(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),al=dn({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=B(t,r.shape);return Gr((function(e){var t=sn(o,e.rank),r=o,i=e;null!=t&&(i=e.transpose(t),r=cn(r.length,e.rank));var a=function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(In(e.shape,"float32"))},s={axes:r},u=Le.runKernelFunc((function(e){return e.sum(i,r)}),{x:i},(function(e){return{x:function(){return a(e)}}}),"Sum",s);if(n){var c=on(u.shape,o);u=u.reshape(c)}return{value:u,gradFunc:a}}))(r)}}),sl=dn({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Qt(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=B(t,r.shape),i=sn(o,r.rank),a=o,s=r;null!=i&&(s=r.transpose(i),a=cn(a.length,r.rank));var u=Le.runKernelFunc((function(e){return e.prod(s,a)}),{permutedX:s});if(n){var c=on(u.shape,o);u=u.reshape(c)}return u}}),ul=dn({elu_:function(e){var t=Qt(e,"x","elu");return Le.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return Le.runKernelFunc((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),cl=dn({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=Qt(e,"x","leakyRelu");return Vu(yn(t).mul(n),n)}}),ll=dn({prelu_:function(e,t){var n=Qt(e,"x","prelu"),r=Qt(t,"alpha","prelu");return Le.runKernelFunc((function(e,t){var o=e.prelu(n,r);return t([n,r]),o}),{x:n,alpha:r},(function(e,t){var n=t[0],r=t[1],o=n.greater(0);return{x:function(){return Au(o,e,e.mul(r))},alpha:function(){var t=Au(o,On(e),e.mul(n)),i=Zr(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}}),"Prelu")}}),fl=dn({relu_:function(e){var t=Qt(e,"x","relu");return"bool"===t.dtype?t.toInt():Le.runKernelFunc((function(e,n){var r=e.relu(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}}),"Relu")}}),dl=dn({relu6_:function(e){var t=Qt(e,"x","relu6");return"bool"===t.dtype?t.toInt():Le.runKernelFunc((function(e,n){var r=e.relu6(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}}),"Relu6")}}),pl=dn({selu_:function(e){var t=Qt(e,"x","selu");return Le.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){var t=n.greater(yn(0)),r=yn(Xa),o=yn(Ya),i=e.mul(o),a=e.mul(r).mul(n.toFloat().exp());return Au(t,i,a)}}}))}}),hl=dn({transpose_:function(e,t){var n=Qt(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),k(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."})),t.forEach((function(e){k(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1)return n.clone();var r={perm:t};return Le.runKernelFunc((function(e){return e.transpose(n,t)}),{x:n},(function(e){var n=un(t);return{x:function(){return e.transpose(n)}}}),"Transpose",r)}}),vl=dn({localResponseNormalization_:function(e,t,n,r,o){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=Qt(e,"x","localResponseNormalization");k(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),k(D(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var a=i,s=!1;3===i.rank&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=Le.runKernelFunc((function(e,i){var s=e.localResponseNormalization4D(a,t,n,r,o);return i([a,s]),s}),{x4D:a},(function(e,i){var a=i[0],s=i[1];return{x4D:function(){return Le.runKernelFunc((function(i){return i.LRNGrad(e,a,s,t,n,r,o)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),ml=dn({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var o=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(yn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=Qt(e,"x","norm"),t,n),i=o.shape;if(r){var a=B(n,e.shape);i=on(o.shape,a)}return o.reshape(i)}}),gl=dn({basicLSTMCell_:function(e,t,n,r,o,i){var a=Qt(e,"forgetBias","basicLSTMCell"),s=Qt(t,"lstmKernel","basicLSTMCell"),u=Qt(n,"lstmBias","basicLSTMCell"),c=Qt(r,"data","basicLSTMCell"),l=Qt(o,"c","basicLSTMCell"),f=Qt(i,"h","basicLSTMCell"),d=c.concat(f,1).matMul(s).add(u),p=d.shape[0],h=d.shape[1]/4,v=[p,h],m=d.slice([0,0],v),g=d.slice([0,h],v),y=d.slice([0,2*h],v),b=d.slice([0,3*h],v),x=m.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(a.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),yl=dn({multiRNNCell_:function(e,t,n,r){for(var o=Qt(t,"data","multiRNNCell"),i=en(n,"c","multiRNNCell"),a=en(r,"h","multiRNNCell"),s=o,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var f=[],d=[];for(c=0;c<u.length;c+=2)f.push(u[c]),d.push(u[c+1]);return[f,d]}}),bl=dn({movingAverage_:function(e,t,n,r,o){void 0===o&&(o=!0);var i=Qt(e,"v","movingAverage"),a=Qt(t,"x","movingAverage"),s=Qt(n,"decay","movingAverage");Ne(i,a),k(A(i.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=yn(1),c=u.sub(s),l=a.sub(i).mul(c);if(o){k(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=Qt(r,"step","movingAverage");l=l.div(u.sub(Ku(s,f)))}return i.add(l)}}),xl=dn({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var c=Qt(e,"x","stridedSlice"),l=Wr(s),f=c.shape.slice();l.forEach((function(e){t[e]=0,n[e]=1,f.splice(e,0,1)})),c=c.reshape(f);for(var d=0;d<c.rank;d++)t[d]=Vr(o,t,r,c.shape,d),n[d]=zr(i,n,r,c.shape,d),r[d]=r[d]||1;var p=Wr(u);p.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var h=Lr(t,n,r),v=h.filter((function(e,t){return-1===p.indexOf(t)}));return r.every((function(e){return 1===e}))?Gc(c,t,h).reshape(v):Le.runKernelFunc((function(e){return e.stridedSlice(c,t,n,r)}),{$x:c}).reshape(v)}}),wl=dn({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=Qt(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=Le.runKernelFunc((function(e){return e.topk(r,t,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),Cl=dn({scatterND_:function(e,t,n){var r=Qt(e,"indices","scatterND","int32"),o=Qt(t,"updates","scatterND");return Pr(o,r,n),Le.runKernelFunc((function(e){return e.scatterND(r,o,n)}),{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Sl=dn({fft_:function(e){k("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Le.runKernelFunc((function(e){return e.fft(r)}),{input:e}).reshape(e.shape)}}),El=dn({ifft_:function(e){k("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Le.runKernelFunc((function(e){return e.ifft(r)}),{input:e}).reshape(e.shape)}}),kl=dn({rfft_:function(e,t){k("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,r=e.shape[e.shape.length-1],o=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),a=e.shape.map((function(e){return e}));a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(_n(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=pn(n,u).as2D(o,r),l=Sl(c),f=Math.floor(r/2)+1,d=hn(l),p=vn(l),h=d.split([f,r-f],d.shape.length-1),v=p.split([f,r-f],p.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,pn(h[0],v[0]).reshape(m)}}),Il=dn({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=El(r);return hn(o)}var i=[n,2*(t-1)],a=hn(e).as2D(n,t),s=vn(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(yn(-1)),l=a.concat(u,1),f=s.concat(c,1);return r=pn(l,f).as2D(i[0],i[1]),o=El(r),hn(o)}}),_l=Object.freeze({fft:Sl,ifft:El,rfft:kl,irfft:Il}),Rl=dn({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var o=Qt(e,"sparseIndices","sparseToDense","int32"),i=Qt(t,"sparseValues","sparseToDense"),a=Qt(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var o=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var a=t.size;if(0!==t.rank&&(1!==t.rank||a!==o))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+o+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),Le.runKernelFunc((function(e){return e.sparseToDense(o,i,n,a)}),{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),Tl=dn({gatherND_:function(e,t){var n=Qt(t,"indices","gatherND","int32"),r=Qt(e,"x","gatherND");return Le.runKernelFunc((function(e){return e.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),Al=dn({diag_:function(e){var t=Qt(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return Le.runKernelFunc((function(e){return e.diag(t)}),{$x:t}).reshape(n)}}),Dl=dn({dropout_:function(e,t,n,r){var o=Qt(e,"x","dropout");if(k("float32"===o.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."})),k(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),0===t)return e instanceof Se?o.clone():o;var i=function(e,t){if(null==t)return e.shape.slice();if(A(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(o,n),a=1-t,s=gr(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function Ol(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return bn(o,"float32")}var Fl,Nl=dn({hannWindow_:function(e){return Ol(e,.5,.5)}}),Pl=dn({hammingWindow_:function(e){return Ol(e,.54,.46)}}),Ml=dn({frame_:function(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Gc(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Fn([Gc(e,i,t-s),Rn([s],o)]);a.push(u),i+=n}return 0===a.length?xn([],[0,t]):Fn(a).as2D(a.length,t)}}),Bl=dn({stft_:function(e,t,n,r,o){var i;void 0===o&&(o=Nl),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=Ml(e,t,n),s=qu(a,o(t)),u=[],c=0;c<a.shape[0];c++)u.push(kl(s.slice([c,0],[1,t]),r));return Fn(u)}}),Wl=Object.freeze({hannWindow:Nl,hammingWindow:Pl,frame:Ml,stft:Bl}),Ll=function(e,t,n){return void 0===n&&(n=1),s(this,void 0,void 0,(function(){var r,o,i,a,s,c,l,f,d,p,h,v,m,g;return u(this,(function(u){switch(u.label){case 0:return r=Qt(e,"predictions","inTopK"),o=Qt(t,"targets","inTopK"),k(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),k(r.rank-1===o.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank})),I(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],k(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return a=u.sent(),[4,o.data()];case 2:for(s=u.sent(),c=[a.length/i,i],f=c[1],d=L("bool",l=c[0]),p=0;p<l;p++){for(h=p*f,v=a.subarray(h,h+f),m=[],g=0;g<v.length;g++)m.push({value:v[g],index:g});for(m.sort((function(e,t){return t.value-e.value})),d[p]=0,g=0;g<n;g++)if(m[g].index===s[p]){d[p]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,mn(d,o.shape,"bool")]}}))}))};!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Fl||(Fl={}));var Vl=dn({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=Fl.SUM_BY_NONZERO_WEIGHTS);var o=Qt(e,"labels","absoluteDifference"),i=Qt(t,"predictions","absoluteDifference"),a=null;null!=n&&(a=Qt(n,"weights","absoluteDifference")),I(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return zl(s,a,r)}}),zl=dn({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=Fl.SUM_BY_NONZERO_WEIGHTS);var r=Qt(e,"losses","computeWeightedLoss"),o=null;null!=t&&(o=Qt(t,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(n===Fl.NONE)return i;if(n===Fl.SUM)return i.sum();if(n===Fl.MEAN){if(null==o)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(yn(a)):s}if(n===Fl.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(yn(r.size));var u=o.mul(In(r.shape)).notEqual(yn(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Ul=dn({cosineDistance_:function(e,t,n,r,o){void 0===o&&(o=Fl.SUM_BY_NONZERO_WEIGHTS);var i=Qt(e,"labels","cosineDistance"),a=Qt(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Qt(r,"weights","cosineDistance")),I(i.shape,a.shape,"Error in cosineDistance: ");var u=yn(1).sub(i.mul(a).sum(n,!0));return zl(u,s,o)}}),Hl=dn({hingeLoss_:function(e,t,n,r){void 0===r&&(r=Fl.SUM_BY_NONZERO_WEIGHTS);var o=Qt(e,"labels","hingeLoss"),i=Qt(t,"predictions","hingeLoss"),a=null;null!=n&&(a=Qt(n,"weights","hingeLoss")),I(o.shape,i.shape,"Error in hingeLoss: ");var s=yn(1);o=yn(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return zl(u,a,r)}}),jl=dn({huberLoss_:function(e,t,n,r,o){void 0===r&&(r=1),void 0===o&&(o=Fl.SUM_BY_NONZERO_WEIGHTS);var i=Qt(e,"labels","huberLoss"),a=Qt(t,"predictions","huberLoss"),s=null;null!=n&&(s=Qt(n,"weights","huberLoss")),I(i.shape,a.shape,"Error in huberLoss: ");var u=yn(r),c=a.sub(i).abs(),l=Uu(c,u),f=c.sub(l),d=yn(.5).mul(l.square()).add(u.mul(f));return zl(d,s,o)}}),Gl=dn({logLoss_:function(e,t,n,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=Fl.SUM_BY_NONZERO_WEIGHTS);var i=Qt(e,"labels","logLoss"),a=Qt(t,"predictions","logLoss"),s=null;null!=n&&(s=Qt(n,"weights","logLoss")),I(i.shape,a.shape,"Error in logLoss: ");var u=yn(1),c=yn(r),l=i.mul(a.add(c).log()).neg().sub(u.sub(i).mul(u.sub(a).add(c).log()));return zl(l,s,o)}}),ql=dn({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=Fl.SUM_BY_NONZERO_WEIGHTS);var o=Qt(e,"labels","meanSquaredError"),i=Qt(t,"predictions","meanSquaredError"),a=null;null!=n&&(a=Qt(n,"weights","meanSquaredError")),I(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return zl(s,a,r)}}),$l=dn({sigmoidCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=Fl.SUM_BY_NONZERO_WEIGHTS);var i=Qt(e,"multiClassLabels","sigmoidCrossEntropy"),a=Qt(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Qt(n,"weights","sigmoidCrossEntropy")),I(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=yn(r),c=yn(1),l=yn(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var f=function(e,t){var n=Qt(e,"labels","sigmoidCrossEntropyWithLogits"),r=Qt(t,"logits","sigmoidCrossEntropyWithLogits");I(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=r.relu(),i=r.mul(n),a=r.abs().neg().exp().log1p();return o.sub(i).add(a)}(i,a);return zl(f,s,o)}}),Kl=dn({softmaxCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=Fl.SUM_BY_NONZERO_WEIGHTS);var i=Qt(e,"onehotLabels","softmaxCrossEntropy"),a=Qt(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Qt(n,"weights","softmaxCrossEntropy")),I(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=yn(r),c=yn(1),l=yn(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var f=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return Gr((function(e,t,r){var o=t.logSumExp([n],!0),i=t.toFloat().sub(o);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],o=t[1],i=on(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(o.exp())),e.reshape(i).mul(o.exp().sub(r.toFloat()))]}}}))(e,t)}(i,a);return zl(f,s,o)}}),Xl=Object.freeze({get Reduction(){return Fl},absoluteDifference:Vl,computeWeightedLoss:zl,cosineDistance:Ul,hingeLoss:Hl,huberLoss:jl,logLoss:Gl,meanSquaredError:ql,sigmoidCrossEntropy:$l,softmaxCrossEntropy:Kl});function Yl(e,t){return void 0===t&&(t=!1),Le.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=ar(n),i=e.clone(),a=xn([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(e){var t,u=i,c=s,l=o;t=Le.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),c=i.slice([e,e],[1,1]),l=xn([[-1]]).where(c.greater(0),xn([[1]])),f=c.sub(l.mul(u)),d=t.div(f);s=1===d.shape[0]?a.clone():a.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var p=l.matMul(f).div(u).neg(),h=i.slice([e,0],[n-e,r]),v=p.mul(s);if(0===e)i=h.sub(v.matMul(s.transpose().matMul(h)));else{var m=h.sub(v.matMul(s.transpose().matMul(h)));i=i.slice([0,0],[e,r]).concat(m,0)}var g=o.slice([0,e],[n,o.shape[1]-e]);if(0===e)o=g.sub(g.matMul(s).matMul(v.transpose()));else{var y=g.sub(g.matMul(s).matMul(v.transpose()));o=o.slice([0,0],[n,e]).concat(y,1)}return[s,i,o]})),s=t[0],i=t[1],o=t[2],Kt([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]}))}var Jl=dn({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Qt(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=An(0,a,1,"int32").reshape([-1,1]),c=An(0,s,1,"int32"),l=Ju(u,c),f=Iu(l.lessEqual(yn(+t,"int32")),l.greaterEqual(yn(-n,"int32"))),d=_n([a,s],r.dtype);return wr(Er(r.reshape([-1,a,s])).map((function(e){return Au(f,e,d)}))).reshape(o)}}),Zl=dn({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,k(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){k(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"}))},o=1;o<e.length;++o)r(o)}else t=!0,e=Wn(e,e.shape[0],0).map((function(e){return xr(e,[0])}));k(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."}));var i=[],a=e,s=function(e){i.push(Le.tidy((function(){var t=a[e];if(e>0)for(var n=0;n<e;++n){var r=al(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(ml(t,"euclidean"))})))};for(o=0;o<e.length;++o)s(o);return t?wr(i,0):i}}),Ql=dn({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return Yl(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Er(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach((function(e){var n=Yl(e,t),r=n[0],a=n[1];o.push(r),i.push(a)})),[wr(o,0).reshape(e.shape),wr(i,0).reshape(e.shape)]}}),ef=Object.freeze({bandPart:Jl,gramSchmidt:Zl,qr:Ql});function tf(e,t,n,r,o,i){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==i&&(i=0);var a=e.shape[0];return n=Math.min(n,a),k(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),k(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"})),k(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),k(1===t.rank,(function(){return"scores must be a 1D tensor"})),k(t.shape[0]===a,(function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]})),k(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var nf=dn({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=Qt(e,"images","resizeBilinear");k(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),k(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=Le.runKernelFunc((function(e,t){return t([o]),e.resizeBilinear(o,a,s,n)}),{x:o},(function(e,t){return{x:function(){return Le.runKernelFunc((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),rf=dn({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=Qt(e,"images","resizeNearestNeighbor");k(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),k(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),k("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=Le.runKernelFunc((function(e,t){return t([o]),e.resizeNearestNeighbor(o,a,s,n)}),{batchImages:o},(function(e,t){return{batchImages:function(){return Le.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),of=dn({nonMaxSuppression_:function(e,t,n,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=Qt(e,"boxes","nonMaxSuppression"),a=Qt(t,"scores","nonMaxSuppression"),s=tf(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return Le.runKernelFunc((function(e){return e.nonMaxSuppression(i,a,n,r,o)}),{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),af=function(e,t,n,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),s(this,void 0,void 0,(function(){var i,a,s,c,l,f,d;return u(this,(function(u){switch(u.label){case 0:return i=Qt(e,"boxes","nonMaxSuppressionAsync"),a=Qt(t,"scores","nonMaxSuppressionAsync"),s=tf(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return c=u.sent(),l=c[0],f=c[1],d=Co(l,f,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,d]}}))}))},sf=dn({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var a=Qt(e,"boxes","nonMaxSuppression"),s=Qt(t,"scores","nonMaxSuppression"),u=tf(a,s,n,r,o,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=Le.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),uf=function(e,t,n,r,o,i){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),s(this,void 0,void 0,(function(){var a,s,c,l,f,d,p;return u(this,(function(u){switch(u.label){case 0:return a=Qt(e,"boxes","nonMaxSuppressionAsync"),s=Qt(t,"scores","nonMaxSuppressionAsync"),c=tf(a,s,n,r,o,i),n=c.maxOutputSize,r=c.iouThreshold,o=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=u.sent(),f=l[0],d=l[1],p=So(f,d,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,p]}}))}))},cf=dn({cropAndResize_:function(e,t,n,r,o,i){var a=Qt(e,"image","cropAndResize"),s=Qt(t,"boxes","cropAndResize","float32"),u=Qt(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var c=s.shape[0];return k(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),k(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),k(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),k(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),k(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),k("bilinear"===o||"nearest"===o,(function(){return"method must be bilinear or nearest, but was "+o})),Le.runKernelFunc((function(e,t){return e.cropAndResize(a,s,u,r,o,i)}),{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),lf=Object.freeze({resizeBilinear:nf,resizeNearestNeighbor:rf,nonMaxSuppression:of,nonMaxSuppressionAsync:af,nonMaxSuppressionWithScore:sf,nonMaxSuppressionWithScoreAsync:uf,cropAndResize:cf}),ff=function(e,t){return!(e>0)||"linear"===t},df=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},pf=function(e,t){var n=t,r=Zr(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},hf=function(e,t,n){if("linear"===t)return e;if("relu"===t)return fl(e);if("elu"===t)return ul(e);if("relu6"===t)return dl(e);if("prelu"===t)return ll(e,n);throw new Error("Unknown fused activation "+t+".")},vf=dn({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=void 0!==o&&o,a=e.transposeB,s=void 0!==a&&a,u=e.bias,c=e.activation,l=void 0===c?"linear":c,f=e.preluActivationWeights;if(!1===ff(Le.state.gradientDepth,l)){var d=Ac(n,r,i,s);return null!=u&&(d=Ou(d,u)),hf(d,l,f)}var p=Qt(n,"a","fused matMul"),h=Qt(r,"b","fused matMul");t=Fe(p,h),p=t[0],h=t[1];var v=i?p.shape[p.rank-2]:p.shape[p.rank-1],m=s?h.shape[h.rank-1]:h.shape[h.rank-2],g=i?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?h.shape[h.rank-2]:h.shape[h.rank-1],b=p.shape.slice(0,-2),x=h.shape.slice(0,-2),w=T(b),C=T(x);k(p.rank>=2&&h.rank>=2&&p.rank===h.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+h.rank+"."})),k(A(b,x),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+h.shape+" must match."})),k(v===m,(function(){return"Error in fused matMul: inner shapes ("+v+") and ("+m+") of Tensors with shapes "+p.shape+" and "+h.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var S,E,I=p.shape.slice(0,-2).concat([g,y]),_=i?p.as3D(w,v,g):p.as3D(w,g,v),R=s?h.as3D(C,y,m):h.as3D(C,m,y);null!=u&&Qr(I,(S=Fe(S=Qt(u,"bias","fused matMul"),p)[0]).shape),null!=f&&(E=Qt(f,"prelu weights","fused matMul"));var D={a:_,b:R};null!=u&&(D.bias=S),null!=f&&(D.preluActivationWeights=E);var O=[_,R];return Le.runKernelFunc((function(e,t){var n=e.fusedBatchMatMul({a:_,b:R,transposeA:i,transposeB:s,bias:S,activation:l,preluActivationWeights:E});return t([_,R,n]),n}),D,(function(e,t){var n=t[0],r=t[1],o=t[2],a=df(e,o,l),c={};return null!=u&&(c={bias:function(){return pf(S,a)}}),i||s?!i&&s?Object.assign({a:function(){return a.matMul(r,!1,!1)},b:function(){return a.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(a,!1,!0)},b:function(){return n.matMul(a,!1,!1)}},c):Object.assign({a:function(){return r.matMul(a,!0,!0)},b:function(){return a.matMul(n,!0,!0)}},c):Object.assign({a:function(){return a.matMul(r,!1,!0)},b:function(){return n.matMul(a,!0,!1)}},c)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},O,[!0]).reshape(I)}}),mf=dn({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights;if(d=d||"linear",!1===ff(Le.state.gradientDepth,d)){var h=xc(t,n,r,o,a,u,c);return null!=l&&(h=Ou(h,l)),hf(h,d,p)}var v=Qt(t,"x","conv2d"),m=Qt(n,"filter","conv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),k(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),k(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=c&&k(D(o),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."})),k(g.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),k(lo(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),k("NHWC"===a,(function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."}));var b,x,w=no(g.shape,m.shape,r,u,o,c);null!=l&&(b=Fe(b=Qt(l,"bias","fused conv2d"),v)[0],Qr(w.outShape,b.shape)),null!=p&&(x=Qt(p,"prelu weights","fused conv2d"));var C={x:g,filter:m};null!=l&&(C.bias=b),null!=p&&(C.preluActivationWeights=x);var S=[m,g],E=Le.runKernelFunc((function(e,t){var n=e.fusedConv2d({input:g,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return t([m,g,n]),n}),C,(function(e,t){var n=t,i=n[0],a=n[1],s=n[2],c=df(e,s,d);k(co(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var f={};return null!=l&&(f={bias:function(){return pf(b,c)}}),Object.assign({x:function(){return Sc(a.shape,c,i,r,o)},filter:function(){return Cc(a,c,i.shape,r,o)}},f)}),"FusedConv2D",{convInfo:w,activation:d},S,[!0]);return y?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),gf=dn({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights;if(!1===ff(Le.state.gradientDepth,d)){var h=Ec(t,n,r,o,a,u,c);return null!=l&&(h=Ou(h,l)),hf(h,d,p)}var v=Qt(t,"x","depthwiseConv2d"),m=Qt(n,"filter","depthwiseConv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),k(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),k(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."})),k(g.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."})),null==u&&(u=[1,1]),k(lo(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&k(D(o),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+o+"."}));var b,x,w=no(g.shape,m.shape,r,u,o,c,!0);null!=l&&(b=Fe(b=Qt(l,"bias","fused conv2d"),v)[0],Qr(w.outShape,b.shape)),null!=p&&(x=Qt(p,"prelu weights","fused depthwiseConv2d"));var C={x:g,filter:m};null!=l&&(C.bias=b),null!=p&&(C.preluActivationWeights=x);var S=[m,g],E=Le.runKernelFunc((function(e,t){var n=e.fusedDepthwiseConv2D({input:g,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return t([m,g,n]),n}),C,(function(e,t){k(co(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=t[0],r=t[1],o=t[2],i=df(e,o,d),a={};return null!=l&&(a={bias:function(){return pf(b,i)}}),Object.assign({x:function(){return kc(r.shape,i,n,w)},filter:function(){return Ic(r,i,n.shape,w)}},a)}),"FusedDepthwiseConv2D",{convInfo:w,activation:d},S,[!0]);return y?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),yf=Object.freeze({matMul:vf,conv2d:mf,depthwiseConv2d:gf}),bf=Object.freeze({image:lf,linalg:ef,losses:Xl,spectral:_l,fused:yf,signal:Wl,square:Ts,squaredDifference:Ds,conv1d:bc,conv2d:xc,conv3d:wc,depthwiseConv2d:Ec,separableConv2d:_c,conv2dTranspose:Rc,conv3dTranspose:Tc,op:dn,batchNormalization2d:yu,batchNormalization3d:bu,batchNormalization4d:xu,batchNormalization:wu,batchNorm:Cu,batchNorm2d:Su,batchNorm3d:Eu,batchNorm4d:ku,booleanMaskAsync:vc,complex:pn,real:hn,imag:vn,concat:Fn,concat1d:Nn,concat2d:Pn,concat3d:Mn,concat4d:Bn,split:Wn,matMul:Ac,dot:Dc,outerProduct:Oc,reverse:Fc,reverse1d:Nc,reverse2d:Pc,reverse3d:Mc,reverse4d:Bc,maxPool:Vc,avgPool:zc,pool:Uc,maxPool3d:Hc,avgPool3d:jc,slice:Gc,slice1d:qc,slice2d:$c,slice3d:Kc,slice4d:Xc,abs:Os,acos:Fs,acosh:Ns,asin:Ps,asinh:Ms,atan:Bs,atanh:Ws,ceil:Ls,clipByValue:Vs,cos:zs,cosh:Us,erf:Hs,exp:js,expm1:Gs,floor:qs,log:$s,log1p:Ks,logSigmoid:Xs,neg:Ys,reciprocal:Js,round:Zs,rsqrt:Qs,sigmoid:eu,sign:tu,isNaN:nu,isInf:ru,isFinite:ou,sin:iu,sinh:au,softplus:su,sqrt:uu,step:cu,tan:lu,tanh:fu,all:Jc,any:Zc,argMax:Qc,argMin:el,logSumExp:tl,max:nl,mean:rl,min:ol,moments:il,sum:al,prod:sl,equal:Qu,equalStrict:ec,greater:tc,greaterEqual:nc,greaterEqualStrict:rc,greaterStrict:oc,less:ic,lessEqual:ac,lessEqualStrict:sc,lessStrict:uc,notEqual:cc,notEqualStrict:lc,add:Ou,addN:Fu,addStrict:Nu,atan2:Pu,div:Mu,divNoNan:Bu,divStrict:Wu,floorDiv:Lu,maximum:Vu,maximumStrict:zu,minimum:Uu,minimumStrict:Hu,mod:ju,modStrict:Gu,mul:qu,mulStrict:$u,pow:Ku,powStrict:Xu,squaredDifferenceStrict:Yu,sub:Ju,subStrict:Zu,elu:ul,leakyRelu:cl,prelu:ll,relu:fl,relu6:dl,selu:pl,logicalAnd:Iu,logicalNot:_u,logicalOr:Ru,logicalXor:Tu,where:Au,whereAsync:Du,buffer:Jn,print:Zn,batchToSpaceND:Qn,broadcastTo:er,cast:tr,clone:nr,cumsum:rr,depthToSpace:or,expandDims:ir,eye:ar,multinomial:sr,oneHot:ur,pad:cr,pad1d:lr,pad2d:fr,pad3d:dr,pad4d:pr,rand:hr,randomNormal:vr,randomGamma:mr,randomUniform:gr,reshape:yr,spaceToBatchND:br,squeeze:xr,stack:wr,tile:Cr,truncatedNormal:Sr,unstack:Er,setdiff1dAsync:kr,fill:Rn,linspace:Tn,ones:In,range:An,scalar:yn,tensor:mn,tensor1d:bn,tensor2d:xn,tensor3d:wn,tensor4d:Cn,tensor5d:Sn,tensor6d:En,variable:kn,zeros:_n,onesLike:Dn,zerosLike:On,transpose:hl,softmax:qr,logSoftmax:$r,localResponseNormalization:vl,norm:ml,gather:pc,unsortedSegmentSum:hc,basicLSTMCell:gl,multiRNNCell:yl,movingAverage:bl,stridedSlice:xl,topk:wl,scatterND:Cl,fft:Sl,ifft:El,rfft:kl,irfft:Il,sparseToDense:Rl,gatherND:Tl,diag:Al,dropout:Dl,hannWindow:Nl,hammingWindow:Pl,frame:Ml,stft:Bl,inTopKAsync:Ll});function xf(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&k("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors."}))}))}function wf(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Cf=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new Kr(t,Le),t}return a(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,f().get("IS_NODE")&&Yt("\n============================\nHi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?mo(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return se(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Jn(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return Le.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return t=oe(),e(),[2,{kernelMs:oe()-t}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Le.keep(e.clone()),imag:Le.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(xf(e,"slice"),Ur(e.shape,t,n)){var r=Hr(t,e.strides),o=T(n);return mn(this.readSync(e.dataId).subarray(r,r+o),n,e.dtype)}for(var i=Jn(n,e.dtype),a=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(e,n){return e+t[n]}));i.values[s]=a.get.apply(a,u)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){xf(e,"stridedSlice");var o=Lr(t,n,r);if(o.some((function(e){return 0===e})))return mn([],o);for(var i=Jn(o,e.dtype),a=this.bufferSync(e),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+t[l];i.set.apply(i,[a.get.apply(a,c)].concat(u))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=Jn([e.size,e.size],e.dtype),r=n.values,o=0;o<t.length;o++)r[o*e.size+o]=t[o];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),o=0,i=0;i<e.rank;i++)i!==t&&(r[o++]=e.shape[i]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)a[t]=i,u[i]=this.slice(e,a,s).reshape(r);return u},t.prototype.reverse=function(e,t){xf(e,"reverse");for(var n=Jn(e.shape,e.dtype),r=this.bufferSync(e),o=function(o){var i=n.indexToLoc(o),a=i.slice();t.forEach((function(t){return a[t]=e.shape[t]-1-a[t]})),n.set.apply(n,[r.get.apply(r,a)].concat(i))},i=0;i<n.size;i++)o(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map((function(e){return hn(e)})),o=e.map((function(e){return vn(e)}));return pn(this.concat(r,t),this.concat(o,t))}var i=e.map((function(e){var n=T(e.shape.slice(t));return e.as2D(-1,n)})),a=fn(i.map((function(e){return e.shape})),1),s=Jn(a,e[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(e){s.set(n.readSync(e.dataId),u),u+=e.size}))}else{var c=0;i.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,o=0;o<e.shape[0];++o)for(var i=o*a[1]+c,u=0;u<e.shape[1];++u)s[i+u]=t[r++];c+=e.shape[1]}))}var l=fn(e.map((function(e){return e.shape})),t);return mn(s,l,e[0].dtype)},t.prototype.neg=function(e){return xf(e,"neg"),this.multiply(yn(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,De(e.dtype,t.dtype),(function(e,t){return e+t}))},t.prototype.addN=function(e){var t=this;xf(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=Jn(e[0].shape,e[0].dtype),o=r.values,i=0;i<e.length;i++)for(var a=n[i],s=0;s<o.length;s++)o[s]+=a[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=B([t],e.shape),r=this.max(e,n),o=on(r.shape,n),i=this.subtract(e,r.reshape(o)),a=this.exp(i),s=this.sum(a,n).reshape(o);return this.realDivide(a,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,De(e.dtype,t.dtype),(function(e,t){return e-t}))},t.prototype.pow=function(e,t){return xf([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},t.prototype.batchMatMul=function(e,t,n,r){xf([e,t],"matMul");for(var o=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],a=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],f=l[0],d=l[1],p=l[2],h=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],v=h[0],m=h[1],g=h[2],y=i*a,b=Jn([s,i,a],e.dtype),x=b.values,w=this.blockSize,C=0;C<s;C++)for(var S=0;S<i;S+=w)for(var E=0;E<a;E+=w)for(var k=0;k<o;k+=w)for(var I=Math.min(S+w,i),_=Math.min(E+w,a),R=Math.min(k+w,o),T=S;T<I;T++)for(var A=E;A<_;A++){for(var D=0,O=k;O<R;O++)D+=u[C*f+T*d+O*p]*c[O*v+A*m+C*g];x[C*y+(T*a+A)]+=D}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,o=e.transposeB,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,o);return i&&(u=this.add(u,i)),a&&(u=wf(this,u,a,s)),u},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,De(e.dtype,t.dtype),(function(e,t){return e*t}))},t.prototype.realDivide=function(e,t){return xf([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",(function(e,t){return e/t}))},t.prototype.floorDiv=function(e,t){return xf([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},t.prototype.sum=function(e,t){xf(e,"sum"),an("sum",t,e.rank);for(var n=rn(e.shape,t),r=n[0],o=n[1],i=_n(r,De(e.dtype,"int32")),a=T(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=0,d=0;d<a;++d)f+=u[l+d];s[c]=f}return i},t.prototype.prod=function(e,t){xf(e,"sum");for(var n=rn(e.shape,t),r=n[0],o=n[1],i=_n(r,De(e.dtype,"int32")),a=T(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=1,d=0;d<a;++d)f*=u[l+d];s[c]=f}return i},t.prototype.unsortedSegmentSum=function(e,t,n){xf(e,"unsortedSegmentSum");for(var r=[],o=e.rank-t.rank,i=0;i<o;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var a=yn(i,"int32"),s=Qu(a,t).asType("float32").mul(e).sum(0);r.push(s)}return wr(r)},t.prototype.argMin=function(e,t){xf(e,"argMin");var n=[t];an("argMin",n,e.rank);for(var r=rn(e.shape,n),o=r[0],i=r[1],a=_n(o,"int32"),s=T(i),u=this.readSync(a.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,d=c[f],p=0,h=0;h<s;++h){var v=c[f+h];v<d&&(d=v,p=h)}u[l]=p}return a},t.prototype.argMax=function(e,t){xf(e,"argMax");var n=[t];an("argMax",n,e.rank);for(var r=rn(e.shape,n),o=r[0],i=r[1],a=_n(o,"int32"),s=T(i),u=this.readSync(a.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,d=c[f],p=0,h=0;h<s;++h){var v=c[f+h];v>d&&(d=v,p=h)}u[l]=p}return a},t.prototype.cumsum=function(e,t,n,r){if(xf(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var o=De(e.dtype,"int32"),i=_n(e.shape,o),a=this.readSync(i.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],c=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},l=0;l<s.length;l+=u)for(var f=0;f<u;f++){var d=c(l,f);if(0===f)a[d]=n?0:s[d];else{var p=c(l,f-1);a[d]=n?s[p]+a[p]:s[d]+a[p]}}return i},t.prototype.equal=function(e,t){return xf([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},t.prototype.notEqual=function(e,t){return xf([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},t.prototype.less=function(e,t){return xf([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},t.prototype.lessEqual=function(e,t){return xf([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},t.prototype.greater=function(e,t){return xf([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},t.prototype.greaterEqual=function(e,t){return xf([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},t.prototype.logicalNot=function(e){xf(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return xf([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},t.prototype.logicalOr=function(e,t){return xf([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},t.prototype.select=function(e,t,n){xf([e,t,n],"select");for(var r=this.readSync(e.dataId),o=this.readSync(t.dataId),i=this.readSync(n.dataId),a=_n(t.shape,De(t.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,c=0===e.rank||e.rank>1||1===t.rank?1:T(t.shape.slice(1)),l=0;l<r.length;l++)for(var f=0;f<c;f++)1===r[l]?s[u++]=o[l]:s[u++]=i[l];return a},t.prototype.where=function(e){xf([e],"where");var t=this.readSync(e.dataId);return Do(e.shape,t)},t.prototype.topk=function(e,t,n){return xf(e,"topk"),Ao(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){xf(e,"min"),an("min",t,e.rank);for(var n=rn(e.shape,t),r=n[0],o=n[1],i=_n(r,e.dtype),a=T(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],d=0;d<a;++d){var p=u[l+d];p<f&&(f=p)}s[c]=f}return i},t.prototype.minimum=function(e,t){return xf([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},t.prototype.mod=function(e,t){return xf([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},t.prototype.max=function(e,t){xf(e,"max"),an("max",t,e.rank);for(var n=rn(e.shape,t),r=n[0],o=n[1],i=_n(r,e.dtype),a=T(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],d=0;d<a;++d){var p=u[l+d];p>f&&(f=p)}s[c]=f}return i},t.prototype.maximum=function(e,t){return xf([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},t.prototype.all=function(e,t){xf(e,"all"),an("all",t,e.rank);for(var n=rn(e.shape,t),r=n[0],o=n[1],i=_n(r,e.dtype),a=T(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],d=0;d<a;++d){var p=u[l+d];f=f&&p}s[c]=f}return i},t.prototype.any=function(e,t){xf(e,"any"),an("any",t,e.rank);for(var n=rn(e.shape,t),r=n[0],o=n[1],i=_n(r,e.dtype),a=T(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],d=0;d<a;++d){var p=u[l+d];f=f||p}s[c]=f}return i},t.prototype.squaredDifference=function(e,t){return xf([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},t.prototype.ceil=function(e){xf(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){xf(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){xf(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){xf(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){xf(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){xf(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){xf(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=Math.floor(t[r]);t[r]-o<.5?n[r]=Math.floor(t[r]):t[r]-o>.5?n[r]=Math.ceil(t[r]):n[r]=o%2==0?o:o+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){xf(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){xf(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){xf(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){xf(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log1p(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){xf(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.sqrt(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){xf(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=1/Math.sqrt(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){xf(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){xf(e,"relu");for(var t=_n(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),o=0;o<r.length;++o)n[o]=Math.max(0,r[o]);return t},t.prototype.relu6=function(e){xf(e,"relu");for(var t=_n(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),o=0;o<r.length;++o)n[o]=Math.min(Math.max(0,r[o]),6);return t},t.prototype.prelu=function(e,t){return xf([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))},t.prototype.elu=function(e){xf(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?o:Math.exp(o)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){xf([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),o=this.readSync(e.dataId),i=0;i<r.length;++i){var a=r[i];n[i]=a>=1?o[i]:o[i]*(a+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){xf(e,"selu");for(var t=Xa,n=Ya,r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?n*a:t*(Math.exp(a)-1)}return this.makeOutput(r,e.shape,"float32")},t.prototype.clip=function(e,t,n){xf(e,"clip");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>n?n:a<t?t:a}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var o=n[2*r],i=n[2*r+1];t[r]=Math.hypot(o,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){xf(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){xf(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){xf(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),o=0;o<r.length;++o){var i=r[o]>-t,a=r[o]<t,s=Math.exp(r[o]),u=void 0;u=a?s:i?r[o]:Math.log(1+s),n[o]=u}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){xf(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){xf(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){xf(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){xf(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){xf(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){xf(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return xf([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},t.prototype.sinh=function(e){xf(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){xf(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){xf(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=O(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){xf(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){xf(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){xf(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){xf(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=Math.sign(n[r]),i=Math.abs(n[r]),a=1/(1+.3275911*i);t[r]=o*(1-((((1.061405429*a-1.453152027)*a+1.421413741)*a-.284496736)*a+.254829592)*a*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),xf(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),o=0;o<r.length;++o){var i=r[o];isNaN(i)?n[o]=NaN:n[o]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights,s=this.conv2d(t,n,r);return o&&(s=this.add(s,o)),i&&(s=wf(this,s,i,a)),s},t.prototype.conv2d=function(e,t,n){xf([e,t],"conv2d");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=Jn(n.outShape,e.dtype),f=e.strides[0],d=c?e.strides[1]:e.strides[2],p=c?e.strides[2]:1,h=c?1:e.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(e.dataId),x=this.readSync(t.dataId),w=l.values,C=0;C<n.batchSize;++C)for(var S=C*f,E=C*v,k=0;k<n.outHeight;++k)for(var I=E+k*m,_=k*n.strideHeight-u,R=0;R<r;R++){var T=_+R*i;if(!(T<0||T>=n.inHeight))for(var A=R*t.strides[0],D=S+T*d,O=0;O<n.outWidth;++O)for(var F=I+O*g,N=O*n.strideWidth-s,P=0;P<o;P++){var M=N+P*a;if(!(M<0||M>=n.inWidth))for(var B=D+M*p,W=A+P*t.strides[1],L=0;L<n.inChannels;++L){for(var V=b[B+L*h],z=0;z<n.outChannels;++z)w[F+z*y]+=V*x[W+z];W+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,o=n.filterHeight,i=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,f=n.padInfo.top,d=Jn(n.outShape,e.dtype),p=this.readSync(e.dataId),h=this.readSync(t.dataId),v=d.values,m=0;m<n.batchSize;++m)for(var g=m*e.strides[0],y=m*d.strides[0],b=0;b<n.outDepth;++b)for(var x=y+b*d.strides[1],w=b*n.strideDepth-c,C=0;C<r;C++){var S=w+C*a;if(!(S<0||S>=n.inDepth))for(var E=C*t.strides[0],k=g+S*e.strides[1],I=0;I<n.outHeight;++I)for(var _=x+I*d.strides[2],R=I*n.strideHeight-f,T=0;T<o;T++){var A=R+T*s;if(!(A<0||A>=n.inHeight))for(var D=E+T*t.strides[1],O=k+A*e.strides[2],F=0;F<n.outWidth;++F)for(var N=_+F*n.outChannels,P=F*n.strideWidth-l,M=0;M<i;M++){var B=P+M*u;if(!(B<0||B>=n.inWidth))for(var W=D+M*t.strides[2],L=O+B*n.inChannels,V=W,z=0;z<n.inChannels;++z){for(var U=p[L+z],H=0;H<n.outChannels;++H)v[N+H]+=U*h[V+H];V+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){xf([e,t],"conv2dDerInput");for(var r=Jn(n.inShape,"float32"),o=r.values,i=this.readSync(e.dataId),a=this.readSync(t.dataId),s=t.strides,u=s[0],c=s[1],l=s[2],f=n.batchSize,d=n.filterHeight,p=n.filterWidth,h=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,C=n.dataFormat,S=d-1-n.padInfo.top,E=p-1-n.padInfo.left,k="channelsLast"===C,I=r.strides[0],_=k?r.strides[1]:r.strides[2],R=k?r.strides[2]:1,T=k?1:r.strides[1],A=e.strides[0],D=k?e.strides[1]:e.strides[2],O=k?e.strides[2]:1,F=k?1:e.strides[1],N=0;N<f;++N)for(var P=0;P<h;++P)for(var M=0;M<v;++M)for(var B=M-S,W=Math.max(0,Math.ceil(B/x)),L=Math.min(y,(d+B)/x),V=0;V<m;++V){for(var z=V-E,U=Math.max(0,Math.ceil(z/w)),H=Math.min(b,(p+z)/w),j=0,G=W;G<L;++G)for(var q=G*x-B,$=U;$<H;++$)for(var K=A*N+D*G+O*$,X=u*(d-1-q)+c*(p-1-($*w-z))+l*P,Y=0;Y<g;++Y)j+=i[K+F*Y]*a[X+Y];o[I*N+_*M+R*V+T*P]=j}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=Jn(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(e.dataId),f=e.strides,d=f[0],p=f[1],h=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],x=g[2],w=g[3],C=n.batchSize,S=n.filterDepth,E=n.filterHeight,k=n.filterWidth,I=n.inChannels,_=n.inDepth,R=n.inHeight,T=n.inWidth,A=n.outChannels,D=n.outDepth,O=n.outHeight,F=n.outWidth,N=n.strideDepth,P=n.strideHeight,M=n.strideWidth,B=S-1-n.padInfo.front,W=E-1-n.padInfo.top,L=k-1-n.padInfo.left,V=0;V<C;++V)for(var z=0;z<I;++z)for(var U=0;U<_;++U)for(var H=U-B,j=Math.max(0,Math.ceil(H/N)),G=Math.min(D,(S+H)/N),q=0;q<R;++q)for(var $=q-W,K=Math.max(0,Math.ceil($/P)),X=Math.min(O,(E+$)/P),Y=0;Y<T;++Y){for(var J=Y-L,Z=Math.max(0,Math.ceil(J/M)),Q=Math.min(F,(k+J)/M),ee=0,te=j;te<G;++te)for(var ne=te*N-H,re=K;re<X;++re)for(var oe=re*P-$,ie=Z;ie<Q;++ie)for(var ae=d*V+p*te+h*re+v*ie,se=y*(S-1-ne)+b*(E-1-oe)+x*(k-1-(ie*M-J))+w*z,ue=0;ue<A;++ue)ee+=l[ae+ue]*m[se+ue];o[a*V+s*U+u*q+c*Y+z]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){xf([e,t],"conv2dDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=Jn(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,f=this.bufferSync(e),d=this.bufferSync(t),p=0;p<i;++p)for(var h=Math.max(0,Math.ceil((l-p)/r)),v=Math.min(n.outHeight,(n.inHeight+l-p)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((c-m)/o)),y=Math.min(n.outWidth,(n.inWidth+c-m)/o),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,C=0;C<n.batchSize;++C)for(var S=h;S<v;++S)for(var E=p+S*r-l,k=g;k<y;++k){var I=m+k*o-c;w+=s?f.get(C,E,I,b)*d.get(C,S,k,x):f.get(C,b,E,I)*d.get(C,x,S,k)}u.set(w,p,m,b,x)}return u.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,o=n.strideHeight,i=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=Jn(n.filterShape,"float32"),l=c.values,f=c.strides,d=f[0],p=f[1],h=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],x=g[2],w=g[3],C=this.readSync(e.dataId),S=e.strides,E=S[0],k=S[1],I=S[2],_=S[3],R=n.padInfo.front,T=n.padInfo.left,A=n.padInfo.top,D=0;D<a;++D)for(var O=Math.max(0,Math.ceil((R-D)/r)),F=Math.min(n.outDepth,(n.inDepth+R-D)/r),N=D*d,P=0;P<s;++P)for(var M=Math.max(0,Math.ceil((A-P)/o)),B=Math.min(n.outHeight,(n.inHeight+A-P)/o),W=P*p+N,L=0;L<u;++L)for(var V=Math.max(0,Math.ceil((T-L)/i)),z=Math.min(n.outWidth,(n.inWidth+T-L)/i),U=L*h+W,H=0;H<n.inChannels;++H)for(var j=H*v+U,G=0;G<n.outChannels;++G){for(var q=0,$=0;$<n.batchSize;++$)for(var K=$*E,X=$*y,Y=O;Y<F;++Y)for(var J=(D+Y*r-R)*k+K,Z=Y*b+X,Q=M;Q<B;++Q)for(var ee=(P+Q*o-A)*I+J,te=Q*x+Z,ne=V;ne<z;++ne){var re=ne*w+te;q+=C[(L+ne*i-T)*_+ee+H]*m[re+G]}l[j+G]=q}return c.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return o&&(s=this.add(s,o)),i&&(s=wf(this,s,i,a)),s},t.prototype.depthwiseConv2D=function(e,t,n){xf([e,t],"depthwiseConv2D");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=Jn(n.outShape,e.dtype),f=this.readSync(e.dataId),d=this.readSync(t.dataId),p=l.values,h=0;h<n.batchSize;++h)for(var v=h*e.strides[0],m=h*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],b=g*n.strideHeight-s,x=0;x<r;++x){var w=b+x*i;if(!(w<0||w>=n.inHeight))for(var C=x*t.strides[0],S=v+w*e.strides[1],E=0;E<n.outWidth;++E)for(var k=y+E*l.strides[2],I=E*n.strideWidth-u,_=0;_<o;++_){var R=I+_*a;if(!(R<0||R>=n.inWidth))for(var T=C+_*t.strides[1],A=S+R*n.inChannels,D=k,O=T,F=0;F<n.inChannels;++F){for(var N=f[A+F],P=0;P<c;++P)p[D+P]+=N*d[O+P];D+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){xf([e,t],"depthwiseConv2DDerInput");for(var r=Jn(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],c=this.readSync(e.dataId),l=e.strides,f=l[0],d=l[1],p=l[2],h=this.readSync(t.dataId),v=t.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,C=n.inChannels,S=n.inHeight,E=n.inWidth,k=n.outChannels,I=n.outHeight,_=n.outWidth,R=n.strideHeight,T=n.strideWidth,A=x-1-n.padInfo.top,D=w-1-n.padInfo.left,O=k/C,F=0;F<b;++F)for(var N=0;N<C;++N)for(var P=0;P<S;++P)for(var M=P-A,B=Math.max(0,Math.ceil(M/R)),W=Math.min(I,(x+M)/R),L=0;L<E;++L){for(var V=L-D,z=Math.max(0,Math.ceil(V/T)),U=Math.min(_,(w+V)/T),H=0,j=B;j<W;++j)for(var G=j*R-M,q=z;q<U;++q)for(var $=f*F+d*j+p*q,K=m*(x-1-G)+g*(w-1-(q*T-V))+y*N,X=0;X<O;++X)H+=c[$+(N*O+X)]*h[K+X];o[a*F+s*P+u*L+N]=H}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){xf([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=Jn(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,f=this.bufferSync(e),d=this.bufferSync(t),p=0;p<i;++p)for(var h=Math.max(0,Math.ceil((c-p)/r)),v=Math.min(n.outHeight,(n.inHeight+c-p)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((u-m)/o)),y=Math.min(n.outWidth,(n.inWidth+u-m)/o),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/l),w=b%l,C=0,S=0;S<n.batchSize;++S)for(var E=h;E<v;++E)for(var k=p+E*r-c,I=g;I<y;++I){var _=m+I*o-u;C+=f.get(S,k,_,x)*d.get(S,E,I,b)}s.set(C,p,m,x,w)}return s.toTensor()},t.prototype.tile=function(e,t){return xf(e,"tile"),To(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){xf(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),o=t.map((function(e){return e[0]})),i=this.bufferSync(e),a=Jn(r,e.dtype);0!==n&&a.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),c=u.map((function(e,t){return e+o[t]}));a.set.apply(a,[i.get.apply(i,u)].concat(c))}return a.toTensor()},t.prototype.transpose=function(e,t){xf(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var o=this.readSync(e.dataId),i=Jn(n,e.dtype),a=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[t[c]];var l=i.locToIndex(u);i.values[l]=o[r]}return i.toTensor()},t.prototype.gather=function(e,t,n){xf([e,t],"gather");var r=e.shape.slice(),o=this.readSync(t.dataId);r[n]=o.length;for(var i=Jn(r,e.dtype),a=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=o[u[n]];var l=a.locToIndex(c);i.values[s]=a.values[l]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){xf([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),o=Ir(e.shape,t,r),i=_r(o.length,t.length),a=Rr(e.shape,t,r),s=Tr(n,t.length),u=Ar(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){xf([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=Ir(a.shape,t,r,!1),u=_r(s.length,t.length,!1),c=Rr(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.pool=function(e,t,n){xf(e,"pool");for(var r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=t.padInfo.top,l=t.padInfo.left,f="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(e.dataId),p=Jn(t.outShape,e.dtype),h=p.values,v=t.outShape[1]*t.outShape[2]*t.outShape[3],m=t.outShape[2]*t.outShape[3],g=t.outShape[3],y=0;y<t.batchSize;++y)for(var b=y*v,x=y*e.strides[0],w=0;w<t.inChannels;++w)for(var C=0;C<t.outHeight;++C)for(var S=C*r-c,E=Math.max(0,S),k=Math.min(t.inHeight,s+S),I=b+C*m,_=0;_<t.outWidth;++_){for(var R=_*o-l,T=Math.max(0,R),A=Math.min(t.inWidth,u+R),D=f,O=0,F=0,N=E;N<k;N+=i){for(var P=x+N*e.strides[1],M=T;M<A;M+=a){var B=d[P+M*e.strides[2]+w];"max"===n&&B>D?D=B:"avg"===n&&(O+=B,F++)}if(isNaN(D))break}h[I+_*g+w]="avg"===n?O/F:D}return p.toTensor()},t.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},t.prototype.maxPoolPositions=function(e,t){for(var n=Jn(t.outShape,"int32"),r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=t.padInfo.top,l=t.padInfo.left,f=this.bufferSync(e),d=0;d<t.batchSize;++d)for(var p=0;p<t.inChannels;++p)for(var h=0;h<t.outHeight;++h){for(var v=h*r-c,m=v;m<0;)m+=i;for(var g=Math.min(t.inHeight,s+v),y=0;y<t.outWidth;++y){for(var b=y*o-l,x=b;x<0;)x+=a;for(var w=Math.min(t.inWidth,u+b),C=Number.NEGATIVE_INFINITY,S=-1,E=m;E<g;E+=i)for(var k=E-v,I=x;I<w;I+=a){var _=I-b,R=f.get(d,E,I,p);R>C&&(C=R,S=k*u+_)}n.set(S,d,h,y,p)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){xf([t,n],"maxPoolBackprop");for(var o=this.maxPoolPositions(t,r),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,f=l-1-r.padInfo.left,d=c-1-r.padInfo.top,p=Jn(t.shape,"float32"),h=this.bufferSync(o),v=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var x=y-d,w=b-f,C=0,S=0;S<c;S+=s){var E=(x+S)/i;if(!(E<0||E>=r.outHeight||Math.floor(E)!==E))for(var k=0;k<l;k+=u){var I=(w+k)/a;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var _=c*l-1-h.get(m,E,I,g)===S*l+k?1:0;0!==_&&(C+=v.get(m,E,I,g)*_)}}}p.set(C,m,y,b,g)}return p.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){xf([e,t],"avgPoolBackprop");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,f=l-1-n.padInfo.left,d=c-1-n.padInfo.top,p=Jn(t.shape,"float32"),h=1/(i*a),v=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var x=y-d,w=b-f,C=0,S=0;S<c;S+=s){var E=(x+S)/r;if(!(E<0||E>=n.outHeight||Math.floor(E)!==E))for(var k=0;k<l;k+=u){var I=(w+k)/o;I<0||I>=n.outWidth||Math.floor(I)!==I||(C+=v.get(m,E,I,g))}}p.set(C*h,m,y,b,g)}return p.toTensor()},t.prototype.pool3d=function(e,t,n){xf(e,"pool3d");for(var r=t.strideDepth,o=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,h=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),g=Jn(t.outShape,e.dtype),y=g.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],C=t.outShape[4],S=0;S<t.batchSize;++S)for(var E=S*b,k=S*e.strides[0],I=0;I<t.inChannels;++I)for(var _=0;_<t.outDepth;++_){for(var R=_*r-d,T=R;T<0;)T+=a;for(var A=Math.min(t.inDepth,c+R),D=E+_*x,O=0;O<t.outHeight;++O){for(var F=O*o-p,N=F;N<0;)N+=s;for(var P=Math.min(t.inHeight,l+F),M=D+O*w,B=0;B<t.outWidth;++B){for(var W=B*i-h,L=W;L<0;)L+=u;for(var V=Math.min(t.inWidth,f+W),z=M+B*C,U=v,H=0,j=0,G=T;G<A;G+=a){for(var q=k+G*e.strides[1],$=N;$<P;$+=s){for(var K=q+$*e.strides[2],X=L;X<V;X+=u){var Y=m[K+X*e.strides[3]+I];if("max"===n&&Y>U?U=Y:"avg"===n&&(H+=Y,j++),isNaN(U))break}if(isNaN(U))break}if(isNaN(U))break}y[z+I]="avg"===n?H/j:U}}}return g.toTensor()},t.prototype.avgPool3d=function(e,t){return xf(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){xf([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,o=n.strideHeight,i=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,p=n.effectiveFilterHeight,h=n.effectiveFilterWidth,v=d-1-n.padInfo.front,m=h-1-n.padInfo.left,g=p-1-n.padInfo.top,y=Jn(t.shape,"float32"),b=1/(a*s*u),x=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var C=0;C<n.inChannels;++C)for(var S=0;S<n.inDepth;++S)for(var E=0;E<n.inHeight;++E)for(var k=0;k<n.inWidth;++k){for(var I=S-v,_=E-g,R=k-m,T=0,A=0;A<d;A+=c){var D=(I+A)/r;if(!(D<0||D>=n.outDepth||Math.floor(D)!==D))for(var O=0;O<p;O+=l){var F=(_+O)/o;if(!(F<0||F>=n.outHeight||Math.floor(F)!==F))for(var N=0;N<h;N+=f){var P=(R+N)/i;P<0||P>=n.outWidth||Math.floor(P)!==P||(T+=x.get(w,D,F,P,C))}}}y.set(T*b,w,S,E,k,C)}return y.toTensor()},t.prototype.maxPool3d=function(e,t){return xf(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=Jn(t.outShape,"int32"),r=t.strideDepth,o=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,h=t.padInfo.left,v=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var g=0;g<t.inChannels;++g)for(var y=0;y<t.outDepth;++y){for(var b=y*r-d,x=b;x<0;)x+=a;for(var w=Math.min(t.inDepth,c+b),C=0;C<t.outHeight;++C){for(var S=C*o-p,E=S;E<0;)E+=s;for(var k=Math.min(t.inHeight,l+S),I=0;I<t.outWidth;++I){for(var _=I*i-h,R=_;R<0;)R+=u;for(var T=Math.min(t.inWidth,f+_),A=Number.NEGATIVE_INFINITY,D=-1,O=x;O<w;O+=a)for(var F=O-b,N=E;N<k;N+=s)for(var P=N-S,M=R;M<T;M+=u){var B=M-_,W=v.get(m,O,N,M,g);W>=A&&(A=W,D=F*l*f+P*l+B)}n.set(D,m,y,C,I,g)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){xf([t,n],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(t,r),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=f-1-r.padInfo.front,v=p-1-r.padInfo.left,m=d-1-r.padInfo.top,g=Jn(t.shape,"float32"),y=this.bufferSync(o),b=this.bufferSync(e),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var C=0;C<r.inDepth;++C)for(var S=0;S<r.inHeight;++S)for(var E=0;E<r.inWidth;++E){for(var k=C-h,I=S-m,_=E-v,R=0,T=0;T<f;T+=u){var A=(k+T)/i;if(!(A<0||A>=r.outDepth||Math.floor(A)!==A))for(var D=0;D<d;D+=c){var O=(I+D)/a;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var F=0;F<p;F+=l){var N=(_+F)/s;if(!(N<0||N>=r.outWidth||Math.floor(N)!==N)){var P=f*d*p-1-y.get(x,A,O,N,w)===T*d*p+D*p+F?1:0;0!==P&&(R+=b.get(x,A,O,N,w)*P)}}}}g.set(R,x,C,S,E,w)}return g.toTensor()},t.prototype.cast=function(e,t){return po(e,t,this)},t.prototype.reshape=function(e,t){return ho(e,t)},t.prototype.avgPool=function(e,t){return xf(e,"avgPool"),this.pool(e,t,"avg").toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){xf(e,"resizeBilinear");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],c=this.readSync(e.dataId),l=new Float32Array(T([i,t,n,u])),f=[r&&t>1?a-1:a,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=0,h=f[0]/d[0],v=f[1]/d[1],m=0;m<i;m++)for(var g=0;g<t;g++)for(var y=h*g,b=Math.floor(y),x=y-b,w=Math.min(a-1,Math.ceil(y)),C=m*e.strides[0]+b*e.strides[1],S=m*e.strides[0]+w*e.strides[1],E=0;E<n;E++)for(var k=v*E,I=Math.floor(k),_=k-I,R=Math.min(s-1,Math.ceil(k)),A=C+I*e.strides[2],D=S+I*e.strides[2],O=C+R*e.strides[2],F=S+R*e.strides[2],N=0;N<u;N++){var P=c[A+N],M=c[D+N],B=P+(c[O+N]-P)*_,W=B+(M+(c[F+N]-M)*_-B)*x;l[p++]=W}return mn(l,[i,t,n,u])},t.prototype.resizeBilinearBackprop=function(e,t,n){xf([e,t],"resizeBilinearBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(o*i*a*s),d=[n&&c>1?i-1:i,n&&l>1?a-1:a],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],h=d[0]/p[0],v=d[1]/p[1],m=this.readSync(e.dataId),g=0,y=0;y<o;y++)for(var b=y*t.strides[0],x=0;x<c;x++)for(var w=x*h,C=Math.floor(w),S=Math.min(Math.ceil(w),i-1),E=b+C*t.strides[1],k=b+S*t.strides[1],I=w-C,_=1-I,R=0;R<l;R++)for(var T=R*v,A=Math.floor(T),D=Math.min(Math.ceil(T),a-1),O=T-A,F=1-O,N=E+A*t.strides[2],P=E+D*t.strides[2],M=k+A*t.strides[2],B=k+D*t.strides[2],W=_*F,L=_*O,V=I*F,z=I*O,U=0;U<s;U++){var H=m[g++];f[N+U]+=H*W,f[P+U]+=H*L,f[M+U]+=H*V,f[B+U]+=H*z}return Cn(f,[o,a,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){xf(e,"resizeNearestNeighbor");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],c=this.readSync(e.dataId),l=new Float32Array(i*t*n*u),f=[r&&t>1?a-1:a,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=f[0]/d[0],h=f[1]/d[1],v=0,m=0;m<i;m++)for(var g=m*e.strides[0],y=0;y<t;y++)for(var b=p*y,x=g+Math.min(a-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var C=h*w,S=x+Math.min(s-1,r?Math.round(C):Math.floor(C))*e.strides[2],E=0;E<u;E++){var k=c[S+E];l[v++]=k}return mn(l,[i,t,n,u],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){xf([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(o*i*a*s),d=this.readSync(e.dataId),p=[n&&c>1?i-1:i,n&&l>1?a-1:a],h=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=p[0]/h[0],m=p[1]/h[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,x=2*Math.ceil(y)+2,w=0;w<o;w++)for(var C=w*t.strides[0],S=0;S<i;S++)for(var E=C+S*t.strides[1],k=Math.floor(S*g),I=Math.floor(k-b/2),_=0;_<a;_++)for(var R=E+_*t.strides[2],T=Math.floor(_*y),A=Math.floor(T-x/2),D=0;D<s;D++){for(var O=0,F=0;F<b;F++){var N=F+I;if(!(N<0||N>=c)){var P=C+N*e.strides[1],M=N*v;if(S===Math.min(i-1,n?Math.round(M):Math.floor(M)))for(var B=0;B<x;B++){var W=B+A;if(!(W<0||W>=l)){var L=P+W*e.strides[2],V=W*m;_===Math.min(a-1,n?Math.round(V):Math.floor(V))&&(O+=d[L+D])}}}}f[R+D]=O}return Cn(f,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,o,i){xf([e,t,n,o,i],"batchNorm");for(var a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),c=o?this.readSync(o.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),f=new Float32Array(a.length),d=l.length,p=c.length,h=u.length,v=s.length,m=0,g=0,y=0,b=0,x=0;x<a.length;++x)f[x]=l[m++]+(a[x]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),m>=d&&(m=0),g>=v&&(g=0),y>=p&&(y=0),b>=h&&(b=0);return Cn(f,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,o){xf(e,"localResponseNormalization4D");var i=e.shape[3],a=i-1,s=this.readSync(e.dataId),u=e.size,c=new Float32Array(u);function l(e){for(var n=e%i,r=e-n+Math.max(0,n-t),o=e-n+Math.min(n+t,a),u=0;r<=o;r++){var c=s[r];u+=c*c}return u}for(var f=0;f<u;f++){var d=l(f),p=s[f]*Math.pow(n+r*d,-o);c[f]=p}return Cn(c,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,o,i,a){xf(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),f=new Float32Array(e.size),d=e.size,p=0;p<d;p++){for(var h=p%s,v=p-h+Math.max(0,h-r),m=p-h+Math.min(s,h+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);for(g=i*g+o,y=v;y<m;y++){var b=-2*i*a*c[y]*l[p]/g;p===y&&(b+=Math.pow(g,-a)),b*=u[p],f[y]+=b}}return Cn(f,e.shape)},t.prototype.multinomial=function(e,t,n,r){xf(e,"multinomial");for(var o=t?e:qr(e),i=o.shape[0],a=o.shape[1],s=_n([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(o.dataId),l=0;l<i;++l){var f=l*a,d=new Float32Array(a-1);d[0]=c[f];for(var p=1;p<d.length;++p)d[p]=d[p-1]+c[f+p];for(var h=$n(r.toString()),v=l*n,m=0;m<n;++m){var g=h();u[v+m]=d.length;for(var y=0;y<d.length;y++)if(g<d[y]){u[v+m]=y;break}}}return s},t.prototype.oneHot=function(e,t,n,r){xf(e,"oneHot");var o=new Float32Array(e.size*t);o.fill(r);for(var i=this.readSync(e.dataId),a=0;a<e.size;++a)i[a]>=0&&i[a]<t&&(o[a*t+i[a]]=n);return xn(o,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,o){return xf(e,"nonMaxSuppression"),Co(this.readSync(e.dataId),this.readSync(t.dataId),n,r,o)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],o=Jn(e.shape,"float32"),i=Jn(e.shape,"float32"),a=hn(e).as2D(n,r),s=vn(e).as2D(n,r),u=0;u<n;u++)for(var c=a.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),f=pn(c,l),d=this.readSync(this.fftImpl(f,t).dataId),p=0;p<r;p++){var h=go(d,p);o.values[u*r+p]=h.real,i.values[u*r+p]=h.imag}return pn(o.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var o=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(o=pn(hn(o).div(yn(r)),vn(o).div(yn(r)))),o}var i=this.readSync(e.dataId),a=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return pn(a.real,a.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),o=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=0;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),a=pn(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=2;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),u=pn(s.real,s.imag).as1D();a=this.fftRadix2(a,o,n),u=this.fftRadix2(u,o,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),o=0;o<Math.ceil(e/2);o++){var i=(t?2:-2)*Math.PI*(o/e);n[o]=Math.cos(i),r[o]=Math.sin(i)}return{real:n,imag:r}}(t,n),l=pn(c.real,c.imag).mul(u),f=a.add(l),d=a.sub(l),p=hn(f).concat(hn(d)),h=vn(f).concat(vn(d));return pn(p,h).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),o=0;o<t;o++){for(var i=0,a=0,s=0;s<t;s++){var u=bo(o*s,t,n),c=go(e,s);i+=c.real*u.real-c.imag*u.imag,a+=c.real*u.imag+c.imag*u.real}n&&(i/=t,a/=t),yo(r,i,a,o)}return r},t.prototype.depthToSpace=function(e,t,n){k("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),k(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));for(var r=e.shape[0],o=e.shape[1],i=e.shape[2],a=e.shape[3],s=o*t,u=i*t,c=a/(t*t),l=this.readSync(e.dataId),f=new Float32Array(r*s*u*c),d=0,p=0;p<r;++p)for(var h=0;h<s;++h)for(var v=Math.floor(h/t),m=h%t,g=0;g<u;++g)for(var y=Math.floor(g/t),b=(m*t+g%t)*c,x=0;x<c;++x){var w=x+b+a*(y+i*(v+o*p));f[d++]=l[w]}return Cn(f,[r,s,u,c])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var o=Qr(e.shape,t.shape),i=Jn(o,n),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=Jr(e.shape,o),c=Jr(t.shape,o),l=i.values;if(u.length+c.length===0)for(var f=0;f<l.length;++f)l[f]=r(a[f%a.length],s[f%s.length]);else{var d=this.bufferSync(e),p=this.bufferSync(t),h=function(n){var o=i.indexToLoc(n),f=o.slice(-e.rank);u.forEach((function(e){return f[e]=0}));var h=d.locToIndex(f),v=o.slice(-t.rank);c.forEach((function(e){return v[e]=0}));var m=p.locToIndex(v);l[n]=r(a[h],s[m])};for(f=0;f<l.length;++f)h(f)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=Qr(e.shape,t.shape),o=Jn(r,"float32"),i=Jn(r,"float32"),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=Jr(e.shape,r),c=Jr(t.shape,r),l=o.values,f=i.values;if(u.length+c.length===0)for(var d=0;d<l.length;d++){var p=d%a.length,h=d%s.length,v=n(a[2*p],a[2*p+1],s[2*h],s[2*h+1]);l[d]=v.real,f[d]=v.imag}else{var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var i=o.indexToLoc(r),d=i.slice(-e.rank);u.forEach((function(e){return d[e]=0}));var p=m.locToIndex(d),h=i.slice(-t.rank);c.forEach((function(e){return h[e]=0}));var v=g.locToIndex(h),y=n(a[2*p],a[2*p+1],s[2*v],s[2*v+1]);l[r]=y.real,f[r]=y.imag};for(d=0;d<l.length;d++)y(d)}return this.complex(o.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return Ro(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,o,i){for(var a=e.shape,s=a[0],u=a[1],c=a[2],l=a[3],f=t.shape[0],d=r[0],p=r[1],h=Jn([f,d,p,l],"float32"),v=this.readSync(t.dataId),m=this.readSync(n.dataId),g=this.readSync(e.dataId),y=e.strides,b=h.strides,x=0;x<f;x++){var w=4*x,C=v[w],S=v[w+1],E=v[w+2],k=v[w+3],I=m[x];if(!(I>=s))for(var _=d>1?(E-C)*(u-1)/(d-1):0,R=p>1?(k-S)*(c-1)/(p-1):0,T=0;T<d;T++){var A=d>1?C*(u-1)+T*_:.5*(C+E)*(u-1);if(A<0||A>u-1)for(var D=0;D<p;D++)for(var O=0;O<l;O++){var F=O+D*b[2]+T*b[1]+x*b[0];h.values[F]=i}else if("bilinear"===o){var N=Math.floor(A),P=Math.ceil(A),M=A-N;for(D=0;D<p;D++)if((G=p>1?S*(c-1)+D*R:.5*(S+k)*(c-1))<0||G>c-1)for(O=0;O<l;O++)F=O+D*b[2]+T*b[1]+x*b[0],h.values[F]=i;else{var B=Math.floor(G),W=Math.ceil(G),L=G-B;for(O=0;O<l;O++){var V=g[F=O+B*y[2]+N*y[1]+I*y[0]],z=g[F=O+W*y[2]+N*y[1]+I*y[0]],U=g[F=O+B*y[2]+P*y[1]+I*y[0]],H=V+(z-V)*L,j=U+(g[F=O+W*y[2]+P*y[1]+I*y[0]]-U)*L;F=O+D*b[2]+T*b[1]+x*b[0],h.values[F]=H+(j-H)*M}}}else for(D=0;D<p;++D){var G;if((G=p>1?S*(c-1)+D*R:.5*(S+k)*(c-1))<0||G>c-1)for(O=0;O<l;O++)F=O+D*b[2]+T*b[1]+x*b[0],h.values[F]=i;else{var q=Math.round(G),$=Math.round(A);for(O=0;O<l;O++){var K=O+q*y[2]+$*y[1]+I*y[0],X=O+D*b[2]+T*b[1]+x*b[0];h.values[X]=g[K]}}}}}return h.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var o=Mr(0,e,n),i=o.sliceRank,a=o.numUpdates,s=o.sliceSize,u=o.strides,c=o.outputSize;return this.scatter(e,t,n,c,s,a,i,u,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=Dr(e,t),i=o[0],a=o[1],s=o[2],u=o[3];if(0===a)return mn([],i,e.dtype);for(var c=new be([a,s],e.dtype),l=this.readSync(t.dataId),f=this.readSync(e.dataId),d=0;d<a;d++){for(var p=[],h=0,v=0;v<r;v++){var m=l[d*r+v];h+=m*u[v],p.push(m)}if(h<0||h>=e.size/s)throw new Error("Invalid indices: "+p+" does not index into "+e.shape);for(var g=0;g<s;g++)c.values[d*s+g]=f[h*s+g]}return c.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=Mr(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=yn(0);return this.scatter(e,t,n,u,a,i,o,s,c,!0)},t.prototype.fill=function(e,t,n){var r=V(n=n||Y(t),T(e));return r.fill(t),Le.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=V(e.dtype,T(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return vo(e,t,n)},t.prototype.scatter=function(e,t,n,r,o,i,a,s,u,c){var l=[r/o,o],f=this.readSync(e.dataId),d=this.readSync(t.dataId);if(0===r)return mn([],n,t.dtype);var p=new be(l,t.dtype);p.values.fill(this.readSync(u.dataId)[0]);for(var h=0;h<i;h++){for(var v=[],m=0,g=0;g<a;g++){var y=f[h*a+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/o)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<o;b++)c?p.values[m*o+b]+=d[h*o+b]:p.values[m*o+b]=0===t.rank?d[0]:d[h*o+b]}return p.toTensor().reshape(n)},t}(Xr);Le.registerBackend("cpu",(function(){return new Cf}),1);for(var Sf=0,Ef=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,d=n;xf(i,"NonMaxSuppressionWithScore");var p=So(d.data.get(i.dataId).values,d.data.get(a.dataId).values,u,c,l,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;xf(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:As,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;xf([o,i],As);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,c=function(e,t,n,r,o,i){var a=Qr(e,t),s=a.length,u=Q(a),c=L(o,T(a)),l=e.length,f=t.length,d=Q(e),p=Q(t),h=Jr(e,a),v=Jr(t,a);if(h.length+v.length===0)for(var m=0;m<c.length;++m)c[m]=i(n[m%n.length],r[m%r.length]);else{var g=function(e){var t=ce(e,s,u),o=t.slice(-l);h.forEach((function(e){return o[e]=0}));var a=ue(o,l,d),m=t.slice(-f);v.forEach((function(e){return m[e]=0}));var g=ue(m,f,p);c[e]=i(n[a],r[g])};for(m=0;m<c.length;++m)g(m)}return[c,a]}(o.shape,i.shape,s,u,o.dtype,(function(e,t){var n=e-t;return n*n})),l=c[0],f=c[1];return{dataId:a.write(l,f,o.dtype),shape:f,dtype:o.dtype}}}];Sf<Ef.length;Sf++)y(Ef[Sf]);for(var kf,If=function(e){this.variableNames=["A"];var t=Bo(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},_f=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Bo(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},Rf=0,Tf=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a="undefined"!=typeof HTMLVideoElement&&o instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=u[0],l=u[1],d=[l,c],p=[l,c,i];(s||a)&&(null==kf&&(kf=document.createElement("canvas").getContext("2d")),kf.canvas.width=c,kf.canvas.height=l,kf.drawImage(o,0,0,c,l),o=kf.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=He.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var v=f().getBool("WEBGL_PACK")?new _f(p):new If(p),m=n.runWebGLProgram(v,[h],"int32");return n.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Yt("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,d=n,p=So(d.readSync(i.dataId),d.readSync(a.dataId),u,c,l,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new Ja(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:As,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=f().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pi("return (a - b) * (a - b);",o.shape,i.shape):new fi("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Rf<Tf.length;Rf++)y(Tf[Rf]);for(var Af=0,Df=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:As,gradFunc:function(e,t){var n=t[0],r=t[1],o=yn(2);return{a:function(){return qu(e,qu(o,Ju(n,r)))},b:function(){return qu(e,qu(o,Ju(r,n)))}}}}];Af<Df.length;Af++)b(Df[Af]);var Of=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();f().get("IS_BROWSER")&&f().setPlatform("browser",new Of);var Ff,Nf=function(){return n(522)},Pf=function(){function e(){this.util=n(753),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=f().global.fetch?f().global.fetch(e,t):(null==Ff&&(Ff=Nf()),Ff(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();f().get("IS_NODE")&&f().setPlatform("node",new Pf);var Mf={float32:4,int32:4,uint16:2,uint8:1,bool:1},Bf=4;function Wf(e,t){for(var n={},r=0,o=function(t){var o=t.name,i=t.dtype,a=t.shape,s=T(a),u=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=Mf[c.dtype],f=e.slice(r,r+s*l),d="uint8"===c.dtype?new Uint8Array(f):new Uint16Array(f);if("float32"===i)u=Float32Array.from(d,(function(e){return e*c.scale+c.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=Int32Array.from(d,(function(e){return Math.round(e*c.scale+c.min)}))}r+=s*l}else if("string"===i){var p=T(t.shape);u=[];for(var h=0;h<p;h++){var v=new Uint32Array(e.slice(r,r+Bf))[0];r+=Bf;var m=new Uint8Array(e.slice(r,r+v));u.push(m),r+=v}}else{var g=Mf[i];if(f=e.slice(r,r+s*g),"float32"===i)u=new Float32Array(f);else if("int32"===i)u=new Int32Array(f);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=new Uint8Array(f)}r+=s*g}n[o]=mn(u,a,i)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function Lf(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),o=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),o),o+=e.byteLength})),r.buffer}var Vf="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function zf(e){return Vf?Buffer.byteLength(e):new Blob([e]).size}function Uf(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Hf(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function jf(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:zf(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:zf(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var Gf=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&o.push(n)})),o},e}(),qf="://",$f=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){k(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(qf)&&(t=t.slice(0,t.indexOf(qf))),k(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();k(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '"+t+"'."})),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Kf(e){if(-1===e.indexOf(qf))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+$f.getSchemes().join(","));return{scheme:e.split(qf)[0],path:e.split(qf)[1]}}function Xf(e,t,n){return void 0===n&&(n=!1),s(this,void 0,void 0,(function(){var r,o,i,a,s,c,l,f,d;return u(this,(function(u){switch(u.label){case 0:return k(e!==t,(function(){return"Old path and new path are the same: '"+e+"'"})),k((r=Gf.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+e+"."})),k(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."})),o=r[0],k((i=Gf.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),k(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."})),a=i[0],s=Kf(e).scheme,c=Kf(e).path,l=s===Kf(e).scheme,[4,o.load()];case 1:return f=u.sent(),n&&l?[4,$f.getManager(s).removeModel(c)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[4,a.save(f)];case 4:return d=u.sent(),!n||l?[3,6]:[4,$f.getManager(s).removeModel(c)];case 5:u.sent(),u.label=6;case 6:return[2,d.modelArtifactsInfo]}}))}))}var Yf="models_store",Jf="model_info_store";function Zf(){if(!f().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Qf(e){var t=e.result;t.createObjectStore(Yf,{keyPath:"modelPath"}),t.createObjectStore(Jf,{keyPath:"modelPath"})}var ed=function(){function e(e){if(this.indexedDB=Zf(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Qf(o)},o.onsuccess=function(){var i=o.result;if(null==t){var a=i.transaction(Yf,"readonly"),s=a.objectStore(Yf).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},a.oncomplete=function(){return i.close()}}else{var u,c=jf(t),l=i.transaction(Jf,"readwrite"),f=l.objectStore(Jf),d=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var o=(u=i.transaction(Yf,"readwrite")).objectStore(Yf).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});o.onsuccess=function(){return e({modelArtifactsInfo:c})},o.onerror=function(e){var t=(f=l.objectStore(Jf)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(o.error)},t.onerror=function(e){return i.close(),r(o.error)}}},d.onerror=function(e){return i.close(),r(d.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},o.onerror=function(e){return r(o.error)}}))},e.URL_SCHEME="indexeddb://",e}(),td=function(e){return f().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ed.URL_SCHEME)?(t=e.slice(ed.URL_SCHEME.length),new ed(t)):null;var t};Gf.registerSaveRouter(td),Gf.registerLoadRouter(td);var nd=function(){function e(){this.indexedDB=Zf()}return e.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Qf(r)},r.onsuccess=function(){var e=r.result,o=e.transaction(Jf,"readonly"),i=o.objectStore(Jf).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var o=r[n];e[o.modelPath]=o.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},o.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(n){var r;return e=(r=e).startsWith(ed.URL_SCHEME)?r.slice(ed.URL_SCHEME.length):r,[2,new Promise((function(n,r){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Qf(o)},o.onsuccess=function(){var t,i=o.result,a=i.transaction(Jf,"readwrite"),s=a.objectStore(Jf),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var o=s.delete(e),a=function(){var o=(t=i.transaction(Yf,"readwrite")).objectStore(Yf).delete(e);o.onsuccess=function(){return n(u.result.modelArtifactsInfo)},o.onerror=function(e){return r(u.error)}};o.onsuccess=a,o.onerror=function(e){return a(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},a.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},o.onerror=function(e){return r(o.error)}}))]}))}))},e}();if(f().getBool("IS_BROWSER"))try{$f.registerManager(ed.URL_SCHEME,new nd)}catch(i){}var rd="/",od="tensorflowjs_models",id="info",ad="model_topology",sd="weight_specs",ud="weight_data",cd="model_metadata";function ld(e){return{info:[od,e,id].join(rd),topology:[od,e,ad].join(rd),weightSpecs:[od,e,sd].join(rd),weightData:[od,e,ud].join(rd),modelMetadata:[od,e,cd].join(rd)}}function fd(e){var t=e.split(rd);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(rd)}var dd=function(){function e(e){if(!f().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=ld(this.modelPath)}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=jf(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(Vf)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,o=t.length;r<o;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return u(this,(function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(o=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(o),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(Vf){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r.set([n.charCodeAt(o)],o);return r.buffer}(a),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),pd=function(e){return f().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(dd.URL_SCHEME)?(t=e.slice(dd.URL_SCHEME.length),new dd(t)):null;var t};Gf.registerSaveRouter(pd),Gf.registerLoadRouter(pd);var hd=function(){function e(){k(f().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),k("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return e.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,o,i;return u(this,(function(a){for(e={},t=od+rd,n=rd+id,r=0;r<this.LS.length;++r)(o=this.LS.key(r)).startsWith(t)&&o.endsWith(n)&&(i=fd(o),e[i]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},e.prototype.removeModel=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){var o;if(e=(o=e).startsWith(dd.URL_SCHEME)?o.slice(dd.URL_SCHEME.length):o,t=ld(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(f().getBool("IS_BROWSER"))try{$f.registerManager(dd.URL_SCHEME,new hd)}catch(i){}var vd="model",md=".json",gd=".weights.bin";function yd(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var bd=function(){function e(t){if(!f().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t=vd),this.modelTopologyFileName=t+md,this.weightDataFileName=t+gd}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i,a;return u(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},o=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=o,[4,yd((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==e.weightData?[3,4]:((a=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,yd((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:jf(e)}]}}))}))},e.URL_SCHEME="downloads://",e}(),xd=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return s(this,void 0,void 0,(function(){var e,t,n=this;return u(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,o){var i=new FileReader;i.onload=function(i){var a=JSON.parse(i.target.result),s=a.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,t)}catch(e){return void o(e)}var l=[],f=[],d=[];u.forEach((function(e){e.paths.forEach((function(e){f.push(e),d.push(null)})),l.push.apply(l,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,o=f.indexOf(e);d[o]=n,-1===d.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:Uf(d),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy,userDefinedMetadata:a.userDefinedMetadata})},t.onerror=function(t){return o("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])}))}))}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return Hf(e.name)})),o={},i=0,a=e;i<a.length;i++)a[i].paths.forEach((function(e){var i=Hf(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");o[e]=t[r.indexOf(i)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return o},e}();function wd(e,t,n,r){!function(e){k(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){k(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),k(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),k(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t}))}(n=null==n?0:n,r=null==r?1:r);var o=0;return Promise.all(e.map((function(i){return i.then((function(i){var a=n+ ++o/e.length*(r-n);return t(a),i})),i})))}function Cd(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,a,s,c,l,d;return u(this,(function(u){switch(u.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?f().platform.fetch:t.fetchFunc,r=e.map((function(e){return n(e,t.requestInit,{isBinary:!0})})),o=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=u.sent(),[3,4];case 2:return[4,wd(r,t.onProgress,o,i)];case 3:a=u.sent(),u.label=4;case 4:return s=a.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return d=u.sent(),[3,8];case 6:return[4,wd(s,t.onProgress,c,l)];case 7:d=u.sent(),u.label=8;case 8:return[2,d]}}))}))}function Sd(e){var t=this;return function(n,r,o){return void 0===r&&(r=""),s(t,void 0,void 0,(function(){var t,i,a,s,c,l,f,d,p,h;return u(this,(function(u){switch(u.label){case 0:if(t=n.map((function(){return!1})),i={},a=null!=o?o.map((function(){return!1})):[],s=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,c=Mf[u]*T(e.shape),l=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=o?o.forEach((function(t,n){t===e.name&&(l(),a[n]=!0)})):l(),s.push(e.name),r+=c}))})),!a.every((function(e){return e})))throw c=o.filter((function(e,t){return!a[t]})),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),f=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;f.push(t)}))})),[4,e(f)];case 1:return d=u.sent(),p={},h=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,o=0;o<t;o++)r+=d[h+o].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,c=0;c<t;c++){var l=new Uint8Array(d[h+c]);s.set(l,u),u+=l.byteLength}i[e].forEach((function(e){var t=Wf(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)p[n]=t[n]})),h+=t})),[2,p]}}))}))}}Gf.registerSaveRouter((function(e){return f().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(bd.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new bd(e)}(e.slice(bd.URL_SCHEME.length)):null}));var Ed=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(k("function"==typeof t.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=f().platform.fetch,k(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&k(2===e.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o;return u(this,(function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=i.sent()).ok)return[2,{modelArtifactsInfo:jf(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},e.prototype.load=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,c,l,f,d;return u(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,e.json()];case 3:return t=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,o=t.weightsManifest,i=t.generatedBy,a=t.convertedBy,s=t.format,c=t.userDefinedMetadata,null==r&&null==o)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==o?[3,7]:[4,this.loadWeights(o)];case 6:d=u.sent(),l=d[0],f=d[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:l,weightData:f,userDefinedMetadata:c,generatedBy:i,convertedBy:a,format:s}]}}))}))},e.prototype.loadWeights=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,l,f,d;return u(this,(function(u){switch(u.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),o=n>t?e.substring(n):"";return[r+"/",o]}(t),r=n[0],o=n[1],i=this.weightPathPrefix||r,a=[],s=0,c=e;s<c.length;s++)l=c[s],a.push.apply(a,l.weights);return f=[],e.forEach((function(e){e.paths.forEach((function(e){f.push(i+e+o)}))})),[4,Cd(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=u.sent(),[2,[a,Uf(d)]]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function kd(e){return null!=e.match(Ed.URL_SCHEME_REGEX)}var Id=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return kd(e)})):kd(e))?_d(e,{onProgress:t}):null};function _d(e,t){return new Ed(e,t)}Gf.registerSaveRouter(Id),Gf.registerLoadRouter(Id);var Rd,Td=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.modelArtifacts]}))}))},e}(),Ad=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),Dd=Object.freeze({browserFiles:function(e){return new xd(e)},browserHTTPRequest:function(e,t){return _d(e,t)},concatenateArrayBuffers:Uf,decodeWeights:Wf,encodeWeights:function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,a,c=this;return u(this,(function(l){switch(l.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e),i=function(i){var a=o[i],l=Array.isArray(e)?e[i].tensor:e[a];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+l.dtype);var f={name:a,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var d=new Promise((function(e){return s(c,void 0,void 0,(function(){var t,n,r,o,i,a,s;return u(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(t=u.sent(),n=t.reduce((function(e,t){return e+t.length}),0)+Bf*t.length,r=new Uint8Array(n),o=0,i=0;i<t.length;i++)a=t[i],s=new Uint8Array(new Uint32Array([a.length]).buffer),r.set(s,o),o+=Bf,r.set(a,o),o+=a.length;return e(r),[2]}}))}))}));r.push(d)}else r.push(l.data());null!=t&&(f.group=t),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:Lf(l.sent()),specs:n}]}}))}))},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Td(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Td({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Td({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Gf.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:jf,getSaveHandlers:function(e){return Gf.getSaveHandlers(e)},http:_d,isHTTPScheme:kd,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),s(this,void 0,void 0,(function(){return u(this,(function(o){return[2,Sd((function(e){return Cd(e,{requestInit:r})}))(e,t,n)]}))}))},registerLoadRouter:function(e){return Gf.registerLoadRouter(e)},registerSaveRouter:function(e){return Gf.registerSaveRouter(e)},weightsLoaderFactory:Sd,withSaveHandler:function(e){return new Ad(e)},copyModel:function(e,t){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,Xf(e,t,!1)]}))}))},listModels:function(){return s(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return u(this,(function(s){switch(s.label){case 0:e=$f.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,$f.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+qf+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,Xf(e,t,!0)]}))}))},removeModel:function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return t=Kf(e),[2,$f.getManager(t.scheme).removeModel(t.path)]}))}))}}),Od=dn({confusionMatrix_:function(e,t,n){var r=Qt(e,"labels","confusionMatrix"),o=Qt(t,"predictions","confusionMatrix");k(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),k(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),k(1===o.rank,(function(){return"Expected the rank of predictions to be 1, but got "+o.rank})),k(r.shape[0]===o.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."})),k(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=ur(r.asType("int32"),n),a=ur(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}}),Fd=(Object.freeze({confusionMatrix:Od}),dn({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=v("FromPixels",Le.backendName))return Le.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,c=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],l=c[0],f=c[1];if(a?s=e.getContext("2d").getImageData(0,0,l,f).data:r||n?s=e.data:(i||o)&&(null==Rd&&(Rd=document.createElement("canvas").getContext("2d")),Rd.canvas.width=l,Rd.canvas.height=f,Rd.drawImage(e,0,0,l,f),s=Rd.getImageData(0,0,l,f).data),4===t)u=new Int32Array(s);else{var d=l*f;u=new Int32Array(d*t);for(var p=0;p<d;p++)for(var h=0;h<t;++h)u[p*t+h]=s[4*p+h]}return wn(u,[f,l,t],"int32")}})),Nd=Object.freeze({toPixels:function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,a,s,c,l,f,d,p,h,v,m,g,y,b,x,w,C,S,E,k;return u(this,(function(u){switch(u.label){case 0:if(n=Qt(e,"img","toPixels"),e instanceof Se||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=u.sent(),c=n.min(),l=n.max(),[4,Promise.all([c.data(),l.data()])];case 2:if(f=u.sent(),d=f[0],p=f[1],h=d[0],v=p[0],c.dispose(),l.dispose(),"float32"===n.dtype){if(h<0||v>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+v+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||v>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+v+"].")}for(m="float32"===n.dtype?255:1,g=new Uint8ClampedArray(i*o*4),y=0;y<o*i;++y)b=void 0,x=void 0,w=void 0,C=void 0,1===a?(b=s[y]*m,x=s[y]*m,w=s[y]*m,C=255):3===a?(b=s[3*y]*m,x=s[3*y+1]*m,w=s[3*y+2]*m,C=255):4===a&&(b=s[4*y]*m,x=s[4*y+1]*m,w=s[4*y+2]*m,C=s[4*y+3]*m),g[0+(S=4*y)]=Math.round(b),g[S+1]=Math.round(x),g[S+2]=Math.round(w),g[S+3]=Math.round(C);return null!=t&&(t.width=i,t.height=o,E=t.getContext("2d"),k=new ImageData(g,i,o),E.putImageData(k,0,0)),n!==e&&n.dispose(),[2,g]}}))}))},fromPixels:Fd}),Pd=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),Md=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Bd(e){k(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),k("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),k(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Md.register(e)}Object.freeze({Serializable:Pd,SerializationMap:Md,registerClass:Bd});var Wd=.001,Ld=.1;function Vd(){return 32===Le.backend.floatPrecision()?Wd:Ld}function zd(e,t,n){var r=!0;if((j(e)||j(t))&&(r=!1),j(e)&&j(t)&&(r=!0),r){var o=e.constructor.name,i=t.constructor.name;if(o!==i)throw new Error("Arrays are of different type. Actual: "+o+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var a=Jt(e),s=Jt(t);if(!A(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=j(e)?e:R(e),c=j(t)?t:R(t);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var f=u[l],d=c[l];if(!n(f,d))throw new Error("Arrays differ: actual["+l+"] = "+f+", expected["+l+"] = "+d+".\nActual:   "+u+".\nExpected: "+c+".")}}function Ud(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:Ld,expectArraysClose:function(e,t,n){return null==n&&(n=Vd()),zd(e,t,(function(e,t){return Ud(e,t,n)}))},testEpsilon:Vd,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return $(e)||$(e[0])||$(t)||$(t[0])?zd(e,n,(function(e,t){return e==t})):zd(e,t,(function(e,t){return Ud(e,t,0)}))},expectNumbersClose:function(e,t,n){if(null==n&&(n=Vd()),!Ud(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:la,webgl_util:jt,forceHalfFloat:function(){f().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Rs,setWebGLContext:$e,GPGPUContext:fa});var Hd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),o=r.value,i=r.grads;if(null!=n){var a=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(a)}else this.applyGradients(i);return Kt(i),t?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return jr(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&Kt(this.iterations_)},t.prototype.saveIterations=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:yn(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}}))}))},t}(Pd);Object.defineProperty(Hd,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var jd=function(e){function t(t,n,r){void 0===r&&(r=null);var o=e.call(this)||this;return o.learningRate=t,o.rho=n,o.epsilon=r,o.accumulatedGrads=[],o.accumulatedUpdates=[],null==r&&(o.epsilon=Le.backend.epsilon()),o}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Le.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:$t((function(){return On(o).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:$t((function(){return On(o).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;$t((function(){var e=a.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(a.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));a.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(o);o.assign(u)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Kt(this.accumulatedGrads.map((function(e){return e.variable}))),Kt(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(Hd);Bd(jd);var Gd=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Le.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:$t((function(){return Rn(o.shape,t.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedGrads[r].variable;$t((function(){var e=a.add(i.square());a.assign(e);var n=i.div(e.add(Le.backend.epsilon()).sqrt()).mul(-t.learningRate).add(o);o.assign(n)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&Kt(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(Hd);Bd(Gd);var qd=function(e){function t(t,n,r,o){void 0===o&&(o=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],$t((function(){i.accBeta1=yn(n).variable(),i.accBeta2=yn(r).variable()})),null==o&&(i.epsilon=Le.backend.epsilon()),i}return a(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);$t((function(){var r=Ju(1,t.accBeta1),o=Ju(1,t.accBeta2);n.forEach((function(n,i){var a=Le.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:$t((function(){return On(a).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:$t((function(){return On(a).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),d=l.div(r),p=f.div(o);u.assign(l),c.assign(f);var h=d.div(p.sqrt().add(t.epsilon)).mul(-t.learningRate).add(a);a.assign(h)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Kt(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Kt(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){var t,n=this;return u(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),$t((function(){n.accBeta1.assign(Ku(n.beta1,n.iterations_+1)),n.accBeta2.assign(Ku(n.beta2,n.iterations_+1))})),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(Hd);Bd(qd);var $d=function(e){function t(t,n,r,o,i){void 0===o&&(o=null),void 0===i&&(i=0);var a=e.call(this)||this;return a.learningRate=t,a.beta1=n,a.beta2=r,a.epsilon=o,a.decay=i,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],$t((function(){a.iteration=yn(0).variable(),a.accBeta1=yn(n).variable()})),null==o&&(a.epsilon=Le.backend.epsilon()),a}return a(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);$t((function(){var r=Ju(1,t.accBeta1),o=Mu(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,i){var a=Le.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:On(a).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:On(a).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2),d=s.abs(),p=f.maximum(d);u.assign(l),c.assign(p);var h=o.div(r).mul(l.div(p.add(t.epsilon))).add(a);a.assign(h)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Kt(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Kt(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(Hd);Bd($d);var Kd=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var i=Le.registeredVariables[n];$t((function(){var e=t.c.mul(o).add(i);i.assign(e)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Xt(yn(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(Hd);Bd(Kd);var Xd=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.learningRate=t,o.momentum=n,o.useNesterov=r,o.accumulations=[],o.m=yn(o.momentum),o}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Le.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:$t((function(){return On(o).variable(!1)}))});var i=t.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[n];null!=a&&$t((function(){var e,n=t.m.mul(i).add(a);e=t.useNesterov?t.c.mul(a.add(n.mul(t.m))).add(o):t.c.mul(n).add(o),i.assign(n),o.assign(e)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Kt(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(Kd);Bd(Xd);var Yd=function(e){function t(t,n,r,o,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1);var a=e.call(this)||this;if(a.learningRate=t,a.decay=n,a.momentum=r,a.epsilon=o,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=i,null==o&&(a.epsilon=Le.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return a(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Le.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:$t((function(){return On(o).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:$t((function(){return On(o).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:$t((function(){return On(o).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;$t((function(){var e=a.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));a.assign(e),n.assign(u),s.assign(c);var l=o.sub(c);o.assign(l)}else{var f=a.mul(t.decay).add(i.square().mul(1-t.decay));c=s.mul(t.momentum).add(i.mul(t.learningRate).div(f.add(t.epsilon).sqrt())),a.assign(f),s.assign(c),l=o.sub(c),o.assign(l)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Kt(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Kt(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Kt(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(Hd);Bd(Yd);var Jd=function(){function e(){}return e.sgd=function(e){return new Kd(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new Xd(e,t,n)},e.rmsprop=function(e,t,n,r,o){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===o&&(o=!1),new Yd(e,t,n,r,o)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new qd(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new jd(e,t,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===o&&(o=0),new $d(e,t,n,r,o)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new Gd(e,t)},e}();Jd.sgd,Jd.momentum,Jd.adadelta,Jd.adagrad,Jd.rmsprop,Jd.adamax,Jd.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;function Zd(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach((function(n,r){var o=n.x,i=n.y,a=t[r];e.moveTo(a.x,a.y),e.lineTo(o,i)})),n){var r=t[t.length-1],o=t[0];if(!r||!o)return;e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)}e.stroke()}Se.prototype.squaredDifference=function(e){return Ds(this,e)},we=bf;n(1299),n(2443);var Qd=function(e,t){return Qd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},Qd(e,t)};function ep(e,t){function n(){this.constructor=e}Qd(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var tp=function(){return tp=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},tp.apply(this,arguments)};function np(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(a){i(a)}}function u(e){try{c(r["throw"](e))}catch(a){i(a)}}function c(e){e.done?n(e.value):o(e.value).then(s,u)}c((r=r.apply(e,t||[])).next())}))}function rp(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(o=2&i[0]?r["return"]:i[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function op(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var ip=function(){function e(e,t){if(!yp(e)||!yp(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function ap(e,t){return e instanceof Se&&e.shape.length===t}function sp(e){return ap(e,1)}function up(e){return ap(e,2)}function cp(e){return ap(e,3)}function lp(e){return ap(e,4)}function fp(e){return e%1!==0}function dp(e){return e%2===0}function pp(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function hp(e){return e&&e.width&&e.height}function vp(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new ip(Math.round(n*o),Math.round(r*o))}function mp(e){return e.reduce((function(e,t){return e.add(t)}),new xp(0,0)).div(new xp(e.length,e.length))}function gp(e,t,n){return Array(e).fill(0).map((function(e,r){return t+r*n}))}function yp(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function bp(e){return yp(e)&&0<=e&&e<=1}var xp=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),wp=function(){function e(t,n){void 0===n&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(yp),i=[r.x,r.y,r.width,r.height].every(yp);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];e.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return e.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(yp)},e.assertIsValidBox=function(t,n,r){if(void 0===r&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new xp(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new xp(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new xp(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new xp(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map((function(e){return Math.round(e)})),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map((function(e){return Math.floor(e)})),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=hp(t)?t.width:t,r=hp(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),c=Math.max(i,0),l=a-u,f=s-c,d=Math.min(l,t-u),p=Math.min(f,n-c);return new e({x:u,y:c,width:d,height:p}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(e,t){var n=this.width+1,r=this.height+1,o=1,i=1,a=n,s=r,u=this.left,c=this.top,l=this.right,f=this.bottom;return l>t&&(a=-l+t+n,l=t),f>e&&(s=-f+e+r,f=e),u<1&&(s=2-u,u=1),c<1&&(s=2-c,c=1),{dy:i,edy:s,dx:o,edx:a,y:c,ey:f,x:u,ex:l,w:n,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Cp=function(e){function t(t,n,r,o,i){return void 0===i&&(i=!1),e.call(this,{left:t,top:n,right:r,bottom:o},i)||this}return ep(t,e),t}(wp),Sp=function(){function e(e,t,n,r,o){this._imageDims=new ip(o.width,o.height),this._score=e,this._classScore=t,this._className=n,this._box=new wp(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new wp(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Ep=function(e){function t(t,n,r){return e.call(this,t,t,"",n,r)||this}return ep(t,e),t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(Sp);function kp(e){var t=e.map((function(e){return e.x})),n=e.map((function(e){return e.y})),r=t.reduce((function(e,t){return t<e?t:e}),1/0),o=n.reduce((function(e,t){return t<e?t:e}),1/0),i=t.reduce((function(e,t){return e<t?t:e}),0),a=n.reduce((function(e,t){return e<t?t:e}),0);return new Cp(r,o,i,a)}function Ip(e,t,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function _p(e,t,n,r){void 0===r&&(r=!0);var o=t.map((function(e,t){return{score:e,boxIndex:t}})).sort((function(e,t){return e.score-t.score})).map((function(e){return e.boxIndex})),i=[],a=function(){var t=o.pop();i.push(t);for(var a=o,s=[],u=0;u<a.length;u++){var c=a[u],l=e[t],f=e[c];s.push(Ip(l,f,r))}o=o.filter((function(e,t){return s[t]<=n}))};while(o.length>0)a();return i}function Rp(e,t){return $t((function(){var n=t[0],r=t[1],o=t[2],i=Rn(op(e.shape.slice(0,3),[1]),n),a=Rn(op(e.shape.slice(0,3),[1]),r),s=Rn(op(e.shape.slice(0,3),[1]),o),u=Fn([i,a,s],3);return Ju(e,u)}))}function Tp(e,t){return void 0===t&&(t=!1),$t((function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(t){var n=e.shape.slice();return n[s]=t,Rn(n,0)},c=u(a),l=i-c.shape[s],f=t&&l?u(l):null,d=[f,e,c].filter((function(e){return!!e})).map((function(e){return e.toFloat()}));return Fn(d,s)}))}function Ap(e){return 1/(1+Math.exp(-e))}var Dp,Op=function(e){function t(t,n,r,o,i){return void 0===i&&(i=!1),e.call(this,{x:t,y:n,width:r,height:o},i)||this}return ep(t,e),t}(wp),Fp=.5,Np=.43,Pp=.45,Mp=function(){function e(e,t,n){void 0===n&&(n=new xp(0,0));var r=t.width,o=t.height;this._imgDims=new ip(r,o),this._shift=n,this._positions=e.map((function(e){return e.mul(new xp(r,o)).add(n)}))}return Object.defineProperty(e.prototype,"shift",{get:function(){return new xp(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map((function(t){return t.sub(e._shift).div(new xp(e.imageWidth,e.imageHeight))}))},enumerable:!0,configurable:!0}),e.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},e.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new xp(e,t))},e.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},e.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof Ep?e.box.floor():new wp(e);return this.shiftBy(n.x,n.y).align(null,t)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),o=r.useDlibAlignment,i=r.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],n=e[1],r=e[2],o=function(e){return r.sub(e).magnitude()},i=(o(t)+o(n))/2,a=Math.floor(i/Pp),s=mp(e),u=Math.floor(Math.max(0,s.x-Fp*a)),c=Math.floor(Math.max(0,s.y-Np*a));return new Op(u,c,Math.min(a,this.imageWidth+u),Math.min(a,this.imageHeight+c))},e.prototype.alignMinBbox=function(e){var t=kp(this.positions);return t.pad(t.width*e,t.height*e)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),Bp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],mp([e[3],e[4]])]},t}(Mp),Wp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(mp)},t}(Mp),Lp=function(){function e(e,t){this._label=e,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+pp(this.distance)+")":"")},e}(),Vp=function(e){function t(t,n){var r=e.call(this,t)||this;return r._label=n,r}return ep(t,e),t.assertIsValidLabeledBox=function(e,t){if(wp.assertIsValidBox(e,t),!yp(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(wp),zp=(n(3753),function(){function e(e,t){if("string"!==typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some((function(e){return!(e instanceof Float32Array)})))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map((function(e){return Array.from(e)}))}},e.fromJSON=function(t){var n=t.descriptors.map((function(e){return new Float32Array(e)}));return new e(t.label,n)},e}());(function(e){function t(t,n,r,o){var i=e.call(this,t,n)||this;return i._score=r,i._classScore=o,i}ep(t,e),t.assertIsValidPredictedBox=function(e,t){if(Vp.assertIsValidLabeledBox(e,t),!bp(e.score)||!bp(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})})(Vp);function Up(e){return e["detection"]instanceof Ep}function Hp(e,t){var n={detection:t};return Object.assign({},e,n)}function jp(){var e=window["fetch"]||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function Gp(e){var t="";if(!e)try{e=n(Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(o){t=o.toString()}var r=e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){return e?r(e):n(t)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:r}}function qp(){var e=n.g["Canvas"]||n.g["HTMLCanvasElement"],t=n.g["Image"]||n.g["HTMLImageElement"],r=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},o=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=n.g["fetch"]||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},a=Gp();return tp({Canvas:e||function(){function e(){}return e}(),CanvasRenderingContext2D:n.g["CanvasRenderingContext2D"]||function(){function e(){}return e}(),Image:t||function(){function e(){}return e}(),ImageData:n.g["ImageData"]||function(){function e(){}return e}(),Video:n.g["HTMLVideoElement"]||function(){function e(){}return e}(),createCanvasElement:r,createImageElement:o,fetch:i},a)}function $p(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}function Kp(){return"object"===typeof n.g&&"undefined"!==typeof process&&!!process.version}function Xp(){if(!Dp)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Dp}function Yp(e){Dp=e}function Jp(){$p()&&Yp(jp()),Kp()&&Yp(qp())}function Zp(e){if(Dp||Jp(),!Dp)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?Dp.Canvas:t,r=e.Image,o=void 0===r?Dp.Image:r;Dp.Canvas=n,Dp.Image=o,Dp.createCanvasElement=e.createCanvasElement||function(){return new n},Dp.createImageElement=e.createImageElement||function(){return new o},Dp.ImageData=e.ImageData||Dp.ImageData,Dp.Video=e.Video||Dp.Video,Dp.fetch=e.fetch||Dp.fetch,Dp.readFile=e.readFile||Dp.readFile}var Qp,eh={getEnv:Xp,setEnv:Yp,initialize:Jp,createBrowserEnv:jp,createFileSystem:Gp,createNodejsEnv:qp,monkeyPatch:Zp,isBrowser:$p,isNodejs:Kp};function th(e){return eh.isNodejs()||"string"!==typeof e?e:document.getElementById(e)}function nh(e){var t=eh.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=th(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}Jp(),function(e){e["TOP_LEFT"]="TOP_LEFT",e["TOP_RIGHT"]="TOP_RIGHT",e["BOTTOM_LEFT"]="BOTTOM_LEFT",e["BOTTOM_RIGHT"]="BOTTOM_RIGHT"}(Qp||(Qp={}));var rh=function(){function e(e){void 0===e&&(e={});var t=e.anchorPosition,n=e.backgroundColor,r=e.fontColor,o=e.fontSize,i=e.fontStyle,a=e.padding;this.anchorPosition=t||Qp.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=i||"Georgia",this.padding=a||4}return e}(),oh=function(){function e(t,n,r){void 0===r&&(r={}),this.text="string"===typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new rh(r)}return e.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map((function(t){return e.measureText(t).width})).reduce((function(e,t){return e<t?t:e}),0)+2*t},e.prototype.measureHeight=function(){var e=this.options,t=e.fontSize,n=e.padding;return this.text.length*t+2*n},e.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,r=n===Qp.BOTTOM_RIGHT||n===Qp.TOP_RIGHT,o=n===Qp.BOTTOM_LEFT||n===Qp.BOTTOM_RIGHT,i=this.measureWidth(e),a=this.measureHeight(),s=r?this.anchor.x-i:this.anchor.x,u=o?this.anchor.y-a:this.anchor.y;if(t){var c=t.width,l=t.height,f=Math.max(Math.min(s,c-i),0),d=Math.max(Math.min(u,l-a),0);return{x:f,y:d}}return{x:s,y:u}},e.prototype.draw=function(e){var t=th(e),n=nh(t),r=this.options,o=r.backgroundColor,i=r.fontColor,a=r.fontSize,s=r.fontStyle,u=r.padding;n.font=a+"px "+s;var c=this.measureWidth(n),l=this.measureHeight();n.fillStyle=o;var f=this.getUpperLeft(n,t);n.fillRect(f.x,f.y,c,l),n.fillStyle=i,this.text.forEach((function(e,t){var r=u+f.x,o=u+f.y+(t+1)*a;n.fillText(e,r,o)}))},e}(),ih=function(){function e(e){void 0===e&&(e={});var t=e.boxColor,n=e.lineWidth,r=e.label,o=e.drawLabelOptions;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:Qp.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new rh(Object.assign({},i,o))}return e}(),ah=function(){function e(e,t){void 0===t&&(t={}),this.box=new wp(e),this.options=new ih(t)}return e.prototype.draw=function(e){var t=nh(e),n=this.options,r=n.boxColor,o=n.lineWidth,i=this.box,a=i.x,s=i.y,u=i.width,c=i.height;t.strokeStyle=r,t.lineWidth=o,t.strokeRect(a,s,u,c);var l=this.options.label;l&&new oh([l],{x:a-o/2,y:s},this.options.drawLabelOptions).draw(e)},e}();function sh(e,t){var n=Array.isArray(t)?t:[t];n.forEach((function(t){var n=t instanceof Ep?t.score:Up(t)?t.detection.score:void 0,r=t instanceof Ep?t.box:Up(t)?t.detection.box:new wp(t),o=n?""+pp(n):void 0;new ah(r,{label:o}).draw(e)}))}function uh(e){var t=eh.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function ch(e){return new Promise((function(t,n){if(e instanceof eh.getEnv().Canvas||uh(e))return t();function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",o),t(e))}function o(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",o),n(e))}e.addEventListener("load",r),e.addEventListener("error",o)}))}function lh(e){return new Promise((function(t,n){if(!(e instanceof Blob))return n("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if("string"!==typeof r.result)return n("bufferToImage - expected reader.result to be a string, in onload");var e=eh.getEnv().createImageElement();e.onload=function(){return t(e)},e.onerror=n,e.src=r.result},r.onerror=n,r.readAsDataURL(e)}))}function fh(e){var t=eh.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new ip(e.naturalWidth,e.naturalHeight):e instanceof r?new ip(e.videoWidth,e.videoHeight):new ip(e.width,e.height)}function dh(e){var t=e.width,n=e.height,r=eh.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function ph(e,t){var n=eh.getEnv().ImageData;if(!(e instanceof n)&&!uh(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||fh(e),o=r.width,i=r.height,a=dh({width:o,height:i});return e instanceof n?nh(a).putImageData(e,0,0):nh(a).drawImage(e,0,0,o,i),a}function hh(e,t){return np(this,void 0,void 0,(function(){var n,r,o,i,a,s;return rp(this,(function(u){switch(u.label){case 0:return n=t||eh.getEnv().createCanvasElement(),r=e.shape.slice(lp(e)?1:0),o=r[0],i=r[1],a=r[2],s=$t((function(){return e.as3D(o,i,a).toInt()})),[4,Nd.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}}))}))}function vh(e){var t=eh.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function mh(e,t,n){void 0===n&&(n=!1);var r=eh.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=fh(e),s=t/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=dh({width:t,height:t}),f=e instanceof i?e:ph(e),d=Math.abs(u-c)/2,p=n&&u<c?d:0,h=n&&c<u?d:0;return nh(l).drawImage(f,p,h,u,c),l}var gh=function(){function e(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((function(e,t){if(cp(e))return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape);if(lp(e)){var r=e.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape.slice(1))}var o=e instanceof eh.getEnv().Canvas?e:ph(e);n._canvases[t]=o,n._inputDimensions[t]=[o.height,o.width,3]}))}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var e=this;return gp(this.batchSize,0,1).map((function(t,n){return e.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),e.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},e.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},e.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},e.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},e.prototype.getReshapedInputDimensions=function(e){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var t=this.getInputWidth(e),n=this.getInputHeight(e);return vp({width:t,height:n},this.inputSize)},e.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,$t((function(){var r=gp(n.batchSize,0,1).map((function(r){var o=n.getInput(r);if(o instanceof Se){var i=lp(o)?o:o.expandDims();return i=Tp(i,t),i.shape[1]===e&&i.shape[2]===e||(i=lf.resizeBilinear(i,[e,e])),i.as3D(e,e,3)}if(o instanceof eh.getEnv().Canvas)return Nd.fromPixels(mh(o,e,t));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)})),o=wr(r.map((function(e){return e.toFloat()}))).as4D(n.batchSize,e,e,3);return o}))},e}();function yh(e){return np(this,void 0,void 0,(function(){var t,n,r;return rp(this,(function(o){switch(o.label){case 0:if(e instanceof gh)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(t){return Array.isArray(e)?" at input index "+t+":":""},r=t.map(th),r.forEach((function(e,r){if(!vh(e)&&!cp(e)&&!lp(e)){if("string"===typeof t[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+t[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(lp(e)){var o=e.shape[0];if(1!==o)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(e){return vh(e)&&ch(e)})))];case 1:return o.sent(),[2,new gh(r,Array.isArray(e))]}}))}))}function bh(e,t){return np(this,void 0,void 0,(function(){var n,r,o,i,a,s,u;return rp(this,(function(c){switch(c.label){case 0:return n=eh.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,yh(e)];case 1:if(o=c.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,hh(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=nh(r),u=t.map((function(e){return e instanceof Ep?e.forSize(r.width,r.height).box.floor():e})).map((function(e){return e.clipAtImageBorders(r.width,r.height)})),[2,u.map((function(e){var t=e.x,n=e.y,r=e.width,o=e.height,i=dh({width:r,height:o});return nh(i).putImageData(s.getImageData(t,n,r,o),0,0),i}))]}}))}))}function xh(e,t){return np(this,void 0,void 0,(function(){return rp(this,(function(n){if(!cp(e)&&!lp(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(lp(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,$t((function(){var n=e.shape.slice(lp(e)?1:0),r=n[0],o=n[1],i=n[2],a=t.map((function(e){return e instanceof Ep?e.forSize(o,r).box:e})).map((function(e){return e.clipAtImageBorders(o,r)})),s=a.map((function(t){var n=t.x,a=t.y,s=t.width,u=t.height;return Kc(e.as3D(r,o,i),[a,n,0],[u,s,i])}));return s}))]}))}))}function wh(e,t){return np(this,void 0,void 0,(function(){var n,r;return rp(this,(function(o){switch(o.label){case 0:return n=eh.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}}))}))}function Ch(e){return np(this,void 0,void 0,(function(){return rp(this,(function(t){switch(t.label){case 0:return[4,wh(e)];case 1:return[2,t.sent().json()]}}))}))}function Sh(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter((function(e){return e})),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function Eh(e,t){return np(this,void 0,void 0,(function(){var n,r,o,i;return rp(this,(function(a){switch(a.label){case 0:return n=Sh(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,Ch(r)];case 1:return i=a.sent(),[2,Dd.loadWeights(i,o)]}}))}))}function kh(e,t,n){void 0===n&&(n=!1);var r=n?fh(t):t,o=r.width,i=r.height;return e.width=o,e.height=i,{width:o,height:i}}var Ih=function(){function e(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e),n=t.obj,r=t.objProp;return n[r]},e.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;r[o].dispose(),r[o]=t},e.prototype.getParamList=function(){var e=this;return this._paramMappings.map((function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}}))},e.prototype.getTrainableParams=function(){return this.getParamList().filter((function(e){return e.tensor instanceof Te}))},e.prototype.getFrozenParams=function(){return this.getParamList().filter((function(e){return!(e.tensor instanceof Te)}))},e.prototype.variable=function(){var e=this;this.getFrozenParams().forEach((function(t){var n=t.path,r=t.tensor;e.reassignParamFromPath(n,r.variable())}))},e.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach((function(t){var n=t.path,r=t.tensor,o=mn(r.dataSync());r.dispose(),e.reassignParamFromPath(n,o)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach((function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()})),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(e){var t=e.tensor;return Array.from(t.dataSync())})).reduce((function(e,t){return e.concat(t)})))},e.prototype.load=function(e){return np(this,void 0,void 0,(function(){return rp(this,(function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.loadFromUri=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,Eh(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}}))}))},e.prototype.loadFromDisk=function(e){return np(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,c,l;return rp(this,(function(f){switch(f.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=eh.getEnv().readFile,n=Sh(e,this.getDefaultModelName()),r=n.manifestUri,o=n.modelBaseUri,i=function(e){return Promise.all(e.map((function(e){return t(e).then((function(e){return e.buffer}))})))},a=Dd.weightsLoaderFactory(i),c=(u=JSON).parse,[4,t(r)];case 1:return s=c.apply(u,[f.sent().toString()]),[4,a(s,o)];case 2:return l=f.sent(),this.loadFromWeightMap(l),[2]}}))}))},e.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.extractWeights=function(e){var t=this.extractParams(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce((function(t,n){if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+e);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}}),{nextObj:this.params}),n=t.obj,r=t.objProp;if(!n||!r||!(n[r]instanceof Se))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:r}},e}();function _h(e,t,n){return $t((function(){var r=_c(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Ou(r,t.bias),r}))}function Rh(e,t,n){return void 0===n&&(n=!1),$t((function(){var r=fl(n?Ou(xc(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):_h(e,t.conv0,[2,2])),o=_h(r,t.conv1,[1,1]),i=fl(Ou(r,o)),a=_h(i,t.conv2,[1,1]);return fl(Ou(r,Ou(o,a)))}))}function Th(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),$t((function(){var o=fl(n?Ou(xc(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):_h(e,t.conv0,r?[2,2]:[1,1])),i=_h(o,t.conv1,[1,1]),a=fl(Ou(o,i)),s=_h(a,t.conv2,[1,1]),u=fl(Ou(o,Ou(i,s))),c=_h(u,t.conv3,[1,1]);return fl(Ou(o,Ou(i,Ou(s,c))))}))}function Ah(e,t,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),$t((function(){var o=Ou(xc(e,t.filters,[1,1],n),t.bias);return r?fl(o):o}))}function Dh(e,t){Object.keys(e).forEach((function(n){t.some((function(e){return e.originalPath===n}))||e[n].dispose()}))}function Oh(e,t){return function(n,r,o,i){var a=Cn(e(n*r*o*o),[o,o,n,r]),s=bn(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function Fh(e,t){return function(n,r,o){var i=xn(e(n*r),[n,r]),a=bn(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var Nh=function(){function e(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}return e}();function Ph(e,t){return function(n,r,o){var i=Cn(e(9*n),[3,3,n,1]),a=Cn(e(n*r),[1,1,n,r]),s=bn(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new Nh(i,a,s)}}function Mh(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new Nh(n,r,o)}}function Bh(e,t){return function(n,r,o){var i=e[n];if(!ap(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function Wh(e){var t=e;function n(e){var n=t.slice(0,e);return t=t.slice(e),n}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function Lh(e,t){var n=Oh(e,t),r=Ph(e,t);function o(e,t,o,i){void 0===i&&(i=!1);var a=i?n(e,t,3,o+"/conv0"):r(e,t,o+"/conv0"),s=r(t,t,o+"/conv1"),u=r(t,t,o+"/conv2");return{conv0:a,conv1:s,conv2:u}}function i(e,t,n,i){void 0===i&&(i=!1);var a=o(e,t,n,i),s=a.conv0,u=a.conv1,c=a.conv2,l=r(t,t,n+"/conv3");return{conv0:s,conv1:u,conv2:c,conv3:l}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function Vh(e){var t=[],n=Wh(e),r=n.extractWeights,o=n.getRemainingWeights,i=Lh(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}function zh(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function Uh(e,t){var n=Bh(e,t),r=zh(n),o=Mh(n);function i(e,t){void 0===t&&(t=!1);var n=t?r(e+"/conv0"):o(e+"/conv0"),i=o(e+"/conv1"),a=o(e+"/conv2");return{conv0:n,conv1:i,conv2:a}}function a(e,t){void 0===t&&(t=!1);var n=t?r(e+"/conv0"):o(e+"/conv0"),i=o(e+"/conv1"),a=o(e+"/conv2"),s=o(e+"/conv3");return{conv0:n,conv1:i,conv2:a,conv3:s}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function Hh(e){var t=[],n=Uh(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Dh(e,t),{params:r,paramMappings:t}}var jh=function(e){function t(){return e.call(this,"FaceFeatureExtractor")||this}return ep(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return $t((function(){var n=e.toBatchTensor(112,!0),r=[122.782,117.001,104.298],o=Rp(n,r).div(yn(255)),i=Th(o,t.dense0,!0);return i=Th(i,t.dense1),i=Th(i,t.dense2),i=Th(i,t.dense3),i=zc(i,[7,7],[2,2],"valid"),i}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Hh(e)},t.prototype.extractParams=function(e){return Vh(e)},t}(Ih);function Gh(e,t){return $t((function(){return Ou(Ac(e,t.weights),t.bias)}))}function qh(e,t,n){var r=[],o=Wh(e),i=o.extractWeights,a=o.getRemainingWeights,s=Fh(i,r),u=s(t,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function $h(e){var t=[],n=Bh(e,t);function r(e){var t=n(e+"/weights",2),r=n(e+"/bias",1);return{weights:t,bias:r}}var o={fc:r("fc")};return Dh(e,t),{params:o,paramMappings:t}}function Kh(e){var t={},n={};return Object.keys(e).forEach((function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]})),{featureExtractorMap:t,classifierMap:n}}var Xh=function(e){function t(t,n){var r=e.call(this,t)||this;return r._faceFeatureExtractor=n,r}return ep(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return $t((function(){var r=e instanceof gh?t.faceFeatureExtractor.forwardInput(e):e;return Gh(r.as2D(r.shape[0],-1),n.fc)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return qh(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var t=Kh(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),$h(r)},t.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,o=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(Ih),Yh=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Jh=function(){function e(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Yh.forEach((function(n,r){t[n]=e[r]}))}return e.prototype.asSortedArray=function(){var e=this;return Yh.map((function(t){return{expression:t,probability:e[t]}})).sort((function(e,t){return t.probability-e.probability}))},e}(),Zh=function(e){function t(t){return void 0===t&&(t=new jh),e.call(this,"FaceExpressionNet",t)||this}return ep(t,e),t.prototype.forwardInput=function(e){var t=this;return $t((function(){return qr(t.runNet(e))}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.predictExpressions=function(e){return np(this,void 0,void 0,(function(){var t,n,r,o,i=this;return rp(this,(function(a){switch(a.label){case 0:return[4,yh(e)];case 1:return t=a.sent(),[4,this.forwardInput(t)];case 2:return n=a.sent(),[4,Promise.all(Er(n).map((function(e){return np(i,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return[4,e.data()];case 1:return t=n.sent(),e.dispose(),[2,t]}}))}))})))];case 3:return r=a.sent(),n.dispose(),o=r.map((function(e){return new Jh(e)})),[2,t.isBatchInput?o:o[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Xh);function Qh(e){return e["expressions"]instanceof Jh}function ev(e,t){var n={expressions:t};return Object.assign({},e,n)}function tv(e,t,n,r){void 0===n&&(n=.1);var o=Array.isArray(t)?t:[t];o.forEach((function(t){var o=t instanceof Jh?t:Qh(t)?t.expressions:void 0;if(!o)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var i=o.asSortedArray(),a=i.filter((function(e){return e.probability>n})),s=Up(t)?t.detection.box.bottomLeft:r||new xp(0,0),u=new oh(a.map((function(e){return e.expression+" ("+pp(e.probability)+")"})),s);u.draw(e)}))}function nv(e){return Up(e)&&e["landmarks"]instanceof Mp&&e["unshiftedLandmarks"]instanceof Mp&&e["alignedRect"]instanceof Ep}function rv(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Ep(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}var ov=function(){function e(e){void 0===e&&(e={});var t=e.drawLines,n=void 0===t||t,r=e.drawPoints,o=void 0===r||r,i=e.lineWidth,a=e.lineColor,s=e.pointSize,u=e.pointColor;this.drawLines=n,this.drawPoints=o,this.lineWidth=i||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=u||"rgba(255, 0, 255, 1)"}return e}(),iv=function(){function e(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new ov(t)}return e.prototype.draw=function(e){var t=nh(e),n=this.options,r=n.drawLines,o=n.drawPoints,i=n.lineWidth,a=n.lineColor,s=n.pointSize,u=n.pointColor;if(r&&this.faceLandmarks instanceof Wp&&(t.strokeStyle=a,t.lineWidth=i,Zd(t,this.faceLandmarks.getJawOutline()),Zd(t,this.faceLandmarks.getLeftEyeBrow()),Zd(t,this.faceLandmarks.getRightEyeBrow()),Zd(t,this.faceLandmarks.getNose()),Zd(t,this.faceLandmarks.getLeftEye(),!0),Zd(t,this.faceLandmarks.getRightEye(),!0),Zd(t,this.faceLandmarks.getMouth(),!0)),o){t.strokeStyle=u,t.fillStyle=u;var c=function(e){t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(c)}},e}();function av(e,t){var n=Array.isArray(t)?t:[t];n.forEach((function(t){var n=t instanceof Mp?t:nv(t)?t.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new iv(n).draw(e)}))}function sv(e,t){var n=Oh(e,t),r=Ph(e,t);function o(e,t,o){var i=r(e,t,o+"/separable_conv0"),a=r(t,t,o+"/separable_conv1"),s=n(e,t,1,o+"/expansion_conv");return{separable_conv0:i,separable_conv1:a,expansion_conv:s}}function i(e,t){var n=r(e,e,t+"/separable_conv0"),o=r(e,e,t+"/separable_conv1"),i=r(e,e,t+"/separable_conv2");return{separable_conv0:n,separable_conv1:o,separable_conv2:i}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function uv(e,t){var n=[],r=Wh(e),o=r.extractWeights,i=r.getRemainingWeights,a=sv(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,f=s(3,32,3,"entry_flow/conv_in"),d=c(32,64,"entry_flow/reduction_block_0"),p=c(64,128,"entry_flow/reduction_block_1"),h={conv_in:f,reduction_block_0:d,reduction_block_1:p},v={};gp(t,0,1).forEach((function(e){v["main_block_"+e]=l(128,"middle_flow/main_block_"+e)}));var m=c(128,256,"exit_flow/reduction_block"),g=u(256,512,"exit_flow/separable_conv"),y={reduction_block:m,separable_conv:g};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:h,middle_flow:v,exit_flow:y}}}function cv(e,t){var n=Bh(e,t),r=zh(n),o=Mh(n);function i(e){var t=o(e+"/separable_conv0"),n=o(e+"/separable_conv1"),i=r(e+"/expansion_conv");return{separable_conv0:t,separable_conv1:n,expansion_conv:i}}function a(e){var t=o(e+"/separable_conv0"),n=o(e+"/separable_conv1"),r=o(e+"/separable_conv2");return{separable_conv0:t,separable_conv1:n,separable_conv2:r}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function lv(e,t){var n=[],r=cv(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),c=a("entry_flow/reduction_block_0"),l=a("entry_flow/reduction_block_1"),f={conv_in:u,reduction_block_0:c,reduction_block_1:l},d={};gp(t,0,1).forEach((function(e){d["main_block_"+e]=s("middle_flow/main_block_"+e)}));var p=a("exit_flow/reduction_block"),h=i("exit_flow/separable_conv"),v={reduction_block:p,separable_conv:h};return Dh(e,n),{params:{entry_flow:f,middle_flow:d,exit_flow:v},paramMappings:n}}function fv(e,t,n){return Ou(xc(e,t.filters,n,"same"),t.bias)}function dv(e,t,n){void 0===n&&(n=!0);var r=n?fl(e):e;return r=_h(r,t.separable_conv0,[1,1]),r=_h(fl(r),t.separable_conv1,[1,1]),r=Vc(r,[3,3],[2,2],"same"),r=Ou(r,fv(e,t.expansion_conv,[2,2])),r}function pv(e,t){var n=_h(fl(e),t.separable_conv0,[1,1]);return n=_h(fl(n),t.separable_conv1,[1,1]),n=_h(fl(n),t.separable_conv2,[1,1]),n=Ou(n,e),n}var hv,vv=function(e){function t(t){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=t,n}return ep(t,e),t.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return $t((function(){var r=e.toBatchTensor(112,!0),o=[122.782,117.001,104.298],i=Rp(r,o).div(yn(256)),a=fl(fv(i,n.entry_flow.conv_in,[2,2]));return a=dv(a,n.entry_flow.reduction_block_0,!1),a=dv(a,n.entry_flow.reduction_block_1),gp(t._numMainBlocks,0,1).forEach((function(e){a=pv(a,n.middle_flow["main_block_"+e])})),a=dv(a,n.exit_flow.reduction_block),a=fl(_h(a,n.exit_flow.separable_conv,[1,1])),a}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return lv(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return uv(e,this._numMainBlocks)},t}(Ih);function mv(e){var t=[],n=Wh(e),r=n.extractWeights,o=n.getRemainingWeights,i=Fh(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function gv(e){var t=[],n=Bh(e,t);function r(e){var t=n(e+"/weights",2),r=n(e+"/bias",1);return{weights:t,bias:r}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Dh(e,t),{params:o,paramMappings:t}}(function(e){e["FEMALE"]="female",e["MALE"]="male"})(hv||(hv={}));var yv=function(e){function t(t){void 0===t&&(t=new vv(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=t,n}return ep(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return $t((function(){var r=e instanceof gh?t.faceFeatureExtractor.forwardInput(e):e,o=zc(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1),i=Gh(o,n.fc.age).as1D(),a=Gh(o,n.fc.gender);return{age:i,gender:a}}))},t.prototype.forwardInput=function(e){var t=this;return $t((function(){var n=t.runNet(e),r=n.age,o=n.gender;return{age:r,gender:qr(o)}}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.predictAgeAndGender=function(e){return np(this,void 0,void 0,(function(){var t,n,r,o,i,a,s=this;return rp(this,(function(u){switch(u.label){case 0:return[4,yh(e)];case 1:return t=u.sent(),[4,this.forwardInput(t)];case 2:return n=u.sent(),r=Er(n.age),o=Er(n.gender),i=r.map((function(e,t){return{ageTensor:e,genderTensor:o[t]}})),[4,Promise.all(i.map((function(e){var t=e.ageTensor,n=e.genderTensor;return np(s,void 0,void 0,(function(){var e,r,o,i,a;return rp(this,(function(s){switch(s.label){case 0:return[4,t.data()];case 1:return e=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],o=r>.5,i=o?hv.MALE:hv.FEMALE,a=o?r:1-r,t.dispose(),n.dispose(),[2,{age:e,gender:i,genderProbability:a}]}}))}))})))];case 3:return a=u.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?a:a[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return mv(e)},t.prototype.extractParamsFromWeigthMap=function(e){var t=Kh(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),gv(r)},t.prototype.extractParams=function(e){var t=1539,n=e.slice(0,e.length-t),r=e.slice(e.length-t);return this.faceFeatureExtractor.extractWeights(n),this.extractClassifierParams(r)},t}(Ih),bv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.postProcess=function(e,t,n){var r=n.map((function(e){var n=e.width,r=e.height,o=t/Math.max(r,n);return{width:n*o,height:r*o}})),o=r.length;return $t((function(){var n=function(e,t){return wr([Rn([68],e),Rn([68],t)],1).as2D(1,136).as1D()},i=function(e,t){var n=r[e],o=n.width,i=n.height;return t(o,i)?Math.abs(o-i)/2:0},a=function(e){return i(e,(function(e,t){return e<t}))},s=function(e){return i(e,(function(e,t){return t<e}))},u=e.mul(Rn([o,136],t)).sub(wr(Array.from(Array(o),(function(e,t){return n(a(t),s(t))})))).div(wr(Array.from(Array(o),(function(e,t){return n(r[t].width,r[t].height)}))));return u}))},t.prototype.forwardInput=function(e){var t=this;return $t((function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map((function(e){var t=e[0],n=e[1];return{height:t,width:n}})))}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.detectLandmarks=function(e){return np(this,void 0,void 0,(function(){var t,n,r,o=this;return rp(this,(function(i){switch(i.label){case 0:return[4,yh(e)];case 1:return t=i.sent(),n=$t((function(){return Er(o.forwardInput(t))})),[4,Promise.all(n.map((function(e,n){return np(o,void 0,void 0,(function(){var r,o,i,a,s;return rp(this,(function(u){switch(u.label){case 0:return i=(o=Array).from,[4,e.data()];case 1:return r=i.apply(o,[u.sent()]),a=r.filter((function(e,t){return dp(t)})),s=r.filter((function(e,t){return!dp(t)})),[2,new Wp(Array(68).fill(0).map((function(e,t){return new xp(a[t],s[t])})),{height:t.getInputHeight(n),width:t.getInputWidth(n)})]}}))}))})))];case 2:return r=i.sent(),n.forEach((function(e){return e.dispose()})),[2,t.isBatchInput?r:r[0]]}}))}))},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Xh),xv=function(e){function t(t){return void 0===t&&(t=new jh),e.call(this,"FaceLandmark68Net",t)||this}return ep(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(bv);function wv(e){var t=[],n=Uh(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Dh(e,t),{params:r,paramMappings:t}}function Cv(e){var t=[],n=Wh(e),r=n.extractWeights,o=n.getRemainingWeights,i=Lh(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var Sv=function(e){function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return ep(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return $t((function(){var n=e.toBatchTensor(112,!0),r=[122.782,117.001,104.298],o=Rp(n,r).div(yn(255)),i=Rh(o,t.dense0,!0);return i=Rh(i,t.dense1),i=Rh(i,t.dense2),i=zc(i,[14,14],[2,2],"valid"),i}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return wv(e)},t.prototype.extractParams=function(e){return Cv(e)},t}(Ih),Ev=function(e){function t(t){return void 0===t&&(t=new Sv),e.call(this,"FaceLandmark68TinyNet",t)||this}return ep(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(bv);(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}ep(t,e)})(xv);function kv(e,t){return Ou(qu(e,t.weights),t.biases)}function Iv(e,t,n,r,o){void 0===o&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=xc(e,a,n,o);return u=Ou(u,s),u=kv(u,t.scale),r?fl(u):u}function _v(e,t){return Iv(e,t,[1,1],!0)}function Rv(e,t){return Iv(e,t,[1,1],!1)}function Tv(e,t){return Iv(e,t,[2,2],!0,"valid")}function Av(e,t){function n(t,n,r){var o=e(t),i=o.length/(n*r*r);if(fp(i))throw new Error("depth has to be an integer: "+i+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return $t((function(){return hl(Cn(o,[n,i,r,r]),[2,3,1,0])}))}function r(r,o,i,a){var s=n(r,o,i),u=bn(e(o));return t.push({paramPath:a+"/filters"},{paramPath:a+"/bias"}),{filters:s,bias:u}}function o(n,r){var o=bn(e(n)),i=bn(e(n));return t.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:o,biases:i}}function i(e,t,n,i){var a=r(e,t,n,i+"/conv"),s=o(t,i+"/scale");return{conv:a,scale:s}}function a(e,t,n,r,o){void 0===o&&(o=!1);var a=i((o?.5:1)*e,t,n,r+"/conv1"),s=i(e,t,n,r+"/conv2");return{conv1:a,conv2:s}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function Dv(e){var t=Wh(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=Av(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),f=s(9216,32,3,"conv32_3"),d=s(36864,64,3,"conv64_down",!0),p=s(36864,64,3,"conv64_1"),h=s(36864,64,3,"conv64_2"),v=s(36864,64,3,"conv64_3"),m=s(147456,128,3,"conv128_down",!0),g=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),C=s(589824,256,3,"conv256_down_out"),S=$t((function(){return hl(xn(n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);var E={conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:f,conv64_down:d,conv64_1:p,conv64_2:h,conv64_3:v,conv128_down:m,conv128_1:g,conv128_2:y,conv256_down:b,conv256_1:x,conv256_2:w,conv256_down_out:C,fc:S};return{params:E,paramMappings:o}}function Ov(e,t){var n=Bh(e,t);function r(e){var t=n(e+"/scale/weights",1),r=n(e+"/scale/biases",1);return{weights:t,biases:r}}function o(e){var t=n(e+"/conv/filters",4),o=n(e+"/conv/bias",1),i=r(e);return{conv:{filters:t,bias:o},scale:i}}function i(e){return{conv1:o(e+"/conv1"),conv2:o(e+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function Fv(e){var t=[],n=Ov(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),c=o("conv64_down"),l=o("conv64_1"),f=o("conv64_2"),d=o("conv64_3"),p=o("conv128_down"),h=o("conv128_1"),v=o("conv128_2"),m=o("conv256_down"),g=o("conv256_1"),y=o("conv256_2"),b=o("conv256_down_out"),x=e["fc"];if(t.push({originalPath:"fc",paramPath:"fc"}),!up(x))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var w={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:f,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:v,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:x};return Dh(e,t),{params:w,paramMappings:t}}function Nv(e,t){var n=_v(e,t.conv1);return n=Rv(n,t.conv2),n=Ou(n,e),n=fl(n),n}function Pv(e,t){var n=Tv(e,t.conv1);n=Rv(n,t.conv2);var r=zc(e,2,2,"valid"),o=_n(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=op(n.shape);s[1]=1;var u=_n(s);n=Fn([n,u],1);var c=op(n.shape);c[2]=1;var l=_n(c);n=Fn([n,l],2)}return r=i?Fn([r,o],3):r,n=Ou(r,n),n=fl(n),n}var Mv=function(e){function t(){return e.call(this,"FaceRecognitionNet")||this}return ep(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return $t((function(){var n=e.toBatchTensor(150,!0).toFloat(),r=[122.782,117.001,104.298],o=Rp(n,r).div(yn(256)),i=Tv(o,t.conv32_down);i=Vc(i,3,2,"valid"),i=Nv(i,t.conv32_1),i=Nv(i,t.conv32_2),i=Nv(i,t.conv32_3),i=Pv(i,t.conv64_down),i=Nv(i,t.conv64_1),i=Nv(i,t.conv64_2),i=Nv(i,t.conv64_3),i=Pv(i,t.conv128_down),i=Nv(i,t.conv128_1),i=Nv(i,t.conv128_2),i=Pv(i,t.conv256_down),i=Nv(i,t.conv256_1),i=Nv(i,t.conv256_2),i=Pv(i,t.conv256_down_out);var a=i.mean([1,2]),s=Ac(a,t.fc);return s}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.computeFaceDescriptor=function(e){return np(this,void 0,void 0,(function(){var t,n,r,o=this;return rp(this,(function(i){switch(i.label){case 0:return[4,yh(e)];case 1:return t=i.sent(),n=$t((function(){return Er(o.forwardInput(t))})),[4,Promise.all(n.map((function(e){return e.data()})))];case 2:return r=i.sent(),n.forEach((function(e){return e.dispose()})),[2,t.isBatchInput?r:r[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Fv(e)},t.prototype.extractParams=function(e){return Dv(e)},t}(Ih);function Bv(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var Wv=function(){function e(e){var t=void 0===e?{}:e,n=t.minFaceSize,r=t.scaleFactor,o=t.maxNumScales,i=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=a,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(e){return"number"!==typeof e})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(e){return"number"!==typeof e}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function Lv(e,t){function n(n,r){var o=Cn(e(9*n),[3,3,n,1]),i=bn(e(n)),a=bn(e(n)),s=bn(e(n)),u=bn(e(n));return t.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:o,batch_norm_scale:i,batch_norm_offset:a,batch_norm_mean:s,batch_norm_variance:u}}function r(n,r,o,i,a){var s=Cn(e(n*r*o*o),[o,o,n,r]),u=bn(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:u}}function o(e,t,n,o){var i=r(e,t,n,o,!0),a=i.filters,s=i.bias;return{filters:a,batch_norm_offset:s}}function i(e,t,r){var i=n(e,r+"/depthwise_conv"),a=o(e,t,1,r+"/pointwise_conv");return{depthwise_conv:i,pointwise_conv:a}}function a(){var e=o(3,32,3,"mobilenetv1/conv_0"),t=i(32,64,"mobilenetv1/conv_1"),n=i(64,128,"mobilenetv1/conv_2"),r=i(128,128,"mobilenetv1/conv_3"),a=i(128,256,"mobilenetv1/conv_4"),s=i(256,256,"mobilenetv1/conv_5"),u=i(256,512,"mobilenetv1/conv_6"),c=i(512,512,"mobilenetv1/conv_7"),l=i(512,512,"mobilenetv1/conv_8"),f=i(512,512,"mobilenetv1/conv_9"),d=i(512,512,"mobilenetv1/conv_10"),p=i(512,512,"mobilenetv1/conv_11"),h=i(512,1024,"mobilenetv1/conv_12"),v=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:e,conv_1:t,conv_2:n,conv_3:r,conv_4:a,conv_5:s,conv_6:u,conv_7:c,conv_8:l,conv_9:f,conv_10:d,conv_11:p,conv_12:h,conv_13:v}}function s(){var e=o(1024,256,1,"prediction_layer/conv_0"),t=o(256,512,3,"prediction_layer/conv_1"),n=o(512,128,1,"prediction_layer/conv_2"),i=o(128,256,3,"prediction_layer/conv_3"),a=o(256,128,1,"prediction_layer/conv_4"),s=o(128,256,3,"prediction_layer/conv_5"),u=o(256,64,1,"prediction_layer/conv_6"),c=o(64,128,3,"prediction_layer/conv_7"),l=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),f=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),d=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),p=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),h=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),v=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),m=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),g=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),y=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),b=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),x=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),w=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),C={box_encoding_predictor:l,class_predictor:f},S={box_encoding_predictor:d,class_predictor:p},E={box_encoding_predictor:h,class_predictor:v},k={box_encoding_predictor:m,class_predictor:g},I={box_encoding_predictor:y,class_predictor:b},_={box_encoding_predictor:x,class_predictor:w};return{conv_0:e,conv_1:t,conv_2:n,conv_3:i,conv_4:a,conv_5:s,conv_6:u,conv_7:c,box_predictor_0:C,box_predictor_1:S,box_predictor_2:E,box_predictor_3:k,box_predictor_4:I,box_predictor_5:_}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function Vv(e){var t=[],n=Wh(e),r=n.extractWeights,o=n.getRemainingWeights,i=Lv(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),c=s(),l=wn(r(20472),[1,5118,4]),f={extra_dim:l};if(t.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:f},paramMappings:t}}function zv(e,t){var n=Bh(e,t);function r(e,t,r){var o=n(e+"/Conv2d_"+t+"_pointwise/weights",4,r+"/filters"),i=n(e+"/Conv2d_"+t+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset");return{filters:o,batch_norm_offset:i}}function o(e){var t="mobilenetv1/conv_"+e,o="MobilenetV1/Conv2d_"+e+"_depthwise",i=t+"/depthwise_conv",a=t+"/pointwise_conv",s=n(o+"/depthwise_weights",4,i+"/filters"),u=n(o+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),c=n(o+"/BatchNorm/beta",1,i+"/batch_norm_offset"),l=n(o+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),f=n(o+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance");return{depthwise_conv:{filters:s,batch_norm_scale:u,batch_norm_offset:c,batch_norm_mean:l,batch_norm_variance:f},pointwise_conv:r("MobilenetV1",e,a)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(e,t){var r=n(e+"/weights",4,t+"/filters"),o=n(e+"/biases",1,t+"/bias");return{filters:r,bias:o}}function s(e){var t=a("Prediction/BoxPredictor_"+e+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+e+"/box_encoding_predictor"),n=a("Prediction/BoxPredictor_"+e+"/ClassPredictor","prediction_layer/box_predictor_"+e+"/class_predictor");return{box_encoding_predictor:t,class_predictor:n}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function Uv(e){var t=[],n=zv(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!cp(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Dh(e,t),{params:a,paramMappings:t}}function Hv(e,t,n){return $t((function(){var r=xc(e,t.filters,n,"same");return r=Ou(r,t.batch_norm_offset),Vs(r,0,6)}))}var jv=.0010000000474974513;function Gv(e,t,n){return $t((function(){var r=Ec(e,t.filters,n,"same");return r=Cu(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,jv),Vs(r,0,6)}))}function qv(e){return[2,4,6,12].some((function(t){return t===e}))?[2,2]:[1,1]}function $v(e,t){return $t((function(){var n=null,r=Hv(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach((function(e,t){var o=t+1,i=qv(o);r=Gv(r,e.depthwise_conv,i),r=Hv(r,e.pointwise_conv,[1,1]),11===o&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}function Kv(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map((function(e,t){return{score:e,boxIndex:t}})).filter((function(e){return e.score>o})).sort((function(e,t){return t.score-e.score})),u=function(e){return e<=r?1:0},c=[];return s.forEach((function(t){if(!(c.length>=a)){for(var n=t.score,r=c.length-1;r>=0;--r){var i=Xv(e,t.boxIndex,c[r]);if(0!==i&&(t.score*=u(i),t.score<=o))break}n===t.score&&c.push(t.boxIndex)}})),c}function Xv(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),f=Math.max(r[n][1],r[n][3]),d=(a-o)*(s-i),p=(l-u)*(f-c);if(d<=0||p<=0)return 0;var h=Math.max(o,u),v=Math.max(i,c),m=Math.min(a,l),g=Math.min(s,f),y=Math.max(m-h,0)*Math.max(g-v,0);return y/(d+p-y)}function Yv(e){var t=Er(hl(e,[1,0])),n=[Ju(t[2],t[0]),Ju(t[3],t[1])],r=[Ou(t[0],Mu(n[0],yn(2))),Ou(t[1],Mu(n[1],yn(2)))];return{sizes:n,centers:r}}function Jv(e,t){var n=Yv(e),r=n.sizes,o=n.centers,i=Er(hl(t,[1,0])),a=Mu(qu(js(Mu(i[2],yn(5))),r[0]),yn(2)),s=Ou(qu(Mu(i[0],yn(10)),r[0]),o[0]),u=Mu(qu(js(Mu(i[3],yn(5))),r[1]),yn(2)),c=Ou(qu(Mu(i[1],yn(10)),r[1]),o[1]);return hl(wr([Ju(s,a),Ju(c,u),Ou(s,a),Ou(c,u)]),[1,0])}function Zv(e,t,n){return $t((function(){var r=e.shape[0],o=Jv(yr(Cr(n.extra_dim,[r,1,1]),[-1,4]),yr(e,[-1,4]));o=yr(o,[r,o.shape[0]/r,4]);var i=eu(Gc(t,[0,0,1],[-1,-1,-1])),a=Gc(i,[0,0,0],[-1,-1,1]);a=yr(a,[r,a.shape[1]]);var s=Er(o),u=Er(a);return{boxes:s,scores:u}}))}function Qv(e,t){return $t((function(){var n=e.shape[0],r=yr(Ah(e,t.box_encoding_predictor),[n,-1,1,4]),o=yr(Ah(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}}))}function em(e,t,n){return $t((function(){var r=Hv(e,n.conv_0,[1,1]),o=Hv(r,n.conv_1,[2,2]),i=Hv(o,n.conv_2,[1,1]),a=Hv(i,n.conv_3,[2,2]),s=Hv(a,n.conv_4,[1,1]),u=Hv(s,n.conv_5,[2,2]),c=Hv(u,n.conv_6,[1,1]),l=Hv(c,n.conv_7,[2,2]),f=Qv(t,n.box_predictor_0),d=Qv(e,n.box_predictor_1),p=Qv(o,n.box_predictor_2),h=Qv(a,n.box_predictor_3),v=Qv(u,n.box_predictor_4),m=Qv(l,n.box_predictor_5),g=Fn([f.boxPredictionEncoding,d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding],1),y=Fn([f.classPrediction,d.classPrediction,p.classPrediction,h.classPrediction,v.classPrediction,m.classPrediction],1);return{boxPredictions:g,classPredictions:y}}))}var tm=function(){function e(e){var t=void 0===e?{}:e,n=t.minConfidence,r=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),nm=function(e){function t(){return e.call(this,"SsdMobilenetv1")||this}return ep(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return $t((function(){var n=e.toBatchTensor(512,!1).toFloat(),r=Ju(qu(n,yn(.007843137718737125)),yn(1)),o=$v(r,t.mobilenetv1),i=em(o.out,o.conv11,t.prediction_layer),a=i.boxPredictions,s=i.classPredictions;return Zv(a,s,t.output_layer)}))},t.prototype.forward=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yh(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),np(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,d,p,h,v,m,g,y,b,x,w,C;return rp(this,(function(S){switch(S.label){case 0:return n=new tm(t),r=n.maxResults,o=n.minConfidence,[4,yh(e)];case 1:for(i=S.sent(),a=this.forwardInput(i),s=a.boxes,u=a.scores,c=s[0],l=u[0],f=1;f<s.length;f++)s[f].dispose(),u[f].dispose();return h=(p=Array).from,[4,l.data()];case 2:return d=h.apply(p,[S.sent()]),v=.5,m=Kv(c,d,r,v,o),g=i.getReshapedInputDimensions(0),y=i.inputSize,b=y/g.width,x=y/g.height,w=c.arraySync(),C=m.map((function(e){var t=[Math.max(0,w[e][0]),Math.min(1,w[e][2])].map((function(e){return e*x})),n=t[0],r=t[1],o=[Math.max(0,w[e][1]),Math.min(1,w[e][3])].map((function(e){return e*b})),a=o[0],s=o[1];return new Ep(d[e],new Op(a,n,s-a,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})})),c.dispose(),l.dispose(),[2,C]}}))}))},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Uv(e)},t.prototype.extractParams=function(e){return Vv(e)},t}(Ih);(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}ep(t,e)})(nm);var rm,om=.4,im=[new xp(.738768,.874946),new xp(2.42204,2.65704),new xp(4.30971,7.04493),new xp(10.246,4.59428),new xp(12.6868,11.8741)],am=[new xp(1.603231,2.094468),new xp(6.041143,7.080126),new xp(2.882459,3.518061),new xp(4.266906,5.178857),new xp(9.041765,10.66308)],sm=[117.001,114.697,97.404],um="tiny_yolov2_model",cm="tiny_yolov2_separable_conv_model",lm=function(e){return"number"===typeof e};function fm(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!==typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!lm(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every((function(e){return"string"===typeof e})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map((function(e){return e||{}})).every((function(e){return lm(e.x)&&lm(e.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(lm)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function dm(e){return $t((function(){var t=qu(e,yn(.10000000149011612));return Ou(fl(Ju(e,t)),t)}))}function pm(e,t){return $t((function(){var n=cr(e,[[0,0],[1,1],[1,1],[0,0]]);return n=xc(n,t.conv.filters,[1,1],"valid"),n=Ju(n,t.bn.sub),n=qu(n,t.bn.truediv),n=Ou(n,t.conv.bias),dm(n)}))}function hm(e,t){return $t((function(){var n=cr(e,[[0,0],[1,1],[1,1],[0,0]]);return n=_c(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ou(n,t.bias),dm(n)}))}function vm(e,t){var n=Oh(e,t);function r(n,r){var o=bn(e(n)),i=bn(e(n));return t.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:o,truediv:i}}function o(e,t,o){var i=n(e,t,3,o+"/conv"),a=r(t,o+"/bn");return{conv:i,bn:a}}var i=Ph(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function mm(e,t,n,r){var o,i=Wh(e),a=i.extractWeights,s=i.getRemainingWeights,u=[],c=vm(a,u),l=c.extractConvParams,f=c.extractConvWithBatchNormParams,d=c.extractSeparableConvParams;if(t.withSeparableConvs){var p=r[0],h=r[1],v=r[2],m=r[3],g=r[4],y=r[5],b=r[6],x=r[7],w=r[8],C=t.isFirstLayerConv2d?l(p,h,3,"conv0"):d(p,h,"conv0"),S=d(h,v,"conv1"),E=d(v,m,"conv2"),k=d(m,g,"conv3"),I=d(g,y,"conv4"),_=d(y,b,"conv5"),R=x?d(b,x,"conv6"):void 0,T=w?d(x,w,"conv7"):void 0,A=l(w||x||b,5*n,1,"conv8");o={conv0:C,conv1:S,conv2:E,conv3:k,conv4:I,conv5:_,conv6:R,conv7:T,conv8:A}}else{p=r[0],h=r[1],v=r[2],m=r[3],g=r[4],y=r[5],b=r[6],x=r[7],w=r[8],C=f(p,h,"conv0"),S=f(h,v,"conv1"),E=f(v,m,"conv2"),k=f(m,g,"conv3"),I=f(g,y,"conv4"),_=f(y,b,"conv5"),R=f(b,x,"conv6"),T=f(x,w,"conv7"),A=l(w,5*n,1,"conv8");o={conv0:C,conv1:S,conv2:E,conv3:k,conv4:I,conv5:_,conv6:R,conv7:T,conv8:A}}if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:o,paramMappings:u}}function gm(e,t){var n=Bh(e,t);function r(e){var t=n(e+"/sub",1),r=n(e+"/truediv",1);return{sub:t,truediv:r}}function o(e){var t=n(e+"/filters",4),r=n(e+"/bias",1);return{filters:t,bias:r}}function i(e){var t=o(e+"/conv"),n=r(e+"/bn");return{conv:t,bn:n}}var a=Mh(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function ym(e,t){var n,r=[],o=gm(e,r),i=o.extractConvParams,a=o.extractConvWithBatchNormParams,s=o.extractSeparableConvParams;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:i("conv8")};return Dh(e,r),{params:n,paramMappings:r}}(function(e){e[e["XS"]=224]="XS",e[e["SM"]=320]="SM",e[e["MD"]=416]="MD",e[e["LG"]=608]="LG"})(rm||(rm={}));var bm=function(){function e(e){var t=void 0===e?{}:e,n=t.inputSize,r=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),xm=function(e){function t(t){var n=e.call(this,"TinyYolov2")||this;return fm(t),n._config=t,n}return ep(t,e),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,t){var n=pm(e,t.conv0);return n=Vc(n,[2,2],[2,2],"same"),n=pm(n,t.conv1),n=Vc(n,[2,2],[2,2],"same"),n=pm(n,t.conv2),n=Vc(n,[2,2],[2,2],"same"),n=pm(n,t.conv3),n=Vc(n,[2,2],[2,2],"same"),n=pm(n,t.conv4),n=Vc(n,[2,2],[2,2],"same"),n=pm(n,t.conv5),n=Vc(n,[2,2],[1,1],"same"),n=pm(n,t.conv6),n=pm(n,t.conv7),Ah(n,t.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?dm(Ah(e,t.conv0,"valid",!1)):hm(e,t.conv0);return n=Vc(n,[2,2],[2,2],"same"),n=hm(n,t.conv1),n=Vc(n,[2,2],[2,2],"same"),n=hm(n,t.conv2),n=Vc(n,[2,2],[2,2],"same"),n=hm(n,t.conv3),n=Vc(n,[2,2],[2,2],"same"),n=hm(n,t.conv4),n=Vc(n,[2,2],[2,2],"same"),n=hm(n,t.conv5),n=Vc(n,[2,2],[1,1],"same"),n=t.conv6?hm(n,t.conv6):n,n=t.conv7?hm(n,t.conv7):n,Ah(n,t.conv8,"valid",!1)},t.prototype.forwardInput=function(e,t){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return $t((function(){var o=e.toBatchTensor(t,!1).toFloat();return o=n.config.meanRgb?Rp(o,n.config.meanRgb):o,o=o.div(yn(256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)}))},t.prototype.forward=function(e,t){return np(this,void 0,void 0,(function(){var n;return rp(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yh(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent()]}}))}))},t.prototype.detect=function(e,t){return void 0===t&&(t={}),np(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,d,p,h,v,m=this;return rp(this,(function(g){switch(g.label){case 0:return n=new bm(t),r=n.inputSize,o=n.scoreThreshold,[4,yh(e)];case 1:return i=g.sent(),[4,this.forwardInput(i,r)];case 2:return a=g.sent(),s=$t((function(){return Er(a)[0].expandDims()})),u={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),o)];case 3:return c=g.sent(),a.dispose(),s.dispose(),l=c.map((function(e){return e.box})),f=c.map((function(e){return e.score})),d=c.map((function(e){return e.classScore})),p=c.map((function(e){return m.config.classes[e.label]})),h=_p(l.map((function(e){return e.rescale(r)})),f,this.config.iouThreshold,!0),v=h.map((function(e){return new Sp(f[e],d[e],p[e],l[e],u)})),[2,v]}}))}))},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return ym(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return mm(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,t,n){return np(this,void 0,void 0,(function(){var r,o,i,a,s,u,c,l,f,d,p,h,v,m,g,y,b,x,w,C,S,E,k,I,_,R,T,A,D,O=this;return rp(this,(function(F){switch(F.label){case 0:return r=t.width,o=t.height,i=Math.max(r,o),a=i/r,s=i/o,u=e.shape[1],c=this.config.anchors.length,l=$t((function(){var t=e.reshape([u,u,c,O.boxEncodingSize]),n=t.slice([0,0,0,0],[u,u,c,4]),r=t.slice([0,0,0,4],[u,u,c,1]),o=O.withClassScores?qr(t.slice([0,0,0,5],[u,u,c,O.config.classes.length]),3):yn(0);return[n,r,o]})),f=l[0],d=l[1],p=l[2],h=[],[4,d.array()];case 1:return v=F.sent(),[4,f.array()];case 2:m=F.sent(),g=0,F.label=3;case 3:if(!(g<u))return[3,12];y=0,F.label=4;case 4:if(!(y<u))return[3,11];b=0,F.label=5;case 5:return b<c?(x=Ap(v[g][y][b][0]),!n||x>n?(w=(y+Ap(m[g][y][b][0]))/u*a,C=(g+Ap(m[g][y][b][1]))/u*s,S=Math.exp(m[g][y][b][2])*this.config.anchors[b].x/u*a,E=Math.exp(m[g][y][b][3])*this.config.anchors[b].y/u*s,k=w-S/2,I=C-E/2,_={row:g,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(p,_)]:[3,7]):[3,9]):[3,10];case 6:return D=F.sent(),[3,8];case 7:D={classScore:1,label:0},F.label=8;case 8:R=D,T=R.classScore,A=R.label,h.push(tp({box:new Cp(k,I,k+S,I+E),score:x,classScore:x*T,label:A},_)),F.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return g++,[3,3];case 12:return f.dispose(),d.dispose(),p.dispose(),[2,h]}}))}))},t.prototype.extractPredictedClass=function(e,t){return np(this,void 0,void 0,(function(){var n,r,o,i;return rp(this,(function(a){switch(a.label){case 0:return n=t.row,r=t.col,o=t.anchor,[4,e.array()];case 1:return i=a.sent(),[2,Array(this.config.classes.length).fill(0).map((function(e,t){return i[n][r][o][t]})).map((function(e,t){return{classScore:e,label:t}})).reduce((function(e,t){return e.classScore>t.classScore?e:t}))]}}))}))},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Ih),wm=function(e){function t(t){void 0===t&&(t=!0);var n=this,r=Object.assign({},{withSeparableConvs:t,iouThreshold:om,classes:["face"]},t?{anchors:am,meanRgb:sm}:{anchors:im,withClassScores:!0});return n=e.call(this,r)||this,n}return ep(t,e),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return np(this,void 0,void 0,(function(){var n;return rp(this,(function(r){switch(r.label){case 0:return[4,this.detect(e,t)];case 1:return n=r.sent(),[2,n.map((function(e){return new Ep(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})}))]}}))}))},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?cm:um},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(xm);var Cm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return ep(t,e),t}(bm),Sm=function(){function e(){}return e.prototype.then=function(e){return np(this,void 0,void 0,(function(){var t;return rp(this,(function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}}))}))},e.prototype.run=function(){return np(this,void 0,void 0,(function(){return rp(this,(function(e){throw new Error("ComposableTask - run is not implemented")}))}))},e}();function Em(e,t){var n={descriptor:t};return Object.assign({},e,n)}function km(e,t,n,r,o){return void 0===o&&(o=function(e){var t=e.alignedRect;return t}),np(this,void 0,void 0,(function(){var i,a,s,u,c;return rp(this,(function(l){switch(l.label){case 0:return i=e.map((function(e){return nv(e)?o(e):e.detection})),s=r,s?[3,5]:t instanceof Se?[4,xh(t,i)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,bh(t,i)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return a=s,[4,n(a)];case 6:return c=l.sent(),a.forEach((function(e){return e instanceof Se&&e.dispose()})),[2,c]}}))}))}function Im(e,t,n,r,o){return np(this,void 0,void 0,(function(){var i=this;return rp(this,(function(a){return[2,km([e],t,(function(e){return np(i,void 0,void 0,(function(){return rp(this,(function(t){return[2,n(e[0])]}))}))}),r,o)]}))}))}function _m(e){return $t((function(){return wr(Er(e,3).reverse(),3)}))}var Rm=2,Tm=12;function Am(e,t){var n=Oh(e,t),r=Fh(e,t);function o(n,r){var o=bn(e(n));return t.push({paramPath:r}),o}function i(e,t,r){void 0===r&&(r=!1);var i=n(e[0],e[1],3,t+"/conv1"),a=o(e[1],t+"/prelu1_alpha"),s=n(e[1],e[2],3,t+"/conv2"),u=o(e[2],t+"/prelu2_alpha"),c=n(e[2],e[3],r?2:3,t+"/conv3"),l=o(e[3],t+"/prelu3_alpha");return{conv1:i,prelu1_alpha:a,conv2:s,prelu2_alpha:u,conv3:c,prelu3_alpha:l}}function a(){var e=i([3,10,16,32],"pnet"),t=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return tp(tp({},e),{conv4_1:t,conv4_2:r})}function s(){var e=i([3,28,48,64],"rnet",!0),t=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return tp(tp({},e),{fc1:t,prelu4_alpha:n,fc2_1:a,fc2_2:s})}function u(){var e=i([3,32,64,64],"onet"),t=n(64,128,2,"onet/conv4"),a=o(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),u=o(256,"onet/prelu5_alpha"),c=r(256,2,"onet/fc2_1"),l=r(256,4,"onet/fc2_2"),f=r(256,10,"onet/fc2_3");return tp(tp({},e),{conv4:t,prelu4_alpha:a,fc1:s,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:f})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function Dm(e){var t=Wh(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=Am(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,c=a(),l=s(),f=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:f},paramMappings:o}}function Om(e,t){var n=Bh(e,t);function r(e){var t=n(e+"/weights",4,e+"/filters"),r=n(e+"/bias",1);return{filters:t,bias:r}}function o(e){var t=n(e+"/weights",2),r=n(e+"/bias",1);return{weights:t,bias:r}}function i(e){return n(e,1)}function a(e){var t=r(e+"/conv1"),n=i(e+"/prelu1_alpha"),o=r(e+"/conv2"),a=i(e+"/prelu2_alpha"),s=r(e+"/conv3"),u=i(e+"/prelu3_alpha");return{conv1:t,prelu1_alpha:n,conv2:o,prelu2_alpha:a,conv3:s,prelu3_alpha:u}}function s(){var e=a("pnet"),t=r("pnet/conv4_1"),n=r("pnet/conv4_2");return tp(tp({},e),{conv4_1:t,conv4_2:n})}function u(){var e=a("rnet"),t=o("rnet/fc1"),n=i("rnet/prelu4_alpha"),r=o("rnet/fc2_1"),s=o("rnet/fc2_2");return tp(tp({},e),{fc1:t,prelu4_alpha:n,fc2_1:r,fc2_2:s})}function c(){var e=a("onet"),t=r("onet/conv4"),n=i("onet/prelu4_alpha"),s=o("onet/fc1"),u=i("onet/prelu5_alpha"),c=o("onet/fc2_1"),l=o("onet/fc2_2"),f=o("onet/fc2_3");return tp(tp({},e),{conv4:t,prelu4_alpha:n,fc1:s,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:f})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:c}}function Fm(e){var t=[],n=Om(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Dh(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function Nm(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function Pm(e,t,n){var r=n[0],o=n[1],i=Tm/e,a=[],s=Math.min(r,o)*i,u=0;while(s>=12)a.push(i*Math.pow(t,u)),s*=t,u+=1;return a}var Mm=function(e){function t(t,n,r,o){return e.call(this,{left:t,top:n,right:r,bottom:o},!0)||this}return ep(t,e),t}(wp);function Bm(e){return $t((function(){return qu(Ju(e,yn(127.5)),yn(.0078125))}))}function Wm(e,t){return $t((function(){return Ou(fl(e),qu(t,Ys(fl(Ys(e)))))}))}function Lm(e,t,n){return void 0===n&&(n=!1),$t((function(){var r=Ah(e,t.conv1,"valid");return r=Wm(r,t.prelu1_alpha),r=Vc(r,n?[2,2]:[3,3],[2,2],"same"),r=Ah(r,t.conv2,"valid"),r=Wm(r,t.prelu2_alpha),r=n?r:Vc(r,[3,3],[2,2],"valid"),r=Ah(r,t.conv3,"valid"),r=Wm(r,t.prelu3_alpha),r}))}function Vm(e,t){return $t((function(){var n=Lm(e,t,!0),r=Ah(n,t.conv4_1,"valid"),o=ir(nl(r,3),3),i=qr(Ju(r,o),3),a=Ah(n,t.conv4_2,"valid");return{prob:i,regions:a}}))}function zm(e,t){return $t((function(){var n=Nm(t,e.shape.slice(1)),r=n.height,o=n.width,i=lf.resizeBilinear(e,[r,o]),a=Bm(i);return hl(a,[0,2,1,3])}))}function Um(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new xp(s,a));var u=o.map((function(e){var r=new Cp(Math.round((e.y*Rm+1)/n),Math.round((e.x*Rm+1)/n),Math.round((e.y*Rm+Tm)/n),Math.round((e.x*Rm+Tm)/n)),o=i[e.y][e.x],a=t.arraySync(),s=new Mm(a[e.y][e.x][0],a[e.y][e.x][1],a[e.y][e.x][2],a[e.y][e.x][3]);return{cell:r,score:o,region:s}}));return u}function Hm(e,t,n,r,o){o.stage1=[];var i=t.map((function(t){return $t((function(){var n={scale:t},o=zm(e,t),i=Date.now(),a=Vm(o,r),s=a.prob,u=a.regions;n.pnet=Date.now()-i;var c=Er(Er(s,3)[1])[0],l=Er(u)[0];return{scoresTensor:c,regionsTensor:l,scale:t,statsForScale:n}}))})),a=i.map((function(e){var t=e.scoresTensor,r=e.regionsTensor,i=e.scale,a=e.statsForScale,s=Um(t,r,i,n);if(t.dispose(),r.dispose(),!s.length)return o.stage1.push(a),[];var u=Date.now(),c=_p(s.map((function(e){return e.cell})),s.map((function(e){return e.score})),.5);return a.nms=Date.now()-u,a.numBoxes=c.length,o.stage1.push(a),c.map((function(e){return s[e]}))})),s=a.reduce((function(e,t){return e.concat(t)}),[]),u=[],c=[];if(s.length>0){var l=Date.now(),f=_p(s.map((function(e){return e.cell})),s.map((function(e){return e.score})),.7);o.stage1_nms=Date.now()-l,c=f.map((function(e){return s[e].score})),u=f.map((function(e){return s[e]})).map((function(e){var t=e.cell,n=e.region;return new Cp(t.left+n.left*t.width,t.top+n.top*t.height,t.right+n.right*t.width,t.bottom+n.bottom*t.height).toSquare().round()}))}return{boxes:u,scores:c}}function jm(e,t,n){var r=n.width,o=n.height;return np(this,void 0,void 0,(function(){var n,i,a,s=this;return rp(this,(function(u){switch(u.label){case 0:return n=nh(e),[4,Promise.all(t.map((function(t){return np(s,void 0,void 0,(function(){var r,o,i,a,s,u,c,l;return rp(this,(function(f){return r=t.padAtBorders(e.height,e.width),o=r.y,i=r.ey,a=r.x,s=r.ex,u=a-1,c=o-1,l=n.getImageData(u,c,s-u,i-c),[2,eh.isNodejs()?ph(l):createImageBitmap(l)]}))}))})))];case 1:return i=u.sent(),a=[],i.forEach((function(e){var t=dh({width:r,height:o}),n=nh(t);n.drawImage(e,0,0,r,o);for(var i=n.getImageData(0,0,r,o).data,s=[],u=0;u<i.length;u+=4)s.push(i[u+2]),s.push(i[u+1]),s.push(i[u]);a.push(s)})),[2,a.map((function(e){var t=$t((function(){var t=hl(Cn(e,[1,r,o,3]),[0,2,1,3]).toFloat();return Bm(t)}));return t}))]}}))}))}function Gm(e,t){return $t((function(){var n=Lm(e,t),r=yr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Gh(r,t.fc1),i=Wm(o,t.prelu4_alpha),a=Gh(i,t.fc2_1),s=ir(nl(a,1),1),u=qr(Ju(a,s),1),c=Gh(i,t.fc2_2),l=Er(u,1)[1];return{scores:l,regions:c}}))}function qm(e,t,n,r,o){return np(this,void 0,void 0,(function(){var i,a,s,u,c,l,f,d,p,h,v,m,g,y;return rp(this,(function(b){switch(b.label){case 0:return i=Date.now(),[4,jm(e,t,{width:24,height:24})];case 1:return a=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map((function(e){var t=Gm(e,r);return e.dispose(),t})),o.stage2_rnet=Date.now()-i,u=s.length>1?Fn(s.map((function(e){return e.scores}))):s[0].scores,f=(l=Array).from,[4,u.data()];case 2:return c=f.apply(l,[b.sent()]),u.dispose(),d=c.map((function(e,t){return{score:e,idx:t}})).filter((function(e){return e.score>n})).map((function(e){var t=e.idx;return t})),p=d.map((function(e){return t[e]})),h=d.map((function(e){return c[e]})),v=[],m=[],p.length>0&&(i=Date.now(),g=_p(p,h,.7),o.stage2_nms=Date.now()-i,y=g.map((function(e){var t=s[d[e]].regions.arraySync();return new Mm(t[0][0],t[0][1],t[0][2],t[0][3])})),m=g.map((function(e){return h[e]})),v=g.map((function(e,t){return p[e].calibrate(y[t])}))),s.forEach((function(e){e.regions.dispose(),e.scores.dispose()})),[2,{boxes:v,scores:m}]}}))}))}function $m(e,t){return $t((function(){var n=Lm(e,t);n=Vc(n,[2,2],[2,2],"same"),n=Ah(n,t.conv4,"valid"),n=Wm(n,t.prelu4_alpha);var r=yr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Gh(r,t.fc1),i=Wm(o,t.prelu5_alpha),a=Gh(i,t.fc2_1),s=ir(nl(a,1),1),u=qr(Ju(a,s),1),c=Gh(i,t.fc2_2),l=Gh(i,t.fc2_3),f=Er(u,1)[1];return{scores:f,regions:c,points:l}}))}function Km(e,t,n,r,o){return np(this,void 0,void 0,(function(){var i,a,s,u,c,l,f,d,p,h,v,m,g,y,b;return rp(this,(function(x){switch(x.label){case 0:return i=Date.now(),[4,jm(e,t,{width:48,height:48})];case 1:return a=x.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map((function(e){var t=$m(e,r);return e.dispose(),t})),o.stage3_onet=Date.now()-i,u=s.length>1?Fn(s.map((function(e){return e.scores}))):s[0].scores,f=(l=Array).from,[4,u.data()];case 2:return c=f.apply(l,[x.sent()]),u.dispose(),d=c.map((function(e,t){return{score:e,idx:t}})).filter((function(e){return e.score>n})).map((function(e){var t=e.idx;return t})),p=d.map((function(e){var t=s[e].regions.arraySync();return new Mm(t[0][0],t[0][1],t[0][2],t[0][3])})),h=d.map((function(e,n){return t[e].calibrate(p[n])})),v=d.map((function(e){return c[e]})),m=[],g=[],y=[],h.length>0&&(i=Date.now(),b=_p(h,v,.7,!1),o.stage3_nms=Date.now()-i,m=b.map((function(e){return h[e]})),g=b.map((function(e){return v[e]})),y=b.map((function(e,t){return Array(5).fill(0).map((function(n,r){var o=s[e].points.arraySync();return new xp(o[0][r]*(m[t].width+1)+m[t].left,o[0][r+5]*(m[t].height+1)+m[t].top)}))}))),s.forEach((function(e){e.regions.dispose(),e.scores.dispose(),e.points.dispose()})),[2,{boxes:m,scores:g,points:y}]}}))}))}var Xm=function(e){function t(){return e.call(this,"Mtcnn")||this}return ep(t,e),t.prototype.load=function(t){return np(this,void 0,void 0,(function(){return rp(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]}))}))},t.prototype.loadFromDisk=function(t){return np(this,void 0,void 0,(function(){return rp(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]}))}))},t.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),np(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,d,p,h,v,m,g,y,b,x,w,C;return rp(this,(function(S){switch(S.label){case 0:if(n=this.params,!n)throw new Error("Mtcnn - load model before inference");if(r=e.canvases[0],!r)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},i=Date.now(),a=$t((function(){return _m(ir(Nd.fromPixels(r)).toFloat())})),s=function(e){return a.dispose(),o.total=Date.now()-i,e},u=a.shape.slice(1),c=u[0],l=u[1],f=new Wv(t),d=f.minFaceSize,p=f.scaleFactor,h=f.maxNumScales,v=f.scoreThresholds,m=f.scaleSteps,g=(m||Pm(d,p,[c,l])).filter((function(e){var t=Nm(e,[c,l]);return Math.min(t.width,t.height)>Tm})).slice(0,h),o.scales=g,o.pyramid=g.map((function(e){return Nm(e,[c,l])})),y=Date.now(),[4,Hm(a,g,v[0],n.pnet,o)];case 1:return b=S.sent(),o.total_stage1=Date.now()-y,b.boxes.length?(o.stage2_numInputBoxes=b.boxes.length,y=Date.now(),[4,qm(r,b.boxes,v[1],n.rnet,o)]):[2,s({results:[],stats:o})];case 2:return x=S.sent(),o.total_stage2=Date.now()-y,x.boxes.length?(o.stage3_numInputBoxes=x.boxes.length,y=Date.now(),[4,Km(r,x.boxes,v[2],n.onet,o)]):[2,s({results:[],stats:o})];case 3:return w=S.sent(),o.total_stage3=Date.now()-y,C=w.boxes.map((function(e,t){return rv(Hp({},new Ep(w.scores[t],new Op(e.left/l,e.top/c,e.width/l,e.height/c),{height:c,width:l})),new Bp(w.points[t].map((function(t){return t.sub(new xp(e.left,e.top)).div(new xp(e.width,e.height))})),{width:e.width,height:e.height}))})),[2,s({results:C,stats:o})]}}))}))},t.prototype.forward=function(e,t){return void 0===t&&(t={}),np(this,void 0,void 0,(function(){var n;return rp(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yh(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent().results]}}))}))},t.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),np(this,void 0,void 0,(function(){var n;return rp(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yh(e)];case 1:return[2,n.apply(this,[r.sent(),t])]}}))}))},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Fm(e)},t.prototype.extractParams=function(e){return Dm(e)},t}(Ih),Ym=.4,Jm=[new xp(1.603231,2.094468),new xp(6.041143,7.080126),new xp(2.882459,3.518061),new xp(4.266906,5.178857),new xp(9.041765,10.66308)],Zm=[117.001,114.697,97.404],Qm=function(e){function t(){var t=this,n={withSeparableConvs:!0,iouThreshold:Ym,classes:["face"],anchors:Jm,meanRgb:Zm,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return t=e.call(this,n)||this,t}return ep(t,e),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return np(this,void 0,void 0,(function(){var n;return rp(this,(function(r){switch(r.label){case 0:return[4,this.detect(e,t)];case 1:return n=r.sent(),[2,n.map((function(e){return new Ep(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})}))]}}))}))},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(xm),eg={ssdMobilenetv1:new nm,tinyFaceDetector:new Qm,tinyYolov2:new wm,mtcnn:new Xm,faceLandmark68Net:new xv,faceLandmark68TinyNet:new Ev,faceRecognitionNet:new Mv,faceExpressionNet:new Zh,ageGenderNet:new yv};function tg(e,t){var n={age:t};return Object.assign({},e,n)}var ng=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.extractedFaces=r,o}return ep(t,e),t}(Sm),rg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t,n=this;return rp(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return e=r.sent(),[4,km(e,this.input,(function(e){return np(n,void 0,void 0,(function(){return rp(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return eg.faceExpressionNet.predictExpressions(e)})))];case 1:return[2,t.sent()]}}))}))}),this.extractedFaces)];case 2:return t=r.sent(),[2,e.map((function(e,n){return ev(e,t[n])}))]}}))}))},t.prototype.withAgeAndGender=function(){return new ug(this,this.input)},t}(ng),og=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t;return rp(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return e=n.sent(),e?[4,Im(e,this.input,(function(e){return eg.faceExpressionNet.predictExpressions(e)}),this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,ev(e,t)]}}))}))},t.prototype.withAgeAndGender=function(){return new cg(this,this.input)},t}(ng),ig=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.withAgeAndGender=function(){return new lg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new pg(this,this.input)},t}(rg),ag=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.withAgeAndGender=function(){return new fg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new hg(this,this.input)},t}(og),sg=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.extractedFaces=r,o}return ep(t,e),t}(Sm),ug=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t,n=this;return rp(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return e=r.sent(),[4,km(e,this.input,(function(e){return np(n,void 0,void 0,(function(){return rp(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return eg.ageGenderNet.predictAgeAndGender(e)})))];case 1:return[2,t.sent()]}}))}))}),this.extractedFaces)];case 2:return t=r.sent(),[2,e.map((function(e,n){var r=t[n],o=r.age,i=r.gender,a=r.genderProbability;return tg(Bv(e,i,a),o)}))]}}))}))},t.prototype.withFaceExpressions=function(){return new rg(this,this.input)},t}(sg),cg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t,n,r,o;return rp(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),e?[4,Im(e,this.input,(function(e){return eg.ageGenderNet.predictAgeAndGender(e)}),this.extractedFaces)]:[2];case 2:return t=i.sent(),n=t.age,r=t.gender,o=t.genderProbability,[2,tg(Bv(e,r,o),n)]}}))}))},t.prototype.withFaceExpressions=function(){return new og(this,this.input)},t}(sg),lg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.withFaceExpressions=function(){return new ig(this,this.input)},t.prototype.withFaceDescriptors=function(){return new pg(this,this.input)},t}(ug),fg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.withFaceExpressions=function(){return new ag(this,this.input)},t.prototype.withFaceDescriptor=function(){return new hg(this,this.input)},t}(cg),dg=function(e){function t(t,n){var r=e.call(this)||this;return r.parentTask=t,r.input=n,r}return ep(t,e),t}(Sm),pg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t;return rp(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return e=n.sent(),[4,km(e,this.input,(function(e){return Promise.all(e.map((function(e){return eg.faceRecognitionNet.computeFaceDescriptor(e)})))}),null,(function(e){return e.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return t=n.sent(),[2,t.map((function(t,n){return Em(e[n],t)}))]}}))}))},t.prototype.withFaceExpressions=function(){return new ig(this,this.input)},t.prototype.withAgeAndGender=function(){return new lg(this,this.input)},t}(dg),hg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t;return rp(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return e=n.sent(),e?[4,Im(e,this.input,(function(e){return eg.faceRecognitionNet.computeFaceDescriptor(e)}),null,(function(e){return e.landmarks.align(null,{useDlibAlignment:!0})}))]:[2];case 2:return t=n.sent(),[2,Em(e,t)]}}))}))},t.prototype.withFaceExpressions=function(){return new ag(this,this.input)},t.prototype.withAgeAndGender=function(){return new fg(this,this.input)},t}(dg),vg=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.useTinyLandmarkNet=r,o}return ep(t,e),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?eg.faceLandmark68TinyNet:eg.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Sm),mg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t,n,r,o,i=this;return rp(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),t=e.map((function(e){return e.detection})),this.input instanceof Se?[4,xh(this.input,t)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,bh(this.input,t)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map((function(e){return i.landmarkNet.detectLandmarks(e)})))];case 6:return o=a.sent(),n.forEach((function(e){return e instanceof Se&&e.dispose()})),[2,e.map((function(e,t){return rv(e,o[t])}))]}}))}))},t.prototype.withFaceExpressions=function(){return new ig(this,this.input)},t.prototype.withAgeAndGender=function(){return new lg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new pg(this,this.input)},t}(vg),gg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t,n,r,o;return rp(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),e?(t=e.detection,this.input instanceof Se?[4,xh(this.input,[t])]:[3,3]):[2];case 2:return r=i.sent(),[3,5];case 3:return[4,bh(this.input,[t])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=i.sent(),n.forEach((function(e){return e instanceof Se&&e.dispose()})),[2,rv(e,o)]}}))}))},t.prototype.withFaceExpressions=function(){return new ag(this,this.input)},t.prototype.withAgeAndGender=function(){return new fg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new hg(this,this.input)},t}(vg),yg=function(e){function t(t,n){void 0===n&&(n=new tm);var r=e.call(this)||this;return r.input=t,r.options=n,r}return ep(t,e),t}(Sm),bg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t,n,r;return rp(this,(function(o){switch(o.label){case 0:return e=this,t=e.input,n=e.options,n instanceof Wv?[4,eg.mtcnn.forward(t,n)]:[3,2];case 1:return[2,o.sent().map((function(e){return e.detection}))];case 2:if(r=n instanceof Cm?function(e){return eg.tinyFaceDetector.locateFaces(e,n)}:n instanceof tm?function(e){return eg.ssdMobilenetv1.locateFaces(e,n)}:n instanceof bm?function(e){return eg.tinyYolov2.locateFaces(e,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(t)]}}))}))},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise((function(t){return np(e,void 0,void 0,(function(){var e;return rp(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e.map((function(e){return Hp({},e)})))]}}))}))}))},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new mg(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new rg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new ug(this.runAndExtendWithFaceDetections(),this.input)},t}(yg),xg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ep(t,e),t.prototype.run=function(){return np(this,void 0,void 0,(function(){var e,t;return rp(this,(function(n){switch(n.label){case 0:return[4,new bg(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach((function(e){e.score>t.score&&(t=e)})),[2,t]}}))}))},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise((function(t){return np(e,void 0,void 0,(function(){var e;return rp(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e?Hp({},e):void 0)]}}))}))}))},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new gg(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new og(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new cg(this.runAndExtendWithFaceDetection(),this.input)},t}(yg);function wg(e,t){return void 0===t&&(t=new tm),new xg(e,t)}function Cg(e,t){return void 0===t&&(t=new tm),new bg(e,t)}function Sg(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map((function(e,t){return e-r[t]})).reduce((function(e,t){return e+Math.pow(t,2)}),0))}var Eg=function(){function e(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,o=function(){return"person "+r++};this._labeledDescriptors=n.map((function(e){if(e instanceof zp)return e;if(e instanceof Float32Array)return new zp(o(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new zp(o(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")}))}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(e,t){return t.map((function(t){return Sg(t,e)})).reduce((function(e,t){return e+t}),0)/(t.length||1)},e.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map((function(n){var r=n.descriptors,o=n.label;return new Lp(o,t.computeMeanDistance(e,r))})).reduce((function(e,t){return e.distance<t.distance?e:t}))},e.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new Lp("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map((function(e){return e.toJSON()}))}},e.fromJSON=function(t){var n=t.labeledDescriptors.map((function(e){return zp.fromJSON(e)}));return new e(n,t.distanceThreshold)},e}();function kg(e,t){var n=new ip(t.width,t.height),r=n.width,o=n.height;if(r<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:o}));if(Array.isArray(e))return e.map((function(e){return kg(e,{width:r,height:o})}));if(nv(e)){var i=e.detection.forSize(r,o),a=e.unshiftedLandmarks.forSize(i.box.width,i.box.height);return rv(Hp(e,i),a)}return Up(e)?Hp(e,e.detection.forSize(r,o)):e instanceof Mp||e instanceof Ep?e.forSize(r,o):e}},89:function(e,t,n){"use strict";n(3948),t.Z=(e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n}},4648:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,{Z:function(){return i}})},253:function(e,t,n){"use strict";n.d(t,{$E:function(){return m},$d:function(){return s},EL:function(){return f},F1:function(){return B},Ib:function(){return I},NB:function(){return p},OR:function(){return _},OT:function(){return d},Vd:function(){return R},Wn:function(){return a},aM:function(){return W},d1:function(){return u},d9:function(){return M},eo:function(){return P},hk:function(){return k},iP:function(){return T},rP:function(){return N}});n(2707),n(4916),n(1817);var r=n(4870),o=n(3396),i="undefined"!==typeof window;function a(e){return i?requestAnimationFrame(e):-1}function s(e){i&&cancelAnimationFrame(e)}function u(e){a((()=>a(e)))}var c=e=>e===window,l=(e,t)=>({top:0,left:0,right:e,bottom:t,width:e,height:t}),f=e=>{const t=(0,r.SU)(e);if(c(t)){const e=t.innerWidth,n=t.innerHeight;return l(e,n)}return(null==t?void 0:t.getBoundingClientRect)?t.getBoundingClientRect():l(0,0)};function d(e=!1){const t=(0,r.iH)(e),n=(e=!t.value)=>{t.value=e};return[t,n]}function p(e){const t=(0,o.f3)(e,null);if(t){const e=(0,o.FN)(),{link:n,unlink:r,internalChildren:i}=t;n(e),(0,o.Ah)((()=>r(e)));const a=(0,o.Fl)((()=>i.indexOf(e)));return{parent:t,index:a}}return{parent:null,index:(0,r.iH)(-1)}}function h(e){const t=[],n=e=>{Array.isArray(e)&&e.forEach((e=>{var r;(0,o.lA)(e)&&(t.push(e),(null==(r=e.component)?void 0:r.subTree)&&(t.push(e.component.subTree),n(e.component.subTree.children)),e.children&&n(e.children))}))};return n(e),t}function v(e,t,n){const r=h(e.subTree.children);n.sort(((e,t)=>r.indexOf(e.vnode)-r.indexOf(t.vnode)));const o=n.map((e=>e.proxy));t.sort(((e,t)=>{const n=o.indexOf(e),r=o.indexOf(t);return n-r}))}function m(e){const t=(0,r.qj)([]),n=(0,r.qj)([]),i=(0,o.FN)(),a=r=>{const a=e=>{e.proxy&&(n.push(e),t.push(e.proxy),v(i,t,n))},s=e=>{const r=n.indexOf(e);t.splice(r,1),n.splice(r,1)};(0,o.JJ)(e,Object.assign({link:a,unlink:s,children:t,internalChildren:n},r))};return{children:t,linkChildren:a}}var g,y,b=1e3,x=60*b,w=60*x,C=24*w;function S(e){const t=Math.floor(e/C),n=Math.floor(e%C/w),r=Math.floor(e%w/x),o=Math.floor(e%x/b),i=Math.floor(e%b);return{total:e,days:t,hours:n,minutes:r,seconds:o,milliseconds:i}}function E(e,t){return Math.floor(e/1e3)===Math.floor(t/1e3)}function k(e){let t,n,u,c;const l=(0,r.iH)(e.time),f=(0,o.Fl)((()=>S(l.value))),d=()=>{u=!1,s(t)},p=()=>Math.max(n-Date.now(),0),h=t=>{var n,r;l.value=t,null==(n=e.onChange)||n.call(e,f.value),0===t&&(d(),null==(r=e.onFinish)||r.call(e))},v=()=>{t=a((()=>{u&&(h(p()),l.value>0&&v())}))},m=()=>{t=a((()=>{if(u){const e=p();E(e,l.value)&&0!==e||h(e),l.value>0&&m()}}))},g=()=>{i&&(e.millisecond?v():m())},y=()=>{u||(n=Date.now()+l.value,u=!0,g())},b=(t=e.time)=>{d(),l.value=t};return(0,o.Jd)(d),(0,o.dl)((()=>{c&&(u=!0,c=!1,g())})),(0,o.se)((()=>{u&&(d(),c=!0)})),{start:y,pause:d,reset:b,current:f}}function I(e){let t;(0,o.bv)((()=>{e(),(0,o.Y3)((()=>{t=!0}))})),(0,o.dl)((()=>{t&&e()}))}function _(e,t,n={}){if(!i)return;const{target:a=window,passive:s=!1,capture:u=!1}=n;let c;const l=n=>{const o=(0,r.SU)(n);o&&!c&&(o.addEventListener(e,t,{capture:u,passive:s}),c=!0)},f=n=>{const o=(0,r.SU)(n);o&&c&&(o.removeEventListener(e,t,u),c=!1)};(0,o.Ah)((()=>f(a))),(0,o.se)((()=>f(a))),I((()=>l(a))),(0,r.dq)(a)&&(0,o.YP)(a,((e,t)=>{f(t),l(e)}))}function R(e,t,n={}){if(!i)return;const{eventName:o="click"}=n,a=n=>{const o=(0,r.SU)(e);o&&!o.contains(n.target)&&t(n)};_(o,a,{target:document})}function T(){if(!g&&(g=(0,r.iH)(0),y=(0,r.iH)(0),i)){const e=()=>{g.value=window.innerWidth,y.value=window.innerHeight};e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",e,{passive:!0})}return{width:g,height:y}}var A,D=/scroll|auto/i,O=i?window:void 0;function F(e){const t=1;return"HTML"!==e.tagName&&"BODY"!==e.tagName&&e.nodeType===t}function N(e,t=O){let n=e;while(n&&n!==t&&F(n)){const{overflowY:e}=window.getComputedStyle(n);if(D.test(e))return n;n=n.parentNode}return t}function P(e,t=O){const n=(0,r.iH)();return(0,o.bv)((()=>{e.value&&(n.value=N(e.value,t))})),n}function M(){if(!A&&(A=(0,r.iH)("visible"),i)){const e=()=>{A.value=document.hidden?"hidden":"visible"};e(),window.addEventListener("visibilitychange",e)}return A}var B=Symbol("van-field");function W(e){const t=(0,o.f3)(B,null);t&&!t.customValue.value&&(t.customValue.value=e,(0,o.YP)(e,(()=>{t.resetValidation(),t.validateWithTrigger("onChange")})))}},3068:function(e,t,n){"use strict";n.d(t,{C:function(){return p}});var r=n(1404),o=(n(3948),n(4916),n(5306),n(3396)),i=n(9537),a=n(5323),s=n(6491),u=n(8332);const[c,l]=(0,i["do"])("badge"),f={dot:Boolean,max:a.Or,tag:(0,a.SQ)("div"),color:String,offset:Array,content:a.Or,showZero:a.J5,position:(0,a.SQ)("top-right")};var d=(0,o.aZ)({name:c,props:f,setup(e,{slots:t}){const n=()=>{if(t.content)return!0;const{content:n,showZero:r}=e;return(0,s.Xq)(n)&&""!==n&&(r||0!==n)},r=()=>{const{dot:r,max:o,content:i}=e;if(!r&&n())return t.content?t.content():(0,s.Xq)(o)&&(0,s.kE)(i)&&+i>o?`${o}+`:i},i=(0,o.Fl)((()=>{const n={background:e.color};if(e.offset){const[r,o]=e.offset;t.default?(n.top=(0,u.Nn)(o),n.right="number"===typeof r?(0,u.Nn)(-r):r.startsWith("-")?r.replace("-",""):`-${r}`):(n.marginTop=(0,u.Nn)(o),n.marginLeft=(0,u.Nn)(r))}return n})),a=()=>{if(n()||e.dot)return(0,o.Wm)("div",{class:l([e.position,{dot:e.dot,fixed:!!t.default}]),style:i.value},[r()])};return()=>{if(t.default){const{tag:n}=e;return(0,o.Wm)(n,{class:l("wrapper")},{default:()=>[t.default(),a()]})}return a()}}});const p=(0,r.n)(d)},7631:function(e,t,n){"use strict";n.d(t,{S:function(){return o},h:function(){return i}});n(1817);var r=n(3396);const o=Symbol();function i(e){const t=(0,r.f3)(o,null);t&&(0,r.YP)(t,(t=>{t&&e()}))}},3444:function(e,t,n){"use strict";n.d(t,{F:function(){return i}});var r=n(3396),o=n(2220);function i(e){const t=(0,r.FN)();t&&(0,o.l7)(t.proxy,e)}},365:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});var r=n(4870),o=n(3396);function i(e){const t=(0,r.iH)(!1);return(0,o.YP)(e,(e=>{e&&(t.value=e)}),{immediate:!0}),e=>()=>t.value?e():null}},5261:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var r=n(4870);function o(e,t){return e>t?"horizontal":t>e?"vertical":""}function i(){const e=(0,r.iH)(0),t=(0,r.iH)(0),n=(0,r.iH)(0),i=(0,r.iH)(0),a=(0,r.iH)(0),s=(0,r.iH)(0),u=(0,r.iH)(""),c=()=>"vertical"===u.value,l=()=>"horizontal"===u.value,f=()=>{n.value=0,i.value=0,a.value=0,s.value=0,u.value=""},d=n=>{f(),e.value=n.touches[0].clientX,t.value=n.touches[0].clientY},p=r=>{const c=r.touches[0];n.value=(c.clientX<0?0:c.clientX)-e.value,i.value=c.clientY-t.value,a.value=Math.abs(n.value),s.value=Math.abs(i.value);const l=10;(!u.value||a.value<l&&s.value<l)&&(u.value=o(a.value,s.value))};return{move:p,start:d,reset:f,startX:e,startY:t,deltaX:n,deltaY:i,offsetX:a,offsetY:s,direction:u,isVertical:c,isHorizontal:l}}},2585:function(e,t,n){"use strict";n.d(t,{Z:function(){return d},q:function(){return c}});n(3948),n(1817);var r=n(3396),o=n(9537),i=n(5323),a=n(8332);const[s,u]=(0,o["do"])("config-provider"),c=Symbol(s),l={tag:(0,i.SQ)("div"),themeVars:Object,iconPrefix:String};function f(e){const t={};return Object.keys(e).forEach((n=>{t[`--van-${(0,a.GL)(n)}`]=e[n]})),t}var d=(0,r.aZ)({name:s,props:l,setup(e,{slots:t}){const n=(0,r.Fl)((()=>{if(e.themeVars)return f(e.themeVars)}));return(0,r.JJ)(c,e),()=>(0,r.Wm)(e.tag,{class:u(),style:n.value},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}})},2598:function(e,t,n){"use strict";n.d(t,{J:function(){return v}});var r=n(1404),o=(n(3948),n(6699),n(3396)),i=n(9537),a=n(5323),s=n(8332),u=n(3068),c=n(2585);const[l,f]=(0,i["do"])("icon"),d=e=>null==e?void 0:e.includes("/"),p={dot:Boolean,tag:(0,a.SQ)("i"),name:String,size:a.Or,badge:a.Or,color:String,badgeProps:Object,classPrefix:String};var h=(0,o.aZ)({name:l,props:p,setup(e,{slots:t}){const n=(0,o.f3)(c.q,null),r=(0,o.Fl)((()=>e.classPrefix||(null==n?void 0:n.iconPrefix)||f()));return()=>{const{tag:n,dot:i,name:a,size:c,badge:l,color:p}=e,h=d(a);return(0,o.Wm)(u.C,(0,o.dG)({dot:i,tag:n,class:[r.value,h?"":`${r.value}-${a}`],style:{color:p,fontSize:(0,s.Nn)(c)},content:l},e.badgeProps),{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t),h&&(0,o.Wm)("img",{class:f("image"),src:a},null)]}})}}});const v=(0,r.n)(h)},7966:function(e,t,n){"use strict";n.d(t,{ZP:function(){return Of}});var r=n(1404),o=(n(3948),n(1817),n(3396)),i=n(4870),a=n(9537),s=n(5323),u=n(253);const c=e=>{const t=(0,i.iH)(),n=()=>{t.value=(0,u.EL)(e).height};return(0,o.bv)((()=>{(0,o.Y3)(n),setTimeout(n,100)})),t};function l(e,t){const n=c(e);return e=>(0,o.Wm)("div",{class:t("placeholder"),style:{height:n.value?`${n.value}px`:void 0}},[e()])}const[f,d]=(0,a["do"])("action-bar"),p=Symbol(f),h={placeholder:Boolean,safeAreaInsetBottom:s.J5};var v=(0,o.aZ)({name:f,props:h,setup(e,{slots:t}){const n=(0,i.iH)(),r=l(n,d),{linkChildren:a}=(0,u.$E)(p);a();const s=()=>{var r;return(0,o.Wm)("div",{ref:n,class:[d(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==(r=t.default)?void 0:r.call(t)])};return()=>e.placeholder?r(s):s()}});const m=(0,r.n)(v);var g=n(2220),y=n(3444);n(4916),n(5306);const b={to:[String,Object],url:String,replace:Boolean};function x({to:e,url:t,replace:n,$router:r}){e&&r?r[n?"replace":"push"](e):t&&(n?location.replace(t):location.href=t)}function w(){const e=(0,o.FN)().proxy;return()=>x(e)}n(6699);var C=n(7936),S=n(5322),E=n(2598),k=n(2229);const[I,_]=(0,a["do"])("button"),R=(0,g.l7)({},b,{tag:(0,s.SQ)("button"),text:String,icon:String,type:(0,s.SQ)("default"),size:(0,s.SQ)("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:(0,s.SQ)("button"),loadingSize:s.Or,loadingText:String,loadingType:String,iconPosition:(0,s.SQ)("left")});var T=(0,o.aZ)({name:I,props:R,emits:["click"],setup(e,{emit:t,slots:n}){const r=w(),i=()=>n.loading?n.loading():(0,o.Wm)(k.g,{size:e.loadingSize,type:e.loadingType,class:_("loading")},null),a=()=>e.loading?i():n.icon?(0,o.Wm)("div",{class:_("icon")},[n.icon()]):e.icon?(0,o.Wm)(E.J,{name:e.icon,class:_("icon"),classPrefix:e.iconPrefix},null):void 0,s=()=>{let t;if(t=e.loading?e.loadingText:n.default?n.default():e.text,t)return(0,o.Wm)("span",{class:_("text")},[t])},u=()=>{const{color:t,plain:n}=e;if(t){const e={color:n?t:"white"};return n||(e.background=t),t.includes("gradient")?e.border=0:e.borderColor=t,e}},c=n=>{e.loading?(0,C.PF)(n):e.disabled||(t("click",n),r())};return()=>{const{tag:t,type:n,size:r,block:i,round:l,plain:f,square:d,loading:p,disabled:h,hairline:v,nativeType:m,iconPosition:g}=e,y=[_([n,r,{plain:f,block:i,round:l,square:d,loading:p,disabled:h,hairline:v}]),{[S._K]:v}];return(0,o.Wm)(t,{type:m,class:y,style:u(),disabled:h,onClick:c},{default:()=>[(0,o.Wm)("div",{class:_("content")},["left"===g&&a(),s(),"right"===g&&a()])]})}}});const A=(0,r.n)(T);const[D,O]=(0,a["do"])("action-bar-button"),F=(0,g.l7)({},b,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var N=(0,o.aZ)({name:D,props:F,setup(e,{slots:t}){const n=w(),{parent:r,index:i}=(0,u.NB)(p),a=(0,o.Fl)((()=>{if(r){const e=r.children[i.value-1];return!(e&&"isButton"in e)}})),s=(0,o.Fl)((()=>{if(r){const e=r.children[i.value+1];return!(e&&"isButton"in e)}}));return(0,y.F)({isButton:!0}),()=>{const{type:r,icon:i,text:u,color:c,loading:l,disabled:f}=e;return(0,o.Wm)(A,{class:O([r,{last:s.value,first:a.value}]),size:"large",type:r,icon:i,color:c,loading:l,disabled:f,onClick:n},{default:()=>[t.default?t.default():u]})}}});const P=(0,r.n)(N);var M=n(3068);const[B,W]=(0,a["do"])("action-bar-icon"),L=(0,g.l7)({},b,{dot:Boolean,text:String,icon:String,color:String,badge:s.Or,iconClass:s.Vg,badgeProps:Object,iconPrefix:String});var V=(0,o.aZ)({name:B,props:L,setup(e,{slots:t}){const n=w();(0,u.NB)(p);const r=()=>{const{dot:n,badge:r,icon:i,color:a,iconClass:s,badgeProps:u,iconPrefix:c}=e;return t.icon?(0,o.Wm)(M.C,(0,o.dG)({dot:n,class:W("icon"),content:r},u),{default:t.icon}):(0,o.Wm)(E.J,{tag:"div",dot:n,name:i,badge:r,color:a,class:[W("icon"),s],badgeProps:u,classPrefix:c},null)};return()=>(0,o.Wm)("div",{role:"button",class:W(),tabindex:0,onClick:n},[r(),t.default?t.default():e.text])}});const z=(0,r.n)(V);var U=n(1206),H=n(4877);const[j,G]=(0,a["do"])("action-sheet"),q=(0,g.l7)({},H.W,{title:String,round:s.J5,actions:(0,s.Ce)(),closeIcon:(0,s.SQ)("cross"),closeable:s.J5,cancelText:String,description:String,closeOnPopstate:s.J5,closeOnClickAction:Boolean,safeAreaInsetBottom:s.J5}),$=[...H.m,"round","closeOnPopstate","safeAreaInsetBottom"];var K=(0,o.aZ)({name:j,props:q,emits:["select","cancel","update:show"],setup(e,{slots:t,emit:n}){const r=e=>n("update:show",e),i=()=>{r(!1),n("cancel")},a=()=>{if(e.title)return(0,o.Wm)("div",{class:G("header")},[e.title,e.closeable&&(0,o.Wm)(E.J,{name:e.closeIcon,class:[G("close"),S.e9],onClick:i},null)])},s=()=>{if(t.cancel||e.cancelText)return[(0,o.Wm)("div",{class:G("gap")},null),(0,o.Wm)("button",{type:"button",class:G("cancel"),onClick:i},[t.cancel?t.cancel():e.cancelText])]},u=(e,n)=>e.loading?(0,o.Wm)(k.g,{class:G("loading-icon")},null):t.action?t.action({action:e,index:n}):[(0,o.Wm)("span",{class:G("name")},[e.name]),e.subname&&(0,o.Wm)("div",{class:G("subname")},[e.subname])],c=(t,i)=>{const{color:a,loading:s,callback:c,disabled:l,className:f}=t,d=()=>{l||s||(c&&c(t),e.closeOnClickAction&&r(!1),(0,o.Y3)((()=>n("select",t,i))))};return(0,o.Wm)("button",{type:"button",style:{color:a},class:[G("item",{loading:s,disabled:l}),f],onClick:d},[u(t,i)])},l=()=>{if(e.description||t.description){const n=t.description?t.description():e.description;return(0,o.Wm)("div",{class:G("description")},[n])}};return()=>(0,o.Wm)(U.G,(0,o.dG)({class:G(),position:"bottom","onUpdate:show":r},(0,g.ei)(e,$)),{default:()=>{var n;return[a(),l(),(0,o.Wm)("div",{class:G("content")},[e.actions.map(c),null==(n=t.default)?void 0:n.call(t)]),s()]}})}});const X=(0,r.n)(K);var Y=n(9242),J=n(6491);function Z(e){if(!(0,J.Xq)(e))return e;if(Array.isArray(e))return e.map((e=>Z(e)));if((0,J.Kn)(e)){const t={};return Object.keys(e).forEach((n=>{t[n]=Z(e[n])})),t}return e}var Q=n(8332),ee=(n(8862),n(5261));const te=200,ne=300,re=15,[oe,ie]=(0,a["do"])("picker-column");function ae(e){const{transform:t}=window.getComputedStyle(e),n=t.slice(7,t.length-1).split(", ")[5];return Number(n)}const se=Symbol(oe),ue=e=>(0,J.Kn)(e)&&e.disabled;var ce=(0,o.aZ)({name:oe,props:{textKey:(0,s.ir)(String),readonly:Boolean,allowHtml:Boolean,className:s.Vg,itemHeight:(0,s.ir)(Number),defaultIndex:(0,s.qM)(0),swipeDuration:(0,s.ir)(s.Or),initialOptions:(0,s.Ce)(),visibleItemCount:(0,s.ir)(s.Or)},emits:["change"],setup(e,{emit:t,slots:n}){let r,a,s,c,l;const f=(0,i.iH)(),d=(0,i.qj)({index:e.defaultIndex,offset:0,duration:0,options:Z(e.initialOptions)}),p=(0,ee.o)(),h=()=>d.options.length,v=()=>e.itemHeight*(+e.visibleItemCount-1)/2,m=e=>{e=(0,Q.uZ)(e,0,h());for(let t=e;t<h();t++)if(!ue(d.options[t]))return t;for(let t=e-1;t>=0;t--)if(!ue(d.options[t]))return t},g=(n,o)=>{n=m(n)||0;const i=-n*e.itemHeight,a=()=>{n!==d.index&&(d.index=n,o&&t("change",n))};r&&i!==d.offset?l=a:a(),d.offset=i},b=t=>{JSON.stringify(t)!==JSON.stringify(d.options)&&(d.options=Z(t),g(e.defaultIndex))},x=t=>{r||e.readonly||(l=null,d.duration=te,g(t,!0))},w=t=>(0,J.Kn)(t)&&e.textKey in t?t[e.textKey]:t,S=t=>(0,Q.uZ)(Math.round(-t/e.itemHeight),0,h()-1),E=(t,n)=>{const r=Math.abs(t/n);t=d.offset+r/.003*(t<0?-1:1);const o=S(t);d.duration=+e.swipeDuration,g(o,!0)},k=()=>{r=!1,d.duration=0,l&&(l(),l=null)},I=t=>{if(!e.readonly){if(p.start(t),r){const e=ae(f.value);d.offset=Math.min(0,e-v()),a=d.offset}else a=d.offset;d.duration=0,s=Date.now(),c=a,l=null}},_=t=>{if(e.readonly)return;p.move(t),p.isVertical()&&(r=!0,(0,C.PF)(t,!0)),d.offset=(0,Q.uZ)(a+p.deltaY.value,-h()*e.itemHeight,e.itemHeight);const n=Date.now();n-s>ne&&(s=n,c=d.offset)},R=()=>{if(e.readonly)return;const t=d.offset-c,n=Date.now()-s,o=n<ne&&Math.abs(t)>re;if(o)return void E(t,n);const i=S(d.offset);d.duration=te,g(i,!0),setTimeout((()=>{r=!1}),0)},T=()=>{const t={height:`${e.itemHeight}px`};return d.options.map(((r,i)=>{const a=w(r),s=ue(r),u={role:"button",style:t,tabindex:s?-1:0,class:ie("item",{disabled:s,selected:i===d.index}),onClick:()=>x(i)},c={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:a};return(0,o.Wm)("li",u,[n.option?n.option(r):(0,o.Wm)("div",c,null)])}))},A=e=>{const{options:t}=d;for(let n=0;n<t.length;n++)if(w(t[n])===e)return g(n)},D=()=>d.options[d.index],O=()=>d.options.length;return g(d.index),(0,u.NB)(se),(0,y.F)({state:d,setIndex:g,getValue:D,setValue:A,setOptions:b,hasOptions:O,stopMomentum:k}),(0,o.YP)((()=>e.initialOptions),b),(0,o.YP)((()=>e.defaultIndex),(e=>g(e))),()=>(0,o.Wm)("div",{class:[ie(),e.className],onTouchstart:I,onTouchmove:_,onTouchend:R,onTouchcancel:R},[(0,o.Wm)("ul",{ref:f,style:{transform:`translate3d(0, ${d.offset+v()}px, 0)`,transitionDuration:`${d.duration}ms`,transitionProperty:d.duration?"all":"none"},class:ie("wrapper"),onTransitionend:k},[T()])])}});const[le,fe,de]=(0,a["do"])("picker"),pe={title:String,loading:Boolean,readonly:Boolean,allowHtml:Boolean,itemHeight:(0,s.SI)(44),showToolbar:s.J5,swipeDuration:(0,s.SI)(1e3),visibleItemCount:(0,s.SI)(6),cancelButtonText:String,confirmButtonText:String},he=(0,g.l7)({},pe,{columns:(0,s.Ce)(),valueKey:String,defaultIndex:(0,s.SI)(0),toolbarPosition:(0,s.SQ)("top"),columnsFieldNames:Object});var ve=(0,o.aZ)({name:le,props:he,emits:["confirm","cancel","change"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(!1),a=(0,i.iH)([]),s=(0,o.Fl)((()=>{const{columnsFieldNames:t}=e;return{text:(null==t?void 0:t.text)||e.valueKey||"text",values:(null==t?void 0:t.values)||"values",children:(null==t?void 0:t.children)||"children"}})),{children:c,linkChildren:l}=(0,u.$E)(se);l();const f=(0,o.Fl)((()=>(0,Q.LU)(e.itemHeight))),d=(0,o.Fl)((()=>{const t=e.columns[0];if("object"===typeof t){if(s.value.children in t)return"cascade";if(s.value.values in t)return"object"}return"plain"})),p=()=>{var t;const n=[];let r={[s.value.children]:e.columns};while(r&&r[s.value.children]){const o=r[s.value.children];let i=null!=(t=r.defaultIndex)?t:+e.defaultIndex;while(o[i]&&o[i].disabled){if(!(i<o.length-1)){i=0;break}i++}n.push({[s.value.values]:r[s.value.children],className:r.className,defaultIndex:i}),r=o[i]}a.value=n},h=()=>{const{columns:t}=e;"plain"===d.value?a.value=[{[s.value.values]:t}]:"cascade"===d.value?p():a.value=t,r.value=a.value.some((e=>e[s.value.values]&&0!==e[s.value.values].length))||c.some((e=>e.hasOptions))},v=()=>c.map((e=>e.state.index)),m=(e,t)=>{const n=c[e];n&&(n.setOptions(t),r.value=!0)},g=t=>{let n={[s.value.children]:e.columns};const r=v();for(let e=0;e<=t;e++)n=n[s.value.children][r[e]];while(n&&n[s.value.children])t++,m(t,n[s.value.children]),n=n[s.value.children][n.defaultIndex||0]},b=e=>c[e],x=e=>{const t=b(e);if(t)return t.getValue()},w=(e,t)=>{const n=b(e);n&&(n.setValue(t),"cascade"===d.value&&g(e))},E=e=>{const t=b(e);if(t)return t.state.index},I=(e,t)=>{const n=b(e);n&&(n.setIndex(t),"cascade"===d.value&&g(e))},_=e=>{const t=b(e);if(t)return t.state.options},R=()=>c.map((e=>e.getValue())),T=e=>{e.forEach(((e,t)=>{w(t,e)}))},A=e=>{e.forEach(((e,t)=>{I(t,e)}))},D=e=>{"plain"===d.value?t(e,x(0),E(0)):t(e,R(),v())},O=e=>{"cascade"===d.value&&g(e),"plain"===d.value?t("change",x(0),E(0)):t("change",R(),e)},F=()=>{c.forEach((e=>e.stopMomentum())),D("confirm")},N=()=>D("cancel"),P=()=>n.title?n.title():e.title?(0,o.Wm)("div",{class:[fe("title"),"van-ellipsis"]},[e.title]):void 0,M=()=>{const t=e.cancelButtonText||de("cancel");return(0,o.Wm)("button",{type:"button",class:[fe("cancel"),S.e9],onClick:N},[n.cancel?n.cancel():t])},B=()=>{const t=e.confirmButtonText||de("confirm");return(0,o.Wm)("button",{type:"button",class:[fe("confirm"),S.e9],onClick:F},[n.confirm?n.confirm():t])},W=()=>{if(e.showToolbar){const e=n.toolbar||n.default;return(0,o.Wm)("div",{class:fe("toolbar")},[e?e():[M(),P(),B()]])}},L=()=>a.value.map(((t,r)=>{var i;return(0,o.Wm)(ce,{textKey:s.value.text,readonly:e.readonly,allowHtml:e.allowHtml,className:t.className,itemHeight:f.value,defaultIndex:null!=(i=t.defaultIndex)?i:+e.defaultIndex,swipeDuration:e.swipeDuration,initialOptions:t[s.value.values],visibleItemCount:e.visibleItemCount,onChange:()=>O(r)},{option:n.option})})),V=e=>{if(r.value){const t={height:`${f.value}px`},n={backgroundSize:`100% ${(e-f.value)/2}px`};return[(0,o.Wm)("div",{class:fe("mask"),style:n},null),(0,o.Wm)("div",{class:[S.pj,fe("frame")],style:t},null)]}},z=()=>{const t=f.value*+e.visibleItemCount,n={height:`${t}px`};return(0,o.Wm)("div",{class:fe("columns"),style:n,onTouchmove:C.PF},[L(),V(t)])};return(0,o.YP)((()=>e.columns),h,{immediate:!0}),(0,y.F)({confirm:F,getValues:R,setValues:T,getIndexes:v,setIndexes:A,getColumnIndex:E,setColumnIndex:I,getColumnValue:x,setColumnValue:w,getColumnValues:_,setColumnValues:m}),()=>{var t,r;return(0,o.Wm)("div",{class:fe()},["top"===e.toolbarPosition?W():null,e.loading?(0,o.Wm)(k.g,{class:fe("loading")},null):null,null==(t=n["columns-top"])?void 0:t.call(n),z(),null==(r=n["columns-bottom"])?void 0:r.call(n),"bottom"===e.toolbarPosition?W():null])}}});const me=(0,r.n)(ve);const[ge,ye]=(0,a["do"])("area"),be="000000",xe=["title","cancel","confirm","toolbar","columns-top","columns-bottom"],we=["title","loading","readonly","itemHeight","swipeDuration","visibleItemCount","cancelButtonText","confirmButtonText"],Ce=e=>"9"===e[0],Se=(0,g.l7)({},pe,{value:String,columnsNum:(0,s.SI)(3),columnsPlaceholder:(0,s.Ce)(),areaList:{type:Object,default:()=>({})},isOverseaCode:{type:Function,default:Ce}});var Ee=(0,o.aZ)({name:ge,props:Se,emits:["change","confirm","cancel"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,i.qj)({code:e.value,columns:[{values:[]},{values:[]},{values:[]}]}),s=(0,o.Fl)((()=>{const{areaList:t}=e;return{province:t.province_list||{},city:t.city_list||{},county:t.county_list||{}}})),u=(0,o.Fl)((()=>{const{columnsPlaceholder:t}=e;return{province:t[0]||"",city:t[1]||"",county:t[2]||""}})),c=()=>{if(e.columnsPlaceholder.length)return be;const{county:t,city:n}=s.value,r=Object.keys(t);if(r[0])return r[0];const o=Object.keys(n);return o[0]?o[0]:""},l=(t,n)=>{let r=[];if("province"!==t&&!n)return r;const o=s.value[t];if(r=Object.keys(o).map((e=>({code:e,name:o[e]}))),n&&("city"===t&&e.isOverseaCode(n)&&(n="9"),r=r.filter((e=>0===e.code.indexOf(n)))),u.value[t]&&r.length){let e="";"city"===t?e=be.slice(2,4):"county"===t&&(e=be.slice(4,6)),r.unshift({code:n+e,name:u.value[t]})}return r},f=(t,n)=>{let r=n.length;"province"===t&&(r=e.isOverseaCode(n)?1:2),"city"===t&&(r=4),n=n.slice(0,r);const o=l(t,r>2?n.slice(0,r-2):"");for(let e=0;e<o.length;e++)if(o[e].code.slice(0,r)===n)return e;return 0},d=()=>{const t=r.value;if(!t)return;let n=a.code||c();const o=l("province"),i=l("city",n.slice(0,2));t.setColumnValues(0,o),t.setColumnValues(1,i),i.length&&"00"===n.slice(2,4)&&!e.isOverseaCode(n)&&([{code:n}]=i),t.setColumnValues(2,l("county",n.slice(0,4))),t.setIndexes([f("province",n),f("city",n),f("county",n)])},p=t=>t.map(((t,n)=>(t&&(t=Z(t),t.code&&t.name!==e.columnsPlaceholder[n]||(t.code="",t.name="")),t))),h=()=>{if(r.value){const e=r.value.getValues().filter(Boolean);return p(e)}return[]},v=()=>{const t=h(),n={code:"",country:"",province:"",city:"",county:""};if(!t.length)return n;const r=t.map((e=>e.name)),o=t.filter((e=>e.code));return n.code=o.length?o[o.length-1].code:"",e.isOverseaCode(n.code)?(n.country=r[1]||"",n.province=r[2]||""):(n.province=r[0]||"",n.city=r[1]||"",n.county=r[2]||""),n},m=(e="")=>{a.code=e,d()},b=(e,n)=>{if(a.code=e[n].code,d(),r.value){const e=p(r.value.getValues());t("change",e,n)}},x=(e,n)=>{d(),t("confirm",p(e),n)},w=(...e)=>t("cancel",...e);return(0,o.bv)(d),(0,o.YP)((()=>e.value),(e=>{a.code=e,d()})),(0,o.YP)((()=>e.areaList),d,{deep:!0}),(0,o.YP)((()=>e.columnsNum),(()=>{(0,o.Y3)(d)})),(0,y.F)({reset:m,getArea:v,getValues:h}),()=>{const t=a.columns.slice(0,+e.columnsNum);return(0,o.Wm)(me,(0,o.dG)({ref:r,class:ye(),columns:t,columnsFieldNames:{text:"name"},onChange:b,onCancel:w,onConfirm:x},(0,g.ei)(e,we)),(0,g.ei)(n,xe))}}});const ke=(0,r.n)(Ee);const[Ie,_e]=(0,a["do"])("cell"),Re={icon:String,size:String,title:s.Or,value:s.Or,label:s.Or,center:Boolean,isLink:Boolean,border:s.J5,required:Boolean,iconPrefix:String,valueClass:s.Vg,labelClass:s.Vg,titleClass:s.Vg,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},Te=(0,g.l7)({},Re,b);var Ae=(0,o.aZ)({name:Ie,props:Te,setup(e,{slots:t}){const n=w(),r=()=>{const n=t.label||(0,J.Xq)(e.label);if(n)return(0,o.Wm)("div",{class:[_e("label"),e.labelClass]},[t.label?t.label():e.label])},i=()=>{if(t.title||(0,J.Xq)(e.title))return(0,o.Wm)("div",{class:[_e("title"),e.titleClass],style:e.titleStyle},[t.title?t.title():(0,o.Wm)("span",null,[e.title]),r()])},a=()=>{const n=t.value||t.default,r=n||(0,J.Xq)(e.value);if(r){const r=t.title||(0,J.Xq)(e.title);return(0,o.Wm)("div",{class:[_e("value",{alone:!r}),e.valueClass]},[n?n():(0,o.Wm)("span",null,[e.value])])}},s=()=>t.icon?t.icon():e.icon?(0,o.Wm)(E.J,{name:e.icon,class:_e("left-icon"),classPrefix:e.iconPrefix},null):void 0,u=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const t=e.arrowDirection?`arrow-${e.arrowDirection}`:"arrow";return(0,o.Wm)(E.J,{name:t,class:_e("right-icon")},null)}};return()=>{var r,c;const{size:l,center:f,border:d,isLink:p,required:h}=e,v=null!=(r=e.clickable)?r:p,m={center:f,required:h,clickable:v,borderless:!d};return l&&(m[l]=!!l),(0,o.Wm)("div",{class:_e(m),role:v?"button":void 0,tabindex:v?0:void 0,onClick:n},[s(),i(),a(),u(),null==(c=t.extra)?void 0:c.call(t)])}}});const De=(0,r.n)(Ae);n(5827);const[Oe,Fe]=(0,a["do"])("form"),Ne={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:s.Or,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:s.J5,showErrorMessage:s.J5,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Pe=(0,o.aZ)({name:Oe,props:Ne,emits:["submit","failed"],setup(e,{emit:t,slots:n}){const{children:r,linkChildren:i}=(0,u.$E)(S.WN),a=e=>e?r.filter((t=>e.includes(t.name))):r,s=e=>new Promise(((t,n)=>{const r=[],o=a(e);o.reduce(((e,t)=>e.then((()=>{if(!r.length)return t.validate().then((e=>{e&&r.push(e)}))}))),Promise.resolve()).then((()=>{r.length?n(r):t()}))})),c=e=>new Promise(((t,n)=>{const r=a(e);Promise.all(r.map((e=>e.validate()))).then((e=>{e=e.filter(Boolean),e.length?n(e):t()}))})),l=e=>{const t=r.find((t=>t.name===e));return t?new Promise(((e,n)=>{t.validate().then((t=>{t?n(t):e()}))})):Promise.reject()},f=t=>"string"===typeof t?l(t):e.validateFirst?s(t):c(t),d=e=>{"string"===typeof e&&(e=[e]);const t=a(e);t.forEach((e=>{e.resetValidation()}))},p=()=>r.reduce(((e,t)=>(e[t.name]=t.getValidationStatus(),e)),{}),h=(e,t)=>{r.some((n=>n.name===e&&(n.$el.scrollIntoView(t),!0)))},v=()=>r.reduce(((e,t)=>(e[t.name]=t.formValue.value,e)),{}),m=()=>{const n=v();f().then((()=>t("submit",n))).catch((r=>{t("failed",{values:n,errors:r}),e.scrollToError&&r[0].name&&h(r[0].name)}))},g=e=>{(0,C.PF)(e),m()};return i({props:e}),(0,y.F)({submit:m,validate:f,getValues:v,scrollToField:h,resetValidation:d,getValidationStatus:p}),()=>{var e;return(0,o.Wm)("form",{class:Fe(),onSubmit:g},[null==(e=n.default)?void 0:e.call(n)])}}});const Me=(0,r.n)(Pe);function Be(e){return Array.isArray(e)?!e.length:0!==e&&!e}function We(e,t){return(!t.required||!Be(e))&&!(t.pattern&&!t.pattern.test(String(e)))}function Le(e,t){return new Promise((n=>{const r=t.validator(e,t);(0,J.tI)(r)?r.then(n):n(r)}))}function Ve(e,t){const{message:n}=t;return(0,J.mf)(n)?n(e,t):n||""}function ze({target:e}){e.composing=!0}function Ue({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function He(e,t){const n=(0,C.oD)();e.style.height="auto";let r=e.scrollHeight;if((0,J.Kn)(t)){const{maxHeight:e,minHeight:n}=t;void 0!==e&&(r=Math.min(r,e)),void 0!==n&&(r=Math.max(r,n))}r&&(e.style.height=`${r}px`,(0,C.kn)(n))}function je(e){return"number"===e?{type:"text",inputmode:"decimal"}:"digit"===e?{type:"tel",inputmode:"numeric"}:{type:e}}function Ge(e){return[...e].length}function qe(e,t){return[...e].slice(0,t).join("")}let $e=0;function Ke(){const e=(0,o.FN)(),{name:t="unknown"}=(null==e?void 0:e.type)||{};return`${t}-${++$e}`}const[Xe,Ye]=(0,a["do"])("field"),Je={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:s.Or,formatter:Function,clearIcon:(0,s.SQ)("clear"),modelValue:(0,s.SI)(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:(0,s.SQ)("focus"),formatTrigger:(0,s.SQ)("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Ze=(0,g.l7)({},Re,Je,{rows:s.Or,type:(0,s.SQ)("text"),rules:Array,autosize:[Boolean,Object],labelWidth:s.Or,labelClass:s.Vg,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Qe=(0,o.aZ)({name:Xe,props:Ze,emits:["blur","focus","clear","keypress","click-input","end-validate","start-validate","click-left-icon","click-right-icon","update:modelValue"],setup(e,{emit:t,slots:n}){const r=Ke(),a=(0,i.qj)({status:"unvalidated",focused:!1,validateMessage:""}),s=(0,i.iH)(),c=(0,i.iH)(),{parent:l}=(0,u.NB)(S.WN),f=()=>{var t;return String(null!=(t=e.modelValue)?t:"")},d=t=>(0,J.Xq)(e[t])?e[t]:l&&(0,J.Xq)(l.props[t])?l.props[t]:void 0,p=(0,o.Fl)((()=>{const t=d("readonly");if(e.clearable&&!t){const t=""!==f(),n="always"===e.clearTrigger||"focus"===e.clearTrigger&&a.focused;return t&&n}return!1})),h=(0,o.Fl)((()=>c.value&&n.input?c.value():e.modelValue)),v=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===a.status)return;let{value:e}=h;return t.formatter&&(e=t.formatter(e,t)),We(e,t)?t.validator?Le(e,t).then((n=>{n&&"string"===typeof n?(a.status="failed",a.validateMessage=n):!1===n&&(a.status="failed",a.validateMessage=Ve(e,t))})):void 0:(a.status="failed",void(a.validateMessage=Ve(e,t)))}))),Promise.resolve()),m=()=>{a.status="unvalidated",a.validateMessage=""},b=()=>t("end-validate",{status:a.status}),x=(n=e.rules)=>new Promise((r=>{m(),n?(t("start-validate"),v(n).then((()=>{"failed"===a.status?(r({name:e.name,message:a.validateMessage}),b()):(a.status="passed",r(),b())}))):r()})),w=t=>{if(l&&e.rules){const{validateTrigger:n}=l.props,r=(0,g.qo)(n).includes(t),o=e.rules.filter((e=>e.trigger?(0,g.qo)(e.trigger).includes(t):r));o.length&&x(o)}},k=t=>{const{maxlength:n}=e;if((0,J.Xq)(n)&&Ge(t)>n){const e=f();return e&&Ge(e)===+n?e:qe(t,+n)}return t},I=(n,r="onChange")=>{if(n=k(n),"number"===e.type||"digit"===e.type){const t="number"===e.type;n=(0,Q.uf)(n,t,t)}e.formatter&&r===e.formatTrigger&&(n=e.formatter(n)),s.value&&s.value.value!==n&&(s.value.value=n),n!==e.modelValue&&t("update:modelValue",n)},_=e=>{e.target.composing||I(e.target.value)},R=()=>{var e;return null==(e=s.value)?void 0:e.blur()},T=()=>{var e;return null==(e=s.value)?void 0:e.focus()},A=()=>{const t=s.value;"textarea"===e.type&&e.autosize&&t&&He(t,e.autosize)},D=e=>{a.focused=!0,t("focus",e),(0,o.Y3)(A),d("readonly")&&R()},O=e=>{d("readonly")||(a.focused=!1,I(f(),"onBlur"),t("blur",e),w("onBlur"),(0,o.Y3)(A),(0,C.pe)())},F=e=>t("click-input",e),N=e=>t("click-left-icon",e),P=e=>t("click-right-icon",e),M=e=>{(0,C.PF)(e),t("update:modelValue",""),t("clear",e)},B=(0,o.Fl)((()=>"boolean"===typeof e.error?e.error:!(!l||!l.props.showError||"failed"!==a.status)||void 0)),W=(0,o.Fl)((()=>{const e=d("labelWidth");if(e)return{width:(0,Q.Nn)(e)}})),L=n=>{const r=13;if(n.keyCode===r){const t=l&&l.props.submitOnEnter;t||"textarea"===e.type||(0,C.PF)(n),"search"===e.type&&R()}t("keypress",n)},V=()=>e.id||`${r}-input`,z=()=>a.status,U=()=>{const t=Ye("control",[d("inputAlign"),{error:B.value,custom:!!n.input,"min-height":"textarea"===e.type&&!e.autosize}]);if(n.input)return(0,o.Wm)("div",{class:t,onClick:F},[n.input()]);const i={id:V(),ref:s,name:e.name,rows:void 0!==e.rows?+e.rows:void 0,class:t,disabled:d("disabled"),readonly:d("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${r}-label`:void 0,onBlur:O,onFocus:D,onInput:_,onClick:F,onChange:Ue,onKeypress:L,onCompositionend:Ue,onCompositionstart:ze};return"textarea"===e.type?(0,o.Wm)("textarea",i,null):(0,o.Wm)("input",(0,o.dG)(je(e.type),i),null)},H=()=>{const t=n["left-icon"];if(e.leftIcon||t)return(0,o.Wm)("div",{class:Ye("left-icon"),onClick:N},[t?t():(0,o.Wm)(E.J,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},j=()=>{const t=n["right-icon"];if(e.rightIcon||t)return(0,o.Wm)("div",{class:Ye("right-icon"),onClick:P},[t?t():(0,o.Wm)(E.J,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},G=()=>{if(e.showWordLimit&&e.maxlength){const t=Ge(f());return(0,o.Wm)("div",{class:Ye("word-limit")},[(0,o.Wm)("span",{class:Ye("word-num")},[t]),(0,o.Uk)("/"),e.maxlength])}},q=()=>{if(l&&!1===l.props.showErrorMessage)return;const t=e.errorMessage||a.validateMessage;if(t){const e=n["error-message"],r=d("errorMessageAlign");return(0,o.Wm)("div",{class:Ye("error-message",r)},[e?e({message:t}):t])}},$=()=>{const t=d("colon")?":":"";return n.label?[n.label(),t]:e.label?(0,o.Wm)("label",{id:`${r}-label`,for:V()},[e.label+t]):void 0},K=()=>[(0,o.Wm)("div",{class:Ye("body")},[U(),p.value&&(0,o.Wm)(E.J,{name:e.clearIcon,class:Ye("clear"),onTouchstart:M},null),j(),n.button&&(0,o.Wm)("div",{class:Ye("button")},[n.button()])]),G(),q()];return(0,y.F)({blur:R,focus:T,validate:x,formValue:h,resetValidation:m,getValidationStatus:z}),(0,o.JJ)(u.F1,{customValue:c,resetValidation:m,validateWithTrigger:w}),(0,o.YP)((()=>e.modelValue),(()=>{I(f()),m(),w("onChange"),(0,o.Y3)(A)})),(0,o.bv)((()=>{I(f(),e.formatTrigger),(0,o.Y3)(A)})),()=>{const t=d("disabled"),r=d("labelAlign"),i=$(),a=H();return(0,o.Wm)(De,{size:e.size,icon:e.leftIcon,class:Ye({error:B.value,disabled:t,[`label-${r}`]:r}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:W.value,valueClass:Ye("value"),titleClass:[Ye("label",[r,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:a?()=>a:null,title:i?()=>i:null,value:K,extra:n.extra})}}});const et=(0,r.n)(Qe);var tt=n(9733);const[nt,rt]=(0,a["do"])("switch"),ot={size:s.Or,loading:Boolean,disabled:Boolean,modelValue:s.Vg,activeColor:String,inactiveColor:String,activeValue:{type:s.Vg,default:!0},inactiveValue:{type:s.Vg,default:!1}};var it=(0,o.aZ)({name:nt,props:ot,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const r=()=>e.modelValue===e.activeValue,i=()=>{if(!e.disabled&&!e.loading){const n=r()?e.inactiveValue:e.activeValue;t("update:modelValue",n),t("change",n)}},a=()=>{if(e.loading){const t=r()?e.activeColor:e.inactiveColor;return(0,o.Wm)(k.g,{class:rt("loading"),color:t},null)}if(n.node)return n.node()};return(0,u.aM)((()=>e.modelValue)),()=>{var t;const{size:s,loading:u,disabled:c,activeColor:l,inactiveColor:f}=e,d=r(),p={fontSize:(0,Q.Nn)(s),backgroundColor:d?l:f};return(0,o.Wm)("div",{role:"switch",class:rt({on:d,loading:u,disabled:c}),style:p,tabindex:c?void 0:0,"aria-checked":d,onClick:i},[(0,o.Wm)("div",{class:rt("node")},[a()]),null==(t=n.background)?void 0:t.call(n)])}}});const at=(0,r.n)(it);n(3210);const[st,ut]=(0,a["do"])("address-edit-detail"),ct=(0,a["do"])("address-edit")[2];var lt=(0,o.aZ)({name:st,props:{show:Boolean,rows:s.Or,value:String,rules:Array,focused:Boolean,maxlength:s.Or,searchResult:Array,showSearchResult:Boolean},emits:["blur","focus","input","select-search"],setup(e,{emit:t}){const n=(0,i.iH)(),r=()=>e.focused&&e.searchResult&&e.showSearchResult,a=e=>{t("select-search",e),t("input",`${e.address||""} ${e.name||""}`.trim())},s=t=>{if(t.name){const n=t.name.replace(e.value,`<span class=${ut("keyword")}>${e.value}</span>`);return(0,o.Wm)("div",{innerHTML:n},null)}},u=()=>{if(!r())return;const{searchResult:t}=e;return t.map((e=>(0,o.Wm)(De,{clickable:!0,key:e.name+e.address,icon:"location-o",label:e.address,class:ut("search-item"),border:!1,onClick:()=>a(e)},{title:()=>s(e)})))},c=e=>t("blur",e),l=e=>t("focus",e),f=e=>t("input",e);return()=>{if(e.show)return(0,o.Wm)(o.HY,null,[(0,o.Wm)(et,{autosize:!0,clearable:!0,ref:n,class:ut(),rows:e.rows,type:"textarea",rules:e.rules,label:ct("addressDetail"),border:!r(),maxlength:e.maxlength,modelValue:e.value,placeholder:ct("addressDetail"),onBlur:c,onFocus:l,"onUpdate:modelValue":f},null),u()])}}});const[ft,dt,pt]=(0,a["do"])("address-edit"),ht={name:"",tel:"",city:"",county:"",country:"",province:"",areaCode:"",isDefault:!1,postalCode:"",addressDetail:""},vt=e=>/^\d{6}$/.test(e),mt={areaList:Object,isSaving:Boolean,isDeleting:Boolean,validator:Function,showArea:s.J5,showDetail:s.J5,showDelete:Boolean,showPostal:Boolean,disableArea:Boolean,searchResult:Array,telMaxlength:s.Or,showSetDefault:Boolean,saveButtonText:String,areaPlaceholder:String,deleteButtonText:String,showSearchResult:Boolean,detailRows:(0,s.SI)(1),detailMaxlength:(0,s.SI)(200),areaColumnsPlaceholder:(0,s.Ce)(),addressInfo:{type:Object,default:()=>(0,g.l7)({},ht)},telValidator:{type:Function,default:J.tq},postalValidator:{type:Function,default:vt}};var gt=(0,o.aZ)({name:ft,props:mt,emits:["save","focus","delete","click-area","change-area","change-detail","select-search","change-default"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,i.qj)({}),s=(0,i.iH)(!1),u=(0,i.iH)(!1),c=(0,o.Fl)((()=>(0,J.Kn)(e.areaList)&&Object.keys(e.areaList).length)),l=(0,o.Fl)((()=>{const{country:e,province:t,city:n,county:r,areaCode:o}=a;if(o){const o=[e,t,n,r];return t&&t===n&&o.splice(1,1),o.filter(Boolean).join("/")}return""})),f=(0,o.Fl)((()=>{var t;return(null==(t=e.searchResult)?void 0:t.length)&&u.value})),d=()=>{if(r.value){const e=r.value.getArea();e.areaCode=e.code,delete e.code,(0,g.l7)(a,e)}},p=e=>{u.value="addressDetail"===e,t("focus",e)},h=(0,o.Fl)((()=>{const{validator:t,telValidator:n,postalValidator:r}=e,o=(e,n)=>({validator:r=>{if(t){const n=t(e,r);if(n)return n}return!!r||n}});return{name:[o("name",pt("nameEmpty"))],tel:[o("tel",pt("telInvalid")),{validator:n,message:pt("telInvalid")}],areaCode:[o("areaCode",pt("areaEmpty"))],addressDetail:[o("addressDetail",pt("addressEmpty"))],postalCode:[o("addressDetail",pt("postalEmpty")),{validator:r,message:pt("postalEmpty")}]}})),v=()=>t("save",a),m=e=>{a.addressDetail=e,t("change-detail",e)},b=e=>{e=e.filter(Boolean),e.some((e=>!e.code))?(0,tt.F)(pt("areaEmpty")):(s.value=!1,d(),t("change-area",e))},x=()=>t("delete",a),w=()=>{var e;return(null==(e=r.value)?void 0:e.getValues())||[]},C=e=>{a.areaCode=e||"",e&&(0,o.Y3)(d)},S=()=>{setTimeout((()=>{u.value=!1}))},E=e=>{a.addressDetail=e},k=()=>{if(e.showSetDefault){const e={"right-icon":()=>(0,o.Wm)(at,{modelValue:a.isDefault,"onUpdate:modelValue":e=>a.isDefault=e,size:"24",onChange:e=>t("change-default",e)},null)};return(0,o.wy)((0,o.Wm)(De,{center:!0,title:pt("defaultAddress"),class:dt("default")},e),[[Y.F8,!f.value]])}};return(0,y.F)({getArea:w,setAreaCode:C,setAddressDetail:E}),(0,o.YP)((()=>e.areaList),(()=>C(a.areaCode))),(0,o.YP)((()=>e.addressInfo),(e=>{(0,g.l7)(a,ht,e),C(e.areaCode)}),{deep:!0,immediate:!0}),()=>{const{disableArea:i}=e;return(0,o.Wm)(Me,{class:dt(),onSubmit:v},{default:()=>{var d;return[(0,o.Wm)("div",{class:dt("fields")},[(0,o.Wm)(et,{modelValue:a.name,"onUpdate:modelValue":e=>a.name=e,clearable:!0,label:pt("name"),rules:h.value.name,placeholder:pt("name"),onFocus:()=>p("name")},null),(0,o.Wm)(et,{modelValue:a.tel,"onUpdate:modelValue":e=>a.tel=e,clearable:!0,type:"tel",label:pt("tel"),rules:h.value.tel,maxlength:e.telMaxlength,placeholder:pt("tel"),onFocus:()=>p("tel")},null),(0,o.wy)((0,o.Wm)(et,{readonly:!0,label:pt("area"),"is-link":!i,modelValue:l.value,rules:h.value.areaCode,placeholder:e.areaPlaceholder||pt("area"),onFocus:()=>p("areaCode"),onClick:()=>{t("click-area"),s.value=!i}},null),[[Y.F8,e.showArea]]),(0,o.Wm)(lt,{show:e.showDetail,rows:e.detailRows,rules:h.value.addressDetail,value:a.addressDetail,focused:u.value,maxlength:e.detailMaxlength,searchResult:e.searchResult,showSearchResult:e.showSearchResult,onBlur:S,onFocus:()=>p("addressDetail"),onInput:m,"onSelect-search":e=>t("select-search",e)},null),e.showPostal&&(0,o.wy)((0,o.Wm)(et,{modelValue:a.postalCode,"onUpdate:modelValue":e=>a.postalCode=e,type:"tel",rules:h.value.postalCode,label:pt("postal"),maxlength:"6",placeholder:pt("postal"),onFocus:()=>p("postalCode")},null),[[Y.F8,!f.value]]),null==(d=n.default)?void 0:d.call(n)]),k(),(0,o.wy)((0,o.Wm)("div",{class:dt("buttons")},[(0,o.Wm)(A,{block:!0,round:!0,type:"danger",text:e.saveButtonText||pt("save"),class:dt("button"),loading:e.isSaving,nativeType:"submit"},null),e.showDelete&&(0,o.Wm)(A,{block:!0,round:!0,class:dt("button"),loading:e.isDeleting,text:e.deleteButtonText||pt("delete"),onClick:x},null)]),[[Y.F8,!f.value]]),(0,o.Wm)(U.G,{show:s.value,"onUpdate:show":e=>s.value=e,round:!0,teleport:"body",position:"bottom",lazyRender:!1},{default:()=>[(0,o.Wm)(ke,{ref:r,value:a.areaCode,loading:!c.value,areaList:e.areaList,columnsPlaceholder:e.areaColumnsPlaceholder,onConfirm:b,onCancel:()=>{s.value=!1}},null)]})]}})}}});const yt=(0,r.n)(gt);const[bt,xt]=(0,a["do"])("radio-group"),wt={disabled:Boolean,iconSize:s.Or,direction:String,modelValue:s.Vg,checkedColor:String},Ct=Symbol(bt);var St=(0,o.aZ)({name:bt,props:wt,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const{linkChildren:r}=(0,u.$E)(Ct),i=e=>t("update:modelValue",e);return(0,o.YP)((()=>e.modelValue),(e=>t("change",e))),r({props:e,updateValue:i}),(0,u.aM)((()=>e.modelValue)),()=>{var t;return(0,o.Wm)("div",{class:xt([e.direction]),role:"radiogroup"},[null==(t=n.default)?void 0:t.call(n)])}}});const Et=(0,r.n)(St);const[kt,It]=(0,a["do"])("tag"),_t={size:String,mark:Boolean,show:s.J5,type:(0,s.SQ)("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var Rt=(0,o.aZ)({name:kt,props:_t,emits:["close"],setup(e,{slots:t,emit:n}){const r=e=>{e.stopPropagation(),n("close",e)},i=()=>e.plain?{color:e.textColor||e.color,borderColor:e.color}:{color:e.textColor,background:e.color},a=()=>{var n;const{type:a,mark:s,plain:u,round:c,size:l,closeable:f}=e,d={mark:s,plain:u,round:c};l&&(d[l]=l);const p=f&&(0,o.Wm)(E.J,{name:"cross",class:[It("close"),S.e9],onClick:r},null);return(0,o.Wm)("span",{style:i(),class:It([d,a])},[null==(n=t.default)?void 0:n.call(t),p])};return()=>(0,o.Wm)(Y.uT,{name:e.closeable?"van-fade":void 0},{default:()=>[e.show?a():null]})}});const Tt=(0,r.n)(Rt);const At={name:s.Vg,shape:(0,s.SQ)("round"),disabled:Boolean,iconSize:s.Or,modelValue:s.Vg,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var Dt=(0,o.aZ)({props:(0,g.l7)({},At,{bem:(0,s.ir)(Function),role:String,parent:Object,checked:Boolean,bindGroup:s.J5}),emits:["click","toggle"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=t=>{if(e.parent&&e.bindGroup)return e.parent.props[t]},s=(0,o.Fl)((()=>a("disabled")||e.disabled)),u=(0,o.Fl)((()=>a("direction"))),c=(0,o.Fl)((()=>{const t=e.checkedColor||a("checkedColor");if(t&&e.checked&&!s.value)return{borderColor:t,backgroundColor:t}})),l=n=>{const{target:o}=n,i=r.value,a=i===o||(null==i?void 0:i.contains(o));s.value||!a&&e.labelDisabled||t("toggle"),t("click",n)},f=()=>{const{bem:t,shape:i,checked:u}=e,l=e.iconSize||a("iconSize");return(0,o.Wm)("div",{ref:r,class:t("icon",[i,{disabled:s.value,checked:u}]),style:{fontSize:(0,Q.Nn)(l)}},[n.icon?n.icon({checked:u,disabled:s.value}):(0,o.Wm)(E.J,{name:"success",style:c.value},null)])},d=()=>{if(n.default)return(0,o.Wm)("span",{class:e.bem("label",[e.labelPosition,{disabled:s.value}])},[n.default()])};return()=>{const t="left"===e.labelPosition?[d(),f()]:[f(),d()];return(0,o.Wm)("div",{role:e.role,class:e.bem([{disabled:s.value,"label-disabled":e.labelDisabled},u.value]),tabindex:s.value?void 0:0,"aria-checked":e.checked,onClick:l},[t])}}});const[Ot,Ft]=(0,a["do"])("radio");var Nt=(0,o.aZ)({name:Ot,props:At,emits:["update:modelValue"],setup(e,{emit:t,slots:n}){const{parent:r}=(0,u.NB)(Ct),i=()=>{const t=r?r.props.modelValue:e.modelValue;return t===e.name},a=()=>{r?r.updateValue(e.name):t("update:modelValue",e.name)};return()=>(0,o.Wm)(Dt,(0,o.dG)({bem:Ft,role:"radio",parent:r,checked:i(),onToggle:a},e),(0,g.ei)(n,["default","icon"]))}});const Pt=(0,r.n)(Nt);const[Mt,Bt]=(0,a["do"])("address-item");var Wt=(0,o.aZ)({name:Mt,props:{address:(0,s.ir)(Object),disabled:Boolean,switchable:Boolean,defaultTagText:String},emits:["edit","click","select"],setup(e,{slots:t,emit:n}){const r=()=>{e.switchable&&n("select"),n("click")},i=()=>(0,o.Wm)(E.J,{name:"edit",class:Bt("edit"),onClick:e=>{e.stopPropagation(),n("edit"),n("click")}},null),a=()=>t.tag?t.tag(e.address):e.address.isDefault&&e.defaultTagText?(0,o.Wm)(Tt,{type:"danger",round:!0,class:Bt("tag")},{default:()=>[e.defaultTagText]}):void 0,s=()=>{const{address:t,disabled:n,switchable:r}=e,i=[(0,o.Wm)("div",{class:Bt("name")},[`${t.name} ${t.tel}`,a()]),(0,o.Wm)("div",{class:Bt("address")},[t.address])];return r&&!n?(0,o.Wm)(Pt,{name:t.id,iconSize:18},{default:()=>[i]}):i};return()=>{var n;const{disabled:a}=e;return(0,o.Wm)("div",{class:Bt({disabled:a}),onClick:r},[(0,o.Wm)(De,{border:!1,valueClass:Bt("value")},{value:s,"right-icon":i}),null==(n=t.bottom)?void 0:n.call(t,(0,g.l7)({},e.address,{disabled:a}))])}}});const[Lt,Vt,zt]=(0,a["do"])("address-list"),Ut={list:(0,s.Ce)(),modelValue:s.Or,switchable:s.J5,disabledText:String,disabledList:(0,s.Ce)(),addButtonText:String,defaultTagText:String};var Ht=(0,o.aZ)({name:Lt,props:Ut,emits:["add","edit","select","click-item","edit-disabled","select-disabled","update:modelValue"],setup(e,{slots:t,emit:n}){const r=(r,i,a)=>{const s=()=>n(a?"edit-disabled":"edit",r,i),u=()=>n("click-item",r,i),c=()=>{n(a?"select-disabled":"select",r,i),a||n("update:modelValue",r.id)};return(0,o.Wm)(Wt,{key:r.id,address:r,disabled:a,switchable:e.switchable,defaultTagText:e.defaultTagText,onEdit:s,onClick:u,onSelect:c},{bottom:t["item-bottom"],tag:t.tag})},i=(e,t)=>{if(e)return e.map(((e,n)=>r(e,n,t)))},a=()=>(0,o.Wm)("div",{class:[Vt("bottom"),"van-safe-area-bottom"]},[(0,o.Wm)(A,{round:!0,block:!0,type:"danger",text:e.addButtonText||zt("add"),class:Vt("add"),onClick:()=>n("add")},null)]);return()=>{var n,r;const s=i(e.list),u=i(e.disabledList,!0),c=e.disabledText&&(0,o.Wm)("div",{class:Vt("disabled-text")},[e.disabledText]);return(0,o.Wm)("div",{class:Vt()},[null==(n=t.top)?void 0:n.call(t),(0,o.Wm)(Et,{modelValue:e.modelValue},{default:()=>[s]}),c,u,null==(r=t.default)?void 0:r.call(t),a()])}}});const jt=(0,r.n)(Ht);const[Gt,qt,$t]=(0,a["do"])("calendar"),Kt=e=>$t("monthTitle",e.getFullYear(),e.getMonth()+1);function Xt(e,t){const n=e.getFullYear(),r=t.getFullYear();if(n===r){const n=e.getMonth(),r=t.getMonth();return n===r?0:n>r?1:-1}return n>r?1:-1}function Yt(e,t){const n=Xt(e,t);if(0===n){const n=e.getDate(),r=t.getDate();return n===r?0:n>r?1:-1}return n}const Jt=e=>new Date(e),Zt=e=>Array.isArray(e)?e.map(Jt):Jt(e);function Qt(e,t){const n=Jt(e);return n.setDate(n.getDate()+t),n}const en=e=>Qt(e,-1),tn=e=>Qt(e,1),nn=()=>{const e=new Date;return e.setHours(0,0,0,0),e};function rn(e){const t=e[0].getTime(),n=e[1].getTime();return(n-t)/864e5+1}function on(){const e=(0,i.iH)([]),t=[];(0,o.Xn)((()=>{e.value=[]}));const n=n=>(t[n]||(t[n]=t=>{e.value[n]=t}),t[n]);return[e,n]}const an=(0,g.l7)({},pe,{filter:Function,columnsOrder:Array,formatter:{type:Function,default:(e,t)=>t}}),sn=Object.keys(pe);function un(e,t){if(e<0)return[];const n=Array(e);let r=-1;while(++r<e)n[r]=t(r);return n}function cn(e){if(!e)return 0;while(Number.isNaN(parseInt(e,10))){if(!(e.length>1))return 0;e=e.slice(1)}return parseInt(e,10)}const ln=(e,t)=>32-new Date(e,t-1,32).getDate(),fn=(e,t)=>{const n=["setValues","setIndexes","setColumnIndex","setColumnValue"];return new Proxy(e,{get:(e,r)=>n.includes(r)?(...n)=>{e[r](...n),t()}:e[r]})},[dn]=(0,a["do"])("calendar-day");var pn=(0,o.aZ)({name:dn,props:{item:(0,s.ir)(Object),color:String,index:Number,offset:(0,s.qM)(0),rowHeight:String},emits:["click"],setup(e,{emit:t,slots:n}){const r=(0,o.Fl)((()=>{var t;const{item:n,index:r,color:o,offset:i,rowHeight:a}=e,s={height:a};if("placeholder"===n.type)return s.width="100%",s;if(0===r&&(s.marginLeft=100*i/7+"%"),o)switch(n.type){case"end":case"start":case"start-end":case"multiple-middle":case"multiple-selected":s.background=o;break;case"middle":s.color=o;break}return i+((null==(t=n.date)?void 0:t.getDate())||1)>28&&(s.marginBottom=0),s})),i=()=>{"disabled"!==e.item.type&&t("click",e.item)},a=()=>{const{topInfo:t}=e.item;if(t||n["top-info"])return(0,o.Wm)("div",{class:qt("top-info")},[n["top-info"]?n["top-info"](e.item):t])},s=()=>{const{bottomInfo:t}=e.item;if(t||n["bottom-info"])return(0,o.Wm)("div",{class:qt("bottom-info")},[n["bottom-info"]?n["bottom-info"](e.item):t])},u=()=>{const{item:t,color:n,rowHeight:r}=e,{type:i,text:u}=t,c=[a(),u,s()];return"selected"===i?(0,o.Wm)("div",{class:qt("selected-day"),style:{width:r,height:r,background:n}},[c]):c};return()=>{const{type:t,className:n}=e.item;return"placeholder"===t?(0,o.Wm)("div",{class:qt("day"),style:r.value},null):(0,o.Wm)("div",{role:"gridcell",style:r.value,class:[qt("day",t),n],tabindex:"disabled"===t?void 0:-1,onClick:i},[u()])}}});const[hn]=(0,a["do"])("calendar-month"),vn={date:(0,s.ir)(Date),type:String,color:String,minDate:(0,s.ir)(Date),maxDate:(0,s.ir)(Date),showMark:Boolean,rowHeight:s.Or,formatter:Function,lazyRender:Boolean,currentDate:[Date,Array],allowSameDay:Boolean,showSubtitle:Boolean,showMonthTitle:Boolean,firstDayOfWeek:Number};var mn=(0,o.aZ)({name:hn,props:vn,emits:["click","update-height"],setup(e,{emit:t,slots:n}){const[r,a]=(0,u.OT)(),s=(0,i.iH)(),l=(0,i.iH)(),f=c(l),d=(0,o.Fl)((()=>Kt(e.date))),p=(0,o.Fl)((()=>(0,Q.Nn)(e.rowHeight))),h=(0,o.Fl)((()=>{const t=e.date.getDay();return e.firstDayOfWeek?(t+7-e.firstDayOfWeek)%7:t})),v=(0,o.Fl)((()=>ln(e.date.getFullYear(),e.date.getMonth()+1))),m=(0,o.Fl)((()=>r.value||!e.lazyRender)),b=()=>d.value,x=t=>{const n=t=>e.currentDate.some((e=>0===Yt(e,t)));if(n(t)){const e=en(t),r=tn(t),o=n(e),i=n(r);return o&&i?"multiple-middle":o?"end":i?"start":"multiple-selected"}return""},w=t=>{const[n,r]=e.currentDate;if(!n)return"";const o=Yt(t,n);if(!r)return 0===o?"start":"";const i=Yt(t,r);return e.allowSameDay&&0===o&&0===i?"start-end":0===o?"start":0===i?"end":o>0&&i<0?"middle":""},S=t=>{const{type:n,minDate:r,maxDate:o,currentDate:i}=e;if(Yt(t,r)<0||Yt(t,o)>0)return"disabled";if(null===i)return"";if(Array.isArray(i)){if("multiple"===n)return x(t);if("range"===n)return w(t)}else if("single"===n)return 0===Yt(t,i)?"selected":"";return""},E=t=>{if("range"===e.type){if("start"===t||"end"===t)return $t(t);if("start-end"===t)return`${$t("start")}/${$t("end")}`}},k=()=>{if(e.showMonthTitle)return(0,o.Wm)("div",{class:qt("month-title")},[d.value])},I=()=>{if(e.showMark&&m.value)return(0,o.Wm)("div",{class:qt("month-mark")},[e.date.getMonth()+1])},_=(0,o.Fl)((()=>{const e=Math.ceil((v.value+h.value)/7);return Array(e).fill({type:"placeholder"})})),R=(0,o.Fl)((()=>{const t=[],n=e.date.getFullYear(),r=e.date.getMonth();for(let o=1;o<=v.value;o++){const i=new Date(n,r,o),a=S(i);let s={date:i,type:a,text:o,bottomInfo:E(a)};e.formatter&&(s=e.formatter(s)),t.push(s)}return t})),T=(0,o.Fl)((()=>R.value.filter((e=>"disabled"===e.type)))),A=(e,t)=>{if(s.value){const n=(0,u.EL)(s.value),r=_.value.length,o=Math.ceil((t.getDate()+h.value)/7),i=(o-1)*n.height/r;(0,C.QU)(e,n.top+i+e.scrollTop-(0,u.EL)(e).top)}},D=(r,i)=>(0,o.Wm)(pn,{item:r,index:i,color:e.color,offset:h.value,rowHeight:p.value,onClick:e=>t("click",e)},(0,g.ei)(n,["top-info","bottom-info"])),O=()=>(0,o.Wm)("div",{ref:s,role:"grid",class:qt("days")},[I(),(m.value?R:_).value.map(D)]);return(0,y.F)({getTitle:b,getHeight:()=>f.value,setVisible:a,scrollToDate:A,disabledDays:T}),()=>(0,o.Wm)("div",{class:qt("month"),ref:l},[k(),O()])}});const[gn]=(0,a["do"])("calendar-header");var yn=(0,o.aZ)({name:gn,props:{title:String,subtitle:String,showTitle:Boolean,showSubtitle:Boolean,firstDayOfWeek:Number},emits:["click-subtitle"],setup(e,{slots:t,emit:n}){const r=()=>{if(e.showTitle){const n=e.title||$t("title"),r=t.title?t.title():n;return(0,o.Wm)("div",{class:qt("header-title")},[r])}},i=e=>n("click-subtitle",e),a=()=>{if(e.showSubtitle){const n=t.subtitle?t.subtitle():e.subtitle;return(0,o.Wm)("div",{class:qt("header-subtitle"),onClick:i},[n])}},s=()=>{const{firstDayOfWeek:t}=e,n=$t("weekdays"),r=[...n.slice(t,7),...n.slice(0,t)];return(0,o.Wm)("div",{class:qt("weekdays")},[r.map((e=>(0,o.Wm)("span",{class:qt("weekday")},[e])))])};return()=>(0,o.Wm)("div",{class:qt("header")},[r(),a(),s()])}});const bn={show:Boolean,type:(0,s.SQ)("single"),title:String,color:String,round:s.J5,readonly:Boolean,poppable:s.J5,maxRange:(0,s.SI)(null),position:(0,s.SQ)("bottom"),teleport:[String,Object],showMark:s.J5,showTitle:s.J5,formatter:Function,rowHeight:s.Or,confirmText:String,rangePrompt:String,lazyRender:s.J5,showConfirm:s.J5,defaultDate:[Date,Array],allowSameDay:Boolean,showSubtitle:s.J5,closeOnPopstate:s.J5,showRangePrompt:s.J5,confirmDisabledText:String,closeOnClickOverlay:s.J5,safeAreaInsetTop:Boolean,safeAreaInsetBottom:s.J5,minDate:{type:Date,validator:J.J_,default:nn},maxDate:{type:Date,validator:J.J_,default:()=>{const e=nn();return new Date(e.getFullYear(),e.getMonth()+6,e.getDate())}},firstDayOfWeek:{type:s.Or,default:0,validator:e=>e>=0&&e<=6}};var xn=(0,o.aZ)({name:Gt,props:bn,emits:["select","confirm","unselect","month-show","over-range","update:show","click-subtitle"],setup(e,{emit:t,slots:n}){const r=(t,n=e.minDate,r=e.maxDate)=>-1===Yt(t,n)?n:1===Yt(t,r)?r:t,a=(t=e.defaultDate)=>{const{type:n,minDate:o,maxDate:i}=e;if(null===t)return t;const a=nn();if("range"===n){Array.isArray(t)||(t=[]);const e=r(t[0]||a,o,en(i)),n=r(t[1]||a,tn(o));return[e,n]}return"multiple"===n?Array.isArray(t)?t.map((e=>r(e))):[r(a)]:(t&&!Array.isArray(t)||(t=a),r(t))};let s;const c=(0,i.iH)(),l=(0,i.iH)(""),f=(0,i.iH)(a()),[d,p]=on(),h=(0,o.Fl)((()=>e.firstDayOfWeek?+e.firstDayOfWeek%7:0)),v=(0,o.Fl)((()=>{const t=[],n=new Date(e.minDate);if(e.lazyRender&&!e.show&&e.poppable)return t;n.setDate(1);do{t.push(new Date(n)),n.setMonth(n.getMonth()+1)}while(1!==Xt(n,e.maxDate));return t})),m=(0,o.Fl)((()=>{if(f.value){if("range"===e.type)return!f.value[0]||!f.value[1];if("multiple"===e.type)return!f.value.length}return!f.value})),b=()=>{const e=(0,C.cx)(c.value),n=e+s,r=v.value.map(((e,t)=>d.value[t].getHeight())),o=r.reduce(((e,t)=>e+t),0);if(n>o&&e>0)return;let i,a=0;const u=[-1,-1];for(let s=0;s<v.value.length;s++){const o=d.value[s],c=a<=n&&a+r[s]>=e;c&&(u[1]=s,i||(i=o,u[0]=s),d.value[s].showed||(d.value[s].showed=!0,t("month-show",{date:o.date,title:o.getTitle()}))),a+=r[s]}v.value.forEach(((e,t)=>{const n=t>=u[0]-1&&t<=u[1]+1;d.value[t].setVisible(n)})),i&&(l.value=i.getTitle())},x=e=>{(0,u.Wn)((()=>{v.value.some(((t,n)=>0===Xt(t,e)&&(c.value&&d.value[n].scrollToDate(c.value,e),!0))),b()}))},w=()=>{if(!e.poppable||e.show)if(f.value){const t="single"===e.type?f.value:f.value[0];x(t)}else(0,u.Wn)(b)},S=()=>{e.poppable&&!e.show||((0,u.Wn)((()=>{s=Math.floor((0,u.EL)(c).height)})),w())},E=(e=a())=>{f.value=e,w()},k=n=>{const{maxRange:r,rangePrompt:o,showRangePrompt:i}=e;return!(r&&rn(n)>r)||(i&&(0,tt.F)(o||$t("rangePrompt",r)),t("over-range"),!1)},I=()=>{var e;return t("confirm",null!=(e=f.value)?e:Zt(f.value))},_=(n,r)=>{const o=e=>{f.value=e,t("select",Zt(e))};if(r&&"range"===e.type){const t=k(n);if(!t)return void o([n[0],Qt(n[0],+e.maxRange-1)])}o(n),r&&!e.showConfirm&&I()},R=(e,t,n)=>{var r;return null==(r=e.find((e=>-1===Yt(t,e.date)&&-1===Yt(e.date,n))))?void 0:r.date},T=(0,o.Fl)((()=>d.value.reduce(((e,t)=>{var n,r;return e.push(...null!=(r=null==(n=t.disabledDays)?void 0:n.value)?r:[]),e}),[]))),D=n=>{if(e.readonly||!n.date)return;const{date:r}=n,{type:o}=e;if("range"===o){if(!f.value)return void _([r]);const[t,n]=f.value;if(t&&!n){const n=Yt(r,t);if(1===n){const e=R(T.value,t,r);if(e){const n=en(e);-1===Yt(t,n)?_([t,n]):_([r])}else _([t,r],!0)}else-1===n?_([r]):e.allowSameDay&&_([r,r],!0)}else _([r])}else if("multiple"===o){if(!f.value)return void _([r]);const n=f.value,o=n.findIndex((e=>0===Yt(e,r)));if(-1!==o){const[e]=n.splice(o,1);t("unselect",Jt(e))}else e.maxRange&&n.length>=e.maxRange?(0,tt.F)(e.rangePrompt||$t("rangePrompt",e.maxRange)):_([...n,r])}else _(r,!0)},O=e=>t("update:show",e),F=(t,r)=>{const i=0!==r||!e.showSubtitle;return(0,o.Wm)(mn,(0,o.dG)({ref:p(r),date:t,currentDate:f.value,showMonthTitle:i,firstDayOfWeek:h.value},(0,g.ei)(e,["type","color","minDate","maxDate","showMark","formatter","rowHeight","lazyRender","showSubtitle","allowSameDay"]),{onClick:D}),(0,g.ei)(n,["top-info","bottom-info"]))},N=()=>{if(n.footer)return n.footer();if(e.showConfirm){const t=n["confirm-text"],r=m.value,i=r?e.confirmDisabledText:e.confirmText;return(0,o.Wm)(A,{round:!0,block:!0,type:"danger",color:e.color,class:qt("confirm"),disabled:r,nativeType:"button",onClick:I},{default:()=>[t?t({disabled:r}):i||$t("confirm")]})}},P=()=>(0,o.Wm)("div",{class:[qt("footer"),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[N()]),M=()=>(0,o.Wm)("div",{class:qt()},[(0,o.Wm)(yn,{title:e.title,subtitle:l.value,showTitle:e.showTitle,showSubtitle:e.showSubtitle,firstDayOfWeek:h.value,"onClick-subtitle":e=>t("click-subtitle",e)},(0,g.ei)(n,["title","subtitle"])),(0,o.Wm)("div",{ref:c,class:qt("body"),onScroll:b},[v.value.map(F)]),P()]);return(0,o.YP)((()=>e.show),S),(0,o.YP)((()=>[e.type,e.minDate,e.maxDate]),(()=>E(a(f.value)))),(0,o.YP)((()=>e.defaultDate),((e=null)=>{f.value=e,w()})),(0,y.F)({reset:E,scrollToDate:x}),(0,u.Ib)(S),()=>e.poppable?(0,o.Wm)(U.G,{show:e.show,class:qt("popup"),round:e.round,position:e.position,closeable:e.showTitle||e.showSubtitle,teleport:e.teleport,closeOnPopstate:e.closeOnPopstate,safeAreaInsetTop:e.safeAreaInsetTop,closeOnClickOverlay:e.closeOnClickOverlay,"onUpdate:show":O},{default:M}):M()}});const wn=(0,r.n)(xn);const[Cn,Sn]=(0,a["do"])("image"),En={src:String,alt:String,fit:String,position:String,round:Boolean,width:s.Or,height:s.Or,radius:s.Or,lazyLoad:Boolean,iconSize:s.Or,showError:s.J5,errorIcon:(0,s.SQ)("photo-fail"),iconPrefix:String,showLoading:s.J5,loadingIcon:(0,s.SQ)("photo")};var kn=(0,o.aZ)({name:Cn,props:En,emits:["load","error"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(!1),a=(0,i.iH)(!0),s=(0,i.iH)(),{$Lazyload:u}=(0,o.FN)().proxy,c=(0,o.Fl)((()=>{const t={width:(0,Q.Nn)(e.width),height:(0,Q.Nn)(e.height)};return(0,J.Xq)(e.radius)&&(t.overflow="hidden",t.borderRadius=(0,Q.Nn)(e.radius)),t}));(0,o.YP)((()=>e.src),(()=>{r.value=!1,a.value=!0}));const l=e=>{a.value=!1,t("load",e)},f=e=>{r.value=!0,a.value=!1,t("error",e)},d=(t,n,r)=>r?r():(0,o.Wm)(E.J,{name:t,size:e.iconSize,class:n,classPrefix:e.iconPrefix},null),p=()=>a.value&&e.showLoading?(0,o.Wm)("div",{class:Sn("loading")},[d(e.loadingIcon,Sn("loading-icon"),n.loading)]):r.value&&e.showError?(0,o.Wm)("div",{class:Sn("error")},[d(e.errorIcon,Sn("error-icon"),n.error)]):void 0,h=()=>{if(r.value||!e.src)return;const t={alt:e.alt,class:Sn("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?(0,o.wy)((0,o.Wm)("img",(0,o.dG)({ref:s},t),null),[[(0,o.Q2)("lazy"),e.src]]):(0,o.Wm)("img",(0,o.dG)({src:e.src,onLoad:l,onError:f},t),null)},v=({el:e})=>{const t=()=>{e===s.value&&a.value&&l()};s.value?t():(0,o.Y3)(t)},m=({el:e})=>{e!==s.value||r.value||f()};return u&&g._f&&(u.$on("loaded",v),u.$on("error",m),(0,o.Jd)((()=>{u.$off("loaded",v),u.$off("error",m)}))),()=>{var t;return(0,o.Wm)("div",{class:Sn({round:e.round}),style:c.value},[h(),p(),null==(t=n.default)?void 0:t.call(n)])}}});const In=(0,r.n)(kn);const[_n,Rn]=(0,a["do"])("card"),Tn={tag:String,num:s.Or,desc:String,thumb:String,title:String,price:s.Or,centered:Boolean,lazyLoad:Boolean,currency:(0,s.SQ)("¥"),thumbLink:String,originPrice:s.Or};var An=(0,o.aZ)({name:_n,props:Tn,emits:["click-thumb"],setup(e,{slots:t,emit:n}){const r=()=>t.title?t.title():e.title?(0,o.Wm)("div",{class:[Rn("title"),"van-multi-ellipsis--l2"]},[e.title]):void 0,i=()=>{if(t.tag||e.tag)return(0,o.Wm)("div",{class:Rn("tag")},[t.tag?t.tag():(0,o.Wm)(Tt,{mark:!0,type:"danger"},{default:()=>[e.tag]})])},a=()=>t.thumb?t.thumb():(0,o.Wm)(In,{src:e.thumb,fit:"cover",width:"100%",height:"100%",lazyLoad:e.lazyLoad},null),s=()=>{if(t.thumb||e.thumb)return(0,o.Wm)("a",{href:e.thumbLink,class:Rn("thumb"),onClick:e=>n("click-thumb",e)},[a(),i()])},u=()=>t.desc?t.desc():e.desc?(0,o.Wm)("div",{class:[Rn("desc"),"van-ellipsis"]},[e.desc]):void 0,c=()=>{const t=e.price.toString().split(".");return(0,o.Wm)("div",null,[(0,o.Wm)("span",{class:Rn("price-currency")},[e.currency]),(0,o.Wm)("span",{class:Rn("price-integer")},[t[0]]),(0,o.Uk)("."),(0,o.Wm)("span",{class:Rn("price-decimal")},[t[1]])])};return()=>{var n,i,a;const l=t.num||(0,J.Xq)(e.num),f=t.price||(0,J.Xq)(e.price),d=t["origin-price"]||(0,J.Xq)(e.originPrice),p=l||f||d||t.bottom,h=f&&(0,o.Wm)("div",{class:Rn("price")},[t.price?t.price():c()]),v=d&&(0,o.Wm)("div",{class:Rn("origin-price")},[t["origin-price"]?t["origin-price"]():`${e.currency} ${e.originPrice}`]),m=l&&(0,o.Wm)("div",{class:Rn("num")},[t.num?t.num():`x${e.num}`]),g=t.footer&&(0,o.Wm)("div",{class:Rn("footer")},[t.footer()]),y=p&&(0,o.Wm)("div",{class:Rn("bottom")},[null==(n=t["price-top"])?void 0:n.call(t),h,v,m,null==(i=t.bottom)?void 0:i.call(t)]);return(0,o.Wm)("div",{class:Rn()},[(0,o.Wm)("div",{class:Rn("header")},[s(),(0,o.Wm)("div",{class:Rn("content",{centered:e.centered})},[(0,o.Wm)("div",null,[r(),u(),null==(a=t.tags)?void 0:a.call(t)]),y])]),g])}}});const Dn=(0,r.n)(An);var On=n(9951);function Fn(e,t,n){let r=0;const o=e.scrollLeft,i=0===n?1:Math.round(1e3*n/16);function a(){e.scrollLeft+=(t-o)/i,++r<i&&(0,u.Wn)(a)}a()}function Nn(e,t,n,r){let o=(0,C.cx)(e);const i=o<t,a=0===n?1:Math.round(1e3*n/16),s=(t-o)/a;function c(){o+=s,(i&&o>t||!i&&o<t)&&(o=t),(0,C.QU)(e,o),i&&o<t||!i&&o>t?(0,u.Wn)(c):r&&(0,u.Wn)(r)}c()}var Pn=n(7631);function Mn(e,t){if(!g._f||!window.IntersectionObserver)return;const n=new IntersectionObserver((e=>{t(e[0].intersectionRatio>0)}),{root:document.body}),r=()=>{e.value&&n.observe(e.value)},i=()=>{e.value&&n.unobserve(e.value)};(0,o.se)(i),(0,o.Jd)(i),(0,u.Ib)(r)}const[Bn,Wn]=(0,a["do"])("sticky"),Ln={zIndex:s.Or,position:(0,s.SQ)("top"),container:Object,offsetTop:(0,s.SI)(0),offsetBottom:(0,s.SI)(0)};var Vn=(0,o.aZ)({name:Bn,props:Ln,emits:["scroll","change"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,u.eo)(r),s=(0,i.qj)({fixed:!1,width:0,height:0,transform:0}),c=(0,o.Fl)((()=>(0,Q.LU)("top"===e.position?e.offsetTop:e.offsetBottom))),l=(0,o.Fl)((()=>{const{fixed:e,height:t,width:n}=s;if(e)return{width:`${n}px`,height:`${t}px`}})),f=(0,o.Fl)((()=>{if(!s.fixed)return;const t=(0,g.l7)((0,Q.As)(e.zIndex),{width:`${s.width}px`,height:`${s.height}px`,[e.position]:`${c.value}px`});return s.transform&&(t.transform=`translate3d(0, ${s.transform}px, 0)`),t})),d=e=>t("scroll",{scrollTop:e,isFixed:s.fixed}),p=()=>{if(!r.value||(0,C.xj)(r))return;const{container:t,position:n}=e,o=(0,u.EL)(r),i=(0,C.cx)(window);if(s.width=o.width,s.height=o.height,"top"===n)if(t){const e=(0,u.EL)(t),n=e.bottom-c.value-s.height;s.fixed=c.value>o.top&&e.bottom>0,s.transform=n<0?n:0}else s.fixed=c.value>o.top;else{const{clientHeight:e}=document.documentElement;if(t){const n=(0,u.EL)(t),r=e-n.top-c.value-s.height;s.fixed=e-c.value<o.bottom&&e>n.top,s.transform=r<0?-r:0}else s.fixed=e-c.value<o.bottom}d(i)};return(0,o.YP)((()=>s.fixed),(e=>t("change",e))),(0,u.OR)("scroll",p,{target:a}),Mn(r,p),()=>{var e;return(0,o.Wm)("div",{ref:r,style:l.value},[(0,o.Wm)("div",{class:Wn({fixed:s.fixed}),style:f.value},[null==(e=n.default)?void 0:e.call(n)])])}}});const zn=(0,r.n)(Vn);const[Un,Hn]=(0,a["do"])("tab");var jn=(0,o.aZ)({name:Un,props:{id:String,dot:Boolean,type:String,color:String,title:String,badge:s.Or,shrink:Boolean,isActive:Boolean,disabled:Boolean,controls:String,scrollable:Boolean,activeColor:String,inactiveColor:String,showZeroBadge:s.J5},setup(e,{slots:t}){const n=(0,o.Fl)((()=>{const t={},{type:n,color:r,disabled:o,isActive:i,activeColor:a,inactiveColor:s}=e,u="card"===n;r&&u&&(t.borderColor=r,o||(i?t.backgroundColor=r:t.color=r));const c=i?a:s;return c&&(t.color=c),t})),r=()=>{const n=(0,o.Wm)("span",{class:Hn("text",{ellipsis:!e.scrollable})},[t.title?t.title():e.title]);return e.dot||(0,J.Xq)(e.badge)&&""!==e.badge?(0,o.Wm)(M.C,{dot:e.dot,content:e.badge,showZero:e.showZeroBadge},{default:()=>[n]}):n};return()=>(0,o.Wm)("div",{id:e.id,role:"tab",class:[Hn([e.type,{grow:e.scrollable&&!e.shrink,shrink:e.shrink,active:e.isActive,disabled:e.disabled}])],style:n.value,tabindex:e.disabled?void 0:e.isActive?0:-1,"aria-selected":e.isActive,"aria-disabled":e.disabled||void 0,"aria-controls":e.controls},[r()])}});const[Gn,qn]=(0,a["do"])("swipe"),$n={loop:s.J5,width:s.Or,height:s.Or,vertical:Boolean,autoplay:(0,s.SI)(0),duration:(0,s.SI)(500),touchable:s.J5,lazyRender:Boolean,initialSwipe:(0,s.SI)(0),indicatorColor:String,showIndicators:s.J5,stopPropagation:s.J5},Kn=Symbol(Gn);var Xn=(0,o.aZ)({name:Gn,props:$n,emits:["change"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,i.qj)({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),s=(0,ee.o)(),{children:c,linkChildren:l}=(0,u.$E)(Kn),f=(0,o.Fl)((()=>c.length)),d=(0,o.Fl)((()=>a[e.vertical?"height":"width"])),p=(0,o.Fl)((()=>e.vertical?s.deltaY.value:s.deltaX.value)),h=(0,o.Fl)((()=>{if(a.rect){const t=e.vertical?a.rect.height:a.rect.width;return t-d.value*f.value}return 0})),v=(0,o.Fl)((()=>Math.ceil(Math.abs(h.value)/d.value))),m=(0,o.Fl)((()=>f.value*d.value)),g=(0,o.Fl)((()=>(a.active+f.value)%f.value)),b=(0,o.Fl)((()=>{const t=e.vertical?"vertical":"horizontal";return s.direction.value===t})),x=(0,o.Fl)((()=>{const t={transitionDuration:`${a.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${a.offset}px)`};if(d.value){const n=e.vertical?"height":"width",r=e.vertical?"width":"height";t[n]=`${m.value}px`,t[r]=e[r]?`${e[r]}px`:""}return t})),w=t=>{const{active:n}=a;return t?e.loop?(0,Q.uZ)(n+t,-1,f.value):(0,Q.uZ)(n+t,0,v.value):n},S=(t,n=0)=>{let r=t*d.value;e.loop||(r=Math.min(r,-h.value));let o=n-r;return e.loop||(o=(0,Q.uZ)(o,h.value,0)),o},E=({pace:n=0,offset:r=0,emitChange:o})=>{if(f.value<=1)return;const{active:i}=a,s=w(n),u=S(s,r);if(e.loop){if(c[0]&&u!==h.value){const e=u<h.value;c[0].setOffset(e?m.value:0)}if(c[f.value-1]&&0!==u){const e=u>0;c[f.value-1].setOffset(e?-m.value:0)}}a.active=s,a.offset=u,o&&s!==i&&t("change",g.value)},k=()=>{a.swiping=!0,a.active<=-1?E({pace:f.value}):a.active>=f.value&&E({pace:-f.value})},I=()=>{k(),s.reset(),(0,u.d1)((()=>{a.swiping=!1,E({pace:-1,emitChange:!0})}))},_=()=>{k(),s.reset(),(0,u.d1)((()=>{a.swiping=!1,E({pace:1,emitChange:!0})}))};let R;const T=()=>clearTimeout(R),A=()=>{T(),e.autoplay>0&&f.value>1&&(R=setTimeout((()=>{_(),A()}),+e.autoplay))},D=(t=+e.initialSwipe)=>{if(!r.value)return;const n=()=>{var n,o;if(!(0,C.xj)(r)){const t={width:r.value.offsetWidth,height:r.value.offsetHeight};a.rect=t,a.width=+(null!=(n=e.width)?n:t.width),a.height=+(null!=(o=e.height)?o:t.height)}f.value&&(t=Math.min(f.value-1,t)),a.active=t,a.swiping=!0,a.offset=S(t),c.forEach((e=>{e.setOffset(0)})),A()};(0,C.xj)(r)?(0,o.Y3)().then(n):n()},O=()=>D(a.active);let F;const N=t=>{e.touchable&&(s.start(t),F=Date.now(),T(),k())},P=t=>{e.touchable&&a.swiping&&(s.move(t),b.value&&((0,C.PF)(t,e.stopPropagation),E({offset:p.value})))},M=()=>{if(!e.touchable||!a.swiping)return;const t=Date.now()-F,n=p.value/t,r=Math.abs(n)>.25||Math.abs(p.value)>d.value/2;if(r&&b.value){const t=e.vertical?s.offsetY.value:s.offsetX.value;let n=0;n=e.loop?t>0?p.value>0?-1:1:0:-Math[p.value>0?"ceil":"floor"](p.value/d.value),E({pace:n,emitChange:!0})}else p.value&&E({pace:0});a.swiping=!1,A()},B=(t,n={})=>{k(),s.reset(),(0,u.d1)((()=>{let r;r=e.loop&&t===f.value?0===a.active?0:t:t%f.value,n.immediate?(0,u.d1)((()=>{a.swiping=!1})):a.swiping=!1,E({pace:r-a.active,emitChange:!0})}))},W=(t,n)=>{const r=n===g.value,i=r?{backgroundColor:e.indicatorColor}:void 0;return(0,o.Wm)("i",{style:i,class:qn("indicator",{active:r})},null)},L=()=>n.indicator?n.indicator({active:g.value,total:f.value}):e.showIndicators&&f.value>1?(0,o.Wm)("div",{class:qn("indicators",{vertical:e.vertical})},[Array(f.value).fill("").map(W)]):void 0;return(0,y.F)({prev:I,next:_,state:a,resize:O,swipeTo:B}),l({size:d,props:e,count:f,activeIndicator:g}),(0,o.YP)((()=>e.initialSwipe),(e=>D(+e))),(0,o.YP)(f,(()=>D(a.active))),(0,o.YP)((()=>e.autoplay),A),(0,o.YP)([C.bn,C.uK],O),(0,o.YP)((0,u.d9)(),(e=>{"visible"===e?A():T()})),(0,o.bv)(D),(0,o.dl)((()=>D(a.active))),(0,Pn.h)((()=>D(a.active))),(0,o.se)(T),(0,o.Jd)(T),()=>{var t;return(0,o.Wm)("div",{ref:r,class:qn()},[(0,o.Wm)("div",{style:x.value,class:qn("track",{vertical:e.vertical}),onTouchstart:N,onTouchmove:P,onTouchend:M,onTouchcancel:M},[null==(t=n.default)?void 0:t.call(n)]),L()])}}});const Yn=(0,r.n)(Xn);const[Jn,Zn]=(0,a["do"])("tabs");var Qn=(0,o.aZ)({name:Jn,props:{count:(0,s.ir)(Number),inited:Boolean,animated:Boolean,duration:(0,s.ir)(s.Or),swipeable:Boolean,lazyRender:Boolean,currentIndex:(0,s.ir)(Number)},emits:["change"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=e=>t("change",e),s=()=>{var t;const i=null==(t=n.default)?void 0:t.call(n);return e.animated||e.swipeable?(0,o.Wm)(Yn,{ref:r,loop:!1,class:Zn("track"),duration:1e3*+e.duration,touchable:e.swipeable,lazyRender:e.lazyRender,showIndicators:!1,onChange:a},{default:()=>[i]}):i},u=t=>{const n=r.value;n&&n.state.active!==t&&n.swipeTo(t,{immediate:!e.inited})};return(0,o.YP)((()=>e.currentIndex),u),(0,o.bv)((()=>{u(e.currentIndex)})),()=>(0,o.Wm)("div",{class:Zn("content",{animated:e.animated||e.swipeable})},[s()])}});const[er,tr]=(0,a["do"])("tabs"),nr={type:(0,s.SQ)("line"),color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:(0,s.SI)(0),duration:(0,s.SI)(.3),animated:Boolean,ellipsis:s.J5,swipeable:Boolean,scrollspy:Boolean,offsetTop:(0,s.SI)(0),background:String,lazyRender:s.J5,lineWidth:s.Or,lineHeight:s.Or,beforeChange:Function,swipeThreshold:(0,s.SI)(5),titleActiveColor:String,titleInactiveColor:String},rr=Symbol(er);var or=(0,o.aZ)({name:er,props:nr,emits:["click","change","scroll","disabled","rendered","click-tab","update:active"],setup(e,{emit:t,slots:n}){let r,a,s;const c=(0,i.iH)(),l=(0,i.iH)(),f=(0,i.iH)(),d=Ke(),p=(0,u.eo)(c),[h,v]=on(),{children:m,linkChildren:b}=(0,u.$E)(rr),w=(0,i.qj)({inited:!1,position:"",lineStyle:{},currentIndex:-1}),E=(0,o.Fl)((()=>m.length>e.swipeThreshold||!e.ellipsis||e.shrink)),k=(0,o.Fl)((()=>({borderColor:e.color,background:e.background}))),I=(e,t)=>{var n;return null!=(n=e.name)?n:t},_=(0,o.Fl)((()=>{const e=m[w.currentIndex];if(e)return I(e,w.currentIndex)})),R=(0,o.Fl)((()=>(0,Q.LU)(e.offsetTop))),T=(0,o.Fl)((()=>e.sticky?R.value+r:0)),A=t=>{const n=l.value,r=h.value;if(!E.value||!n||!r||!r[w.currentIndex])return;const o=r[w.currentIndex].$el,i=o.offsetLeft-(n.offsetWidth-o.offsetWidth)/2;Fn(n,i,t?0:+e.duration)},D=()=>{const t=w.inited;(0,o.Y3)((()=>{const n=h.value;if(!n||!n[w.currentIndex]||"line"!==e.type||(0,C.xj)(c.value))return;const r=n[w.currentIndex].$el,{lineWidth:o,lineHeight:i}=e,a=r.offsetLeft+r.offsetWidth/2,s={width:(0,Q.Nn)(o),backgroundColor:e.color,transform:`translateX(${a}px) translateX(-50%)`};if(t&&(s.transitionDuration=`${e.duration}s`),(0,J.Xq)(i)){const e=(0,Q.Nn)(i);s.height=e,s.borderRadius=e}w.lineStyle=s}))},O=e=>{const t=e<w.currentIndex?-1:1;while(e>=0&&e<m.length){if(!m[e].disabled)return e;e+=t}},F=n=>{const r=O(n);if(!(0,J.Xq)(r))return;const o=m[r],i=I(o,r),a=null!==w.currentIndex;w.currentIndex=r,i!==e.active&&(t("update:active",i),a&&t("change",i,o.title))},N=e=>{const t=m.find(((t,n)=>I(t,n)===e)),n=t?m.indexOf(t):0;F(n)},P=(t=!1)=>{if(e.scrollspy){const n=m[w.currentIndex].$el;if(n&&p.value){const r=(0,C.U4)(n,p.value)-T.value;a=!0,Nn(p.value,r,t?0:+e.duration,(()=>{a=!1}))}}},M=(n,r,o)=>{const{title:i,disabled:a}=m[r],s=I(m[r],r);a?t("disabled",s,i):((0,On.I)(e.beforeChange,{args:[s],done:()=>{F(r),P()}}),t("click",s,i),x(n)),t("click-tab",{name:s,title:i,event:o,disabled:a})},B=e=>{s=e.isFixed,t("scroll",e)},W=e=>{(0,o.Y3)((()=>{N(e),P(!0)}))},L=()=>{for(let e=0;e<m.length;e++){const{top:t}=(0,u.EL)(m[e].$el);if(t>T.value)return 0===e?0:e-1}return m.length-1},V=()=>{if(e.scrollspy&&!a){const e=L();F(e)}},z=()=>m.map(((t,n)=>(0,o.Wm)(jn,(0,o.dG)({key:t.id,id:`${d}-${n}`,ref:v(n),type:e.type,color:e.color,style:t.titleStyle,class:t.titleClass,shrink:e.shrink,isActive:n===w.currentIndex,controls:t.id,scrollable:E.value,activeColor:e.titleActiveColor,inactiveColor:e.titleInactiveColor,onClick:e=>M(t,n,e)},(0,g.ei)(t,["dot","badge","title","disabled","showZeroBadge"])),{title:t.$slots.title}))),U=()=>{if("line"===e.type&&m.length)return(0,o.Wm)("div",{class:tr("line"),style:w.lineStyle},null)},H=()=>{var t,r;const{type:i,border:a}=e;return(0,o.Wm)("div",{ref:f,class:[tr("wrap"),{[S.r5]:"line"===i&&a}]},[(0,o.Wm)("div",{ref:l,role:"tablist",class:tr("nav",[i,{shrink:e.shrink,complete:E.value}]),style:k.value,"aria-orientation":"horizontal"},[null==(t=n["nav-left"])?void 0:t.call(n),z(),U(),null==(r=n["nav-right"])?void 0:r.call(n)])])};(0,o.YP)([()=>e.color,C.bn],D),(0,o.YP)((()=>e.active),(e=>{e!==_.value&&N(e)})),(0,o.YP)((()=>m.length),(()=>{w.inited&&(N(e.active),D(),(0,o.Y3)((()=>{A(!0)})))})),(0,o.YP)((()=>w.currentIndex),(()=>{A(),D(),s&&!e.scrollspy&&(0,C.kn)(Math.ceil((0,C.U4)(c.value)-R.value))}));const j=()=>{N(e.active),(0,o.Y3)((()=>{w.inited=!0,f.value&&(r=(0,u.EL)(f.value).height),A(!0)}))},G=(e,n)=>t("rendered",e,n);return(0,y.F)({resize:D,scrollTo:W}),(0,o.dl)(D),(0,Pn.h)(D),(0,u.Ib)(j),(0,u.OR)("scroll",V,{target:p}),b({id:d,props:e,setLine:D,onRendered:G,currentName:_,scrollIntoView:A}),()=>{var t;return(0,o.Wm)("div",{ref:c,class:tr([e.type])},[e.sticky?(0,o.Wm)(zn,{container:c.value,offsetTop:R.value,onScroll:B},{default:()=>{var e;return[H(),null==(e=n["nav-bottom"])?void 0:e.call(n)]}}):[H(),null==(t=n["nav-bottom"])?void 0:t.call(n)],(0,o.Wm)(Qn,{count:m.length,inited:w.inited,animated:e.animated,duration:e.duration,swipeable:e.swipeable,lazyRender:e.lazyRender,currentIndex:w.currentIndex,onChange:F},{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n)]}})])}}});const ir=Symbol(),ar=()=>(0,o.f3)(ir,null),[sr,ur]=(0,a["do"])("swipe-item");var cr=(0,o.aZ)({name:sr,setup(e,{slots:t}){let n;const r=(0,i.qj)({offset:0,inited:!1,mounted:!1}),{parent:a,index:s}=(0,u.NB)(Kn);if(!a)return void 0;const c=(0,o.Fl)((()=>{const e={},{vertical:t}=a.props;return a.size.value&&(e[t?"height":"width"]=`${a.size.value}px`),r.offset&&(e.transform=`translate${t?"Y":"X"}(${r.offset}px)`),e})),l=(0,o.Fl)((()=>{const{loop:e,lazyRender:t}=a.props;if(!t||n)return!0;if(!r.mounted)return!1;const o=a.activeIndicator.value,i=a.count.value-1,u=0===o&&e?i:o-1,c=o===i&&e?0:o+1;return n=s.value===o||s.value===u||s.value===c,n})),f=e=>{r.offset=e};return(0,o.bv)((()=>{(0,o.Y3)((()=>{r.mounted=!0}))})),(0,y.F)({setOffset:f}),()=>{var e;return(0,o.Wm)("div",{class:ur(),style:c.value},[l.value?null==(e=t.default)?void 0:e.call(t):null])}}});const lr=(0,r.n)(cr);const[fr,dr]=(0,a["do"])("tab"),pr=(0,g.l7)({},b,{dot:Boolean,name:s.Or,badge:s.Or,title:String,disabled:Boolean,titleClass:s.Vg,titleStyle:[String,Object],showZeroBadge:s.J5});var hr=(0,o.aZ)({name:fr,props:pr,setup(e,{slots:t}){const n=Ke(),r=(0,i.iH)(!1),{parent:a,index:s}=(0,u.NB)(rr);if(!a)return void 0;const c=()=>{var t;return null!=(t=e.name)?t:s.value},l=()=>{r.value=!0,a.props.lazyRender&&(0,o.Y3)((()=>{a.onRendered(c(),e.title)}))},f=(0,o.Fl)((()=>{const e=c()===a.currentName.value;return e&&!r.value&&l(),e}));return(0,o.YP)((()=>e.title),(()=>{a.setLine(),a.scrollIntoView()})),(0,o.JJ)(ir,f),()=>{var e;const i=`${a.id}-${s.value}`,{animated:u,swipeable:c,scrollspy:l,lazyRender:d}=a.props;if(!t.default&&!u)return;const p=l||f.value;if(u||c)return(0,o.Wm)(lr,{id:n,role:"tabpanel",class:dr("panel-wrapper",{inactive:!f.value}),tabindex:f.value?0:-1,"aria-hidden":!f.value,"aria-labelledby":i},{default:()=>{var e;return[(0,o.Wm)("div",{class:dr("panel")},[null==(e=t.default)?void 0:e.call(t)])]}});const h=r.value||l||!d,v=h?null==(e=t.default)?void 0:e.call(t):null;return(0,y.F)({id:n}),(0,o.wy)((0,o.Wm)("div",{id:n,role:"tabpanel",class:dr("panel"),tabindex:p?0:-1,"aria-labelledby":i},[v]),[[Y.F8,p]])}}});const vr=(0,r.n)(hr);const mr=(0,r.n)(or);const[gr,yr,br]=(0,a["do"])("cascader"),xr={title:String,options:(0,s.Ce)(),closeable:s.J5,swipeable:s.J5,closeIcon:(0,s.SQ)("cross"),showHeader:s.J5,modelValue:s.Or,fieldNames:Object,placeholder:String,activeColor:String};var wr=(0,o.aZ)({name:gr,props:xr,emits:["close","change","finish","click-tab","update:modelValue"],setup(e,{slots:t,emit:n}){const r=(0,i.iH)([]),a=(0,i.iH)(0),{text:s,value:u,children:c}=(0,g.l7)({text:"text",value:"value",children:"children"},e.fieldNames),l=(e,t)=>{for(const n of e){if(n[u]===t)return[n];if(n[c]){const e=l(n[c],t);if(e)return[n,...e]}}},f=()=>{const{options:t,modelValue:n}=e;if(void 0!==n){const e=l(t,n);if(e){let n=t;return r.value=e.map((e=>{const t={options:n,selected:e},r=n.find((t=>t[u]===e[u]));return r&&(n=r[c]),t})),n&&r.value.push({options:n,selected:null}),void(0,o.Y3)((()=>{a.value=r.value.length-1}))}}r.value=[{options:t,selected:null}]},d=(e,t)=>{if(e.disabled)return;if(r.value[t].selected=e,r.value.length>t+1&&(r.value=r.value.slice(0,t+1)),e[c]){const n={options:e[c],selected:null};r.value[t+1]?r.value[t+1]=n:r.value.push(n),(0,o.Y3)((()=>{a.value++}))}const i=r.value.map((e=>e.selected)).filter(Boolean);n("update:modelValue",e[u]);const s={value:e[u],tabIndex:t,selectedOptions:i};n("change",s),e[c]||n("finish",s)},p=()=>n("close"),h=({name:e,title:t})=>n("click-tab",e,t),v=()=>e.showHeader?(0,o.Wm)("div",{class:yr("header")},[(0,o.Wm)("h2",{class:yr("title")},[t.title?t.title():e.title]),e.closeable?(0,o.Wm)(E.J,{name:e.closeIcon,class:[yr("close-icon"),S.e9],onClick:p},null):null]):null,m=(n,r,i)=>{const{disabled:a}=n,c=!(!r||n[u]!==r[u]),l=n.color||(c?e.activeColor:void 0),f=t.option?t.option({option:n,selected:c}):(0,o.Wm)("span",null,[n[s]]);return(0,o.Wm)("li",{role:"menuitemradio",class:[yr("option",{selected:c,disabled:a}),n.className],style:{color:l},tabindex:a?void 0:c?0:-1,"aria-checked":c,"aria-disabled":a||void 0,onClick:()=>d(n,i)},[f,c?(0,o.Wm)(E.J,{name:"success",class:yr("selected-icon")},null):null])},y=(e,t,n)=>(0,o.Wm)("ul",{role:"menu",class:yr("options")},[e.map((e=>m(e,t,n)))]),b=(n,r)=>{const{options:i,selected:a}=n,u=e.placeholder||br("select"),c=a?a[s]:u;return(0,o.Wm)(vr,{title:c,titleClass:yr("tab",{unselected:!a})},{default:()=>{var e,n;return[null==(e=t["options-top"])?void 0:e.call(t,{tabIndex:r}),y(i,a,r),null==(n=t["options-bottom"])?void 0:n.call(t,{tabIndex:r})]}})},x=()=>(0,o.Wm)(mr,{active:a.value,"onUpdate:active":e=>a.value=e,shrink:!0,animated:!0,class:yr("tabs"),color:e.activeColor,swipeable:e.swipeable,"onClick-tab":h},{default:()=>[r.value.map(b)]});return f(),(0,o.YP)((()=>e.options),f,{deep:!0}),(0,o.YP)((()=>e.modelValue),(e=>{if(void 0!==e){const t=r.value.map((e=>{var t;return null==(t=e.selected)?void 0:t[u]}));if(t.includes(e))return}f()})),()=>(0,o.Wm)("div",{class:yr()},[v(),x()])}});const Cr=(0,r.n)(wr);const[Sr,Er]=(0,a["do"])("cell-group"),kr={title:String,inset:Boolean,border:s.J5};var Ir=(0,o.aZ)({name:Sr,inheritAttrs:!1,props:kr,setup(e,{slots:t,attrs:n}){const r=()=>{var r;return(0,o.Wm)("div",(0,o.dG)({class:[Er({inset:e.inset}),{[S.r5]:e.border&&!e.inset}]},n),[null==(r=t.default)?void 0:r.call(t)])},i=()=>(0,o.Wm)("div",{class:Er("title",{inset:e.inset})},[t.title?t.title():e.title]);return()=>e.title||t.title?(0,o.Wm)(o.HY,null,[i(),r()]):r()}});const _r=(0,r.n)(Ir);const[Rr,Tr]=(0,a["do"])("checkbox-group"),Ar={max:s.Or,disabled:Boolean,iconSize:s.Or,direction:String,modelValue:(0,s.Ce)(),checkedColor:String},Dr=Symbol(Rr);var Or=(0,o.aZ)({name:Rr,props:Ar,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const{children:r,linkChildren:i}=(0,u.$E)(Dr),a=e=>t("update:modelValue",e),s=(e={})=>{"boolean"===typeof e&&(e={checked:e});const{checked:t,skipDisabled:n}=e,o=r.filter((e=>!!e.props.bindGroup&&(e.props.disabled&&n?e.checked.value:null!=t?t:!e.checked.value))),i=o.map((e=>e.name));a(i)};return(0,o.YP)((()=>e.modelValue),(e=>t("change",e))),(0,y.F)({toggleAll:s}),(0,u.aM)((()=>e.modelValue)),i({props:e,updateValue:a}),()=>{var t;return(0,o.Wm)("div",{class:Tr([e.direction])},[null==(t=n.default)?void 0:t.call(n)])}}});const[Fr,Nr]=(0,a["do"])("checkbox"),Pr=(0,g.l7)({},At,{bindGroup:s.J5});var Mr=(0,o.aZ)({name:Fr,props:Pr,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const{parent:r}=(0,u.NB)(Dr),i=t=>{const{name:n}=e,{max:o,modelValue:i}=r.props,a=i.slice();if(t){const t=o&&a.length>=o;t||a.includes(n)||(a.push(n),e.bindGroup&&r.updateValue(a))}else{const t=a.indexOf(n);-1!==t&&(a.splice(t,1),e.bindGroup&&r.updateValue(a))}},a=(0,o.Fl)((()=>r&&e.bindGroup?-1!==r.props.modelValue.indexOf(e.name):!!e.modelValue)),s=(n=!a.value)=>{r&&e.bindGroup?i(n):t("update:modelValue",n)};return(0,o.YP)((()=>e.modelValue),(e=>t("change",e))),(0,y.F)({toggle:s,props:e,checked:a}),(0,u.aM)((()=>e.modelValue)),()=>(0,o.Wm)(Dt,(0,o.dG)({bem:Nr,role:"checkbox",parent:r,checked:a.value,onToggle:s},e),(0,g.ei)(n,["default","icon"]))}});const Br=(0,r.n)(Mr);const Wr=(0,r.n)(Or);n(2707);const[Lr,Vr]=(0,a["do"])("circle");let zr=0;const Ur=e=>Math.min(Math.max(+e,0),100);function Hr(e,t){const n=e?1:0;return`M ${t/2} ${t/2} m 0, -500 a 500, 500 0 1, ${n} 0, 1000 a 500, 500 0 1, ${n} 0, -1000`}const jr={text:String,size:s.Or,fill:(0,s.SQ)("none"),rate:(0,s.SI)(100),speed:(0,s.SI)(0),color:[String,Object],clockwise:s.J5,layerColor:String,currentRate:(0,s.qM)(0),strokeWidth:(0,s.SI)(40),strokeLinecap:String,startPosition:(0,s.SQ)("top")};var Gr=(0,o.aZ)({name:Lr,props:jr,emits:["update:currentRate"],setup(e,{emit:t,slots:n}){const r="van-circle-"+zr++,i=(0,o.Fl)((()=>+e.strokeWidth+1e3)),a=(0,o.Fl)((()=>Hr(e.clockwise,i.value))),s=(0,o.Fl)((()=>{const t={top:0,right:90,bottom:180,left:270},n=t[e.startPosition];if(n)return{transform:`rotate(${n}deg)`}}));(0,o.YP)((()=>e.rate),(n=>{let r;const o=Date.now(),i=e.currentRate,a=Ur(n),s=Math.abs(1e3*(i-a)/+e.speed),c=()=>{const e=Date.now(),n=Math.min((e-o)/s,1),l=n*(a-i)+i;t("update:currentRate",Ur(parseFloat(l.toFixed(1)))),(a>i?l<a:l>a)&&(r=(0,u.Wn)(c))};e.speed?(r&&(0,u.$d)(r),r=(0,u.Wn)(c)):t("update:currentRate",a)}),{immediate:!0});const c=()=>{const t=3140,{strokeWidth:n,currentRate:i,strokeLinecap:s}=e,u=t*i/100,c=(0,J.Kn)(e.color)?`url(#${r})`:e.color,l={stroke:c,strokeWidth:+n+1+"px",strokeLinecap:s,strokeDasharray:`${u}px ${t}px`};return(0,o.Wm)("path",{d:a.value,style:l,class:Vr("hover"),stroke:c},null)},l=()=>{const t={fill:e.fill,stroke:e.layerColor,strokeWidth:`${e.strokeWidth}px`};return(0,o.Wm)("path",{class:Vr("layer"),style:t,d:a.value},null)},f=()=>{const{color:t}=e;if(!(0,J.Kn)(t))return;const n=Object.keys(t).sort(((e,t)=>parseFloat(e)-parseFloat(t))).map(((e,n)=>(0,o.Wm)("stop",{key:n,offset:e,"stop-color":t[e]},null)));return(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{id:r,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[n])])},d=()=>n.default?n.default():e.text?(0,o.Wm)("div",{class:Vr("text")},[e.text]):void 0;return()=>(0,o.Wm)("div",{class:Vr(),style:(0,Q.Xn)(e.size)},[(0,o.Wm)("svg",{viewBox:`0 0 ${i.value} ${i.value}`,style:s.value},[f(),l(),c()]),d()])}});const qr=(0,r.n)(Gr);const[$r,Kr]=(0,a["do"])("row"),Xr=Symbol($r),Yr={tag:(0,s.SQ)("div"),wrap:s.J5,align:String,gutter:(0,s.SI)(0),justify:String};var Jr=(0,o.aZ)({name:$r,props:Yr,setup(e,{slots:t}){const{children:n,linkChildren:r}=(0,u.$E)(Xr),i=(0,o.Fl)((()=>{const e=[[]];let t=0;return n.forEach(((n,r)=>{t+=Number(n.span),t>24?(e.push([r]),t-=24):e[e.length-1].push(r)})),e})),a=(0,o.Fl)((()=>{const t=Number(e.gutter),n=[];return t?(i.value.forEach((e=>{const r=t*(e.length-1)/e.length;e.forEach(((e,o)=>{if(0===o)n.push({right:r});else{const o=t-n[e-1].right,i=r-o;n.push({left:o,right:i})}}))})),n):n}));return r({spaces:a}),()=>{const{tag:n,wrap:r,align:i,justify:a}=e;return(0,o.Wm)(n,{class:Kr({[`align-${i}`]:i,[`justify-${a}`]:a,nowrap:!r})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}});const[Zr,Qr]=(0,a["do"])("col"),eo={tag:(0,s.SQ)("div"),span:(0,s.SI)(0),offset:s.Or};var to=(0,o.aZ)({name:Zr,props:eo,setup(e,{slots:t}){const{parent:n,index:r}=(0,u.NB)(Xr),i=(0,o.Fl)((()=>{if(!n)return;const{spaces:e}=n;if(e&&e.value&&e.value[r.value]){const{left:t,right:n}=e.value[r.value];return{paddingLeft:t?`${t}px`:null,paddingRight:n?`${n}px`:null}}}));return()=>{const{tag:n,span:r,offset:a}=e;return(0,o.Wm)(n,{style:i.value,class:Qr({[r]:r,[`offset-${a}`]:a})},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}}});const no=(0,r.n)(to);const[ro,oo]=(0,a["do"])("collapse"),io=Symbol(ro),ao={border:s.J5,accordion:Boolean,modelValue:{type:[String,Number,Array],default:""}};var so=(0,o.aZ)({name:ro,props:ao,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const{linkChildren:r}=(0,u.$E)(io),i=e=>{t("change",e),t("update:modelValue",e)},a=(t,n)=>{const{accordion:r,modelValue:o}=e;i(r?t===o?"":t:n?o.concat(t):o.filter((e=>e!==t)))},s=t=>{const{accordion:n,modelValue:r}=e;return n?r===t:r.includes(t)};return r({toggle:a,isExpanded:s}),()=>{var t;return(0,o.Wm)("div",{class:[oo(),{[S.r5]:e.border}]},[null==(t=n.default)?void 0:t.call(n)])}}});const uo=(0,r.n)(so);var co=n(365);const[lo,fo]=(0,a["do"])("collapse-item"),po=["icon","title","value","label","right-icon"],ho=(0,g.l7)({},Re,{name:s.Or,isLink:s.J5,disabled:Boolean,readonly:Boolean,lazyRender:s.J5});var vo=(0,o.aZ)({name:lo,props:ho,setup(e,{slots:t}){const n=(0,i.iH)(),r=(0,i.iH)(),{parent:a,index:s}=(0,u.NB)(io);if(!a)return void 0;const c=(0,o.Fl)((()=>{var t;return null!=(t=e.name)?t:s.value})),l=(0,o.Fl)((()=>a.isExpanded(c.value))),f=(0,i.iH)(l.value),d=(0,co.W)((()=>f.value||!e.lazyRender)),p=()=>{l.value?n.value&&(n.value.style.height=""):f.value=!1};(0,o.YP)(l,((e,t)=>{if(null===t)return;e&&(f.value=!0);const i=e?o.Y3:u.Wn;i((()=>{if(!r.value||!n.value)return;const{offsetHeight:t}=r.value;if(t){const r=`${t}px`;n.value.style.height=e?"0":r,(0,u.d1)((()=>{n.value&&(n.value.style.height=e?r:"0")}))}else p()}))}));const h=(e=!l.value)=>{a.toggle(c.value,e)},v=()=>{e.disabled||e.readonly||h()},m=()=>{const{border:n,disabled:r,readonly:i}=e,a=(0,g.ei)(e,Object.keys(Re));return i&&(a.isLink=!1),(r||i)&&(a.clickable=!1),(0,o.Wm)(De,(0,o.dG)({role:"button",class:fo("title",{disabled:r,expanded:l.value,borderless:!n}),"aria-expanded":String(l.value),onClick:v},a),(0,g.ei)(t,po))},b=d((()=>{var e;return(0,o.wy)((0,o.Wm)("div",{ref:n,class:fo("wrapper"),onTransitionend:p},[(0,o.Wm)("div",{ref:r,class:fo("content")},[null==(e=t.default)?void 0:e.call(t)])]),[[Y.F8,f.value]])}));return(0,y.F)({toggle:h}),()=>(0,o.Wm)("div",{class:[fo({border:s.value&&e.border})]},[m(),b()])}});const mo=(0,r.n)(vo);var go=n(2585);const yo=(0,r.n)(go.Z);const[bo,xo,wo]=(0,a["do"])("contact-card"),Co={tel:String,name:String,type:(0,s.SQ)("add"),addText:String,editable:s.J5};var So=(0,o.aZ)({name:bo,props:Co,emits:["click"],setup(e,{emit:t}){const n=n=>{e.editable&&t("click",n)},r=()=>"add"===e.type?e.addText||wo("addContact"):[(0,o.Wm)("div",null,[`${wo("name")}：${e.name}`]),(0,o.Wm)("div",null,[`${wo("tel")}：${e.tel}`])];return()=>(0,o.Wm)(De,{center:!0,icon:"edit"===e.type?"contact":"add-square",class:xo([e.type]),border:!1,isLink:e.editable,valueClass:xo("value"),onClick:n},{value:r})}});const Eo=(0,r.n)(So);const[ko,Io,_o]=(0,a["do"])("contact-edit"),Ro={tel:"",name:""},To={isEdit:Boolean,isSaving:Boolean,isDeleting:Boolean,showSetDefault:Boolean,setDefaultLabel:String,contactInfo:{type:Object,default:()=>(0,g.l7)({},Ro)},telValidator:{type:Function,default:J.tq}};var Ao=(0,o.aZ)({name:ko,props:To,emits:["save","delete","change-default"],setup(e,{emit:t}){const n=(0,i.qj)((0,g.l7)({},Ro,e.contactInfo)),r=()=>{e.isSaving||t("save",n)},a=()=>t("delete",n),s=()=>(0,o.Wm)("div",{class:Io("buttons")},[(0,o.Wm)(A,{block:!0,round:!0,type:"danger",text:_o("save"),class:Io("button"),loading:e.isSaving,nativeType:"submit"},null),e.isEdit&&(0,o.Wm)(A,{block:!0,round:!0,text:_o("delete"),class:Io("button"),loading:e.isDeleting,onClick:a},null)]),u=()=>(0,o.Wm)(at,{modelValue:n.isDefault,"onUpdate:modelValue":e=>n.isDefault=e,size:24,onChange:e=>t("change-default",e)},null),c=()=>{if(e.showSetDefault)return(0,o.Wm)(De,{title:e.setDefaultLabel,class:Io("switch-cell"),border:!1},{"right-icon":u})};return(0,o.YP)((()=>e.contactInfo),(e=>(0,g.l7)(n,Ro,e))),()=>(0,o.Wm)(Me,{class:Io(),onSubmit:r},{default:()=>[(0,o.Wm)("div",{class:Io("fields")},[(0,o.Wm)(et,{modelValue:n.name,"onUpdate:modelValue":e=>n.name=e,clearable:!0,label:_o("name"),rules:[{required:!0,message:_o("nameEmpty")}],maxlength:"30",placeholder:_o("name")},null),(0,o.Wm)(et,{modelValue:n.tel,"onUpdate:modelValue":e=>n.tel=e,clearable:!0,type:"tel",label:_o("tel"),rules:[{validator:e.telValidator,message:_o("telInvalid")}],placeholder:_o("tel")},null)]),c(),s()]})}});const Do=(0,r.n)(Ao);const[Oo,Fo,No]=(0,a["do"])("contact-list"),Po={list:Array,addText:String,modelValue:s.Vg,defaultTagText:String};var Mo=(0,o.aZ)({name:Oo,props:Po,emits:["add","edit","select","update:modelValue"],setup(e,{emit:t}){const n=(n,r)=>{const i=()=>{t("update:modelValue",n.id),t("select",n,r)},a=()=>(0,o.Wm)(Pt,{class:Fo("radio"),name:n.id,iconSize:16},null),s=()=>(0,o.Wm)(E.J,{name:"edit",class:Fo("edit"),onClick:e=>{e.stopPropagation(),t("edit",n,r)}},null),u=()=>{const t=[`${n.name}，${n.tel}`];return n.isDefault&&e.defaultTagText&&t.push((0,o.Wm)(Tt,{type:"danger",round:!0,class:Fo("item-tag")},{default:()=>[e.defaultTagText]})),t};return(0,o.Wm)(De,{key:n.id,isLink:!0,center:!0,class:Fo("item"),valueClass:Fo("item-value"),onClick:i},{icon:s,value:u,"right-icon":a})};return()=>(0,o.Wm)("div",{class:Fo()},[(0,o.Wm)(Et,{modelValue:e.modelValue,class:Fo("group")},{default:()=>[e.list&&e.list.map(n)]}),(0,o.Wm)("div",{class:[Fo("bottom"),"van-safe-area-bottom"]},[(0,o.Wm)(A,{round:!0,block:!0,type:"danger",class:Fo("add"),text:e.addText||No("addContact"),onClick:()=>t("add")},null)])])}});const Bo=(0,r.n)(Mo);function Wo(e,t){const{days:n}=t;let{hours:r,minutes:o,seconds:i,milliseconds:a}=t;if(e.includes("DD")?e=e.replace("DD",(0,Q.Bd)(n)):r+=24*n,e.includes("HH")?e=e.replace("HH",(0,Q.Bd)(r)):o+=60*r,e.includes("mm")?e=e.replace("mm",(0,Q.Bd)(o)):i+=60*o,e.includes("ss")?e=e.replace("ss",(0,Q.Bd)(i)):a+=1e3*i,e.includes("S")){const t=(0,Q.Bd)(a,3);e=e.includes("SSS")?e.replace("SSS",t):e.includes("SS")?e.replace("SS",t.slice(0,2)):e.replace("S",t.charAt(0))}return e}const[Lo,Vo]=(0,a["do"])("count-down"),zo={time:(0,s.SI)(0),format:(0,s.SQ)("HH:mm:ss"),autoStart:s.J5,millisecond:Boolean};var Uo=(0,o.aZ)({name:Lo,props:zo,emits:["change","finish"],setup(e,{emit:t,slots:n}){const{start:r,pause:i,reset:a,current:s}=(0,u.hk)({time:+e.time,millisecond:e.millisecond,onChange:e=>t("change",e),onFinish:()=>t("finish")}),c=(0,o.Fl)((()=>Wo(e.format,s.value))),l=()=>{a(+e.time),e.autoStart&&r()};return(0,o.YP)((()=>e.time),l,{immediate:!0}),(0,y.F)({start:r,pause:i,reset:l}),()=>(0,o.Wm)("div",{role:"timer",class:Vo()},[n.default?n.default(s.value):c.value])}});const Ho=(0,r.n)(Uo);function jo(e){const t=new Date(1e3*e);return`${t.getFullYear()}.${(0,Q.Bd)(t.getMonth()+1)}.${(0,Q.Bd)(t.getDate())}`}const Go=e=>(e/10).toFixed(e%10===0?0:1),qo=e=>(e/100).toFixed(e%100===0?0:e%10===0?1:2),[$o,Ko,Xo]=(0,a["do"])("coupon");var Yo=(0,o.aZ)({name:$o,props:{chosen:Boolean,coupon:(0,s.ir)(Object),disabled:Boolean,currency:(0,s.SQ)("¥")},setup(e){const t=(0,o.Fl)((()=>{const{startAt:t,endAt:n}=e.coupon;return`${jo(t)} - ${jo(n)}`})),n=(0,o.Fl)((()=>{const{coupon:t,currency:n}=e;if(t.valueDesc)return[t.valueDesc,(0,o.Wm)("span",null,[t.unitDesc||""])];if(t.denominations){const e=qo(t.denominations);return[(0,o.Wm)("span",null,[n]),` ${e}`]}return t.discount?Xo("discount",Go(t.discount)):""})),r=(0,o.Fl)((()=>{const t=qo(e.coupon.originCondition||0);return"0"===t?Xo("unlimited"):Xo("condition",t)}));return()=>{const{chosen:i,coupon:a,disabled:s}=e,u=s&&a.reason||a.description;return(0,o.Wm)("div",{class:Ko({disabled:s})},[(0,o.Wm)("div",{class:Ko("content")},[(0,o.Wm)("div",{class:Ko("head")},[(0,o.Wm)("h2",{class:Ko("amount")},[n.value]),(0,o.Wm)("p",{class:Ko("condition")},[a.condition||r.value])]),(0,o.Wm)("div",{class:Ko("body")},[(0,o.Wm)("p",{class:Ko("name")},[a.name]),(0,o.Wm)("p",{class:Ko("valid")},[t.value]),!s&&(0,o.Wm)(Br,{class:Ko("corner"),modelValue:i},null)])]),u&&(0,o.Wm)("p",{class:Ko("description")},[u])])}}});const Jo=(0,r.n)(Yo);const[Zo,Qo,ei]=(0,a["do"])("coupon-cell"),ti={title:String,border:s.J5,editable:s.J5,coupons:(0,s.Ce)(),currency:(0,s.SQ)("¥"),chosenCoupon:(0,s.SI)(-1)};function ni({coupons:e,chosenCoupon:t,currency:n}){const r=e[+t];if(r){let e=0;return(0,J.Xq)(r.value)?({value:e}=r):(0,J.Xq)(r.denominations)&&(e=r.denominations),`-${n} ${(e/100).toFixed(2)}`}return 0===e.length?ei("noCoupon"):ei("count",e.length)}var ri=(0,o.aZ)({name:Zo,props:ti,setup(e){return()=>{const t=e.coupons[+e.chosenCoupon];return(0,o.Wm)(De,{class:Qo(),value:ni(e),title:e.title||ei("title"),border:e.border,isLink:e.editable,valueClass:Qo("value",{selected:t})},null)}}});const oi=(0,r.n)(ri);const ii=e=>`van-empty-${e}`,ai=e=>`url(#${ii(e)})`,si=(e,t,n)=>(0,o.Wm)("stop",{"stop-color":e,offset:`${t}%`,"stop-opacity":n},null),ui=(e,t)=>[si(e,0),si(t,100)],ci=e=>[(0,o.Wm)("defs",null,[(0,o.Wm)("radialGradient",{id:ii(e),cx:"50%",cy:"54%",fx:"50%",fy:"54%",r:"297%",gradientTransform:"matrix(-.16 0 0 -.33 .58 .72)"},[si("#EBEDF0",0),si("#F2F3F5",100,.3)])]),(0,o.Wm)("ellipse",{fill:ai(e),opacity:".8",cx:"80",cy:"140",rx:"46",ry:"8"},null)],li=()=>[(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{id:ii("a"),x1:"64%",y1:"100%",x2:"64%"},[si("#FFF",0,.5),si("#F2F3F5",100)])]),(0,o.Wm)("g",{opacity:".8"},[(0,o.Wm)("path",{d:"M36 131V53H16v20H2v58h34z",fill:ai("a")},null),(0,o.Wm)("path",{d:"M123 15h22v14h9v77h-31V15z",fill:ai("a")},null)])],fi=()=>[(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{id:ii("b"),x1:"64%",y1:"97%",x2:"64%",y2:"0%"},[si("#F2F3F5",0,.3),si("#F2F3F5",100)])]),(0,o.Wm)("g",{opacity:".8"},[(0,o.Wm)("path",{d:"M87 6c3 0 7 3 8 6a8 8 0 1 1-1 16H80a7 7 0 0 1-8-6c0-4 3-7 6-7 0-5 4-9 9-9Z",fill:ai("b")},null),(0,o.Wm)("path",{d:"M19 23c2 0 3 1 4 3 2 0 4 2 4 4a4 4 0 0 1-4 3v1h-7v-1l-1 1c-2 0-3-2-3-4 0-1 1-3 3-3 0-2 2-4 4-4Z",fill:ai("b")},null)])],di=()=>(0,o.Wm)("svg",{viewBox:"0 0 160 160"},[(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{id:ii(1),x1:"64%",y1:"100%",x2:"64%"},[si("#FFF",0,.5),si("#F2F3F5",100)]),(0,o.Wm)("linearGradient",{id:ii(2),x1:"50%",x2:"50%",y2:"84%"},[si("#EBEDF0",0),si("#DCDEE0",100,0)]),(0,o.Wm)("linearGradient",{id:ii(3),x1:"100%",x2:"100%",y2:"100%"},[ui("#EAEDF0","#DCDEE0")]),(0,o.Wm)("radialGradient",{id:ii(4),cx:"50%",cy:"0%",fx:"50%",fy:"0%",r:"100%",gradientTransform:"matrix(0 1 -.54 0 .5 -.5)"},[si("#EBEDF0",0),si("#FFF",100,0)])]),(0,o.Wm)("g",{fill:"none"},[li(),(0,o.Wm)("path",{fill:ai(4),d:"M0 139h160v21H0z"},null),(0,o.Wm)("path",{d:"M80 54a7 7 0 0 1 3 13v27l-2 2h-2a2 2 0 0 1-2-2V67a7 7 0 0 1 3-13z",fill:ai(2)},null),(0,o.Wm)("g",{opacity:".6","stroke-linecap":"round","stroke-width":"7"},[(0,o.Wm)("path",{d:"M64 47a19 19 0 0 0-5 13c0 5 2 10 5 13",stroke:ai(3)},null),(0,o.Wm)("path",{d:"M53 36a34 34 0 0 0 0 48",stroke:ai(3)},null),(0,o.Wm)("path",{d:"M95 73a19 19 0 0 0 6-13c0-5-2-9-6-13",stroke:ai(3)},null),(0,o.Wm)("path",{d:"M106 84a34 34 0 0 0 0-48",stroke:ai(3)},null)]),(0,o.Wm)("g",{transform:"translate(31 105)"},[(0,o.Wm)("rect",{fill:"#EBEDF0",width:"98",height:"34",rx:"2"},null),(0,o.Wm)("rect",{fill:"#FFF",x:"9",y:"8",width:"80",height:"18",rx:"1.1"},null),(0,o.Wm)("rect",{fill:"#EBEDF0",x:"15",y:"12",width:"18",height:"6",rx:"1.1"},null)])])]),pi=()=>(0,o.Wm)("svg",{viewBox:"0 0 160 160"},[(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:ii(5)},[ui("#F2F3F5","#DCDEE0")]),(0,o.Wm)("linearGradient",{x1:"95%",y1:"48%",x2:"5.5%",y2:"51%",id:ii(6)},[ui("#EAEDF1","#DCDEE0")]),(0,o.Wm)("linearGradient",{y1:"45%",x2:"100%",y2:"54%",id:ii(7)},[ui("#EAEDF1","#DCDEE0")])]),li(),fi(),(0,o.Wm)("g",{transform:"translate(36 50)",fill:"none"},[(0,o.Wm)("g",{transform:"translate(8)"},[(0,o.Wm)("rect",{fill:"#EBEDF0",opacity:".6",x:"38",y:"13",width:"36",height:"53",rx:"2"},null),(0,o.Wm)("rect",{fill:ai(5),width:"64",height:"66",rx:"2"},null),(0,o.Wm)("rect",{fill:"#FFF",x:"6",y:"6",width:"52",height:"55",rx:"1"},null),(0,o.Wm)("g",{transform:"translate(15 17)",fill:ai(6)},[(0,o.Wm)("rect",{width:"34",height:"6",rx:"1"},null),(0,o.Wm)("path",{d:"M0 14h34v6H0z"},null),(0,o.Wm)("rect",{y:"28",width:"34",height:"6",rx:"1"},null)])]),(0,o.Wm)("rect",{fill:ai(7),y:"61",width:"88",height:"28",rx:"1"},null),(0,o.Wm)("rect",{fill:"#F7F8FA",x:"29",y:"72",width:"30",height:"6",rx:"1"},null)])]),hi=()=>(0,o.Wm)("svg",{viewBox:"0 0 160 160"},[(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:ii(8)},[ui("#EAEDF1","#DCDEE0")])]),li(),fi(),ci("c"),(0,o.Wm)("path",{d:"m59 60 21 21 21-21h3l9 9v3L92 93l21 21v3l-9 9h-3l-21-21-21 21h-3l-9-9v-3l21-21-21-21v-3l9-9h3Z",fill:ai(8)},null)]),vi=()=>(0,o.Wm)("svg",{viewBox:"0 0 160 160"},[(0,o.Wm)("defs",null,[(0,o.Wm)("linearGradient",{x1:"50%",y1:"100%",x2:"50%",id:ii(9)},[ui("#EEE","#D8D8D8")]),(0,o.Wm)("linearGradient",{x1:"100%",y1:"50%",y2:"50%",id:ii(10)},[ui("#F2F3F5","#DCDEE0")]),(0,o.Wm)("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:ii(11)},[ui("#F2F3F5","#DCDEE0")]),(0,o.Wm)("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:ii(12)},[ui("#FFF","#F7F8FA")])]),li(),fi(),ci("d"),(0,o.Wm)("g",{transform:"rotate(-45 113 -4)",fill:"none"},[(0,o.Wm)("rect",{fill:ai(9),x:"24",y:"52.8",width:"5.8",height:"19",rx:"1"},null),(0,o.Wm)("rect",{fill:ai(10),x:"22.1",y:"67.3",width:"9.9",height:"28",rx:"1"},null),(0,o.Wm)("circle",{stroke:ai(11),"stroke-width":"8",cx:"27",cy:"27",r:"27"},null),(0,o.Wm)("circle",{fill:ai(12),cx:"27",cy:"27",r:"16"},null),(0,o.Wm)("path",{d:"M37 7c-8 0-15 5-16 12",stroke:ai(11),"stroke-width":"3",opacity:".5","stroke-linecap":"round",transform:"rotate(45 29 13)"},null)])]),[mi,gi]=(0,a["do"])("empty"),yi={error:hi,search:vi,network:di,default:pi},bi={image:(0,s.SQ)("default"),imageSize:[Number,String,Array],description:String};var xi=(0,o.aZ)({name:mi,props:bi,setup(e,{slots:t}){const n=()=>{var n;return t.image?t.image():(null==(n=yi[e.image])?void 0:n.call(yi))||(0,o.Wm)("img",{src:e.image},null)},r=()=>{const n=t.description?t.description():e.description;if(n)return(0,o.Wm)("p",{class:gi("description")},[n])},i=()=>{if(t.default)return(0,o.Wm)("div",{class:gi("bottom")},[t.default()])};return()=>(0,o.Wm)("div",{class:gi()},[(0,o.Wm)("div",{class:gi("image"),style:(0,Q.Xn)(e.imageSize)},[n()]),r(),i()])}});const wi=(0,r.n)(xi);const[Ci,Si,Ei]=(0,a["do"])("coupon-list"),ki={code:(0,s.SQ)(""),coupons:(0,s.Ce)(),currency:(0,s.SQ)("¥"),showCount:s.J5,emptyImage:String,chosenCoupon:(0,s.qM)(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:(0,s.Ce)(),showExchangeBar:s.J5,showCloseButton:s.J5,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:(0,s.qM)(1),exchangeButtonText:String,displayedCouponIndex:(0,s.qM)(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean};var Ii=(0,o.aZ)({name:Ci,props:ki,emits:["change","exchange","update:code"],setup(e,{emit:t,slots:n}){const[r,a]=on(),s=(0,i.iH)(),c=(0,i.iH)(),l=(0,i.iH)(0),f=(0,i.iH)(0),d=(0,i.iH)(e.code),p=(0,o.Fl)((()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!d.value||d.value.length<e.exchangeMinLength))),h=()=>{const e=44,t=(0,u.EL)(s).height,n=(0,u.EL)(c).height+e;f.value=(t>n?t:C.uK.value)-n},v=()=>{t("exchange",d.value),e.code||(d.value="")},m=e=>{(0,o.Y3)((()=>{var t;return null==(t=r.value[e])?void 0:t.scrollIntoView()}))},g=()=>(0,o.Wm)(wi,{image:e.emptyImage},{default:()=>[(0,o.Wm)("p",{class:Si("empty-tip")},[Ei("noCoupon")])]}),y=()=>{if(e.showExchangeBar)return(0,o.Wm)("div",{ref:c,class:Si("exchange-bar")},[(0,o.Wm)(et,{modelValue:d.value,"onUpdate:modelValue":e=>d.value=e,clearable:!0,border:!1,class:Si("field"),placeholder:e.inputPlaceholder||Ei("placeholder"),maxlength:"20"},null),(0,o.Wm)(A,{plain:!0,type:"danger",class:Si("exchange"),text:e.exchangeButtonText||Ei("exchange"),loading:e.exchangeButtonLoading,disabled:p.value,onClick:v},null)])},b=()=>{const{coupons:r}=e,i=e.showCount?` (${r.length})`:"",s=(e.enabledTitle||Ei("enable"))+i;return(0,o.Wm)(vr,{title:s},{default:()=>{var i;return[(0,o.Wm)("div",{class:Si("list",{"with-bottom":e.showCloseButton}),style:{height:`${f.value}px`}},[r.map(((n,r)=>(0,o.Wm)(Jo,{key:n.id,ref:a(r),coupon:n,chosen:r===e.chosenCoupon,currency:e.currency,onClick:()=>t("change",r)},null))),!r.length&&g(),null==(i=n["list-footer"])?void 0:i.call(n)])]}})},x=()=>{const{disabledCoupons:t}=e,r=e.showCount?` (${t.length})`:"",i=(e.disabledTitle||Ei("disabled"))+r;return(0,o.Wm)(vr,{title:i},{default:()=>{var r;return[(0,o.Wm)("div",{class:Si("list",{"with-bottom":e.showCloseButton}),style:{height:`${f.value}px`}},[t.map((t=>(0,o.Wm)(Jo,{disabled:!0,key:t.id,coupon:t,currency:e.currency},null))),!t.length&&g(),null==(r=n["disabled-list-footer"])?void 0:r.call(n)])]}})};return(0,o.YP)((()=>e.code),(e=>{d.value=e})),(0,o.YP)(C.uK,h),(0,o.YP)(d,(e=>t("update:code",e))),(0,o.YP)((()=>e.displayedCouponIndex),m),(0,o.bv)((()=>{h(),m(e.displayedCouponIndex)})),()=>(0,o.Wm)("div",{ref:s,class:Si()},[y(),(0,o.Wm)(mr,{active:l.value,"onUpdate:active":e=>l.value=e,class:Si("tab")},{default:()=>[b(),x()]}),(0,o.Wm)("div",{class:Si("bottom")},[(0,o.wy)((0,o.Wm)(A,{round:!0,block:!0,type:"danger",class:Si("close"),text:e.closeButtonText||Ei("close"),onClick:()=>t("change",-1)},null),[[Y.F8,e.showCloseButton]])])])}});const _i=(0,r.n)(Ii);const[Ri]=(0,a["do"])("time-picker");var Ti=(0,o.aZ)({name:Ri,props:(0,g.l7)({},an,{minHour:(0,s.SI)(0),maxHour:(0,s.SI)(23),minMinute:(0,s.SI)(0),maxMinute:(0,s.SI)(59),modelValue:String}),emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:t,slots:n}){const r=t=>{const{minHour:n,maxHour:r,maxMinute:o,minMinute:i}=e;t||(t=`${(0,Q.Bd)(n)}:${(0,Q.Bd)(i)}`);let[a,s]=t.split(":");return a=(0,Q.Bd)((0,Q.uZ)(+a,+n,+r)),s=(0,Q.Bd)((0,Q.uZ)(+s,+i,+o)),`${a}:${s}`},a=(0,i.iH)(),s=(0,i.iH)(r(e.modelValue)),u=(0,o.Fl)((()=>[{type:"hour",range:[+e.minHour,+e.maxHour]},{type:"minute",range:[+e.minMinute,+e.maxMinute]}])),c=(0,o.Fl)((()=>u.value.map((({type:t,range:n})=>{let r=un(n[1]-n[0]+1,(e=>(0,Q.Bd)(n[0]+e)));return e.filter&&(r=e.filter(t,r)),{type:t,values:r}})))),l=(0,o.Fl)((()=>c.value.map((t=>({values:t.values.map((n=>e.formatter(t.type,n)))}))))),f=()=>{const t=s.value.split(":"),n=[e.formatter("hour",t[0]),e.formatter("minute",t[1])];(0,o.Y3)((()=>{var e;null==(e=a.value)||e.setValues(n)}))},d=()=>{const[e,t]=a.value.getIndexes(),[n,o]=c.value,i=n.values[e]||n.values[0],u=o.values[t]||o.values[0];s.value=r(`${i}:${u}`),f()},p=()=>t("confirm",s.value),h=()=>t("cancel"),v=()=>{d(),(0,o.Y3)((()=>{(0,o.Y3)((()=>t("change",s.value)))}))};return(0,o.bv)((()=>{f(),(0,o.Y3)(d)})),(0,o.YP)(l,f),(0,o.YP)((()=>[e.filter,e.maxHour,e.minMinute,e.maxMinute]),d),(0,o.YP)((()=>e.minHour),(()=>{(0,o.Y3)(d)})),(0,o.YP)(s,(e=>t("update:modelValue",e))),(0,o.YP)((()=>e.modelValue),(e=>{e=r(e),e!==s.value&&(s.value=e,f())})),(0,y.F)({getPicker:()=>a.value&&fn(a.value,d)}),()=>(0,o.Wm)(me,(0,o.dG)({ref:a,columns:l.value,onChange:v,onCancel:h,onConfirm:p},(0,g.ei)(e,sn)),n)}});const Ai=(new Date).getFullYear(),[Di]=(0,a["do"])("date-picker");var Oi=(0,o.aZ)({name:Di,props:(0,g.l7)({},an,{type:(0,s.SQ)("datetime"),modelValue:Date,minDate:{type:Date,default:()=>new Date(Ai-10,0,1),validator:J.J_},maxDate:{type:Date,default:()=>new Date(Ai+10,11,31),validator:J.J_}}),emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:t,slots:n}){const r=t=>{if((0,J.J_)(t)){const n=(0,Q.uZ)(t.getTime(),e.minDate.getTime(),e.maxDate.getTime());return new Date(n)}},a=(0,i.iH)(),s=(0,i.iH)(r(e.modelValue)),u=(t,n)=>{const r=e[`${t}Date`],o=r.getFullYear();let i=1,a=1,s=0,u=0;return"max"===t&&(i=12,a=ln(n.getFullYear(),n.getMonth()+1),s=23,u=59),n.getFullYear()===o&&(i=r.getMonth()+1,n.getMonth()+1===i&&(a=r.getDate(),n.getDate()===a&&(s=r.getHours(),n.getHours()===s&&(u=r.getMinutes())))),{[`${t}Year`]:o,[`${t}Month`]:i,[`${t}Date`]:a,[`${t}Hour`]:s,[`${t}Minute`]:u}},c=(0,o.Fl)((()=>{const{maxYear:t,maxDate:n,maxMonth:r,maxHour:o,maxMinute:i}=u("max",s.value||e.minDate),{minYear:a,minDate:c,minMonth:l,minHour:f,minMinute:d}=u("min",s.value||e.minDate);let p=[{type:"year",range:[a,t]},{type:"month",range:[l,r]},{type:"day",range:[c,n]},{type:"hour",range:[f,o]},{type:"minute",range:[d,i]}];switch(e.type){case"date":p=p.slice(0,3);break;case"year-month":p=p.slice(0,2);break;case"month-day":p=p.slice(1,3);break;case"datehour":p=p.slice(0,4);break}if(e.columnsOrder){const t=e.columnsOrder.concat(p.map((e=>e.type)));p.sort(((e,n)=>t.indexOf(e.type)-t.indexOf(n.type)))}return p})),l=(0,o.Fl)((()=>c.value.map((({type:t,range:n})=>{let r=un(n[1]-n[0]+1,(e=>(0,Q.Bd)(n[0]+e)));return e.filter&&(r=e.filter(t,r)),{type:t,values:r}})))),f=(0,o.Fl)((()=>l.value.map((t=>({values:t.values.map((n=>e.formatter(t.type,n)))}))))),d=()=>{const t=s.value||e.minDate,{formatter:n}=e,r=l.value.map((e=>{switch(e.type){case"year":return n("year",`${t.getFullYear()}`);case"month":return n("month",(0,Q.Bd)(t.getMonth()+1));case"day":return n("day",(0,Q.Bd)(t.getDate()));case"hour":return n("hour",(0,Q.Bd)(t.getHours()));case"minute":return n("minute",(0,Q.Bd)(t.getMinutes()));default:return""}}));(0,o.Y3)((()=>{var e;null==(e=a.value)||e.setValues(r)}))},p=()=>{const{type:t}=e,n=a.value.getIndexes(),o=e=>{let t=0;l.value.forEach(((n,r)=>{e===n.type&&(t=r)}));const{values:r}=l.value[t];return cn(r[n[t]])};let i,u,c;"month-day"===t?(i=(s.value||e.minDate).getFullYear(),u=o("month"),c=o("day")):(i=o("year"),u=o("month"),c="year-month"===t?1:o("day"));const f=ln(i,u);c=c>f?f:c;let d=0,p=0;"datehour"===t&&(d=o("hour")),"datetime"===t&&(d=o("hour"),p=o("minute"));const h=new Date(i,u-1,c,d,p);s.value=r(h)},h=()=>{t("update:modelValue",s.value),t("confirm",s.value)},v=()=>t("cancel"),m=()=>{p(),(0,o.Y3)((()=>{p(),(0,o.Y3)((()=>t("change",s.value)))}))};return(0,o.bv)((()=>{d(),(0,o.Y3)(p)})),(0,o.YP)(f,d),(0,o.YP)(s,((e,n)=>t("update:modelValue",n?e:null))),(0,o.YP)((()=>[e.filter,e.minDate,e.maxDate]),(()=>{(0,o.Y3)(p)})),(0,o.YP)((()=>e.modelValue),(e=>{var t;e=r(e),e&&e.valueOf()!==(null==(t=s.value)?void 0:t.valueOf())&&(s.value=e)})),(0,y.F)({getPicker:()=>a.value&&fn(a.value,p)}),()=>(0,o.Wm)(me,(0,o.dG)({ref:a,columns:f.value,onChange:m,onCancel:v,onConfirm:h},(0,g.ei)(e,sn)),n)}});const[Fi,Ni]=(0,a["do"])("datetime-picker"),Pi=Object.keys(Ti.props),Mi=Object.keys(Oi.props),Bi=(0,g.l7)({},Ti.props,Oi.props,{modelValue:[String,Date]});var Wi=(0,o.aZ)({name:Fi,props:Bi,setup(e,{attrs:t,slots:n}){const r=(0,i.iH)();return(0,y.F)({getPicker:()=>{var e;return null==(e=r.value)?void 0:e.getPicker()}}),()=>{const i="time"===e.type,a=i?Ti:Oi,s=(0,g.ei)(e,i?Pi:Mi);return(0,o.Wm)(a,(0,o.dG)({ref:r,class:Ni()},s,t),n)}}});const Li=(0,r.n)(Wi);var Vi=n(7548);const[zi,Ui,Hi]=(0,a["do"])("dialog"),ji=(0,g.l7)({},H.W,{title:String,theme:String,width:s.Or,message:[String,Function],callback:Function,allowHtml:Boolean,className:s.Vg,transition:(0,s.SQ)("van-dialog-bounce"),messageAlign:String,closeOnPopstate:s.J5,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:s.J5,closeOnClickOverlay:Boolean}),Gi=[...H.m,"transition","closeOnPopstate"];var qi=(0,o.aZ)({name:zi,props:ji,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,i.qj)({confirm:!1,cancel:!1}),s=e=>t("update:show",e),u=t=>{var n;s(!1),null==(n=e.callback)||n.call(e,t)},c=n=>()=>{e.show&&(t(n),e.beforeClose?(a[n]=!0,(0,On.I)(e.beforeClose,{args:[n],done(){u(n),a[n]=!1},canceled(){a[n]=!1}})):u(n))},l=c("cancel"),f=c("confirm"),d=(0,Y.D2)((n=>{var o,i;if(n.target!==(null==(i=null==(o=r.value)?void 0:o.popupRef)?void 0:i.value))return;const a={Enter:e.showConfirmButton?f:g.ZT,Escape:e.showCancelButton?l:g.ZT};a[n.key](),t("keydown",n)}),["enter","esc"]),p=()=>{const t=n.title?n.title():e.title;if(t)return(0,o.Wm)("div",{class:Ui("header",{isolated:!e.message&&!n.default})},[t])},h=t=>{const{message:n,allowHtml:r,messageAlign:i}=e,a=Ui("message",{"has-title":t,[i]:i}),s=(0,J.mf)(n)?n():n;return r&&"string"===typeof s?(0,o.Wm)("div",{class:a,innerHTML:s},null):(0,o.Wm)("div",{class:a},[s])},v=()=>{if(n.default)return(0,o.Wm)("div",{class:Ui("content")},[n.default()]);const{title:t,message:r,allowHtml:i}=e;if(r){const e=!(!t&&!n.title);return(0,o.Wm)("div",{key:i?1:0,class:Ui("content",{isolated:!e})},[h(e)])}},y=()=>(0,o.Wm)("div",{class:[S.k7,Ui("footer")]},[e.showCancelButton&&(0,o.Wm)(A,{size:"large",text:e.cancelButtonText||Hi("cancel"),class:Ui("cancel"),style:{color:e.cancelButtonColor},loading:a.cancel,disabled:e.cancelButtonDisabled,onClick:l},null),e.showConfirmButton&&(0,o.Wm)(A,{size:"large",text:e.confirmButtonText||Hi("confirm"),class:[Ui("confirm"),{[S.a8]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:a.confirm,disabled:e.confirmButtonDisabled,onClick:f},null)]),b=()=>(0,o.Wm)(m,{class:Ui("footer")},{default:()=>[e.showCancelButton&&(0,o.Wm)(P,{type:"warning",text:e.cancelButtonText||Hi("cancel"),class:Ui("cancel"),color:e.cancelButtonColor,loading:a.cancel,disabled:e.cancelButtonDisabled,onClick:l},null),e.showConfirmButton&&(0,o.Wm)(P,{type:"danger",text:e.confirmButtonText||Hi("confirm"),class:Ui("confirm"),color:e.confirmButtonColor,loading:a.confirm,disabled:e.confirmButtonDisabled,onClick:f},null)]}),x=()=>n.footer?n.footer():"round-button"===e.theme?b():y();return()=>{const{width:t,title:n,theme:i,message:a,className:u}=e;return(0,o.Wm)(U.G,(0,o.dG)({ref:r,role:"dialog",class:[Ui([i]),u],style:{width:(0,Q.Nn)(t)},tabindex:0,"aria-labelledby":n||a,onKeydown:d,"onUpdate:show":s},(0,g.ei)(e,Gi)),{default:()=>[p(),v(),x()]})}}});let $i;function Ki(){const e={setup(){const{state:e,toggle:t}=(0,Vi.o)();return()=>(0,o.Wm)(qi,(0,o.dG)(e,{"onUpdate:show":t}),null)}};({instance:$i}=(0,Vi.H)(e))}function Xi(e){return g._f?new Promise(((t,n)=>{$i||Ki(),$i.open((0,g.l7)({},Xi.currentOptions,e,{callback:e=>{("confirm"===e?t:n)(e)}}))})):Promise.resolve()}Xi.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},Xi.currentOptions=(0,g.l7)({},Xi.defaultOptions),Xi.alert=Xi,Xi.confirm=e=>Xi((0,g.l7)({showCancelButton:!0},e)),Xi.close=()=>{$i&&$i.toggle(!1)},Xi.setDefaultOptions=e=>{(0,g.l7)(Xi.currentOptions,e)},Xi.resetDefaultOptions=()=>{Xi.currentOptions=(0,g.l7)({},Xi.defaultOptions)},Xi.Component=(0,r.n)(qi),Xi.install=e=>{e.use(Xi.Component),e.config.globalProperties.$dialog=Xi};const[Yi,Ji]=(0,a["do"])("divider"),Zi={dashed:Boolean,hairline:s.J5,contentPosition:(0,s.SQ)("center")};var Qi=(0,o.aZ)({name:Yi,props:Zi,setup(e,{slots:t}){return()=>{var n;return(0,o.Wm)("div",{role:"separator",class:Ji({dashed:e.dashed,hairline:e.hairline,[`content-${e.contentPosition}`]:!!t.default})},[null==(n=t.default)?void 0:n.call(t)])}}});const ea=(0,r.n)(Qi);const[ta,na]=(0,a["do"])("dropdown-menu"),ra={overlay:s.J5,zIndex:s.Or,duration:(0,s.SI)(.2),direction:(0,s.SQ)("down"),activeColor:String,closeOnClickOutside:s.J5,closeOnClickOverlay:s.J5},oa=Symbol(ta);var ia=(0,o.aZ)({name:ta,props:ra,setup(e,{slots:t}){const n=Ke(),r=(0,i.iH)(),a=(0,i.iH)(),s=(0,i.iH)(0),{children:c,linkChildren:l}=(0,u.$E)(oa),f=(0,u.eo)(r),d=(0,o.Fl)((()=>c.some((e=>e.state.showWrapper)))),p=(0,o.Fl)((()=>{if(d.value&&(0,J.Xq)(e.zIndex))return{zIndex:+e.zIndex+1}})),h=()=>{e.closeOnClickOutside&&c.forEach((e=>{e.toggle(!1)}))},v=()=>{if(a.value){const t=(0,u.EL)(a);"down"===e.direction?s.value=t.bottom:s.value=C.uK.value-t.top}},m=()=>{d.value&&v()},g=e=>{c.forEach(((t,n)=>{n===e?(v(),t.toggle()):t.state.showPopup&&t.toggle(!1,{immediate:!0})}))},y=(t,r)=>{const{showPopup:i}=t.state,{disabled:a,titleClass:s}=t;return(0,o.Wm)("div",{id:`${n}-${r}`,role:"button",tabindex:a?void 0:0,class:[na("item",{disabled:a}),{[S.e9]:!a}],onClick:()=>{a||g(r)}},[(0,o.Wm)("span",{class:[na("title",{down:i===("down"===e.direction),active:i}),s],style:{color:i?e.activeColor:""}},[(0,o.Wm)("div",{class:"van-ellipsis"},[t.renderTitle()])])])};return l({id:n,props:e,offset:s}),(0,u.Vd)(r,h),(0,u.OR)("scroll",m,{target:f}),()=>{var e;return(0,o.Wm)("div",{ref:r,class:na()},[(0,o.Wm)("div",{ref:a,style:p.value,class:na("bar",{opened:d.value})},[c.map(y)]),null==(e=t.default)?void 0:e.call(t)])}}});const[aa,sa]=(0,a["do"])("dropdown-item"),ua={title:String,options:(0,s.Ce)(),disabled:Boolean,teleport:[String,Object],lazyRender:s.J5,modelValue:s.Vg,titleClass:s.Vg};var ca=(0,o.aZ)({name:aa,props:ua,emits:["open","opened","close","closed","change","update:modelValue"],setup(e,{emit:t,slots:n}){const r=(0,i.qj)({showPopup:!1,transition:!0,showWrapper:!1}),{parent:a,index:s}=(0,u.NB)(oa);if(!a)return void 0;const c=e=>()=>t(e),l=c("open"),f=c("close"),d=c("opened"),p=()=>{r.showWrapper=!1,t("closed")},h=t=>{e.teleport&&t.stopPropagation()},v=(e=!r.showPopup,t={})=>{e!==r.showPopup&&(r.showPopup=e,r.transition=!t.immediate,e&&(r.showWrapper=!0))},m=()=>{if(n.title)return n.title();if(e.title)return e.title;const t=e.options.find((t=>t.value===e.modelValue));return t?t.text:""},g=n=>{const{activeColor:i}=a.props,s=n.value===e.modelValue,u=()=>{r.showPopup=!1,n.value!==e.modelValue&&(t("update:modelValue",n.value),t("change",n.value))},c=()=>{if(s)return(0,o.Wm)(E.J,{class:sa("icon"),color:i,name:"success"},null)};return(0,o.Wm)(De,{role:"menuitem",key:n.value,icon:n.icon,title:n.text,class:sa("option",{active:s}),style:{color:s?i:""},tabindex:s?0:-1,clickable:!0,onClick:u},{value:c})},b=()=>{const{offset:t}=a,{zIndex:i,overlay:u,duration:c,direction:v,closeOnClickOverlay:m}=a.props,y=(0,Q.As)(i);return"down"===v?y.top=`${t.value}px`:y.bottom=`${t.value}px`,(0,o.wy)((0,o.Wm)("div",{style:y,class:sa([v]),onClick:h},[(0,o.Wm)(U.G,{show:r.showPopup,"onUpdate:show":e=>r.showPopup=e,role:"menu",class:sa("content"),overlay:u,position:"down"===v?"top":"bottom",duration:r.transition?c:0,lazyRender:e.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${a.id}-${s.value}`,closeOnClickOverlay:m,onOpen:l,onClose:f,onOpened:d,onClosed:p},{default:()=>{var t;return[e.options.map(g),null==(t=n.default)?void 0:t.call(n)]}})]),[[Y.F8,r.showWrapper]])};return(0,y.F)({state:r,toggle:v,renderTitle:m}),()=>e.teleport?(0,o.Wm)(o.lR,{to:e.teleport},{default:()=>[b()]}):b()}});const la=(0,r.n)(ca);const fa=(0,r.n)(ia);const[da,pa]=(0,a["do"])("grid"),ha={square:Boolean,center:s.J5,border:s.J5,gutter:s.Or,reverse:Boolean,iconSize:s.Or,direction:String,clickable:Boolean,columnNum:(0,s.SI)(4)},va=Symbol(da);var ma=(0,o.aZ)({name:da,props:ha,setup(e,{slots:t}){const{linkChildren:n}=(0,u.$E)(va);return n({props:e}),()=>{var n;return(0,o.Wm)("div",{style:{paddingLeft:(0,Q.Nn)(e.gutter)},class:[pa(),{[S.k7]:e.border&&!e.gutter}]},[null==(n=t.default)?void 0:n.call(t)])}}});const ga=(0,r.n)(ma);n(5069);const[ya,ba]=(0,a["do"])("grid-item"),xa=(0,g.l7)({},b,{dot:Boolean,text:String,icon:String,badge:s.Or,iconColor:String,iconPrefix:String,badgeProps:Object});var wa=(0,o.aZ)({name:ya,props:xa,setup(e,{slots:t}){const{parent:n,index:r}=(0,u.NB)(va),i=w();if(!n)return void 0;const a=(0,o.Fl)((()=>{const{square:e,gutter:t,columnNum:o}=n.props,i=100/+o+"%",a={flexBasis:i};if(e)a.paddingTop=i;else if(t){const e=(0,Q.Nn)(t);a.paddingRight=e,r.value>=o&&(a.marginTop=e)}return a})),s=(0,o.Fl)((()=>{const{square:e,gutter:t}=n.props;if(e&&t){const e=(0,Q.Nn)(t);return{right:e,bottom:e,height:"auto"}}})),c=()=>t.icon?(0,o.Wm)(M.C,(0,o.dG)({dot:e.dot,content:e.badge},e.badgeProps),{default:t.icon}):e.icon?(0,o.Wm)(E.J,{dot:e.dot,name:e.icon,size:n.props.iconSize,badge:e.badge,class:ba("icon"),color:e.iconColor,badgeProps:e.badgeProps,classPrefix:e.iconPrefix},null):void 0,l=()=>t.text?t.text():e.text?(0,o.Wm)("span",{class:ba("text")},[e.text]):void 0,f=()=>t.default?t.default():[c(),l()];return()=>{const{center:e,border:t,square:r,gutter:u,reverse:c,direction:l,clickable:d}=n.props,p=[ba("content",[l,{center:e,square:r,reverse:c,clickable:d,surround:t&&u}]),{[S.T5]:t}];return(0,o.Wm)("div",{class:[ba({square:r})],style:a.value},[(0,o.Wm)("div",{role:d?"button":void 0,class:p,style:s.value,tabindex:d?0:void 0,onClick:i},[f()])])}}});const Ca=(0,r.n)(wa);const Sa=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Ea=(0,a["do"])("image-preview")[1];var ka=(0,o.aZ)({props:{src:String,show:Boolean,active:Number,minZoom:(0,s.ir)(s.Or),maxZoom:(0,s.ir)(s.Or),rootWidth:(0,s.ir)(Number),rootHeight:(0,s.ir)(Number)},emits:["scale","close"],setup(e,{emit:t}){const n=(0,i.qj)({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),r=(0,ee.o)(),a=(0,o.Fl)((()=>{const{rootWidth:t,rootHeight:r}=e,o=r/t;return n.imageRatio>o})),s=(0,o.Fl)((()=>{const{scale:e,moveX:t,moveY:r,moving:o,zooming:i}=n,a={transitionDuration:i||o?"0s":".3s"};if(1!==e){const n=t/e,o=r/e;a.transform=`scale(${e}, ${e}) translate(${n}px, ${o}px)`}return a})),u=(0,o.Fl)((()=>{if(n.imageRatio){const{rootWidth:t,rootHeight:r}=e,o=a.value?r/n.imageRatio:t;return Math.max(0,(n.scale*o-t)/2)}return 0})),c=(0,o.Fl)((()=>{if(n.imageRatio){const{rootWidth:t,rootHeight:r}=e,o=a.value?r:t*n.imageRatio;return Math.max(0,(n.scale*o-r)/2)}return 0})),l=r=>{r=(0,Q.uZ)(r,+e.minZoom,+e.maxZoom+1),r!==n.scale&&(n.scale=r,t("scale",{scale:r,index:e.active}))},f=()=>{l(1),n.moveX=0,n.moveY=0},d=()=>{const e=n.scale>1?1:2;l(e),n.moveX=0,n.moveY=0};let p,h,v,m,g,y,b;const x=e=>{const{touches:t}=e,{offsetX:o}=r;r.start(e),p=t.length,h=n.moveX,v=n.moveY,b=Date.now(),n.moving=1===p&&1!==n.scale,n.zooming=2===p&&!o.value,n.zooming&&(m=n.scale,g=Sa(e.touches))},w=e=>{const{touches:t}=e;if(r.move(e),(n.moving||n.zooming)&&(0,C.PF)(e,!0),n.moving){const{deltaX:e,deltaY:t}=r,o=e.value+h,i=t.value+v;n.moveX=(0,Q.uZ)(o,-u.value,u.value),n.moveY=(0,Q.uZ)(i,-c.value,c.value)}if(n.zooming&&2===t.length){const e=Sa(t),n=m*e/g;l(n)}},S=()=>{if(p>1)return;const{offsetX:e,offsetY:n}=r,o=Date.now()-b,i=250,a=5;e.value<a&&n.value<a&&o<i&&(y?(clearTimeout(y),y=null,d()):y=setTimeout((()=>{t("close"),y=null}),i))},E=t=>{let o=!1;(n.moving||n.zooming)&&(o=!0,n.moving&&h===n.moveX&&v===n.moveY&&(o=!1),t.touches.length||(n.zooming&&(n.moveX=(0,Q.uZ)(n.moveX,-u.value,u.value),n.moveY=(0,Q.uZ)(n.moveY,-c.value,c.value),n.zooming=!1),n.moving=!1,h=0,v=0,m=1,n.scale<1&&f(),n.scale>e.maxZoom&&(n.scale=+e.maxZoom))),(0,C.PF)(t,o),S(),r.reset()},I=e=>{const{naturalWidth:t,naturalHeight:r}=e.target;n.imageRatio=r/t};return(0,o.YP)((()=>e.active),f),(0,o.YP)((()=>e.show),(e=>{e||f()})),()=>{const t={loading:()=>(0,o.Wm)(k.g,{type:"spinner"},null)};return(0,o.Wm)(lr,{class:Ea("swipe-item"),onTouchstart:x,onTouchmove:w,onTouchend:E,onTouchcancel:E},{default:()=>[(0,o.Wm)(In,{src:e.src,fit:"contain",class:Ea("image",{vertical:a.value}),style:s.value,onLoad:I},t)]})}}});const[Ia,_a]=(0,a["do"])("image-preview"),Ra=["show","transition","overlayStyle","closeOnPopstate"],Ta={show:Boolean,loop:s.J5,images:(0,s.Ce)(),minZoom:(0,s.SI)(1/3),maxZoom:(0,s.SI)(3),overlay:s.J5,closeable:Boolean,showIndex:s.J5,className:s.Vg,closeIcon:(0,s.SQ)("clear"),transition:String,beforeClose:Function,overlayClass:s.Vg,overlayStyle:Object,swipeDuration:(0,s.SI)(300),startPosition:(0,s.SI)(0),showIndicators:Boolean,closeOnPopstate:s.J5,closeIconPosition:(0,s.SQ)("top-right")};var Aa=(0,o.aZ)({name:Ia,props:Ta,emits:["scale","close","closed","change","update:show"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,i.qj)({active:0,rootWidth:0,rootHeight:0}),s=()=>{if(r.value){const e=(0,u.EL)(r.value.$el);a.rootWidth=e.width,a.rootHeight=e.height,r.value.resize()}},c=e=>t("scale",e),l=e=>t("update:show",e),f=()=>{(0,On.I)(e.beforeClose,{args:[a.active],done:()=>l(!1)})},d=e=>{e!==a.active&&(a.active=e,t("change",e))},p=()=>{if(e.showIndex)return(0,o.Wm)("div",{class:_a("index")},[n.index?n.index({index:a.active}):`${a.active+1} / ${e.images.length}`])},h=()=>{if(n.cover)return(0,o.Wm)("div",{class:_a("cover")},[n.cover()])},v=()=>(0,o.Wm)(Yn,{ref:r,lazyRender:!0,loop:e.loop,class:_a("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:d},{default:()=>[e.images.map((t=>(0,o.Wm)(ka,{src:t,show:e.show,active:a.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:a.rootWidth,rootHeight:a.rootHeight,onScale:c,onClose:f},null)))]}),m=()=>{if(e.closeable)return(0,o.Wm)(E.J,{role:"button",name:e.closeIcon,class:[_a("close-icon",e.closeIconPosition),S.e9],onClick:f},null)},b=()=>t("closed"),x=(e,t)=>{var n;return null==(n=r.value)?void 0:n.swipeTo(e,t)};return(0,y.F)({swipeTo:x}),(0,o.bv)(s),(0,o.YP)([C.bn,C.uK],s),(0,o.YP)((()=>e.startPosition),(e=>d(+e))),(0,o.YP)((()=>e.show),(n=>{const{images:r,startPosition:i}=e;n?(d(+i),(0,o.Y3)((()=>{s(),x(+i,{immediate:!0})}))):t("close",{index:a.active,url:r[a.active]})})),()=>(0,o.Wm)(U.G,(0,o.dG)({class:[_a(),e.className],overlayClass:[_a("overlay"),e.overlayClass],onClosed:b,"onUpdate:show":l},(0,g.ei)(e,Ra)),{default:()=>[m(),v(),p(),h()]})}});let Da;const Oa={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function Fa(){({instance:Da}=(0,Vi.H)({setup(){const{state:e,toggle:t}=(0,Vi.o)(),n=()=>{e.images=[]};return()=>(0,o.Wm)(Aa,(0,o.dG)(e,{onClosed:n,"onUpdate:show":t}),null)}}))}const Na=(e,t=0)=>{if(g._f)return Da||Fa(),e=Array.isArray(e)?{images:e,startPosition:t}:e,Da.open((0,g.l7)({},Oa,e)),Da};function Pa(){const e="A".charCodeAt(0),t=Array(26).fill("").map(((t,n)=>String.fromCharCode(e+n)));return t}Na.Component=(0,r.n)(Aa),Na.install=e=>{e.use(Na.Component)};const[Ma,Ba]=(0,a["do"])("index-bar"),Wa={sticky:s.J5,zIndex:s.Or,teleport:[String,Object],highlightColor:String,stickyOffsetTop:(0,s.qM)(0),indexList:{type:Array,default:Pa}},La=Symbol(Ma);var Va=(0,o.aZ)({name:Ma,props:Wa,emits:["select","change"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=(0,i.iH)(""),s=(0,ee.o)(),c=(0,u.eo)(r),{children:l,linkChildren:f}=(0,u.$E)(La);let d;f({props:e});const p=(0,o.Fl)((()=>{if((0,J.Xq)(e.zIndex))return{zIndex:+e.zIndex+1}})),h=(0,o.Fl)((()=>{if(e.highlightColor)return{color:e.highlightColor}})),v=(t,n)=>{for(let r=l.length-1;r>=0;r--){const o=r>0?n[r-1].height:0,i=e.sticky?o+e.stickyOffsetTop:0;if(t+i>=n[r].top)return r}return-1},m=e=>l.find((t=>String(t.index)===e)),g=()=>{if((0,C.xj)(r))return;const{sticky:t,indexList:n}=e,o=(0,C.cx)(c.value),i=(0,u.EL)(c),s=l.map((e=>e.getRect(c.value,i)));let f=-1;if(d){const e=m(d);if(e){const t=e.getRect(c.value,i);f=v(t.top,s)}}else f=v(o,s);a.value=n[f],t&&l.forEach(((t,n)=>{const{state:r,$el:a}=t;if(n===f||n===f-1){const e=a.getBoundingClientRect();r.left=e.left,r.width=e.width}else r.left=null,r.width=null;if(n===f)r.active=!0,r.top=Math.max(e.stickyOffsetTop,s[n].top-o)+i.top;else if(n===f-1&&""===d){const e=s[f].top-o;r.active=e>0,r.top=e+i.top-s[n].height}else r.active=!1})),d=""},b=()=>{(0,o.Y3)(g)};(0,u.OR)("scroll",g,{target:c}),(0,o.bv)(b),(0,o.YP)((()=>e.indexList),b),(0,o.YP)(a,(e=>{e&&t("change",e)}));const x=()=>e.indexList.map((e=>{const t=e===a.value;return(0,o.Wm)("span",{class:Ba("index",{active:t}),style:t?h.value:void 0,"data-index":e},[e])})),w=n=>{d=String(n);const r=m(d);if(r){const n=(0,C.cx)(c.value),o=(0,u.EL)(c),{offsetHeight:i}=document.documentElement;if(n===i-o.height)return void g();r.$el.scrollIntoView(),e.sticky&&e.stickyOffsetTop&&(0,C.kn)((0,C.oD)()-e.stickyOffsetTop),t("select",r.index)}},S=e=>{const{index:t}=e.dataset;t&&w(t)},E=e=>{S(e.target)};let k;const I=e=>{if(s.move(e),s.isVertical()){(0,C.PF)(e);const{clientX:t,clientY:n}=e.touches[0],r=document.elementFromPoint(t,n);if(r){const{index:e}=r.dataset;e&&k!==e&&(k=e,S(r))}}},_=()=>(0,o.Wm)("div",{class:Ba("sidebar"),style:p.value,onClick:E,onTouchstart:s.start,onTouchmove:I},[x()]);return(0,y.F)({scrollTo:w}),()=>{var t;return(0,o.Wm)("div",{ref:r,class:Ba()},[e.teleport?(0,o.Wm)(o.lR,{to:e.teleport},{default:()=>[_()]}):_(),null==(t=n.default)?void 0:t.call(n)])}}});const[za,Ua]=(0,a["do"])("index-anchor"),Ha={index:s.Or};var ja=(0,o.aZ)({name:za,props:Ha,setup(e,{slots:t}){const n=(0,i.qj)({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),r=(0,i.iH)(),{parent:a}=(0,u.NB)(La);if(!a)return void 0;const s=()=>n.active&&a.props.sticky,c=(0,o.Fl)((()=>{const{zIndex:e,highlightColor:t}=a.props;if(s())return(0,g.l7)((0,Q.As)(e),{left:n.left?`${n.left}px`:void 0,width:n.width?`${n.width}px`:void 0,transform:n.top?`translate3d(0, ${n.top}px, 0)`:void 0,color:t})})),l=(e,t)=>{const o=(0,u.EL)(r);return n.rect.height=o.height,e===window||e===document.body?n.rect.top=o.top+(0,C.oD)():n.rect.top=o.top+(0,C.cx)(e)-t.top,n.rect};return(0,y.F)({state:n,getRect:l}),()=>{const i=s();return(0,o.Wm)("div",{ref:r,style:{height:i?`${n.rect.height}px`:void 0}},[(0,o.Wm)("div",{style:c.value,class:[Ua({sticky:i}),{[S.xe]:i}]},[t.default?t.default():e.index])])}}});const Ga=(0,r.n)(ja);const qa=(0,r.n)(Va);const[$a,Ka,Xa]=(0,a["do"])("list"),Ya={error:Boolean,offset:(0,s.SI)(300),loading:Boolean,finished:Boolean,errorText:String,direction:(0,s.SQ)("down"),loadingText:String,finishedText:String,immediateCheck:s.J5};var Ja=(0,o.aZ)({name:$a,props:Ya,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(!1),a=(0,i.iH)(),s=(0,i.iH)(),c=ar(),l=(0,u.eo)(a),f=()=>{(0,o.Y3)((()=>{if(r.value||e.finished||e.error||!1===(null==c?void 0:c.value))return;const{offset:n,direction:o}=e,i=(0,u.EL)(l);if(!i.height||(0,C.xj)(a))return;let f=!1;const d=(0,u.EL)(s);f="up"===o?i.top-d.top<=n:d.bottom-i.bottom<=n,f&&(r.value=!0,t("update:loading",!0),t("load"))}))},d=()=>{if(e.finished){const t=n.finished?n.finished():e.finishedText;if(t)return(0,o.Wm)("div",{class:Ka("finished-text")},[t])}},p=()=>{t("update:error",!1),f()},h=()=>{if(e.error){const t=n.error?n.error():e.errorText;if(t)return(0,o.Wm)("div",{role:"button",class:Ka("error-text"),tabindex:0,onClick:p},[t])}},v=()=>{if(r.value&&!e.finished)return(0,o.Wm)("div",{class:Ka("loading")},[n.loading?n.loading():(0,o.Wm)(k.g,{class:Ka("loading-icon")},{default:()=>[e.loadingText||Xa("loading")]})])};return(0,o.YP)((()=>[e.loading,e.finished,e.error]),f),c&&(0,o.YP)(c,(e=>{e&&f()})),(0,o.ic)((()=>{r.value=e.loading})),(0,o.bv)((()=>{e.immediateCheck&&f()})),(0,y.F)({check:f}),(0,u.OR)("scroll",f,{target:l}),()=>{var t;const i=null==(t=n.default)?void 0:t.call(n),u=(0,o.Wm)("div",{ref:s,class:Ka("placeholder")},null);return(0,o.Wm)("div",{ref:a,role:"feed",class:Ka(),"aria-busy":r.value},["down"===e.direction?i:u,v(),d(),h(),"up"===e.direction?i:u])}}});const Za=(0,r.n)(Ja);var Qa=n(1296);const[es,ts]=(0,a["do"])("nav-bar"),ns={title:String,fixed:Boolean,zIndex:s.Or,border:s.J5,leftText:String,rightText:String,leftArrow:Boolean,placeholder:Boolean,safeAreaInsetTop:Boolean};var rs=(0,o.aZ)({name:es,props:ns,emits:["click-left","click-right"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=l(r,ts),s=e=>t("click-left",e),u=e=>t("click-right",e),c=()=>n.left?n.left():[e.leftArrow&&(0,o.Wm)(E.J,{class:ts("arrow"),name:"arrow-left"},null),e.leftText&&(0,o.Wm)("span",{class:ts("text")},[e.leftText])],f=()=>n.right?n.right():(0,o.Wm)("span",{class:ts("text")},[e.rightText]),d=()=>{const{title:t,fixed:i,border:a,zIndex:l}=e,d=(0,Q.As)(l),p=e.leftArrow||e.leftText||n.left,h=e.rightText||n.right;return(0,o.Wm)("div",{ref:r,style:d,class:[ts({fixed:i}),{[S.xe]:a,"van-safe-area-top":e.safeAreaInsetTop}]},[(0,o.Wm)("div",{class:ts("content")},[p&&(0,o.Wm)("div",{class:[ts("left"),S.e9],onClick:s},[c()]),(0,o.Wm)("div",{class:[ts("title"),"van-ellipsis"]},[n.title?n.title():t]),h&&(0,o.Wm)("div",{class:[ts("right"),S.e9],onClick:u},[f()])])])};return()=>e.fixed&&e.placeholder?a(d):d()}});const os=(0,r.n)(rs);const[is,as]=(0,a["do"])("notice-bar"),ss={text:String,mode:String,color:String,delay:(0,s.SI)(1),speed:(0,s.SI)(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var us=(0,o.aZ)({name:is,props:ss,emits:["close","replay"],setup(e,{emit:t,slots:n}){let r,a=0,s=0;const c=(0,i.iH)(),l=(0,i.iH)(),f=(0,i.qj)({show:!0,offset:0,duration:0}),d=()=>n["left-icon"]?n["left-icon"]():e.leftIcon?(0,o.Wm)(E.J,{class:as("left-icon"),name:e.leftIcon},null):void 0,p=()=>"closeable"===e.mode?"cross":"link"===e.mode?"arrow":void 0,h=n=>{"closeable"===e.mode&&(f.show=!1,t("close",n))},v=()=>{if(n["right-icon"])return n["right-icon"]();const e=p();return e?(0,o.Wm)(E.J,{name:e,class:as("right-icon"),onClick:h},null):void 0},m=()=>{f.offset=a,f.duration=0,(0,u.Wn)((()=>{(0,u.d1)((()=>{f.offset=-s,f.duration=(s+a)/+e.speed,t("replay")}))}))},g=()=>{const t=!1===e.scrollable&&!e.wrapable,r={transform:f.offset?`translateX(${f.offset}px)`:"",transitionDuration:`${f.duration}s`};return(0,o.Wm)("div",{ref:c,role:"marquee",class:as("wrap")},[(0,o.Wm)("div",{ref:l,style:r,class:[as("content"),{"van-ellipsis":t}],onTransitionend:m},[n.default?n.default():e.text])])},b=()=>{const{delay:t,speed:n,scrollable:o}=e,i=(0,J.Xq)(t)?1e3*+t:0;a=0,s=0,f.offset=0,f.duration=0,clearTimeout(r),r=setTimeout((()=>{if(!c.value||!l.value||!1===o)return;const e=(0,u.EL)(c).width,t=(0,u.EL)(l).width;(o||t>e)&&(0,u.d1)((()=>{a=e,s=t,f.offset=-s,f.duration=s/+n}))}),i)};return(0,Pn.h)(b),(0,u.Ib)(b),(0,u.OR)("pageshow",b),(0,y.F)({reset:b}),(0,o.YP)((()=>[e.text,e.scrollable]),b),()=>{const{color:t,wrapable:n,background:r}=e;return(0,o.wy)((0,o.Wm)("div",{role:"alert",class:as({wrapable:n}),style:{color:t,background:r}},[d(),g(),v()]),[[Y.F8,f.show]])}}});const cs=(0,r.n)(us);const[ls,fs]=(0,a["do"])("notify"),ds=(0,g.l7)({},H.W,{type:(0,s.SQ)("danger"),color:String,message:s.Or,position:(0,s.SQ)("top"),className:s.Vg,background:String,lockScroll:Boolean});var ps=(0,o.aZ)({name:ls,props:ds,emits:["update:show"],setup(e,{emit:t,slots:n}){const r=e=>t("update:show",e);return()=>(0,o.Wm)(U.G,{show:e.show,class:[fs([e.type]),e.className],style:{color:e.color,background:e.background},overlay:!1,position:e.position,duration:.2,lockScroll:e.lockScroll,"onUpdate:show":r},{default:()=>[n.default?n.default():e.message]})}});let hs,vs;const ms=e=>(0,J.Kn)(e)?e:{message:e};function gs(){({instance:vs}=(0,Vi.H)({setup(){const{state:e,toggle:t}=(0,Vi.o)();return()=>(0,o.Wm)(ps,(0,o.dG)(e,{"onUpdate:show":t}),null)}}))}function ys(e){if(g._f)return vs||gs(),e=(0,g.l7)({},ys.currentOptions,ms(e)),vs.open(e),clearTimeout(hs),e.duration>0&&(hs=window.setTimeout(ys.clear,e.duration)),vs}const bs=()=>({type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0});ys.clear=()=>{vs&&vs.toggle(!1)},ys.currentOptions=bs(),ys.setDefaultOptions=e=>{(0,g.l7)(ys.currentOptions,e)},ys.resetDefaultOptions=()=>{ys.currentOptions=bs()},ys.Component=(0,r.n)(ps),ys.install=e=>{e.use(ys.Component),e.config.globalProperties.$notify=ys};const[xs,ws]=(0,a["do"])("key"),Cs=(0,o.Wm)("svg",{class:ws("collapse-icon"),viewBox:"0 0 30 24"},[(0,o.Wm)("path",{d:"M26 13h-2v2h2v-2zm-8-3h2V8h-2v2zm2-4h2V4h-2v2zm2 4h4V4h-2v4h-2v2zm-7 14 3-3h-6l3 3zM6 13H4v2h2v-2zm16 0H8v2h14v-2zm-12-3h2V8h-2v2zM28 0l1 1 1 1v15l-1 2H1l-1-2V2l1-1 1-1zm0 2H2v15h26V2zM6 4v2H4V4zm10 2h2V4h-2v2zM8 9v1H4V8zm8 0v1h-2V8zm-6-5v2H8V4zm4 0v2h-2V4z",fill:"currentColor"},null)]),Ss=(0,o.Wm)("svg",{class:ws("delete-icon"),viewBox:"0 0 32 22"},[(0,o.Wm)("path",{d:"M28 0a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H10.4a2 2 0 0 1-1.4-.6L1 13.1c-.6-.5-.9-1.3-.9-2 0-1 .3-1.7.9-2.2L9 .6a2 2 0 0 1 1.4-.6zm0 2H10.4l-8.2 8.3a1 1 0 0 0-.3.7c0 .3.1.5.3.7l8.2 8.4H28a2 2 0 0 0 2-2V4c0-1.1-.9-2-2-2zm-5 4a1 1 0 0 1 .7.3 1 1 0 0 1 0 1.4L20.4 11l3.3 3.3c.2.2.3.5.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3L19 12.4l-3.4 3.3a1 1 0 0 1-.6.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.2.1-.5.3-.7l3.3-3.3-3.3-3.3A1 1 0 0 1 14 7c0-.3.1-.5.3-.7A1 1 0 0 1 15 6a1 1 0 0 1 .6.3L19 9.6l3.3-3.3A1 1 0 0 1 23 6z",fill:"currentColor"},null)]);var Es=(0,o.aZ)({name:xs,props:{type:String,text:s.Or,color:String,wider:Boolean,large:Boolean,loading:Boolean},emits:["press"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(!1),a=(0,ee.o)(),s=e=>{a.start(e),r.value=!0},u=e=>{a.move(e),a.direction.value&&(r.value=!1)},c=o=>{r.value&&(n.default||(0,C.PF)(o),r.value=!1,t("press",e.text,e.type))},l=()=>{if(e.loading)return(0,o.Wm)(k.g,{class:ws("loading-icon")},null);const t=n.default?n.default():e.text;switch(e.type){case"delete":return t||Ss;case"extra":return t||Cs;default:return t}};return()=>(0,o.Wm)("div",{class:ws("wrapper",{wider:e.wider}),onTouchstart:s,onTouchmove:u,onTouchend:c,onTouchcancel:c},[(0,o.Wm)("div",{role:"button",tabindex:0,class:ws([e.color,{large:e.large,active:r.value,delete:"delete"===e.type}])},[l()])])}});const[ks,Is]=(0,a["do"])("number-keyboard"),_s={show:Boolean,title:String,theme:(0,s.SQ)("default"),zIndex:s.Or,teleport:[String,Object],maxlength:(0,s.SI)(1/0),modelValue:(0,s.SQ)(""),transition:s.J5,blurOnClose:s.J5,showDeleteKey:s.J5,randomKeyOrder:Boolean,closeButtonText:String,deleteButtonText:String,closeButtonLoading:Boolean,hideOnClickOutside:s.J5,safeAreaInsetBottom:s.J5,extraKey:{type:[String,Array],default:""}};function Rs(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e}var Ts=(0,o.aZ)({name:ks,props:_s,emits:["show","hide","blur","input","close","delete","update:modelValue"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=()=>{const t=Array(9).fill("").map(((e,t)=>({text:t+1})));return e.randomKeyOrder&&Rs(t),t},s=()=>[...a(),{text:e.extraKey,type:"extra"},{text:0},{text:e.showDeleteKey?e.deleteButtonText:"",type:e.showDeleteKey?"delete":""}],c=()=>{const t=a(),{extraKey:n}=e,r=Array.isArray(n)?n:[n];return 1===r.length?t.push({text:0,wider:!0},{text:r[0],type:"extra"}):2===r.length&&t.push({text:r[0],type:"extra"},{text:0},{text:r[1],type:"extra"}),t},l=(0,o.Fl)((()=>"custom"===e.theme?c():s())),f=()=>{e.show&&t("blur")},d=()=>{t("close"),e.blurOnClose&&f()},p=()=>t(e.show?"show":"hide"),h=(n,r)=>{if(""===n)return void("extra"===r&&f());const o=e.modelValue;"delete"===r?(t("delete"),t("update:modelValue",o.slice(0,o.length-1))):"close"===r?d():o.length<e.maxlength&&(t("input",n),t("update:modelValue",o+n))},v=()=>{const{title:t,theme:r,closeButtonText:i}=e,a=n["title-left"],s=i&&"default"===r,u=t||s||a;if(u)return(0,o.Wm)("div",{class:Is("header")},[a&&(0,o.Wm)("span",{class:Is("title-left")},[a()]),t&&(0,o.Wm)("h2",{class:Is("title")},[t]),s&&(0,o.Wm)("button",{type:"button",class:[Is("close"),S.e9],onClick:d},[i])])},m=()=>l.value.map((e=>{const t={};return"delete"===e.type&&(t.default=n.delete),"extra"===e.type&&(t.default=n["extra-key"]),(0,o.Wm)(Es,{key:e.text,text:e.text,type:e.type,wider:e.wider,color:e.color,onPress:h},t)})),g=()=>{if("custom"===e.theme)return(0,o.Wm)("div",{class:Is("sidebar")},[e.showDeleteKey&&(0,o.Wm)(Es,{large:!0,text:e.deleteButtonText,type:"delete",onPress:h},{delete:n.delete}),(0,o.Wm)(Es,{large:!0,text:e.closeButtonText,type:"close",color:"blue",loading:e.closeButtonLoading,onPress:h},null)])};return(0,o.YP)((()=>e.show),(n=>{e.transition||t(n?"show":"hide")})),e.hideOnClickOutside&&(0,u.Vd)(r,f,{eventName:"touchstart"}),()=>{const t=v(),n=(0,o.Wm)(Y.uT,{name:e.transition?"van-slide-up":""},{default:()=>[(0,o.wy)((0,o.Wm)("div",{ref:r,style:(0,Q.As)(e.zIndex),class:Is({unfit:!e.safeAreaInsetBottom,"with-title":!!t}),onTouchstart:C.UW,onAnimationend:p,onWebkitAnimationEnd:p},[t,(0,o.Wm)("div",{class:Is("body")},[(0,o.Wm)("div",{class:Is("keys")},[m()]),g()])]),[[Y.F8,e.show]])]});return e.teleport?(0,o.Wm)(o.lR,{to:e.teleport},{default:()=>[n]}):n}}});const As=(0,r.n)(Ts);var Ds=n(6810);const[Os,Fs,Ns]=(0,a["do"])("pagination"),Ps=(e,t,n)=>({number:e,text:t,active:n}),Ms={mode:(0,s.SQ)("multi"),prevText:String,nextText:String,pageCount:(0,s.SI)(0),modelValue:(0,s.qM)(0),totalItems:(0,s.SI)(0),showPageSize:(0,s.SI)(5),itemsPerPage:(0,s.SI)(10),forceEllipses:Boolean};var Bs=(0,o.aZ)({name:Os,props:Ms,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const r=(0,o.Fl)((()=>{const{pageCount:t,totalItems:n,itemsPerPage:r}=e,o=+t||Math.ceil(+n/+r);return Math.max(1,o)})),i=(0,o.Fl)((()=>{const t=[],n=r.value,o=+e.showPageSize,{modelValue:i,forceEllipses:a}=e;let s=1,u=n;const c=o<n;c&&(s=Math.max(i-Math.floor(o/2),1),u=s+o-1,u>n&&(u=n,s=u-o+1));for(let e=s;e<=u;e++){const n=Ps(e,e,e===i);t.push(n)}if(c&&o>0&&a){if(s>1){const e=Ps(s-1,"...");t.unshift(e)}if(u<n){const e=Ps(u+1,"...");t.push(e)}}return t})),a=(n,o)=>{n=(0,Q.uZ)(n,1,r.value),e.modelValue!==n&&(t("update:modelValue",n),o&&t("change",n))};(0,o.m0)((()=>a(e.modelValue)));const s=()=>(0,o.Wm)("li",{class:Fs("page-desc")},[n.pageDesc?n.pageDesc():`${e.modelValue}/${r.value}`]),u=()=>{const{mode:t,modelValue:r}=e,i=n["prev-text"],s=1===r;return(0,o.Wm)("li",{class:[Fs("item",{disabled:s,border:"simple"===t,prev:!0}),S._K]},[(0,o.Wm)("button",{type:"button",disabled:s,onClick:()=>a(r-1,!0)},[i?i():e.prevText||Ns("prev")])])},c=()=>{const{mode:t,modelValue:i}=e,s=n["next-text"],u=i===r.value;return(0,o.Wm)("li",{class:[Fs("item",{disabled:u,border:"simple"===t,next:!0}),S._K]},[(0,o.Wm)("button",{type:"button",disabled:u,onClick:()=>a(i+1,!0)},[s?s():e.nextText||Ns("next")])])},l=()=>i.value.map((e=>(0,o.Wm)("li",{class:[Fs("item",{active:e.active,page:!0}),S._K]},[(0,o.Wm)("button",{type:"button","aria-current":e.active||void 0,onClick:()=>a(e.number,!0)},[n.page?n.page(e):e.text])])));return()=>(0,o.Wm)("nav",{role:"navigation",class:Fs()},[(0,o.Wm)("ul",{class:Fs("items")},[u(),"simple"===e.mode?s():l(),c()])])}});const Ws=(0,r.n)(Bs);const[Ls,Vs]=(0,a["do"])("password-input"),zs={info:String,mask:s.J5,value:(0,s.SQ)(""),gutter:s.Or,length:(0,s.SI)(6),focused:Boolean,errorInfo:String};var Us=(0,o.aZ)({name:Ls,props:zs,emits:["focus"],setup(e,{emit:t}){const n=e=>{e.stopPropagation(),t("focus",e)},r=()=>{const t=[],{mask:n,value:r,length:i,gutter:a,focused:s}=e;for(let e=0;e<i;e++){const i=r[e],u=0!==e&&!a,c=s&&e===r.length;let l;0!==e&&a&&(l={marginLeft:(0,Q.Nn)(a)}),t.push((0,o.Wm)("li",{class:[{[S.a8]:u},Vs("item",{focus:c})],style:l},[n?(0,o.Wm)("i",{style:{visibility:i?"visible":"hidden"}},null):i,c&&(0,o.Wm)("div",{class:Vs("cursor")},null)]))}return t};return()=>{const t=e.errorInfo||e.info;return(0,o.Wm)("div",{class:Vs()},[(0,o.Wm)("ul",{class:[Vs("security"),{[S._K]:!e.gutter}],onTouchstart:n},[r()]),t&&(0,o.Wm)("div",{class:Vs(e.errorInfo?"error-info":"info")},[t])])}}});const Hs=(0,r.n)(Us);function js(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Gs(e){var t=js(e).Element;return e instanceof t||e instanceof Element}function qs(e){var t=js(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function $s(e){if("undefined"===typeof ShadowRoot)return!1;var t=js(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Ks=Math.round;function Xs(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),r=1,o=1;if(qs(e)&&t){var i=e.offsetHeight,a=e.offsetWidth;a>0&&(r=Ks(n.width)/a||1),i>0&&(o=Ks(n.height)/i||1)}return{width:n.width/r,height:n.height/o,top:n.top/o,right:n.right/r,bottom:n.bottom/o,left:n.left/r,x:n.left/r,y:n.top/o}}function Ys(e){var t=js(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Js(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Zs(e){return e!==js(e)&&qs(e)?Js(e):Ys(e)}function Qs(e){return e?(e.nodeName||"").toLowerCase():null}function eu(e){return((Gs(e)?e.ownerDocument:e.document)||window.document).documentElement}function tu(e){return Xs(eu(e)).left+Ys(e).scrollLeft}function nu(e){return js(e).getComputedStyle(e)}function ru(e){var t=nu(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function ou(e){var t=e.getBoundingClientRect(),n=Ks(t.width)/e.offsetWidth||1,r=Ks(t.height)/e.offsetHeight||1;return 1!==n||1!==r}function iu(e,t,n){void 0===n&&(n=!1);var r=qs(t),o=qs(t)&&ou(t),i=eu(t),a=Xs(e,o),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!n)&&(("body"!==Qs(t)||ru(i))&&(s=Zs(t)),qs(t)?(u=Xs(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):i&&(u.x=tu(i))),{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}function au(e){var t=Xs(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function su(e){return"html"===Qs(e)?e:e.assignedSlot||e.parentNode||($s(e)?e.host:null)||eu(e)}function uu(e){return["html","body","#document"].indexOf(Qs(e))>=0?e.ownerDocument.body:qs(e)&&ru(e)?e:uu(su(e))}function cu(e,t){var n;void 0===t&&(t=[]);var r=uu(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=js(r),a=o?[i].concat(i.visualViewport||[],ru(r)?r:[]):r,s=t.concat(a);return o?s:s.concat(cu(su(a)))}function lu(e){return["table","td","th"].indexOf(Qs(e))>=0}function fu(e){return qs(e)&&"fixed"!==nu(e).position?e.offsetParent:null}function du(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox"),n=-1!==navigator.userAgent.indexOf("Trident");if(n&&qs(e)){var r=nu(e);if("fixed"===r.position)return null}var o=su(e);$s(o)&&(o=o.host);while(qs(o)&&["html","body"].indexOf(Qs(o))<0){var i=nu(o);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return o;o=o.parentNode}return null}function pu(e){var t=js(e),n=fu(e);while(n&&lu(n)&&"static"===nu(n).position)n=fu(n);return n&&("html"===Qs(n)||"body"===Qs(n)&&"static"===nu(n).position)?t:n||du(e)||t}var hu="top",vu="bottom",mu="right",gu="left",yu="auto",bu=[hu,vu,mu,gu],xu="start",wu="end",Cu=[].concat(bu,[yu]).reduce((function(e,t){return e.concat([t,t+"-"+xu,t+"-"+wu])}),[]),Su="beforeRead",Eu="read",ku="afterRead",Iu="beforeMain",_u="main",Ru="afterMain",Tu="beforeWrite",Au="write",Du="afterWrite",Ou=[Su,Eu,ku,Iu,_u,Ru,Tu,Au,Du];function Fu(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name);var i=[].concat(e.requires||[],e.requiresIfExists||[]);i.forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}function Nu(e){var t=Fu(e);return Ou.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}function Pu(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}function Mu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return[].concat(n).reduce((function(e,t){return e.replace(/%s/,t)}),e)}var Bu='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',Wu='Popper: modifier "%s" requires "%s", but "%s" modifier is not available',Lu=["name","enabled","phase","fn","effect","requires","options"];function Vu(e){e.forEach((function(t){[].concat(Object.keys(t),Lu).filter((function(e,t,n){return n.indexOf(e)===t})).forEach((function(n){switch(n){case"name":"string"!==typeof t.name&&console.error(Mu(Bu,String(t.name),'"name"','"string"','"'+String(t.name)+'"'));break;case"enabled":"boolean"!==typeof t.enabled&&console.error(Mu(Bu,t.name,'"enabled"','"boolean"','"'+String(t.enabled)+'"'));break;case"phase":Ou.indexOf(t.phase)<0&&console.error(Mu(Bu,t.name,'"phase"',"either "+Ou.join(", "),'"'+String(t.phase)+'"'));break;case"fn":"function"!==typeof t.fn&&console.error(Mu(Bu,t.name,'"fn"','"function"','"'+String(t.fn)+'"'));break;case"effect":null!=t.effect&&"function"!==typeof t.effect&&console.error(Mu(Bu,t.name,'"effect"','"function"','"'+String(t.fn)+'"'));break;case"requires":null==t.requires||Array.isArray(t.requires)||console.error(Mu(Bu,t.name,'"requires"','"array"','"'+String(t.requires)+'"'));break;case"requiresIfExists":Array.isArray(t.requiresIfExists)||console.error(Mu(Bu,t.name,'"requiresIfExists"','"array"','"'+String(t.requiresIfExists)+'"'));break;case"options":case"data":break;default:console.error('PopperJS: an invalid property has been provided to the "'+t.name+'" modifier, valid properties are '+Lu.map((function(e){return'"'+e+'"'})).join(", ")+'; but "'+n+'" was provided.')}t.requires&&t.requires.forEach((function(n){null==e.find((function(e){return e.name===n}))&&console.error(Mu(Wu,String(t.name),n,n))}))}))}))}function zu(e,t){var n=new Set;return e.filter((function(e){var r=t(e);if(!n.has(r))return n.add(r),!0}))}function Uu(e){return e.split("-")[0]}function Hu(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}function ju(e){return e.split("-")[1]}function Gu(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function qu(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?Uu(o):null,a=o?ju(o):null,s=n.x+n.width/2-r.width/2,u=n.y+n.height/2-r.height/2;switch(i){case hu:t={x:s,y:n.y-r.height};break;case vu:t={x:s,y:n.y+n.height};break;case mu:t={x:n.x+n.width,y:u};break;case gu:t={x:n.x-r.width,y:u};break;default:t={x:n.x,y:n.y}}var c=i?Gu(i):null;if(null!=c){var l="y"===c?"height":"width";switch(a){case xu:t[c]=t[c]-(n[l]/2-r[l]/2);break;case wu:t[c]=t[c]+(n[l]/2-r[l]/2);break;default:}}return t}var $u="Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.",Ku="Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.",Xu={placement:"bottom",modifiers:[],strategy:"absolute"};function Yu(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function Ju(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,i=void 0===o?Xu:o;return function(e,t,n){void 0===n&&(n=i);var o={placement:"bottom",orderedModifiers:[],options:Object.assign({},Xu,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},a=[],s=!1,u={state:o,setOptions:function(n){var a="function"===typeof n?n(o.options):n;l(),o.options=Object.assign({},i,o.options,a),o.scrollParents={reference:Gs(e)?cu(e):e.contextElement?cu(e.contextElement):[],popper:cu(t)};var s=Nu(Hu([].concat(r,o.options.modifiers)));o.orderedModifiers=s.filter((function(e){return e.enabled}));var f=zu([].concat(s,o.options.modifiers),(function(e){var t=e.name;return t}));if(Vu(f),Uu(o.options.placement)===yu){var d=o.orderedModifiers.find((function(e){var t=e.name;return"flip"===t}));d||console.error(['Popper: "auto" placements require the "flip" modifier be',"present and enabled to work."].join(" "))}var p=nu(t),h=p.marginTop,v=p.marginRight,m=p.marginBottom,g=p.marginLeft;return[h,v,m,g].some((function(e){return parseFloat(e)}))&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding',"between the popper and its reference element or boundary.","To replicate margin, use the `offset` modifier, as well as","the `padding` option in the `preventOverflow` and `flip`","modifiers."].join(" ")),c(),u.update()},forceUpdate:function(){if(!s){var e=o.elements,t=e.reference,n=e.popper;if(Yu(t,n)){o.rects={reference:iu(t,pu(n),"fixed"===o.options.strategy),popper:au(n)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach((function(e){return o.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0,i=0;i<o.orderedModifiers.length;i++){if(r+=1,r>100){console.error(Ku);break}if(!0!==o.reset){var a=o.orderedModifiers[i],c=a.fn,l=a.options,f=void 0===l?{}:l,d=a.name;"function"===typeof c&&(o=c({state:o,options:f,name:d,instance:u})||o)}else o.reset=!1,i=-1}}else console.error($u)}},update:Pu((function(){return new Promise((function(e){u.forceUpdate(),e(o)}))})),destroy:function(){l(),s=!0}};if(!Yu(e,t))return console.error($u),u;function c(){o.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,i=e.effect;if("function"===typeof i){var s=i({state:o,name:t,instance:u,options:r}),c=function(){};a.push(s||c)}}))}function l(){a.forEach((function(e){return e()})),a=[]}return u.setOptions(n).then((function(e){!s&&n.onFirstUpdate&&n.onFirstUpdate(e)})),u}}var Zu={passive:!0};function Qu(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,a=r.resize,s=void 0===a||a,u=js(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&c.forEach((function(e){e.addEventListener("scroll",n.update,Zu)})),s&&u.addEventListener("resize",n.update,Zu),function(){i&&c.forEach((function(e){e.removeEventListener("scroll",n.update,Zu)})),s&&u.removeEventListener("resize",n.update,Zu)}}var ec={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Qu,data:{}};function tc(e){var t=e.state,n=e.name;t.modifiersData[n]=qu({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var nc={name:"popperOffsets",enabled:!0,phase:"read",fn:tc,data:{}},rc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function oc(e){var t=e.x,n=e.y,r=window,o=r.devicePixelRatio||1;return{x:Ks(t*o)/o||0,y:Ks(n*o)/o||0}}function ic(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.variation,a=e.offsets,s=e.position,u=e.gpuAcceleration,c=e.adaptive,l=e.roundOffsets,f=e.isFixed,d=a.x,p=void 0===d?0:d,h=a.y,v=void 0===h?0:h,m="function"===typeof l?l({x:p,y:v}):{x:p,y:v};p=m.x,v=m.y;var g=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),b=gu,x=hu,w=window;if(c){var C=pu(n),S="clientHeight",E="clientWidth";if(C===js(n)&&(C=eu(n),"static"!==nu(C).position&&"absolute"===s&&(S="scrollHeight",E="scrollWidth")),o===hu||(o===gu||o===mu)&&i===wu){x=vu;var k=f&&C===w&&w.visualViewport?w.visualViewport.height:C[S];v-=k-r.height,v*=u?1:-1}if(o===gu||(o===hu||o===vu)&&i===wu){b=mu;var I=f&&C===w&&w.visualViewport?w.visualViewport.width:C[E];p-=I-r.width,p*=u?1:-1}}var _,R=Object.assign({position:s},c&&rc),T=!0===l?oc({x:p,y:v}):{x:p,y:v};return p=T.x,v=T.y,u?Object.assign({},R,(_={},_[x]=y?"0":"",_[b]=g?"0":"",_.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",_)):Object.assign({},R,(t={},t[x]=y?v+"px":"",t[b]=g?p+"px":"",t.transform="",t))}function ac(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,u=void 0===s||s,c=nu(t.elements.popper).transitionProperty||"";a&&["transform","top","right","bottom","left"].some((function(e){return c.indexOf(e)>=0}))&&console.warn(["Popper: Detected CSS transitions on at least one of the following",'CSS properties: "transform", "top", "right", "bottom", "left".',"\n\n",'Disable the "computeStyles" modifier\'s `adaptive` option to allow',"for smooth transitions, or remove these properties from the CSS","transition declaration on the popper element if only transitioning","opacity or background-color for example.","\n\n","We recommend using the popper element as a wrapper around an inner","element that can have any CSS property transitioned for animations."].join(" "));var l={placement:Uu(t.placement),variation:ju(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ic(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ic(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var sc={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ac,data:{}};function uc(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];qs(o)&&Qs(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))}function cc(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]),a=i.reduce((function(e,t){return e[t]="",e}),{});qs(r)&&Qs(r)&&(Object.assign(r.style,a),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}}var lc={name:"applyStyles",enabled:!0,phase:"write",fn:uc,effect:cc,requires:["computeStyles"]},fc=[ec,nc,sc,lc],dc=Ju({defaultModifiers:fc});function pc(e,t,n){var r=Uu(e),o=[gu,hu].indexOf(r)>=0?-1:1,i="function"===typeof n?n(Object.assign({},t,{placement:e})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[gu,mu].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}function hc(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,a=Cu.reduce((function(e,n){return e[n]=pc(n,t.rects,i),e}),{}),s=a[t.placement],u=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=a}var vc={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hc};const[mc,gc]=(0,a["do"])("popover"),yc=["show","overlay","duration","teleport","overlayStyle","overlayClass","closeOnClickOverlay"],bc={show:Boolean,theme:(0,s.SQ)("light"),overlay:Boolean,actions:(0,s.Ce)(),trigger:(0,s.SQ)("click"),duration:s.Or,showArrow:s.J5,placement:(0,s.SQ)("bottom"),iconPrefix:String,overlayClass:s.Vg,overlayStyle:Object,closeOnClickAction:s.J5,closeOnClickOverlay:s.J5,closeOnClickOutside:s.J5,offset:{type:Array,default:()=>[0,8]},teleport:{type:[String,Object],default:"body"}};var xc=(0,o.aZ)({name:mc,props:bc,emits:["select","touchstart","update:show"],setup(e,{emit:t,slots:n,attrs:r}){let a;const s=(0,i.iH)(),c=(0,i.iH)(),l=()=>s.value&&c.value?dc(s.value,c.value.popupRef.value,{placement:e.placement,modifiers:[{name:"computeStyles",options:{adaptive:!1,gpuAcceleration:!1}},(0,g.l7)({},vc,{options:{offset:e.offset}})]}):null,f=()=>{(0,o.Y3)((()=>{e.show&&(a?a.setOptions({placement:e.placement}):a=l())}))},d=e=>t("update:show",e),p=()=>{"click"===e.trigger&&d(!e.show)},h=e=>{e.stopPropagation(),t("touchstart",e)},v=(n,r)=>{n.disabled||(t("select",n,r),e.closeOnClickAction&&d(!1))},m=()=>{!e.closeOnClickOutside||e.overlay&&!e.closeOnClickOverlay||d(!1)},y=(t,r)=>n.action?n.action({action:t,index:r}):[t.icon&&(0,o.Wm)(E.J,{name:t.icon,classPrefix:e.iconPrefix,class:gc("action-icon")},null),(0,o.Wm)("div",{class:[gc("action-text"),S.xe]},[t.text])],b=(e,t)=>{const{icon:n,color:r,disabled:i,className:a}=e;return(0,o.Wm)("div",{role:"menuitem",class:[gc("action",{disabled:i,"with-icon":n}),a],style:{color:r},tabindex:i?void 0:0,"aria-disabled":i||void 0,onClick:()=>v(e,t)},[y(e,t)])};return(0,o.bv)(f),(0,o.Jd)((()=>{a&&(a.destroy(),a=null)})),(0,o.YP)((()=>[e.show,e.placement]),f),(0,u.Vd)(s,m,{eventName:"touchstart"}),()=>{var t;return(0,o.Wm)(o.HY,null,[(0,o.Wm)("span",{ref:s,class:gc("wrapper"),onClick:p},[null==(t=n.reference)?void 0:t.call(n)]),(0,o.Wm)(U.G,(0,o.dG)({ref:c,class:gc([e.theme]),position:"",transition:"van-popover-zoom",lockScroll:!1,onTouchstart:h,"onUpdate:show":d},r,(0,g.ei)(e,yc)),{default:()=>[e.showArrow&&(0,o.Wm)("div",{class:gc("arrow")},null),(0,o.Wm)("div",{role:"menu",class:gc("content")},[n.default?n.default():e.actions.map(b)])]})])}}});const wc=(0,r.n)(xc);const[Cc,Sc]=(0,a["do"])("progress"),Ec={color:String,inactive:Boolean,pivotText:String,textColor:String,showPivot:s.J5,pivotColor:String,trackColor:String,strokeWidth:s.Or,percentage:{type:s.Or,default:0,validator:e=>e>=0&&e<=100}};var kc=(0,o.aZ)({name:Cc,props:Ec,setup(e){const t=(0,o.Fl)((()=>e.inactive?void 0:e.color)),n=()=>{const{textColor:n,pivotText:r,pivotColor:i,percentage:a}=e,s=null!=r?r:`${a}%`;if(e.showPivot&&s){const r={color:n,left:+a+"%",transform:`translate(-${+a}%,-50%)`,background:i||t.value};return(0,o.Wm)("span",{style:r,class:Sc("pivot",{inactive:e.inactive})},[s])}};return()=>{const{trackColor:r,percentage:i,strokeWidth:a}=e,s={background:r,height:(0,Q.Nn)(a)},u={width:`${i}%`,background:t.value};return(0,o.Wm)("div",{class:Sc(),style:s},[(0,o.Wm)("span",{class:Sc("portion",{inactive:e.inactive}),style:u},null),n()])}}});const Ic=(0,r.n)(kc);const[_c,Rc,Tc]=(0,a["do"])("pull-refresh"),Ac=50,Dc=["pulling","loosing","success"],Oc={disabled:Boolean,modelValue:Boolean,headHeight:(0,s.SI)(Ac),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:s.Or,successDuration:(0,s.SI)(500),animationDuration:(0,s.SI)(300)};var Fc=(0,o.aZ)({name:_c,props:Oc,emits:["change","refresh","update:modelValue"],setup(e,{emit:t,slots:n}){let r;const a=(0,i.iH)(),s=(0,u.eo)(a),c=(0,i.qj)({status:"normal",distance:0,duration:0}),l=(0,ee.o)(),f=()=>{if(e.headHeight!==Ac)return{height:`${e.headHeight}px`}},d=()=>"loading"!==c.status&&"success"!==c.status&&!e.disabled,p=t=>{const n=+(e.pullDistance||e.headHeight);return t>n&&(t=t<2*n?n+(t-n)/2:1.5*n+(t-2*n)/4),Math.round(t)},h=(n,r)=>{const o=+(e.pullDistance||e.headHeight);c.distance=n,c.status=r?"loading":0===n?"normal":n<o?"pulling":"loosing",t("change",{status:c.status,distance:n})},v=()=>{const{status:t}=c;return"normal"===t?"":e[`${t}Text`]||Tc(t)},m=()=>{const{status:e,distance:t}=c;if(n[e])return n[e]({distance:t});const r=[];return Dc.includes(e)&&r.push((0,o.Wm)("div",{class:Rc("text")},[v()])),"loading"===e&&r.push((0,o.Wm)(k.g,{class:Rc("loading")},{default:v})),r},g=()=>{c.status="success",setTimeout((()=>{h(0)}),+e.successDuration)},y=e=>{r=0===(0,C.cx)(s.value),r&&(c.duration=0,l.start(e))},b=e=>{d()&&y(e)},x=e=>{if(d()){r||y(e);const{deltaY:t}=l;l.move(e),r&&t.value>=0&&l.isVertical()&&((0,C.PF)(e),h(p(t.value)))}},w=()=>{r&&l.deltaY.value&&d()&&(c.duration=+e.animationDuration,"loosing"===c.status?(h(+e.headHeight,!0),t("update:modelValue",!0),(0,o.Y3)((()=>t("refresh")))):h(0))};return(0,o.YP)((()=>e.modelValue),(t=>{c.duration=+e.animationDuration,t?h(+e.headHeight,!0):n.success||e.successText?g():h(0,!1)})),()=>{var e;const t={transitionDuration:`${c.duration}ms`,transform:c.distance?`translate3d(0,${c.distance}px, 0)`:""};return(0,o.Wm)("div",{ref:a,class:Rc()},[(0,o.Wm)("div",{class:Rc("track"),style:t,onTouchstart:b,onTouchmove:x,onTouchend:w,onTouchcancel:w},[(0,o.Wm)("div",{class:Rc("head"),style:f()},[m()]),null==(e=n.default)?void 0:e.call(n)])])}}});const Nc=(0,r.n)(Fc);const[Pc,Mc]=(0,a["do"])("rate");function Bc(e,t,n,r){if(e>=t)return{status:"full",value:1};if(e+.5>=t&&n&&!r)return{status:"half",value:.5};if(e+1>=t&&n&&r){const n=10**10;return{status:"half",value:Math.round((e-t+1)*n)/n}}return{status:"void",value:0}}const Wc={size:s.Or,icon:(0,s.SQ)("star"),color:String,count:(0,s.SI)(5),gutter:s.Or,readonly:Boolean,disabled:Boolean,voidIcon:(0,s.SQ)("star-o"),allowHalf:Boolean,voidColor:String,touchable:s.J5,iconPrefix:String,modelValue:(0,s.qM)(0),disabledColor:String};var Lc=(0,o.aZ)({name:Pc,props:Wc,emits:["change","update:modelValue"],setup(e,{emit:t}){const n=(0,ee.o)(),[r,a]=on(),s=(0,i.iH)(),c=()=>e.readonly||e.disabled||!e.touchable,l=(0,o.Fl)((()=>Array(+e.count).fill("").map(((t,n)=>Bc(e.modelValue,n+1,e.allowHalf,e.readonly)))));let f,d,p=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;const v=()=>{d=(0,u.EL)(s);const t=r.value.map(u.EL);f=[],t.forEach(((t,n)=>{p=Math.min(t.top,p),h=Math.max(t.top,h),e.allowHalf?f.push({score:n+.5,left:t.left,top:t.top,height:t.height},{score:n+1,left:t.left+t.width/2,top:t.top,height:t.height}):f.push({score:n+1,left:t.left,top:t.top,height:t.height})}))},m=(t,n)=>{for(let e=f.length-1;e>0;e--)if(n>=d.top&&n<=d.bottom){if(t>f[e].left&&n>=f[e].top&&n<=f[e].top+f[e].height)return f[e].score}else{const r=n<d.top?p:h;if(t>f[e].left&&f[e].top===r)return f[e].score}return e.allowHalf?.5:1},g=n=>{e.disabled||e.readonly||n===e.modelValue||(t("update:modelValue",n),t("change",n))},y=e=>{c()||(n.start(e),v())},b=e=>{if(!c()&&(n.move(e),n.isHorizontal())){const{clientX:t,clientY:n}=e.touches[0];(0,C.PF)(e),g(m(t,n))}},x=(t,n)=>{const{icon:r,size:i,color:s,count:u,gutter:c,voidIcon:l,disabled:f,voidColor:d,allowHalf:p,iconPrefix:h,disabledColor:y}=e,b=n+1,x="full"===t.status,w="void"===t.status,C=p&&t.value>0&&t.value<1;let S;c&&b!==+u&&(S={paddingRight:(0,Q.Nn)(c)});const k=e=>{v(),g(p?m(e.clientX,e.clientY):b)};return(0,o.Wm)("div",{key:n,ref:a(n),role:"radio",style:S,class:Mc("item"),tabindex:f?void 0:0,"aria-setsize":u,"aria-posinset":b,"aria-checked":!w,onClick:k},[(0,o.Wm)(E.J,{size:i,name:x?r:l,class:Mc("icon",{disabled:f,full:x}),color:f?y:x?s:d,classPrefix:h},null),C&&(0,o.Wm)(E.J,{size:i,style:{width:t.value+"em"},name:w?l:r,class:Mc("icon",["half",{disabled:f,full:!w}]),color:f?y:w?d:s,classPrefix:h},null)])};return(0,u.aM)((()=>e.modelValue)),()=>(0,o.Wm)("div",{ref:s,role:"radiogroup",class:Mc({readonly:e.readonly,disabled:e.disabled}),tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,"aria-readonly":e.readonly,onTouchstart:y,onTouchmove:b},[l.value.map(x)])}});const Vc=(0,r.n)(Lc);const zc=(0,r.n)(Jr);const[Uc,Hc,jc]=(0,a["do"])("search"),Gc=(0,g.l7)({},Je,{label:String,shape:(0,s.SQ)("square"),leftIcon:(0,s.SQ)("search"),clearable:s.J5,actionText:String,background:String,showAction:Boolean});var qc=(0,o.aZ)({name:Uc,props:Gc,emits:["blur","focus","clear","search","cancel","click-input","click-left-icon","click-right-icon","update:modelValue"],setup(e,{emit:t,slots:n,attrs:r}){const a=Ke(),s=(0,i.iH)(),u=()=>{n.action||(t("update:modelValue",""),t("cancel"))},c=n=>{const r=13;n.keyCode===r&&((0,C.PF)(n),t("search",e.modelValue))},l=()=>e.id||`${a}-input`,f=()=>{if(n.label||e.label)return(0,o.Wm)("label",{class:Hc("label"),for:l()},[n.label?n.label():e.label])},d=()=>{if(e.showAction){const t=e.actionText||jc("cancel");return(0,o.Wm)("div",{class:Hc("action"),role:"button",tabindex:0,onClick:u},[n.action?n.action():t])}},p=()=>{var e;return null==(e=s.value)?void 0:e.blur()},h=()=>{var e;return null==(e=s.value)?void 0:e.focus()},v=e=>t("blur",e),m=e=>t("focus",e),b=e=>t("clear",e),x=e=>t("click-input",e),w=e=>t("click-left-icon",e),S=e=>t("click-right-icon",e),E=Object.keys(Je),k=()=>{const i=(0,g.l7)({},r,(0,g.ei)(e,E),{id:l()}),a=e=>t("update:modelValue",e);return(0,o.Wm)(et,(0,o.dG)({ref:s,type:"search",class:Hc("field"),border:!1,onBlur:v,onFocus:m,onClear:b,onKeypress:c,"onClick-input":x,"onClick-left-icon":w,"onClick-right-icon":S,"onUpdate:modelValue":a},i),(0,g.ei)(n,["left-icon","right-icon"]))};return(0,y.F)({focus:h,blur:p}),()=>{var t;return(0,o.Wm)("div",{class:Hc({"show-action":e.showAction}),style:{background:e.background}},[null==(t=n.left)?void 0:t.call(n),(0,o.Wm)("div",{class:Hc("content",e.shape)},[f(),k()]),d()])}}});const $c=(0,r.n)(qc);const Kc=[...H.m,"round","closeOnPopstate","safeAreaInsetBottom"],Xc={qq:"qq",link:"link-o",weibo:"weibo",qrcode:"qr",poster:"photo-o",wechat:"wechat","weapp-qrcode":"miniprogram-o","wechat-moments":"wechat-moments"},[Yc,Jc,Zc]=(0,a["do"])("share-sheet"),Qc=(0,g.l7)({},H.W,{title:String,round:s.J5,options:(0,s.Ce)(),cancelText:String,description:String,closeOnPopstate:s.J5,safeAreaInsetBottom:s.J5});var el=(0,o.aZ)({name:Yc,props:Qc,emits:["cancel","select","update:show"],setup(e,{emit:t,slots:n}){const r=e=>t("update:show",e),i=()=>{r(!1),t("cancel")},a=(e,n)=>t("select",e,n),s=()=>{const t=n.title?n.title():e.title,r=n.description?n.description():e.description;if(t||r)return(0,o.Wm)("div",{class:Jc("header")},[t&&(0,o.Wm)("h2",{class:Jc("title")},[t]),r&&(0,o.Wm)("span",{class:Jc("description")},[r])])},u=e=>Xc[e]?(0,o.Wm)("div",{class:Jc("icon",[e])},[(0,o.Wm)(E.J,{name:Xc[e]||e},null)]):(0,o.Wm)("img",{src:e,class:Jc("image-icon")},null),c=(e,t)=>{const{name:n,icon:r,className:i,description:s}=e;return(0,o.Wm)("div",{role:"button",tabindex:0,class:[Jc("option"),i,S.e9],onClick:()=>a(e,t)},[u(r),n&&(0,o.Wm)("span",{class:Jc("name")},[n]),s&&(0,o.Wm)("span",{class:Jc("option-description")},[s])])},l=(e,t)=>(0,o.Wm)("div",{class:Jc("options",{border:t})},[e.map(c)]),f=()=>{const{options:t}=e;return Array.isArray(t[0])?t.map(((e,t)=>l(e,0!==t))):l(t)},d=()=>{var t;const r=null!=(t=e.cancelText)?t:Zc("cancel");if(n.cancel||r)return(0,o.Wm)("button",{type:"button",class:Jc("cancel"),onClick:i},[n.cancel?n.cancel():r])};return()=>(0,o.Wm)(U.G,(0,o.dG)({class:Jc(),position:"bottom","onUpdate:show":r},(0,g.ei)(e,Kc)),{default:()=>[s(),f(),d()]})}});const tl=(0,r.n)(el);const[nl,rl]=(0,a["do"])("sidebar"),ol=Symbol(nl),il={modelValue:(0,s.SI)(0)};var al=(0,o.aZ)({name:nl,props:il,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const{linkChildren:r}=(0,u.$E)(ol),i=()=>+e.modelValue,a=e=>{e!==i()&&(t("update:modelValue",e),t("change",e))};return r({getActive:i,setActive:a}),()=>{var e;return(0,o.Wm)("div",{role:"tablist",class:rl()},[null==(e=n.default)?void 0:e.call(n)])}}});const sl=(0,r.n)(al);const[ul,cl]=(0,a["do"])("sidebar-item"),ll=(0,g.l7)({},b,{dot:Boolean,title:String,badge:s.Or,disabled:Boolean,badgeProps:Object});var fl=(0,o.aZ)({name:ul,props:ll,emits:["click"],setup(e,{emit:t,slots:n}){const r=w(),{parent:i,index:a}=(0,u.NB)(ol);if(!i)return void 0;const s=()=>{e.disabled||(t("click",a.value),i.setActive(a.value),r())};return()=>{const{dot:t,badge:r,title:u,disabled:c}=e,l=a.value===i.getActive();return(0,o.Wm)("div",{role:"tab",class:cl({select:l,disabled:c}),tabindex:c?void 0:0,"aria-selected":l,onClick:s},[(0,o.Wm)(M.C,(0,o.dG)({dot:t,class:cl("text"),content:r},e.badgeProps),{default:()=>[n.title?n.title():u]})])}}});const dl=(0,r.n)(fl);const[pl,hl]=(0,a["do"])("skeleton"),vl="100%",ml="60%",gl={row:(0,s.SI)(0),title:Boolean,round:Boolean,avatar:Boolean,loading:s.J5,animate:s.J5,avatarSize:s.Or,titleWidth:s.Or,avatarShape:(0,s.SQ)("round"),rowWidth:{type:[Number,String,Array],default:vl}};var yl=(0,o.aZ)({name:pl,inheritAttrs:!1,props:gl,setup(e,{slots:t,attrs:n}){const r=()=>{if(e.avatar)return(0,o.Wm)("div",{class:hl("avatar",e.avatarShape),style:(0,Q.Xn)(e.avatarSize)},null)},i=()=>{if(e.title)return(0,o.Wm)("h3",{class:hl("title"),style:{width:(0,Q.Nn)(e.titleWidth)}},null)},a=t=>{const{rowWidth:n}=e;return n===vl&&t===+e.row-1?ml:Array.isArray(n)?n[t]:n},s=()=>Array(+e.row).fill("").map(((e,t)=>(0,o.Wm)("div",{class:hl("row"),style:{width:(0,Q.Nn)(a(t))}},null)));return()=>{var a;return e.loading?(0,o.Wm)("div",(0,o.dG)({class:hl({animate:e.animate,round:e.round})},n),[r(),(0,o.Wm)("div",{class:hl("content")},[i(),s()])]):null==(a=t.default)?void 0:a.call(t)}}});const bl=(0,r.n)(yl);const[xl,wl]=(0,a["do"])("slider"),Cl={min:(0,s.SI)(0),max:(0,s.SI)(100),step:(0,s.SI)(1),range:Boolean,reverse:Boolean,disabled:Boolean,readonly:Boolean,vertical:Boolean,barHeight:s.Or,buttonSize:s.Or,activeColor:String,inactiveColor:String,modelValue:{type:[Number,Array],default:0}};var Sl=(0,o.aZ)({name:xl,props:Cl,emits:["change","drag-end","drag-start","update:modelValue"],setup(e,{emit:t,slots:n}){let r,a,s;const c=(0,i.iH)(),l=(0,i.iH)(),f=(0,ee.o)(),d=(0,o.Fl)((()=>Number(e.max)-Number(e.min))),p=(0,o.Fl)((()=>{const t=e.vertical?"width":"height";return{background:e.inactiveColor,[t]:(0,Q.Nn)(e.barHeight)}})),h=t=>e.range&&Array.isArray(t),v=()=>{const{modelValue:t,min:n}=e;return h(t)?100*(t[1]-t[0])/d.value+"%":100*(t-Number(n))/d.value+"%"},m=()=>{const{modelValue:t,min:n}=e;return h(t)?100*(t[0]-Number(n))/d.value+"%":"0%"},g=(0,o.Fl)((()=>{const t=e.vertical?"height":"width",n={[t]:v(),background:e.activeColor};l.value&&(n.transition="none");const r=()=>e.vertical?e.reverse?"bottom":"top":e.reverse?"right":"left";return n[r()]=m(),n})),y=t=>{const n=+e.min,r=+e.max,o=+e.step;t=(0,Q.uZ)(t,n,r);const i=Math.round((t-n)/o)*o;return(0,Q.Ft)(n,i)},b=(e,t)=>JSON.stringify(e)===JSON.stringify(t),x=t=>{var n,r;const o=null!=(n=t[0])?n:Number(e.min),i=null!=(r=t[1])?r:Number(e.max);return o>i?[i,o]:[o,i]},w=(n,r)=>{n=h(n)?x(n).map(y):y(n),b(n,e.modelValue)||t("update:modelValue",n),r&&!b(n,s)&&t("change",n)},S=t=>{if(t.stopPropagation(),e.disabled||e.readonly)return;const{min:n,reverse:r,vertical:o,modelValue:i}=e,a=(0,u.EL)(c),s=()=>o?r?a.bottom-t.clientY:t.clientY-a.top:r?a.right-t.clientX:t.clientX-a.left,l=o?a.height:a.width,f=Number(n)+s()/l*d.value;if(h(i)){const[e,t]=i,n=(e+t)/2;w(f<=n?[f,t]:[e,f],!0)}else w(f,!0)},E=t=>{e.disabled||e.readonly||(f.start(t),a=e.modelValue,s=h(a)?a.map(y):y(a),l.value="start")},k=n=>{if(e.disabled||e.readonly)return;"start"===l.value&&t("drag-start",n),(0,C.PF)(n,!0),f.move(n),l.value="dragging";const o=(0,u.EL)(c),i=e.vertical?f.deltaY.value:f.deltaX.value,p=e.vertical?o.height:o.width;let v=i/p*d.value;if(e.reverse&&(v=-v),h(s)){const t=e.reverse?1-r:r;a[t]=s[t]+v}else a=s+v;w(a)},I=n=>{e.disabled||e.readonly||("dragging"===l.value&&(w(a,!0),t("drag-end",n)),l.value="")},_=t=>{if("number"===typeof t){const e=["left","right"];return wl("button-wrapper",e[t])}return wl("button-wrapper",e.reverse?"left":"right")},R=(t,r)=>{if("number"===typeof r){const e=n[0===r?"left-button":"right-button"];if(e)return e({value:t})}return n.button?n.button({value:t}):(0,o.Wm)("div",{class:wl("button"),style:(0,Q.Xn)(e.buttonSize)},null)},T=t=>{const n="number"===typeof t?e.modelValue[t]:e.modelValue;return(0,o.Wm)("div",{role:"slider",class:_(t),tabindex:e.disabled?void 0:0,"aria-valuemin":e.min,"aria-valuenow":n,"aria-valuemax":e.max,"aria-disabled":e.disabled||void 0,"aria-readonly":e.readonly||void 0,"aria-orientation":e.vertical?"vertical":"horizontal",onTouchstart:e=>{"number"===typeof t&&(r=t),E(e)},onTouchmove:k,onTouchend:I,onTouchcancel:I,onClick:C.UW},[R(n,t)])};return w(e.modelValue),(0,u.aM)((()=>e.modelValue)),()=>(0,o.Wm)("div",{ref:c,style:p.value,class:wl({vertical:e.vertical,disabled:e.disabled}),onClick:S},[(0,o.Wm)("div",{class:wl("bar"),style:g.value},[e.range?[T(0),T(1)]:T()])])}});const El=(0,r.n)(Sl);const[kl,Il]=(0,a["do"])("steps"),_l={active:(0,s.SI)(0),direction:(0,s.SQ)("horizontal"),activeIcon:(0,s.SQ)("checked"),iconPrefix:String,finishIcon:String,activeColor:String,inactiveIcon:String,inactiveColor:String},Rl=Symbol(kl);var Tl=(0,o.aZ)({name:kl,props:_l,emits:["click-step"],setup(e,{emit:t,slots:n}){const{linkChildren:r}=(0,u.$E)(Rl),i=e=>t("click-step",e);return r({props:e,onClickStep:i}),()=>{var t;return(0,o.Wm)("div",{class:Il([e.direction])},[(0,o.Wm)("div",{class:Il("items")},[null==(t=n.default)?void 0:t.call(n)])])}}});const[Al,Dl]=(0,a["do"])("step");var Ol=(0,o.aZ)({name:Al,setup(e,{slots:t}){const{parent:n,index:r}=(0,u.NB)(Rl);if(!n)return void 0;const i=n.props,a=()=>{const e=+i.active;return r.value<e?"finish":r.value===e?"process":"waiting"},s=()=>"process"===a(),c=(0,o.Fl)((()=>({background:"finish"===a()?i.activeColor:i.inactiveColor}))),l=(0,o.Fl)((()=>s()?{color:i.activeColor}:"waiting"===a()?{color:i.inactiveColor}:void 0)),f=()=>n.onClickStep(r.value),d=()=>{const{iconPrefix:e,finishIcon:n,activeIcon:r,activeColor:u,inactiveIcon:l}=i;return s()?t["active-icon"]?t["active-icon"]():(0,o.Wm)(E.J,{class:Dl("icon","active"),name:r,color:u,classPrefix:e},null):"finish"===a()&&(n||t["finish-icon"])?t["finish-icon"]?t["finish-icon"]():(0,o.Wm)(E.J,{class:Dl("icon","finish"),name:n,color:u,classPrefix:e},null):t["inactive-icon"]?t["inactive-icon"]():l?(0,o.Wm)(E.J,{class:Dl("icon"),name:l,classPrefix:e},null):(0,o.Wm)("i",{class:Dl("circle"),style:c.value},null)};return()=>{var e;const n=a();return(0,o.Wm)("div",{class:[S.T5,Dl([i.direction,{[n]:n}])]},[(0,o.Wm)("div",{class:Dl("title",{active:s()}),style:l.value,onClick:f},[null==(e=t.default)?void 0:e.call(t)]),(0,o.Wm)("div",{class:Dl("circle-container"),onClick:f},[d()]),(0,o.Wm)("div",{class:Dl("line"),style:c.value},null)])}}});const Fl=(0,r.n)(Ol);const[Nl,Pl]=(0,a["do"])("stepper"),Ml=200,Bl=600,Wl=(e,t)=>String(e)===String(t),Ll={min:(0,s.SI)(1),max:(0,s.SI)(1/0),name:(0,s.SI)(""),step:(0,s.SI)(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:s.J5,showMinus:s.J5,showInput:s.J5,longPress:s.J5,allowEmpty:Boolean,modelValue:s.Or,inputWidth:s.Or,buttonSize:s.Or,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:(0,s.SI)(1),decimalLength:s.Or};var Vl=(0,o.aZ)({name:Nl,props:Ll,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:t}){const n=t=>{const{min:n,max:r,allowEmpty:o,decimalLength:i}=e;return o&&""===t||(t=(0,Q.uf)(String(t),!e.integer),t=""===t?0:+t,t=Number.isNaN(t)?+n:t,t=Math.max(Math.min(+r,t),+n),(0,J.Xq)(i)&&(t=t.toFixed(+i))),t},r=()=>{var r;const o=null!=(r=e.modelValue)?r:e.defaultValue,i=n(o);return Wl(i,e.modelValue)||t("update:modelValue",i),i};let a;const s=(0,i.iH)(),c=(0,i.iH)(r()),l=(0,o.Fl)((()=>e.disabled||e.disableMinus||c.value<=+e.min)),f=(0,o.Fl)((()=>e.disabled||e.disablePlus||c.value>=+e.max)),d=(0,o.Fl)((()=>({width:(0,Q.Nn)(e.inputWidth),height:(0,Q.Nn)(e.buttonSize)}))),p=(0,o.Fl)((()=>(0,Q.Xn)(e.buttonSize))),h=()=>{const e=n(c.value);Wl(e,c.value)||(c.value=e)},v=t=>{e.beforeChange?(0,On.I)(e.beforeChange,{args:[t],done(){c.value=t}}):c.value=t},m=()=>{if("plus"===a&&f.value||"minus"===a&&l.value)return void t("overlimit",a);const r="minus"===a?-e.step:+e.step,o=n((0,Q.Ft)(+c.value,r));v(o),t(a)},g=t=>{const n=t.target,{value:r}=n,{decimalLength:o}=e;let i=(0,Q.uf)(String(r),!e.integer);if((0,J.Xq)(o)&&i.includes(".")){const e=i.split(".");i=`${e[0]}.${e[1].slice(0,+o)}`}e.beforeChange?n.value=String(c.value):Wl(r,i)||(n.value=i);const a=i===String(+i);v(a?+i:i)},y=n=>{var r;e.disableInput?null==(r=s.value)||r.blur():t("focus",n)},b=e=>{const r=e.target,i=n(r.value);r.value=String(i),c.value=i,(0,o.Y3)((()=>{t("blur",e),(0,C.pe)()}))};let x,w;const E=()=>{w=setTimeout((()=>{m(),E()}),Ml)},k=()=>{e.longPress&&(x=!1,clearTimeout(w),w=setTimeout((()=>{x=!0,m(),E()}),Bl))},I=t=>{e.longPress&&(clearTimeout(w),x&&(0,C.PF)(t))},_=t=>{e.disableInput&&(0,C.PF)(t)},R=e=>({onClick:t=>{(0,C.PF)(t),a=e,m()},onTouchstart:()=>{a=e,k()},onTouchend:I,onTouchcancel:I});return(0,o.YP)((()=>[e.max,e.min,e.integer,e.decimalLength]),h),(0,o.YP)((()=>e.modelValue),(e=>{Wl(e,c.value)||(c.value=n(e))})),(0,o.YP)(c,(n=>{t("update:modelValue",n),t("change",n,{name:e.name})})),(0,u.aM)((()=>e.modelValue)),()=>(0,o.Wm)("div",{role:"group",class:Pl([e.theme])},[(0,o.wy)((0,o.Wm)("button",(0,o.dG)({type:"button",style:p.value,class:[Pl("minus",{disabled:l.value}),{[S.e9]:!l.value}],"aria-disabled":l.value||void 0},R("minus")),null),[[Y.F8,e.showMinus]]),(0,o.wy)((0,o.Wm)("input",{ref:s,type:e.integer?"tel":"text",role:"spinbutton",class:Pl("input"),value:c.value,style:d.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":c.value,onBlur:b,onInput:g,onFocus:y,onMousedown:_},null),[[Y.F8,e.showInput]]),(0,o.wy)((0,o.Wm)("button",(0,o.dG)({type:"button",style:p.value,class:[Pl("plus",{disabled:f.value}),{[S.e9]:!f.value}],"aria-disabled":f.value||void 0},R("plus")),null),[[Y.F8,e.showPlus]])])}});const zl=(0,r.n)(Vl);const Ul=(0,r.n)(Tl);const[Hl,jl,Gl]=(0,a["do"])("submit-bar"),ql={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,currency:(0,s.SQ)("¥"),disabled:Boolean,textAlign:String,buttonText:String,buttonType:(0,s.SQ)("danger"),buttonColor:String,suffixLabel:String,placeholder:Boolean,decimalLength:(0,s.SI)(2),safeAreaInsetBottom:s.J5};var $l=(0,o.aZ)({name:Hl,props:ql,emits:["submit"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=l(r,jl),s=()=>{const{price:t,label:n,currency:r,textAlign:i,suffixLabel:a,decimalLength:s}=e;if("number"===typeof t){const e=(t/100).toFixed(+s).split("."),u=s?`.${e[1]}`:"";return(0,o.Wm)("div",{class:jl("text"),style:{textAlign:i}},[(0,o.Wm)("span",null,[n||Gl("label")]),(0,o.Wm)("span",{class:jl("price")},[r,(0,o.Wm)("span",{class:jl("price-integer")},[e[0]]),u]),a&&(0,o.Wm)("span",{class:jl("suffix-label")},[a])])}},u=()=>{var t;const{tip:r,tipIcon:i}=e;if(n.tip||r)return(0,o.Wm)("div",{class:jl("tip")},[i&&(0,o.Wm)(E.J,{class:jl("tip-icon"),name:i},null),r&&(0,o.Wm)("span",{class:jl("tip-text")},[r]),null==(t=n.tip)?void 0:t.call(n)])},c=()=>t("submit"),f=()=>n.button?n.button():(0,o.Wm)(A,{round:!0,type:e.buttonType,text:e.buttonText,class:jl("button",e.buttonType),color:e.buttonColor,loading:e.loading,disabled:e.disabled,onClick:c},null),d=()=>{var t,i;return(0,o.Wm)("div",{ref:r,class:[jl(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==(t=n.top)?void 0:t.call(n),u(),(0,o.Wm)("div",{class:jl("bar")},[null==(i=n.default)?void 0:i.call(n),s(),f()])])};return()=>e.placeholder?a(d):d()}});const Kl=(0,r.n)($l);const[Xl,Yl]=(0,a["do"])("swipe-cell"),Jl={name:(0,s.SI)(""),disabled:Boolean,leftWidth:s.Or,rightWidth:s.Or,beforeClose:Function,stopPropagation:Boolean};var Zl=(0,o.aZ)({name:Xl,props:Jl,emits:["open","close","click"],setup(e,{emit:t,slots:n}){let r,a,s;const c=(0,i.iH)(),l=(0,i.iH)(),f=(0,i.iH)(),d=(0,i.qj)({offset:0,dragging:!1}),p=(0,ee.o)(),h=e=>e.value?(0,u.EL)(e).width:0,v=(0,o.Fl)((()=>(0,J.Xq)(e.leftWidth)?+e.leftWidth:h(l))),m=(0,o.Fl)((()=>(0,J.Xq)(e.rightWidth)?+e.rightWidth:h(f))),g=n=>{d.offset="left"===n?v.value:-m.value,r||(r=!0,t("open",{name:e.name,position:n}))},b=n=>{d.offset=0,r&&(r=!1,t("close",{name:e.name,position:n}))},x=e=>{const t=Math.abs(d.offset),n=.15,o=r?1-n:n,i="left"===e?v.value:m.value;i&&t>i*o?g(e):b(e)},w=t=>{e.disabled||(s=d.offset,p.start(t))},S=t=>{if(e.disabled)return;const{deltaX:n}=p;if(p.move(t),p.isHorizontal()){a=!0,d.dragging=!0;const o=!r||n.value*s<0;o&&(0,C.PF)(t,e.stopPropagation),d.offset=(0,Q.uZ)(n.value+s,-m.value,v.value)}},E=()=>{d.dragging&&(d.dragging=!1,x(d.offset>0?"left":"right"),setTimeout((()=>{a=!1}),0))},k=(n="outside")=>{t("click",n),r&&!a&&(0,On.I)(e.beforeClose,{args:[{name:e.name,position:n}],done:()=>b(n)})},I=(e,t)=>n=>{t&&n.stopPropagation(),k(e)},_=(e,t)=>{const r=n[e];if(r)return(0,o.Wm)("div",{ref:t,class:Yl(e),onClick:I(e,!0)},[r()])};return(0,y.F)({open:g,close:b}),(0,u.Vd)(c,(()=>k("outside")),{eventName:"touchstart"}),()=>{var e;const t={transform:`translate3d(${d.offset}px, 0, 0)`,transitionDuration:d.dragging?"0s":".6s"};return(0,o.Wm)("div",{ref:c,class:Yl(),onClick:I("cell",a),onTouchstart:w,onTouchmove:S,onTouchend:E,onTouchcancel:E},[(0,o.Wm)("div",{class:Yl("wrapper"),style:t},[_("left",l),null==(e=n.default)?void 0:e.call(n),_("right",f)])])}}});const Ql=(0,r.n)(Zl);const[ef,tf]=(0,a["do"])("tabbar"),nf={route:Boolean,fixed:s.J5,border:s.J5,zIndex:s.Or,placeholder:Boolean,activeColor:String,beforeChange:Function,inactiveColor:String,modelValue:(0,s.SI)(0),safeAreaInsetBottom:{type:Boolean,default:null}},rf=Symbol(ef);var of=(0,o.aZ)({name:ef,props:nf,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),{linkChildren:a}=(0,u.$E)(rf),s=l(r,tf),c=()=>{var t;return null!=(t=e.safeAreaInsetBottom)?t:e.fixed},f=()=>{var t;const{fixed:i,zIndex:a,border:s}=e;return(0,o.Wm)("div",{ref:r,role:"tablist",style:(0,Q.As)(a),class:[tf({fixed:i}),{[S.r5]:s,"van-safe-area-bottom":c()}]},[null==(t=n.default)?void 0:t.call(n)])},d=(n,r)=>{(0,On.I)(e.beforeChange,{args:[n],done(){t("update:modelValue",n),t("change",n),r()}})};return a({props:e,setActive:d}),()=>e.fixed&&e.placeholder?s(f):f()}});const af=(0,r.n)(of);const[sf,uf]=(0,a["do"])("tabbar-item"),cf=(0,g.l7)({},b,{dot:Boolean,icon:String,name:s.Or,badge:s.Or,badgeProps:Object,iconPrefix:String});var lf=(0,o.aZ)({name:sf,props:cf,emits:["click"],setup(e,{emit:t,slots:n}){const r=w(),i=(0,o.FN)().proxy,{parent:a,index:s}=(0,u.NB)(rf);if(!a)return void 0;const c=(0,o.Fl)((()=>{var t;const{route:n,modelValue:r}=a.props;if(n&&"$route"in i){const{$route:t}=i,{to:n}=e,r=(0,J.Kn)(n)?n:{path:n};return!!t.matched.find((e=>{const t="path"in r&&r.path===e.path,n="name"in r&&r.name===e.name;return t||n}))}return(null!=(t=e.name)?t:s.value)===r})),l=n=>{var o;c.value||a.setActive(null!=(o=e.name)?o:s.value,r),t("click",n)},f=()=>n.icon?n.icon({active:c.value}):e.icon?(0,o.Wm)(E.J,{name:e.icon,classPrefix:e.iconPrefix},null):void 0;return()=>{var t;const{dot:r,badge:i}=e,{activeColor:s,inactiveColor:u}=a.props,d=c.value?s:u;return(0,o.Wm)("div",{role:"tab",class:uf({active:c.value}),style:{color:d},tabindex:0,"aria-selected":c.value,onClick:l},[(0,o.Wm)(M.C,(0,o.dG)({dot:r,class:uf("icon"),content:i},e.badgeProps),{default:f}),(0,o.Wm)("div",{class:uf("text")},[null==(t=n.default)?void 0:t.call(n,{active:c.value})])])}}});const ff=(0,r.n)(lf);const[df,pf]=(0,a["do"])("tree-select"),hf={max:(0,s.SI)(1/0),items:(0,s.Ce)(),height:(0,s.SI)(300),selectedIcon:(0,s.SQ)("success"),mainActiveIndex:(0,s.SI)(0),activeId:{type:[Number,String,Array],default:0}};var vf=(0,o.aZ)({name:df,props:hf,emits:["click-nav","click-item","update:activeId","update:mainActiveIndex"],setup(e,{emit:t,slots:n}){const r=t=>Array.isArray(e.activeId)?e.activeId.includes(t):e.activeId===t,i=n=>{const i=()=>{if(n.disabled)return;let r;if(Array.isArray(e.activeId)){r=e.activeId.slice();const t=r.indexOf(n.id);-1!==t?r.splice(t,1):r.length<e.max&&r.push(n.id)}else r=n.id;t("update:activeId",r),t("click-item",n)};return(0,o.Wm)("div",{key:n.id,class:["van-ellipsis",pf("item",{active:r(n.id),disabled:n.disabled})],onClick:i},[n.text,r(n.id)&&(0,o.Wm)(E.J,{name:e.selectedIcon,class:pf("selected")},null)])},a=e=>{t("update:mainActiveIndex",e)},s=e=>t("click-nav",e),u=()=>{const t=e.items.map((e=>(0,o.Wm)(dl,{dot:e.dot,title:e.text,badge:e.badge,class:[pf("nav-item"),e.className],disabled:e.disabled,onClick:s},null)));return(0,o.Wm)(sl,{class:pf("nav"),modelValue:e.mainActiveIndex,onChange:a},{default:()=>[t]})},c=()=>{if(n.content)return n.content();const t=e.items[+e.mainActiveIndex]||{};return t.children?t.children.map(i):void 0};return()=>(0,o.Wm)("div",{class:pf(),style:{height:(0,Q.Nn)(e.height)}},[u(),(0,o.Wm)("div",{class:pf("content")},[c()])])}});const mf=(0,r.n)(vf);n(285),n(1637);const[gf,yf,bf]=(0,a["do"])("uploader");function xf(e,t){return new Promise((n=>{if("file"===t)return void n();const r=new FileReader;r.onload=e=>{n(e.target.result)},"dataUrl"===t?r.readAsDataURL(e):"text"===t&&r.readAsText(e)}))}function wf(e,t){return(0,g.qo)(e).some((e=>!!e.file&&((0,J.mf)(t)?t(e.file):e.file.size>t)))}function Cf(e,t){const n=[],r=[];return e.forEach((e=>{wf(e,t)?r.push(e):n.push(e)})),{valid:n,invalid:r}}const Sf=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i,Ef=e=>Sf.test(e);function kf(e){return!!e.isImage||(e.file&&e.file.type?0===e.file.type.indexOf("image"):e.url?Ef(e.url):"string"===typeof e.content&&0===e.content.indexOf("data:image"))}var If=(0,o.aZ)({props:{name:s.Or,item:(0,s.ir)(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:t,slots:n}){const r=()=>{const{status:t,message:n}=e.item;if("uploading"===t||"failed"===t){const e="failed"===t?(0,o.Wm)(E.J,{name:"close",class:yf("mask-icon")},null):(0,o.Wm)(k.g,{class:yf("loading")},null),r=(0,J.Xq)(n)&&""!==n;return(0,o.Wm)("div",{class:yf("mask")},[e,r&&(0,o.Wm)("div",{class:yf("mask-message")},[n])])}},i=n=>{const{name:r,item:o,index:i,beforeDelete:a}=e;n.stopPropagation(),(0,On.I)(a,{args:[o,{name:r,index:i}],done:()=>t("delete")})},a=()=>t("preview"),s=()=>{if(e.deletable&&"uploading"!==e.item.status){const e=n["preview-delete"];return(0,o.Wm)("div",{role:"button",class:yf("preview-delete",{shadow:!e}),tabindex:0,"aria-label":bf("delete"),onClick:i},[e?e():(0,o.Wm)(E.J,{name:"cross",class:yf("preview-delete-icon")},null)])}},u=()=>{if(n["preview-cover"]){const{index:t,item:r}=e;return(0,o.Wm)("div",{class:yf("preview-cover")},[n["preview-cover"]((0,g.l7)({index:t},r))])}},c=()=>{const{item:t,lazyLoad:n,imageFit:r,previewSize:i}=e;return kf(t)?(0,o.Wm)(In,{fit:r,src:t.content||t.url,class:yf("preview-image"),width:Array.isArray(i)?i[0]:i,height:Array.isArray(i)?i[1]:i,lazyLoad:n,onClick:a},{default:u}):(0,o.Wm)("div",{class:yf("file"),style:(0,Q.Xn)(e.previewSize)},[(0,o.Wm)(E.J,{class:yf("file-icon"),name:"description"},null),(0,o.Wm)("div",{class:[yf("file-name"),"van-ellipsis"]},[t.file?t.file.name:t.url]),u()])};return()=>(0,o.Wm)("div",{class:yf("preview")},[c(),r(),s()])}});const _f={name:(0,s.SI)(""),accept:(0,s.SQ)("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:(0,s.SI)(1/0),imageFit:(0,s.SQ)("cover"),resultType:(0,s.SQ)("dataUrl"),uploadIcon:(0,s.SQ)("photograph"),uploadText:String,deletable:s.J5,afterRead:Function,showUpload:s.J5,modelValue:(0,s.Ce)(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:s.J5,previewOptions:Object,previewFullImage:s.J5,maxSize:{type:[Number,String,Function],default:1/0}};var Rf=(0,o.aZ)({name:gf,props:_f,emits:["delete","oversize","click-upload","close-preview","click-preview","update:modelValue"],setup(e,{emit:t,slots:n}){const r=(0,i.iH)(),a=[],s=(t=e.modelValue.length)=>({name:e.name,index:t}),c=()=>{r.value&&(r.value.value="")},l=n=>{if(c(),wf(n,e.maxSize)){if(!Array.isArray(n))return void t("oversize",n,s());{const r=Cf(n,e.maxSize);if(n=r.valid,t("oversize",r.invalid,s()),!n.length)return}}n=(0,i.qj)(n),t("update:modelValue",[...e.modelValue,...(0,g.qo)(n)]),e.afterRead&&e.afterRead(n,s())},f=t=>{const{maxCount:n,modelValue:r,resultType:o}=e;if(Array.isArray(t)){const e=+n-r.length;t.length>e&&(t=t.slice(0,e)),Promise.all(t.map((e=>xf(e,o)))).then((e=>{const n=t.map(((t,n)=>{const r={file:t,status:"",message:""};return e[n]&&(r.content=e[n]),r}));l(n)}))}else xf(t,o).then((e=>{const n={file:t,status:"",message:""};e&&(n.content=e),l(n)}))},d=t=>{const{files:n}=t.target;if(e.disabled||!n||!n.length)return;const r=1===n.length?n[0]:[].slice.call(n);if(e.beforeRead){const t=e.beforeRead(r,s());if(!t)return void c();if((0,J.tI)(t))return void t.then((e=>{f(e||r)})).catch(c)}f(r)};let p;const h=()=>t("close-preview"),v=t=>{if(e.previewFullImage){const n=e.modelValue.filter(kf),r=n.map((e=>(e.file&&!e.url&&(e.url=URL.createObjectURL(e.file),a.push(e.url)),e.url))).filter(Boolean);p=Na((0,g.l7)({images:r,startPosition:n.indexOf(t),onClose:h},e.previewOptions))}},m=()=>{p&&p.close()},b=(n,r)=>{const o=e.modelValue.slice(0);o.splice(r,1),t("update:modelValue",o),t("delete",n,s(r))},x=(r,i)=>{const a=["imageFit","deletable","previewSize","beforeDelete"],u=(0,g.l7)((0,g.ei)(e,a),(0,g.ei)(r,a,!0));return(0,o.Wm)(If,(0,o.dG)({item:r,index:i,onClick:()=>t("click-preview",r,s(i)),onDelete:()=>b(r,i),onPreview:()=>v(r)},(0,g.ei)(e,["name","lazyLoad"]),u),(0,g.ei)(n,["preview-cover","preview-delete"]))},w=()=>{if(e.previewImage)return e.modelValue.map(x)},C=e=>t("click-upload",e),S=()=>{if(e.modelValue.length>=e.maxCount||!e.showUpload)return;const t=e.readonly?null:(0,o.Wm)("input",{ref:r,type:"file",class:yf("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:d},null);return n.default?(0,o.Wm)("div",{class:yf("input-wrapper"),onClick:C},[n.default(),t]):(0,o.Wm)("div",{class:yf("upload",{readonly:e.readonly}),style:(0,Q.Xn)(e.previewSize),onClick:C},[(0,o.Wm)(E.J,{name:e.uploadIcon,class:yf("upload-icon")},null),e.uploadText&&(0,o.Wm)("span",{class:yf("upload-text")},[e.uploadText]),t])},k=()=>{r.value&&!e.disabled&&r.value.click()};return(0,o.Jd)((()=>{a.forEach((e=>URL.revokeObjectURL(e)))})),(0,y.F)({chooseFile:k,closeImagePreview:m}),(0,u.aM)((()=>e.modelValue)),()=>(0,o.Wm)("div",{class:yf()},[(0,o.Wm)("div",{class:yf("wrapper",{disabled:e.disabled})},[w(),S()])])}});const Tf=(0,r.n)(Rf);const Af="3.5.2";function Df(e){const t=[m,P,z,X,yt,jt,ke,M.C,A,wn,Dn,Cr,De,_r,Br,Wr,qr,no,uo,mo,yo,Eo,Do,Bo,Ho,Jo,oi,_i,Li,Xi,ea,la,fa,wi,et,Me,ga,Ca,E.J,In,Na,Ga,qa,Za,k.g,Qa.g,os,cs,ys,As,Ds.a,Ws,Hs,me,wc,U.G,Ic,Nc,Pt,Et,Vc,zc,$c,tl,sl,dl,bl,El,Fl,zl,Ul,zn,Kl,Yn,Ql,lr,at,vr,af,ff,mr,Tt,tt.F,mf,Tf];t.forEach((t=>{t.install?e.use(t):t.name&&e.component(t.name,t)}))}var Of={install:Df,version:Af}},2229:function(e,t,n){"use strict";n.d(t,{g:function(){return v}});var r=n(1404),o=(n(3948),n(3396)),i=n(9537),a=n(5323),s=n(2220),u=n(8332);const[c,l]=(0,i["do"])("loading"),f=Array(12).fill(null).map(((e,t)=>(0,o.Wm)("i",{class:l("line",String(t+1))},null))),d=(0,o.Wm)("svg",{class:l("circular"),viewBox:"25 25 50 50"},[(0,o.Wm)("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),p={size:a.Or,type:(0,a.SQ)("circular"),color:String,vertical:Boolean,textSize:a.Or,textColor:String};var h=(0,o.aZ)({name:c,props:p,setup(e,{slots:t}){const n=(0,o.Fl)((()=>(0,s.l7)({color:e.color},(0,u.Xn)(e.size)))),r=()=>{var n;if(t.default)return(0,o.Wm)("span",{class:l("text"),style:{fontSize:(0,u.Nn)(e.textSize),color:null!=(n=e.textColor)?n:e.color}},[t.default()])};return()=>{const{type:t,vertical:i}=e;return(0,o.Wm)("div",{class:l([t,{vertical:i}]),"aria-live":"polite","aria-busy":!0},[(0,o.Wm)("span",{class:l("spinner",t),style:n.value},["spinner"===t?f:d]),r()])}}});const v=(0,r.n)(h)},1296:function(e,t,n){"use strict";n.d(t,{g:function(){return f},Z:function(){return d}});var r=n(4870),o=n(6491);const{hasOwnProperty:i}=Object.prototype;function a(e,t,n){const r=t[n];(0,o.Xq)(r)&&(i.call(e,n)&&(0,o.Kn)(r)?e[n]=s(Object(e[n]),r):e[n]=r)}function s(e,t){return Object.keys(t).forEach((n=>{a(e,t,n)})),e}var u={name:"姓名",tel:"电话",save:"保存",confirm:"确认",cancel:"取消",delete:"删除",loading:"加载中...",noCoupon:"暂无优惠券",nameEmpty:"请填写姓名",addContact:"添加联系人",telInvalid:"请填写正确的电话",vanCalendar:{end:"结束",start:"开始",title:"日期选择",weekdays:["日","一","二","三","四","五","六"],monthTitle:(e,t)=>`${e}年${t}月`,rangePrompt:e=>`最多选择 ${e} 天`},vanCascader:{select:"请选择"},vanPagination:{prev:"上一页",next:"下一页"},vanPullRefresh:{pulling:"下拉即可刷新...",loosing:"释放即可刷新..."},vanSubmitBar:{label:"合计:"},vanCoupon:{unlimited:"无门槛",discount:e=>`${e}折`,condition:e=>`满${e}元可用`},vanCouponCell:{title:"优惠券",count:e=>`${e}张可用`},vanCouponList:{exchange:"兑换",close:"不使用",enable:"可用",disabled:"不可用",placeholder:"输入优惠码"},vanAddressEdit:{area:"地区",postal:"邮政编码",areaEmpty:"请选择地区",addressEmpty:"请填写详细地址",postalEmpty:"邮政编码不正确",addressDetail:"详细地址",defaultAddress:"设为默认收货地址"},vanAddressList:{add:"新增地址"}};const c=(0,r.iH)("zh-CN"),l=(0,r.qj)({"zh-CN":u}),f={messages(){return l[c.value]},use(e,t){c.value=e,this.add({[e]:t})},add(e={}){s(l,e)}};var d=f},6810:function(e,t,n){"use strict";n.d(t,{a:function(){return g}});var r=n(1404),o=(n(3948),n(3396)),i=n(9242),a=n(9537),s=n(5323),u=n(7936),c=n(2220),l=n(8332),f=n(6491),d=n(365);const[p,h]=(0,a["do"])("overlay"),v={show:Boolean,zIndex:s.Or,duration:s.Or,className:s.Vg,lockScroll:s.J5,lazyRender:s.J5,customStyle:Object};var m=(0,o.aZ)({name:p,props:v,setup(e,{slots:t}){const n=(0,d.W)((()=>e.show||!e.lazyRender)),r=e=>{(0,u.PF)(e,!0)},a=n((()=>{var n;const a=(0,c.l7)((0,l.As)(e.zIndex),e.customStyle);return(0,f.Xq)(e.duration)&&(a.animationDuration=`${e.duration}s`),(0,o.wy)((0,o.Wm)("div",{style:a,class:[h(),e.className],onTouchmove:e.lockScroll?r:c.ZT},[null==(n=t.default)?void 0:n.call(t)]),[[i.F8,e.show]])}));return()=>(0,o.Wm)(i.uT,{name:"van-fade",appear:!0},{default:a})}});const g=(0,r.n)(m)},1206:function(e,t,n){"use strict";n.d(t,{G:function(){return A}});var r=n(1404),o=(n(3948),n(3396)),i=n(9242),a=n(4870),s=n(4877),u=n(2220),c=n(5323),l=n(9537),f=n(6491),d=n(9951),p=n(5322),h=n(253),v=n(3444),m=n(5261),g=n(7936);let y=0;const b="van-overflow-hidden";function x(e,t){const n=(0,m.o)(),r=t=>{n.move(t);const r=n.deltaY.value>0?"10":"01",o=(0,h.rP)(t.target,e.value),{scrollHeight:i,offsetHeight:a,scrollTop:s}=o;let u="11";0===s?u=a>=i?"00":"01":s+a>=i&&(u="10"),"11"===u||!n.isVertical()||parseInt(u,2)&parseInt(r,2)||(0,g.PF)(t,!0)},i=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",r,{passive:!1}),y||document.body.classList.add(b),y++},a=()=>{y&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",r),y--,y||document.body.classList.remove(b))},s=()=>t()&&i(),u=()=>t()&&a();(0,h.Ib)(s),(0,o.se)(u),(0,o.Jd)(u),(0,o.YP)(t,(e=>{e?i():a()}))}var w=n(365),C=n(7631),S=n(2598),E=n(6810);const k=(0,u.l7)({},s.W,{round:Boolean,position:(0,c.SQ)("center"),closeIcon:(0,c.SQ)("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:(0,c.SQ)("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[I,_]=(0,l["do"])("popup");let R=2e3;var T=(0,o.aZ)({name:I,inheritAttrs:!1,props:k,emits:["open","close","opened","closed","keydown","update:show","click-overlay","click-close-icon"],setup(e,{emit:t,attrs:n,slots:r}){let s,u;const c=(0,a.iH)(),l=(0,a.iH)(),m=(0,w.W)((()=>e.show||!e.lazyRender)),g=(0,o.Fl)((()=>{const t={zIndex:c.value};if((0,f.Xq)(e.duration)){const n="center"===e.position?"animationDuration":"transitionDuration";t[n]=`${e.duration}s`}return t})),y=()=>{s||(void 0!==e.zIndex&&(R=+e.zIndex),s=!0,c.value=++R,t("open"))},b=()=>{s&&(0,d.I)(e.beforeClose,{done(){s=!1,t("close"),t("update:show",!1)}})},k=n=>{t("click-overlay",n),e.closeOnClickOverlay&&b()},I=()=>{if(e.overlay)return(0,o.Wm)(E.a,{show:e.show,class:e.overlayClass,zIndex:c.value,duration:e.duration,customStyle:e.overlayStyle,onClick:k},{default:r["overlay-content"]})},T=e=>{t("click-close-icon",e),b()},A=()=>{if(e.closeable)return(0,o.Wm)(S.J,{role:"button",tabindex:0,name:e.closeIcon,class:[_("close-icon",e.closeIconPosition),p.e9],classPrefix:e.iconPrefix,onClick:T},null)},D=()=>t("opened"),O=()=>t("closed"),F=e=>t("keydown",e),N=m((()=>{var t;const{round:a,position:s,safeAreaInsetTop:u,safeAreaInsetBottom:c}=e;return(0,o.wy)((0,o.Wm)("div",(0,o.dG)({ref:l,style:g.value,class:[_({round:a,[s]:s}),{"van-safe-area-top":u,"van-safe-area-bottom":c}],onKeydown:F},n),[null==(t=r.default)?void 0:t.call(r),A()]),[[i.F8,e.show]])})),P=()=>{const{position:t,transition:n,transitionAppear:r}=e,a="center"===t?"van-fade":`van-popup-slide-${t}`;return(0,o.Wm)(i.uT,{name:n||a,appear:r,onAfterEnter:D,onAfterLeave:O},{default:N})};return(0,o.YP)((()=>e.show),(e=>{e&&!s&&(y(),0===n.tabindex&&(0,o.Y3)((()=>{var e;null==(e=l.value)||e.focus()}))),!e&&s&&(s=!1,t("close"))})),(0,v.F)({popupRef:l}),x(l,(()=>e.show&&e.lockScroll)),(0,h.OR)("popstate",(()=>{e.closeOnPopstate&&(b(),u=!1)})),(0,o.bv)((()=>{e.show&&y()})),(0,o.dl)((()=>{u&&(t("update:show",!0),u=!1)})),(0,o.se)((()=>{e.show&&e.teleport&&(b(),u=!0)})),(0,o.JJ)(C.S,(()=>e.show)),()=>e.teleport?(0,o.Wm)(o.lR,{to:e.teleport},{default:()=>[I(),P()]}):(0,o.Wm)(o.HY,null,[I(),P()])}});const A=(0,r.n)(T)},4877:function(e,t,n){"use strict";n.d(t,{W:function(){return o},m:function(){return i}});var r=n(5323);const o={show:Boolean,zIndex:r.Or,overlay:r.J5,duration:r.Or,teleport:[String,Object],lockScroll:r.J5,lazyRender:r.J5,beforeClose:Function,overlayStyle:Object,overlayClass:r.Vg,transitionAppear:Boolean,closeOnClickOverlay:r.J5},i=Object.keys(o)},9733:function(e,t,n){"use strict";n.d(t,{F:function(){return T}});n(3948);var r=n(3396),o=n(4870),i=n(2220),a=n(6491),s=n(1404),u=n(7548),c=n(9537),l=n(5323);let f=0;function d(e){e?(f||document.body.classList.add("van-toast--unclickable"),f++):f&&(f--,f||document.body.classList.remove("van-toast--unclickable"))}var p=n(2598),h=n(1206),v=n(2229);const[m,g]=(0,c["do"])("toast"),y=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],b={icon:String,show:Boolean,type:(0,l.SQ)("text"),overlay:Boolean,message:l.Or,iconSize:l.Or,duration:(0,l.qM)(2e3),position:(0,l.SQ)("middle"),teleport:[String,Object],className:l.Vg,iconPrefix:String,transition:(0,l.SQ)("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:l.Vg,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var x=(0,r.aZ)({name:m,props:b,emits:["update:show"],setup(e,{emit:t}){let n,o=!1;const s=()=>{const t=e.show&&e.forbidClick;o!==t&&(o=t,d(o))},u=e=>t("update:show",e),c=()=>{e.closeOnClick&&u(!1)},l=()=>clearTimeout(n),f=()=>{const{icon:t,type:n,iconSize:o,iconPrefix:i,loadingType:a}=e,s=t||"success"===n||"fail"===n;return s?(0,r.Wm)(p.J,{name:t||n,size:o,class:g("icon"),classPrefix:i},null):"loading"===n?(0,r.Wm)(v.g,{class:g("loading"),size:o,type:a},null):void 0},m=()=>{const{type:t,message:n}=e;if((0,a.Xq)(n)&&""!==n)return"html"===t?(0,r.Wm)("div",{key:0,class:g("text"),innerHTML:String(n)},null):(0,r.Wm)("div",{class:g("text")},[n])};return(0,r.YP)((()=>[e.show,e.forbidClick]),s),(0,r.YP)((()=>[e.show,e.type,e.message,e.duration]),(()=>{l(),e.show&&e.duration>0&&(n=setTimeout((()=>{u(!1)}),e.duration))})),(0,r.bv)(s),(0,r.Ah)(s),()=>(0,r.Wm)(h.G,(0,r.dG)({class:[g([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:c,onClosed:l,"onUpdate:show":u},(0,i.ei)(e,y)),{default:()=>[f(),m()]})}});const w={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let C=[],S=!1,E=(0,i.l7)({},w);const k=new Map;function I(e){return(0,a.Kn)(e)?e:{message:e}}function _(){const{instance:e,unmount:t}=(0,u.H)({setup(){const n=(0,o.iH)(""),{open:i,state:a,close:s,toggle:c}=(0,u.o)(),l=()=>{S&&(C=C.filter((t=>t!==e)),t())},f=()=>{const e={onClosed:l,"onUpdate:show":c};return(0,r.Wm)(x,(0,r.dG)(a,e),null)};return(0,r.YP)(n,(e=>{a.message=e})),(0,r.FN)().render=f,{open:i,clear:s,message:n}}});return e}function R(){if(!C.length||S){const e=_();C.push(e)}return C[C.length-1]}function T(e={}){if(!i._f)return{};const t=R(),n=I(e);return t.open((0,i.l7)({},E,k.get(n.type||E.type),n)),t}const A=e=>t=>T((0,i.l7)({type:e},I(t)));function D(e,t){"string"===typeof e?k.set(e,t):(0,i.l7)(E,e)}T.loading=A("loading"),T.success=A("success"),T.fail=A("fail"),T.clear=e=>{var t;C.length&&(e?(C.forEach((e=>{e.clear()})),C=[]):S?null==(t=C.shift())||t.clear():C[0].clear())},T.setDefaultOptions=D,T.resetDefaultOptions=e=>{"string"===typeof e?k.delete(e):(E=(0,i.l7)({},w),k.clear())},T.allowMultiple=(e=!0)=>{S=e},T.install=e=>{e.use((0,s.n)(x)),e.config.globalProperties.$toast=T}},2220:function(e,t,n){"use strict";n.d(t,{U2:function(){return a},ZT:function(){return r},_f:function(){return i},ei:function(){return s},l7:function(){return o},qo:function(){return u}});n(4916),n(5827);function r(){}const o=Object.assign,i="undefined"!==typeof window;function a(e,t){const n=t.split(".");let r=e;return n.forEach((e=>{var t;r=null!=(t=r[e])?t:""})),r}function s(e,t,n){return t.reduce(((t,r)=>(n&&void 0===e[r]||(t[r]=e[r]),t)),{})}const u=e=>Array.isArray(e)?e:[e]},5322:function(e,t,n){"use strict";n.d(t,{T5:function(){return r},WN:function(){return f},_K:function(){return s},a8:function(){return i},e9:function(){return l},k7:function(){return o},pj:function(){return c},r5:function(){return u},xe:function(){return a}});n(1817);const r="van-hairline",o=`${r}--top`,i=`${r}--left`,a=`${r}--bottom`,s=`${r}--surround`,u=`${r}--top-bottom`,c=`${r}-unset--top-bottom`,l="van-haptics-feedback",f=Symbol("van-form")},9537:function(e,t,n){"use strict";n.d(t,{do:function(){return l}});n(3948),n(5827);var r=n(2220),o=n(8332),i=n(6491),a=n(1296);function s(e){const t=(0,o._A)(e)+".";return(e,...n)=>{const o=a.Z.messages(),s=(0,r.U2)(o,t+e)||(0,r.U2)(o,e);return(0,i.mf)(s)?s(...n):s}}function u(e,t){return t?"string"===typeof t?` ${e}--${t}`:Array.isArray(t)?t.reduce(((t,n)=>t+u(e,n)),""):Object.keys(t).reduce(((n,r)=>n+(t[r]?u(e,r):"")),""):""}function c(e){return(t,n)=>(t&&"string"!==typeof t&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${u(t,n)}`)}function l(e){const t=`van-${e}`;return[t,c(t),s(t)]}},7936:function(e,t,n){"use strict";n.d(t,{PF:function(){return h},QU:function(){return s},U4:function(){return l},UW:function(){return p},bn:function(){return m},cx:function(){return a},kn:function(){return c},oD:function(){return u},pe:function(){return d},uK:function(){return g},xj:function(){return v}});var r=n(253),o=n(4870),i=n(6491);function a(e){const t="scrollTop"in e?e.scrollTop:e.pageYOffset;return Math.max(t,0)}function s(e,t){"scrollTop"in e?e.scrollTop=t:e.scrollTo(e.scrollX,t)}function u(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}function c(e){s(window,e),s(document.body,e)}function l(e,t){if(e===window)return 0;const n=t?a(t):u();return(0,r.EL)(e).top+n}const f=(0,i.gn)();function d(){f&&c(u())}const p=e=>e.stopPropagation();function h(e,t){("boolean"!==typeof e.cancelable||e.cancelable)&&e.preventDefault(),t&&p(e)}function v(e){const t=(0,o.SU)(e);if(!t)return!1;const n=window.getComputedStyle(t),r="none"===n.display,i=null===t.offsetParent&&"fixed"!==n.position;return r||i}const{width:m,height:g}=(0,r.iP)()},8332:function(e,t,n){"use strict";n.d(t,{As:function(){return u},Bd:function(){return y},Ft:function(){return C},GL:function(){return g},LU:function(){return h},Nn:function(){return a},Xn:function(){return s},_A:function(){return m},uZ:function(){return b},uf:function(){return w}});n(4916),n(5306),n(6699);var r=n(2220),o=n(7936),i=n(6491);function a(e){if((0,i.Xq)(e))return(0,i.kE)(e)?`${e}px`:String(e)}function s(e){if((0,i.Xq)(e)){if(Array.isArray(e))return{width:a(e[0]),height:a(e[1])};const t=a(e);return{width:t,height:t}}}function u(e){const t={};return void 0!==e&&(t.zIndex=+e),t}let c;function l(){if(!c){const e=document.documentElement,t=e.style.fontSize||window.getComputedStyle(e).fontSize;c=parseFloat(t)}return c}function f(e){return e=e.replace(/rem/g,""),+e*l()}function d(e){return e=e.replace(/vw/g,""),+e*o.bn.value/100}function p(e){return e=e.replace(/vh/g,""),+e*o.uK.value/100}function h(e){if("number"===typeof e)return e;if(r._f){if(e.includes("rem"))return f(e);if(e.includes("vw"))return d(e);if(e.includes("vh"))return p(e)}return parseFloat(e)}const v=/-(\w)/g,m=e=>e.replace(v,((e,t)=>t.toUpperCase())),g=e=>e.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^-/,"");function y(e,t=2){let n=e+"";while(n.length<t)n="0"+n;return n}const b=(e,t,n)=>Math.min(Math.max(e,t),n);function x(e,t,n){const r=e.indexOf(t);return-1===r?e:"-"===t&&0!==r?e.slice(0,r):e.slice(0,r+1)+e.slice(r).replace(n,"")}function w(e,t=!0,n=!0){e=t?x(e,".",/\./g):e.split(".")[0],e=n?x(e,"-",/-/g):e.replace(/-/,"");const r=t?/[^-0-9.]/g:/[^-0-9]/g;return e.replace(r,"")}function C(e,t){const n=10**10;return Math.round((e+t)*n)/n}},9951:function(e,t,n){"use strict";n.d(t,{I:function(){return i}});var r=n(2220),o=n(6491);function i(e,{args:t=[],done:n,canceled:i}){if(e){const a=e.apply(null,t);(0,o.tI)(a)?a.then((e=>{e?n():i&&i()})).catch(r.ZT):a?n():i&&i()}else n()}},7548:function(e,t,n){"use strict";n.d(t,{H:function(){return u},o:function(){return s}});var r=n(4870),o=n(9242),i=n(2220),a=n(3444);function s(){const e=(0,r.qj)({show:!1}),t=t=>{e.show=t},n=n=>{(0,i.l7)(e,n,{transitionAppear:!0}),t(!0)},o=()=>t(!1);return(0,a.F)({open:n,close:o,toggle:t}),{open:n,close:o,state:e,toggle:t}}function u(e){const t=(0,o.ri)(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}},5323:function(e,t,n){"use strict";n.d(t,{Ce:function(){return s},J5:function(){return i},Or:function(){return o},SI:function(){return c},SQ:function(){return l},Vg:function(){return r},ir:function(){return a},qM:function(){return u}});const r=null,o=[Number,String],i={type:Boolean,default:!0},a=e=>({type:e,required:!0}),s=()=>({type:Array,default:()=>[]}),u=e=>({type:Number,default:e}),c=e=>({type:o,default:e}),l=e=>({type:String,default:e})},6491:function(e,t,n){"use strict";n.d(t,{J_:function(){return u},Kn:function(){return a},Xq:function(){return o},gn:function(){return f},kE:function(){return l},mf:function(){return i},tI:function(){return s},tq:function(){return c}});n(4916),n(5306);var r=n(2220);const o=e=>void 0!==e&&null!==e,i=e=>"function"===typeof e,a=e=>null!==e&&"object"===typeof e,s=e=>a(e)&&i(e.then)&&i(e.catch),u=e=>"[object Date]"===Object.prototype.toString.call(e)&&!Number.isNaN(e.getTime());function c(e){return e=e.replace(/[^-|\d]/g,""),/^((\+86)|(86))?(1)\d{10}$/.test(e)||/^0[0-9-]{10,13}$/.test(e)}const l=e=>"number"===typeof e||/^\d+(\.\d+)?$/.test(e),f=()=>!!r._f&&/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase())},1404:function(e,t,n){"use strict";n.d(t,{n:function(){return o}});var r=n(8332);function o(e){return e.install=t=>{const{name:n}=e;t.component(n,e),t.component((0,r._A)(`-${n}`),e)},e}}}]);
//# sourceMappingURL=chunk-vendors.ef245949.js.map